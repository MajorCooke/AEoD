//================================================================================================================
//================================================================================================================
//
//
//					AEons Of Death v6: Class 10 weapons
//
//
//================================================================================================================
//================================================================================================================

//The Hand of God
//Remake by Major Cooke

/*
Every culture, religion, or group has a trump card. It could be a cult, a faith, 
a race, or something else. Everyone or everything will have something of power
they may or may not use in any given circumstance. 

In the case of the Triads, it was the Hand of God. Fortunately, the Hand of God
refuses to bind itself to entities that seek to use it for the wrong reasons.
Now they know it was a mistake investing time into such a powerful artifact's
creation with the help of the fallen angels. To ensure none could stumble upon
or steal the Hand's powers, El Oscuro stored it in a pocket dimension that requires
constant attention towards, for the void desperately wants to spit it out. It 
goes without saying: killing him is the only way to get it.

The Hand of God is a powerful weapon, capable of blazing through enemies en masse
and dissolving them entirely, leaving nothing left. Their entire physical, 
elemental, and spiritual existence is erased from the mortal universe, thrusting
them back into the afterlife. The might of the holy power expressed by Heaven is
so vast, no enemy can resist its prowess, save for Lucifer himself along with a
few questionable entities.

The other powerful ability it offers is the ability to call forth a repentive
El Oscuro in the form of many -- more than one of him can be summoned at any
given time to fight the legions. His images possess all his power, along with
an ethereal invulnerability. As long as he has retribution to mete out, he will
remain and fight.
*/

Actor AEoDHandOfGodItem : AEoDWeaponPickup //6124
{
	Inventory.Amount 1
	Inventory.PickupMessage "You have the Hand of God. Banish the demons back to hell!"
	Inventory.PickupSound "HandOfGod/Pickup"
	Scale 0.5
	States
	{
	Spawn:
		GDPU ABCDEFGH 3 Bright
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDHandOfGod",1,"Ammo")
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",0) <= 0,"Nothing")
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("HandOfGodDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDHandOfGod",1)
		TNT1 A 0 A_SpawnItemEx("HandOfGodPickupFX",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_PrintBold("\cgSlot 10: Hand of God")
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDHandOfGod",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,0,159,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDHandOfGod",1)
		Stop
	}
}

Actor AEoDHandOfGod : AEoDWeaponBase // 6124
{
	+IGNORESKILL	
	+DONTGIB
	+WEAPON.CHEATNOTWEAPON
	Inventory.PickupMessage "You have the Hand of God. Banish the demons back to hell!"
	Inventory.PickupSound "HandOfGod/Pickup"
	Weapon.AmmoType BlueMana
	Weapon.AmmoType2 BlueMana
	Weapon.AmmoGive1 250
	Weapon.AmmoUse1 200
	Weapon.AmmoUse2 350 
	Weapon.SelectionOrder 19800
	Weapon.UpSound "weapons/draw"
	Scale 0.5
	Tag "Hand of god"
	States
	{
	Spawn:
		GDPU ABCDEFGH 3 bright
		Loop
	Pickup:
		TNT1 A 0 A_SpawnItemEx("HandOfGodPickupFX",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		Stop
	Select:
		TNT1 A 0 	
		GDWP A 1 A_Raise
		GDWP AA 0 A_Raise
		Loop
	Deselect:
		TNT1 A 0 	
		GDWP A 1 A_Lower
		GDWP AA 0 A_Lower
		Loop
	Ready:
		GDWP A 1 A_WeaponReady
		Loop
	Fire:
		GDWP A 0 A_JumpIfInventory("PowerEconomizer",1,3)
		GDWP A 0 A_JumpIfInventory("InfiniteAmmo",1,2)
		GDWP A 0 A_JumpIfInventory("BlueMana",1,1)
		Goto Ready
		
		GDWP ABCDE 4 bright
		GDWP F 0 Bright A_PlayWeaponSound("weapons/gshoot")
		GDWP F 4 Bright A_FireCustomMissile("GodBall",0,1,0)
		GDWP GH 4 bright
		Goto Ready
	AltFire:
		GDWP A 0 A_JumpIfInventory("PowerEconomizer",1,3)
		GDWP A 0 A_JumpIfInventory("InfiniteAmmo",1,2)
		GDWP A 0 A_JumpIfInventory("BlueMana",5,1)
		Goto Ready
		
		GDWP A 4 bright
		GDWP BCDE 4 bright
		GDWP F 0 A_PlayWeaponSound("Weapons/gshoot")
		GDWP F 0 A_SpawnItemEx("OscuroHelperPortal",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER|SXF_TRANSFERPOINTERS)
		GDWP F 4 Bright A_FireCustomMissile("Nothing",0,1,0)
		GDWP GH 4 bright
		GDWP A 45 bright
		Goto Ready
	}
}


Actor GodBall
{
	var int user_c;
	Radius 6
	Height 5
	Speed 20
	Damage 75
	Scale .65
	Projectile
	+FORCERADIUSDMG
	+NODAMAGETHRUST +CANNOTPUSH
	+SEEKERMISSILE
	+THRUACTORS
	//+SKYEXPLODE
	+DONTREFLECT
	+EXTREMEDEATH
	+STEPMISSILE
	+NOTIMEFREEZE
	+FOILINVUL
	+BOUNCEONFLOORS
	+CANBOUNCEWATER
	+DONTSPLASH
	+PAINLESS
	+NODAMAGE //Don't allow A_Kill functions to destroy this projectile.
	//+foilbuddha
	DamageType "HolyNoResist"
	DeathType "Disintegrate"
	RenderStyle Add
	BounceFactor 1
	Alpha 1
	MaxStepHeight 48
	SeeSound "weapons/gcharge"
	DeathSound "weapons/gexplode"   
	States
	{
	Spawn:
		GDBA ABCDABCD 1 bright
		{
			A_SeekerMissile(90,90);
			A_FaceTracer;	
			A_SpawnItemEx("GodsBallTrailSpawner",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION);
			A_Explode(256,24,0);
		}
		Goto SeekerTime
	SeekerTime:
		GDBA AABBCCDD 1 bright
		{
			A_SeekerMissile(90,90,SMF_LOOK|SMF_PRECISE);
			A_FaceTracer;
			A_SpawnItemEx("GodsBallTrailSpawner",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION);
			if (!A_JumpIfTargetInLOS("Null",360,JLOSF_CHECKTRACER,512))
			{	A_RearrangePointers(AAPTR_DEFAULT,AAPTR_DEFAULT,AAPTR_NULL,PTROP_NOSAFEGUARDS);	}
			A_SetUserVar(user_c, (user_c + 1) % 2);
			if (user_c)	{ A_SpawnItemEx("GodBallVaporizer",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS);	}
		}
		Loop
	Death:
		TNT1 A 1
		{	
			A_Explode(1000000,128,0);
			A_PlaySound("weapons/gexplode",5,1);
			A_PlaySound("weapons/gvaporize",6,1);
			A_SpawnItemEx("MonExplosionMediumNoSmokeSimple",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER);
		} 
		TNT1 AAAAA 5 A_SpawnItemEx("HRWhiteFX",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		Stop
	}
}

Actor GodsBallTrailSpawner
{
	+NOTIMEFREEZE
	+NOINTERACTION
	+NOTONAUTOMAP
	RenderStyle None
	States
	{
	Spawn:
		TNT1 A 0 
		TNT1 AAAAAA 0 A_SpawnItemEx("GodsBallTrail",0,random(7,-7),random(5,-5),random(1,2),random(1,2),random(-2,2),random(1,360),SXF_NOCHECKPOSITION)
		Stop
	}
}

Actor GodsBallTrail //heh
{
	+NOTIMEFREEZE
	Translation "0:255=%[0,0,0]:[1.0,1.0,1.0]"
	+NOINTERACTION
	Scale 0.1
	RenderStyle Add
	States
	{
	Spawn:
		TNT1 A 0
		X079 ABCDEFGH 0	A_JumpIf(random(1,8) == 1,"Perform")
	Perform:
		"####" "#" 1 A_SetScale(ScaleX+0.01)
		"####" "#" 0 A_FadeOut(0.05)
		Loop
	}
}

Actor GodBallVaporizer
{
	Radius 24
	Height 7
	Speed 0
	Damage 50
	Projectile
	+FORCERADIUSDMG
	+EXTREMEDEATH
	+NODAMAGETHRUST +CANNOTPUSH
	+DONTREFLECT
	+FOILINVUL
	+PAINLESS
	+NODAMAGE
	+NOTIMEFREEZE
	DeathSound "weapons/gvaporize"
	DamageType "Holy"
	DeathType "Disintegrate"
	States
	{
	Spawn:
		TNT1 A 1
		Stop
	Death:
		TNT1 A 0 A_Explode(512,36,0)
		TNT1 A 1 A_PlaySound("weapons/gvaporize",CHAN_AUTO,1,0)
		Stop
	}
}

Actor OscuroHelperPortal
{
	Projectile
	+NOTIMEFREEZE
	+NOINTERACTION
	+NODAMAGE
	Speed 0
	Height 1
	Radius 1
	RenderStyle Add
	States
	{
	Spawn:
		TNT1 A 16 NoDelay A_SpawnItemEx("HeavenlyPortalFX",0,0,-16,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 AAAAAAA 16
		TNT1 A 0 A_SpawnItemEx("OscuroPlayer",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER)
		Stop
	}
}

Actor PortalFX1
{
	Projectile
	+NOTIMEFREEZE
	+NOINTERACTION
	Speed 4
	Height 1
	Radius 1
	Scale 0.25
	RenderStyle Add
	States
	{
	Spawn:
		CB02 A 0 NoDelay A_PlaySound("weapons/gvaporize")
		CB02 ABCDEFGHIJKL 3 bright
		CB02 MNOPQRS 2 bright
		Stop
	}
}

Actor HandOfGodPickupFX
{
	+NOINTERACTION
	+NOTONAUTOMAP
	Renderstyle None
	States
	{
	Spawn:
		TNT1 A 175 NoDelay A_PlaySound("HandOfGod/Pickup",CHAN_AUTO,1,0,ATTN_NONE)
		Stop
	}
}

Actor OscuroPlayer
{
	var int user_life;
	var int user_chasecount;
	var int user_target;
	//DesignatedTeam 1
	Health 1500000
	Radius 18
	Height 64
	Speed 12
	PainChance 255
	Scale .65
	MONSTER
	+DONTTHRUST
	+BOSS
	+BOSSDEATH
	+NOBLOCKMONST
	+NOICEDEATH
	+FULLVOLACTIVE
	+FULLVOLDEATH
	+NOTIMEFREEZE
	+DONTMORPH
	+QUICKTORETALIATE
	+FRIENDLY
	+MISSILEMORE
	+MISSILEEVENMORE
	+DONTRIP
	+MBFBOUNCER
	+FORCERADIUSDMG
	+FOILINVUL
	+FOILBUDDHA
	-SOLID
	-NODROPOFF
	+DROPOFF
	+THRUSPECIES
	+DONTHURTSPECIES
	+NODAMAGE
	+NOTELESTOMP
	+ALLOWPAIN
	+DONTGIB
	+NOPAIN
	Species "OscuroAlly"
	//+AVOIDMELEE
	SeeSound "oscuro/alert"
	DeathSound "oscuro/die"
	PainSound ""
	ActiveSound "oscuro/active"
	DamageType "Holy"
	PainChance "Seeker", 255
	PainChance "Ice", 255
	PainChance "Fire", 255
	PainChance "Poison", 255
	PainChance "Disintegrate", 255
	PainChance "Bone", 255
	PainChance "Drain", 255
	PainChance "DBT", 255
	PainChance "CleansingFire", 255
	DamageFactor "OscuroHelper", 0
	DamageFactor "TempestLightning", 0
	DamageFactor "Normal", 0.1
	States
	{
	Spawn:
		OIDL A 0 NoDelay 
		{
			A_SetUserVar("user_life",1000);
			A_SetInvulnerable;
			A_CopyFriendliness(AAPTR_PLAYER1);
			A_RearrangePointers(AAPTR_DEFAULT,AAPTR_PLAYER1,AAPTR_DEFAULT,4);
			A_ChangeFlag(NOPAIN,false);
		}
		OIDL AAAAAAAAAA 1 A_FadeIn(0.05,FTF_CLAMP)
		OIDL A 0 A_Gravity
		OIDL AAAAAAAAA 7 A_Look
		Goto See
	See:
		//"####" "#" 0 A_CopyFriendliness(AAPTR_PLAYER1)
		"####" "#" 0 A_ChangeFlag("FRIENDLY",1)
		OIDL AAAAAAAAA 7 A_FaceTarget //10 frames
		OSEE ABCD 4 //14 frames
		OSEE D 0 { A_SetFloat; A_NoGravity; }
		//OSEE D 0 A_CopyFriendliness(AAPTR_MASTER)
	ResetAndChase:
		OFLY A 0 
		{
			A_SetUserVar(user_target,0);
			A_Stop;
		}
	Chasing:
		OFLY A 0 
		{
			A_ChangeFlag("NOPAIN",0);
			A_UnsetInvulnerable;
			A_ChangeFlag("SOLID",0);
		}
	ChaseCont:
		//OFLY A 0 A_CopyFriendliness(AAPTR_PLAYER1)
		"####" "#" 0 
		{
			A_ChangeFlag("FRIENDLY",1);
			if (A_JumpIfHealthLower(1,"Null",TargetPtr) || (IsPointerEqual(AAPTR_TARGET,AAPTR_NULL)))
			{
				A_SetUserVar(user_target,0);
				A_Stop;
				A_ClearTarget;
			}
		}
		OFLY AAAAAAAA 2 A_Chase("","Missile")
		OFLY A 0 
		{
			// No time left. Bye bye.
			if (user_life <= 0)
			{	
				A_ChangeFlag(NODAMAGE,false);
				A_Die;
				return state("Death");	
			}
			//
			if (!A_JumpIfTargetInLOS("Null",360))
			{
				A_SetUserVar(user_target,user_target+1);
				if (user_target > 4)
				{	
					A_ClearTarget;
					A_SetUserVar(user_target,0);
				}
				return state("Chasing");
			}
			
			if (GetDistance(true) <= 128)
			{	return state("Melee");	}
			A_SetUserVar("user_life", user_life-2);
			return state("Chasing");
		}
		Goto ResetAndChase
	Melee:
		OSEE A 1
		OSEE A 0 
		{
			if (A_JumpIfHealthLower(1,"Null",TargetPtr) || (IsPointerEqual(AAPTR_TARGET,AAPTR_NULL)))
			{
				A_SetUserVar(user_target,0);
				A_Stop;
				A_ClearTarget;
				return state("Chasing");
			}
			
			if (random(1,2) == 1)
			{	return state("GoldFaceAttack");	}
			
			A_ChangeFlag("NOPAIN",1); A_SetInvulnerable; A_ChangeFlag("SOLID",1); A_SetUserVar("user_chasecount",0); 
			return state(1);
		}
		OSEE DCBABCD 2 A_FaceTarget
	HurtingChaseLooper:
		OCHA A 0 A_JumpIfTargetInLOS(2,360,JLOSF_DEADNOJUMP)
		OCHA A 0 A_Stop
		Goto Chasing
		
		OCHA A 0 A_FaceTarget
		OCHA A 0 A_Recoil(-50)
		OCHA A 2 A_CustomMissile("ChaseDamager",48,0,0)
		OCHA A 0 A_SetUserVar("user_chasecount",user_chasecount+1)
		OCHA A 0 A_JumpIf(user_chasecount>=50,1)
		Loop
		TNT1 A 0 A_ChangeFlag("SOLID",0)
		TNT1 A 0 A_Stop
		TNT1 A 0 A_UnSetInvulnerable
		OCHA A 0 A_Jump(64,"GoldFaceAttack")
		OCHA A 0 A_JumpIfCloser(128,"MeleeReachCheck")
		Goto GoldFaceAttack
	MeleeReachCheck:
		OCHA A 0 A_Jump(205,"Melee")
		Goto GoldFaceAttack
	GoldFaceAttack:
		OATS AAAAAAAA 4 A_FaceTarget
		OATS BCD 4 Bright A_FaceTarget
		OATS D 0 Bright A_PlaySound("oscuro/specialfire")
		OATS E 4 Bright A_CustomMissile("GoldFaceHoly",48,0)
		OATS FGHI 4 //36 frames
		//OATS I 0 A_JumpIfCloser(128,"GoldFaceAttack")
		Goto Chasing
	Missile:
		TNT1 A 0 A_Jump(129,"Missile2")
		//TNT1 A 0 A_SetInvulnerable
		OATG ABCDEF 2 Bright A_FaceTarget
		OATG G 0 Bright A_PlaySound("oscuro/missile1fire")
		OATG G 4 Bright A_CustomMissile("SilverMissileHoly",56,14)
		OATG G 0 Bright A_PlaySound("oscuro/missile1fire")
		OATG G 4 Bright A_CustomMissile("SilverMissileHoly",56,14)
		OATG G 0 Bright A_PlaySound("oscuro/missile1fire")
		OATG G 4 Bright A_CustomMissile("SilverMissileHoly",56,14)
		OATG G 0 Bright A_PlaySound("oscuro/missile1fire")
		OATG G 4 Bright A_CustomMissile("SilverMissileHoly",56,14)
		OATG G 0 Bright A_PlaySound("oscuro/missile1fire")
		OATG G 4 Bright A_CustomMissile("SilverMissileHoly",56,14)
		OATG G 0 Bright A_PlaySound("oscuro/missile1fire")
		OATG G 4 Bright A_CustomMissile("SilverMissileHoly",56,14)
		OATG G 0 Bright A_PlaySound("oscuro/missile1fire")
		OATG G 4 Bright A_CustomMissile("SilverMissileHoly",56,14)
		OATG G 0 Bright A_PlaySound("oscuro/missile1fire")
		OATG G 4 Bright A_CustomMissile("SilverMissileHoly",56,14)
		OATG HIJ 2 //61 frames
		Goto Chasing
	Missile2:
		TNT1 A 0 //A_Jump(32,"ZeroFire")
		//TNT1 A 0 A_SetInvulnerable
		OAT2 ABC 4 Bright A_FaceTarget
		OAT2 D 0 Bright A_PlaySound("oscuro/missile2fire")
		OAT2 D 4 Bright A_CustomMissile("GreenSphereHoly")
		OAT2 EF 4
		Goto Chasing
	MeteorFire:
		OATS A 0 A_SetInvulnerable
		OATS AAAAAAAA 4 Bright A_FaceTarget
		OATS B 4 bright
		OATS C 4 bright
		OATS D 0 Bright A_PlaySound("weapons/volcanofire")
		OATS D 4 Bright A_CustomMissile("MeteorWeakHoly",0,0)
		OATS EFGHI 4 bright
		OATS I 0 Bright A_UnSetInvulnerable
		Goto Chasing
	ApocalypseFire:
		TNT1 A 0 A_SetInvulnerable
		TNT1 A 0 A_PlaySound("castspell/fire")
		OAT1 AAAAAAAA 4 A_FaceTarget
		OAT1 BCDEF 2 Bright A_FaceTarget
		OAT1 G 0 Bright A_PlaySound("oscuro/specialfire")
		OAT1 G 2 Bright A_CustomMissile("ApocalypseStarter2",48,0)
		OAT1 HI 2
		Goto Chasing
	Death:
		TNT1 A 0 A_SetFloorClip
		OFLY A 20 Bright //A_NoBlocking
		OFLY A 0 Bright A_SpawnItemEx("HeavenlyPortalFX",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		OFLY A 1 Bright A_FadeOut(0.02)
		Wait
	Pain:
		OATS A 0 A_ChangeFlag("NOPAIN",1)
		OATS A 0 A_SetUserVar("user_life",user_life+50)
		Goto Pain.Seeker
	Pain.Ice:
		OATS A 0 A_ChangeFlag("NOPAIN",1)
		OATS A 0 A_FadeIn(1,FTF_CLAMP)
		OATS A 0 A_Jump(30,"MeteorFire")
		OATS A 0 A_SetInvulnerable
		OATS A 0 A_SetUserVar("user_life",user_life+35)
		OATI AAAAAAAA 4 Bright A_FaceTarget
		OATI BCDE 2 bright
		OATI F 4 Bright A_CustomMissile("IceRetaliationHoly",48,0)
		OATI F 0 Bright A_PlaySound("oscuro/flamefire")
		OATI F 4 Bright A_CustomMissile("IceRetaliationHoly",48,0)
		OATI F 0 Bright A_PlaySound("oscuro/flamefire")
		OATI F 4 Bright A_CustomMissile("IceRetaliationHoly",48,0)
		OATI F 0 Bright A_PlaySound("oscuro/flamefire")
		OATI F 4 Bright A_CustomMissile("IceRetaliationHoly",48,0)
		OATI F 0 Bright A_PlaySound("oscuro/flamefire")
		OATI F 4 Bright A_CustomMissile("IceRetaliationHoly",48,0)
		OATI F 0 Bright A_PlaySound("oscuro/flamefire")
		OATI F 4 Bright A_CustomMissile("IceRetaliationHoly",48,0)
		OATI F 0 Bright A_PlaySound("oscuro/flamefire")
		OATI F 4 Bright A_CustomMissile("IceRetaliationHoly",48,0)
		OATI F 0 Bright A_PlaySound("oscuro/flamefire")
		OATI F 4 Bright A_CustomMissile("IceRetaliationHoly",48,0)
		OATI F 0 Bright A_PlaySound("oscuro/flamefire")
		OATI GH 2
		Goto Chasing
	Pain.AEPoison:
	Pain.Fire:
		OATS A 0 A_ChangeFlag("NOPAIN",1)
		OATS A 0 A_FadeIn(1,FTF_CLAMP)
		OATS A 0 A_SetUserVar("user_life",user_life+30)
		OATS A 0 A_Jump(30,"ApocalypseFire")
		OATF ABC 2 Bright A_FaceTarget
		OATF D 0 Bright A_CustomMissile("FlameRetaliationHoly",0,0,0,CMF_AIMDIRECTION)
		OATF D 0 Bright A_CustomMissile("FlameRetaliationHoly",0,0,20,CMF_AIMDIRECTION)
		OATF D 0 Bright A_CustomMissile("FlameRetaliationHoly",0,0,-20,CMF_AIMDIRECTION)
		OATF D 4 Bright A_PlaySound("oscuro/flamefire")
		OATF D 0 A_FaceTarget
		OATF D 0 Bright A_CustomMissile("FlameRetaliationHoly",0,0,0,CMF_AIMDIRECTION)
		OATF D 0 Bright A_CustomMissile("FlameRetaliationHoly",0,0,20,CMF_AIMDIRECTION)
		OATF D 0 Bright A_CustomMissile("FlameRetaliationHoly",0,0,-20,CMF_AIMDIRECTION)
		OATF D 4 Bright A_PlaySound("oscuro/flamefire")
		OATF D 0 A_FaceTarget
		OATF D 0 Bright A_CustomMissile("FlameRetaliationHoly",0,0,0,CMF_AIMDIRECTION)
		OATF D 0 Bright A_CustomMissile("FlameRetaliationHoly",0,0,20,CMF_AIMDIRECTION)
		OATF D 0 Bright A_CustomMissile("FlameRetaliationHoly",0,0,-20,CMF_AIMDIRECTION)
		OATF D 4 Bright A_PlaySound("oscuro/flamefire")
		OATF D 0 A_FaceTarget
		OATF D 0 Bright A_CustomMissile("FlameRetaliationHoly",0,0,0,CMF_AIMDIRECTION)
		OATF D 0 Bright A_CustomMissile("FlameRetaliationHoly",0,0,20,CMF_AIMDIRECTION)
		OATF D 0 Bright A_CustomMissile("FlameRetaliationHoly",0,0,-20,CMF_AIMDIRECTION)
		OATF D 4 Bright A_PlaySound("oscuro/flamefire")
		OATF D 0 A_FaceTarget
		OATF D 0 Bright A_CustomMissile("FlameRetaliationHoly",0,0,0,CMF_AIMDIRECTION)
		OATF D 0 Bright A_CustomMissile("FlameRetaliationHoly",0,0,20,CMF_AIMDIRECTION)
		OATF D 0 Bright A_CustomMissile("FlameRetaliationHoly",0,0,-20,CMF_AIMDIRECTION)
		OATF D 4 Bright A_PlaySound("oscuro/flamefire")
		OATF D 0 A_FaceTarget
		OATF D 0 Bright A_CustomMissile("FlameRetaliationHoly",0,0,0,CMF_AIMDIRECTION)
		OATF D 0 Bright A_CustomMissile("FlameRetaliationHoly",0,0,20,CMF_AIMDIRECTION)
		OATF D 0 Bright A_CustomMissile("FlameRetaliationHoly",0,0,-20,CMF_AIMDIRECTION)
		OATF D 4 Bright A_PlaySound("oscuro/flamefire")
		OATF D 0 A_FaceTarget
		OATF D 0 Bright A_CustomMissile("FlameRetaliationHoly",0,0,0,CMF_AIMDIRECTION)
		OATF D 0 Bright A_CustomMissile("FlameRetaliationHoly",0,0,20,CMF_AIMDIRECTION)
		OATF D 0 Bright A_CustomMissile("FlameRetaliationHoly",0,0,-20,CMF_AIMDIRECTION)
		OATF D 4 Bright A_PlaySound("oscuro/flamefire")
		OATF D 0 A_FaceTarget
		OATF D 0 Bright A_CustomMissile("FlameRetaliationHoly",0,0,0,CMF_AIMDIRECTION)
		OATF D 0 Bright A_CustomMissile("FlameRetaliationHoly",0,0,20,CMF_AIMDIRECTION)
		OATF D 0 Bright A_CustomMissile("FlameRetaliationHoly",0,0,-20,CMF_AIMDIRECTION)
		OATF D 4 Bright A_PlaySound("oscuro/flamefire")
		OATF EF 4
		Goto Chasing
	Pain.Seeker:
		OATS A 0 A_ChangeFlag("NOPAIN",1)
		OATS A 0 A_FadeIn(1,FTF_CLAMP)
		OAT1 AAAAAAAA 4 A_FaceTarget
		OAT1 BCDEF 2 Bright A_FaceTarget
		OAT1 G 0 Bright A_PlaySound("oscuro/specialfire")
		OAT1 G 2 Bright A_CustomMissile("SeekerStarHoly",58,17) //Same actions as the gold face, only instead this one seeks.
		OAT1 HI 2
		Goto Chasing
	Pain.Poison:
		Goto Pain.Seeker
	Pain.UnholyDisint:
	Pain.PlasmaDisint:
	Pain.Holy:
	Pain.Disintegrate:
		OATS A 0 A_ChangeFlag("NOPAIN",1)
		OATS A 0 A_FadeIn(1,FTF_CLAMP)
		OATS A 0 A_SetUserVar("user_life",user_life+100)
		OATS A 0 A_Jump(128,21)
		OATG ABCDEFGHIJ 2 bright
		OATS ABCD 2 bright
		OATS E 0 A_PlaySound("oscuro/specialfire")
		OATS E 2 Bright A_CustomMissile("KES",48,0,0)
		OATS FGHI 2
		OATS A 0 A_ChangeFlag("NOPAIN",0)
		Goto Chasing
		
		TNT1 A 0 A_ChangeFlag("NOPAIN",1)
		OAT1 ABCDEF 2 Bright A_FaceTarget
		OAT1 G 0 Bright A_PlaySound("weapons/gshoot")
		OAT1 G 4 Bright A_CustomMissile("DBTKES",56,14)
		OAT1 G 0 Bright A_PlaySound("weapons/gshoot")
		OAT1 G 4 Bright A_CustomMissile("DBTKES",56,14)
		OAT1 G 0 Bright A_PlaySound("weapons/gshoot")
		OAT1 G 4 Bright A_CustomMissile("DBTKES",56,14)
		OAT1 G 0 Bright A_PlaySound("weapons/gshoot")
		OAT1 G 4 Bright A_CustomMissile("DBTKES",56,14)
		OAT1 G 0 Bright A_PlaySound("weapons/gshoot")
		OAT1 G 4 Bright A_CustomMissile("DBTKES",56,14)
		OAT1 G 0 Bright A_PlaySound("weapons/gshoot")
		OAT1 G 4 Bright A_CustomMissile("DBTKES",56,14)
		OAT1 G 0 Bright A_PlaySound("weapons/gshoot")
		OAT1 G 4 Bright A_CustomMissile("DBTKES",56,14)
		OAT1 G 0 Bright A_PlaySound("weapons/gshoot")
		OAT1 G 4 Bright A_CustomMissile("DBTKES",56,14)
		OAT1 HI 2
		TNT1 A 0 A_ChangeFlag("NOPAIN",0)
		Goto See+16
	Pain.Bone:
		Goto Pain.Seeker
	Pain.Drain:
		TNT1 A 0 A_Jump(256,"Pain.Fire","Pain.Ice")
	Pain.DBT:
		TNT1 A 0 A_Jump(256,"Pain.Fire","Pain.Ice")
	Pain.CleansingFire:
		Goto Pain.Ice
	Pain.FireWall:
		Goto Pain.Fire
	}
}

Actor HandOfGodDrop : AEoDWeaponDrop
{
	Inventory.MaxAmount 1
	States
	{
	Use:
		TNT1 A 0 A_SpawnItemEx("DroppedHandOfGod",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		Stop
	}
}

Actor DroppedHandOfGod
{
	Radius 16
	Height 20
	Scale 0.5
	States
	{
	Spawn:
		GDPU DEFGH 3 Bright
		TNT1 A 0 A_SpawnItemEx("AEoDHandOfGodNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
}

Actor AEoDHandOfGodNoAmmo : AEoDHandOfGodItem
{
	+FLOORCLIP
	+IGNORESKILL	+DONTGIB
	Inventory.Amount 1
	Inventory.PickupMessage "You have the Hand of God. Banish the demons back to hell!"
	Inventory.PickupSound "weapons/handofgod"
	Scale 0.5
	States
	{
	Spawn:
		GDPU ABCDEFGH 3 Bright
		Loop
	Pickup:
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",0) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("BlueMana",5,"Ammo")
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("HandOfGodDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDHandOfGod",1)
		TNT1 A 0 A_TakeInventory("BlueMana",5)
		TNT1 A 0 A_SpawnItemEx("HandOfGodPickupFX",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDHandOfGod",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,0,159,0)
		Fail
	Ammo:
		TNT1 A 0 A_TakeInventory("BlueMana",100)
		TNT1 A 0 A_JumpIfInventory("AEoDHandOfGod",1,2)
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("HandOfGodDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDHandOfGod",1)
		TNT1 A 0 A_SpawnItemEx("HandOfGodPickupFX",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		Stop
	Ammo2:
		TNT1 A 0 A_TakeInventory("BlueMana",100)
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("HandOfGodDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDHandOfGod",1)
		TNT1 A 0 A_SpawnItemEx("HandOfGodPickupFX",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		Stop
	Ammo3:
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("HandOfGodDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDHandOfGod",1)
		TNT1 A 0 A_TakeInventory("BlueMana",100)
		TNT1 A 0 A_SpawnItemEx("HandOfGodPickupFX",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		Stop
	}
}

//==================================================================================
//==================================================================================
//Volcano Cannon
//by Major Cooke
//Graphics from Doom64
//Modified by Major Cooke
//==================================================================================
//==================================================================================

Actor AEoDVolcanoCannonItem : AEoDWeaponPickup 6128
{
	+FLOORCLIP
	+IGNORESKILL	+DONTGIB
	Inventory.Amount 1
	Inventory.PickupMessage "You found the Volcano Cannon! Let salvation come..."
	Inventory.PickupSound "MajorCooke/Weapons/CannonPickup"
	Translation "192:207=%[0.1,0,0]:[1,0,0]"
	States
	{
	Spawn:
		VOLP A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDVolcanoCannon",1,"Ammo")
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",0) <= 0,"Nothing")
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("VolcanoCannonDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDVolcanoCannon",1)
		TNT1 A 0 A_PrintBold("\cgSlot 10: Volcano Cannon")
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDVolcanoCannon",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,0,154,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDVolcanoCannon",1)
		Stop
	}
}

Actor AEoDVolcanoCannon : AEoDWeaponBase // 6128
{
	+IGNORESKILL	+DONTGIB
	+WEAPON.CHEATNOTWEAPON
	Weapon.AmmoType1 "RedMana"
	Weapon.AmmoType2 "DarkMana"
	Weapon.AmmoUse1 10
	Weapon.AmmoUse2 10
	Weapon.AmmoGive1 20
	Weapon.AmmoGive2 20
	Weapon.SelectionOrder 15500
	Translation "192:207=%[0.1,0,0]:[1,0,0]"
	Obituary "%o was broiled into molten slag by %k's Volcano Cannon."
	Inventory.PickupMessage "You found the Volcano Cannon! Let salvation come..."
	Inventory.PickupSound "MajorCooke/Weapons/CannonPickup"
	Weapon.UpSound "weapons/draw"
	Tag "Volcano cannon"
	States
	{
	Spawn:
		VOLP A -1
		Loop
	Select:
		VOLW A 0 	
		VOLW A 1 A_Raise
		VOLW AA 0 A_Raise
		Loop
	Deselect:
		VOLW A 0 	
		VOLW A 1 A_Lower
		VOLW AA 0 A_Lower
		Loop
	Ready:
		VOLW A 1 A_WeaponReady
		Loop
	Fire:
		VOLW A 5 bright
		VOLW BC 2 bright
		VOLW D 0 Bright A_PlaySound("weapons/volcanofire", CHAN_WEAPON, 1)
		VOLW D 0 Bright A_Recoil(3.5)
		VOLW D 3 Bright A_FireCustomMissile("Meteor",0,1,0)
		VOLW CBA 3 bright
		VOLW A 10 
		VOLW A 0 A_ReFire
		Goto Ready
	AltFire:
		VOLW A 5 bright
		VOLW BC 2 bright
		VOLW D 0 Bright A_PlaySound("weapons/volcanofire", CHAN_WEAPON, 1)
		VOLW D 0 Bright A_Recoil(3.5)
		VOLW D 5 Bright A_FireCustomMissile("VolcanoProjectile",0,1,0)
		VOLW CBA 5 bright
		VOLW A 70
		VOLW A 0 A_ReFire
		Goto Ready
	}
}

//Meteor Part - Primary Fire
Actor Meteor
{
	Height 4
	Radius 6
	Scale 1.1
	Speed 30
	Damage 100
	Projectile
	+DONTREFLECT
	+EXTREMEDEATH
	+SEEKERMISSILE
	+FORCERADIUSDMG
	+BLOODLESSIMPACT
	DamageType "Fire"
	DeathSound "weapons/meteorboom"
	States
	{
	Spawn:
		MSP1 A 1 Bright A_SeekerMissile(10,20)
		MSP1 AAAA 0 A_SpawnItemEx("EFLMeteorFlames",2,0,0,frandom(1,4),frandom(-3,5),frandom(-5,5),0,SXF_NOCHECKPOSITION)
		MSP1 B 1 Bright A_SeekerMissile(10,20)
		MSP1 AAAA 0 A_SpawnItemEx("EFLMeteorFlames",2,0,0,frandom(1,4),frandom(-3,5),frandom(-5,5),0,SXF_NOCHECKPOSITION)
		MSP1 C 1 Bright A_SeekerMissile(10,20)
		MSP1 AAAA 0 A_SpawnItemEx("EFLMeteorFlames",2,0,0,frandom(1,4),frandom(-3,5),frandom(-5,5),0,SXF_NOCHECKPOSITION)
		MSP1 D 1 Bright A_SeekerMissile(10,20)
		MSP1 AAAA 0 A_SpawnItemEx("EFLMeteorFlames",2,0,0,frandom(1,4),frandom(-3,5),frandom(-5,5),0,SXF_NOCHECKPOSITION)
		MSP1 E 1 Bright A_SeekerMissile(10,20)
		MSP1 AAAA 0 A_SpawnItemEx("EFLMeteorFlames",2,0,0,frandom(1,4),frandom(-3,5),frandom(-5,5),0,SXF_NOCHECKPOSITION)
		MSP1 F 1 Bright A_SeekerMissile(10,20)
		MSP1 AAAA 0 A_SpawnItemEx("EFLMeteorFlames",2,0,0,frandom(1,4),frandom(-3,5),frandom(-5,5),0,SXF_NOCHECKPOSITION)
		Loop
	Death:
		MSP1 G 0 A_CheckFloor("FloorBoom")
		MSP1 G 0 Bright A_PlaySound("weapons/meteorboom")
		MSP1 G 0 Bright A_Explode(768,256,0)
		TNT1 A 0 A_QuakeEx(2,2,0,45,0,1024,"", QF_SCALEDOWN)
		TNT1 A 0 A_Scream
		TNT1 A 0 A_SpawnItemEx("VCPrimaryFX",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)//A_SpawnItemEx("MonExplosionBig",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 2
		TNT1 A 8 A_ChangeFlag("FORCEPAIN",true)
		TNT1 A 0 A_Explode(768,512,0)
		TNT1 A 8
		Stop
	FloorBoom:
		MSP1 G 0 Bright A_PlaySound("weapons/meteorboom")
		MSP1 G 0 Bright A_Explode(768,256,0)
		TNT1 A 0 A_QuakeEx(2,2,0,45,0,1024,"", QF_SCALEDOWN)
		TNT1 A 0 A_Scream
		TNT1 A 0 A_SpawnItemEx("VCPrimaryFX",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)//A_SpawnItemEx("MonExplosionBig",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 2
		TNT1 A 8 A_ChangeFlag("FORCEPAIN",true)
		TNT1 A 0 A_Explode(768,512,0)
		TNT1 A 8
		Stop
	}
}

//==================================================================================
//==================================================================================
// New volcano cannon FX by Major Cooke
// Further adjustments by DBT
// Redone from scratch yet again by Major Cooke for v6.03
//==================================================================================
//==================================================================================

Actor VCPrimaryFX
{
	var int user_x[3];
	var int user_angle[5];
	//[0] = Angle to use
	//[1] = Angle threshold to add to [0]
	//[2] = Multiplier
	//[3] = default angling to readjust to 1.
	//[4] = 
	var int user_count;
	+NOINTERACTION
	States
	{
	Spawn:
		TNT1 A 0
		//TNT1 A 0 A_CheckFloor("SpreadFloor")
		TNT1 A 0 A_SpawnItemEx("MeteorExploSpriteBig",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SetUserArray("user_angle",1,random(1,4))
		TNT1 A 0 A_SetUserArray("user_angle",2,10)
		TNT1 A 0 A_SetUserArray("user_angle",0,user_angle[1]*user_angle[2])
		TNT1 A 0 A_SetUserArray("user_x",1,1)
		TNT1 A 0 A_SetUserArray("user_x",0,(45))
		TNT1 A 0 A_SetUserArray("user_x",2,user_x[0])
	Spread:
		TNT1 A 0 A_SpawnItemEx("MeteorExploSprites",((user_x[2]*user_x[1])+frandom(-10,10)),0,0,0,0,random(-4,4),user_angle[0],SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SetUserArray("user_angle",1,random(1,4))
		TNT1 A 0 A_SetUserArray("user_angle",0,user_angle[0]+(user_angle[1]*user_angle[2]))
		//TNT1 A 0 A_SetUserArray("user_x",1,user_x[1]+1)
		
		TNT1 A 0 A_JumpIf(user_angle[0]>=360,1)
		Loop
	SpreadOut:
		TNT1 A 1 A_SetUserArray("user_angle",2,user_angle[2]-1)
		TNT1 A 0 A_SetUserArray("user_angle",0,user_angle[1]*user_angle[2])
		TNT1 A 0 A_SetUserArray("user_x",1,user_x[1]+1)
		TNT1 A 0 A_SetUserArray("user_x",2,user_x[0])
		TNT1 A 0 A_JumpIf((user_angle[2]<=4)&&(user_count>=1),"End")
		TNT1 A 0 A_JumpIf(user_angle[2]<=1,1)
		Goto Spread
	Spread2:
		TNT1 A 1 A_SetUserVar("user_count",1)
		TNT1 A 0 A_SetUserArray("user_angle",2,10)
		TNT1 A 0 A_SetUserArray("user_x",1,1)
		Goto Spread
	End:
		TNT1 A 0
		Stop
	}
}

Actor VCFlameSpawner
{
	var int user_count;
	+NOINTERACTION
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SetUserVar("user_count",0)
	Looper:
		TNT1 A 0 A_SpawnItemEx("FTFlameTrailVC",random(-8,8),random(-64,64),random(-8,8),random(3,15),0,random(-12,6),0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("FTFlameTrailVC",random(-8,8),random(-64,64),random(-8,8),0,0,random(1,6),0,SXF_NOCHECKPOSITION,192)
		TNT1 A 0 A_SetUserVar("user_count",user_count+1)
		TNT1 A 1 A_JumpIf(user_count>=20,1)
		Loop
		TNT1 A 0
		Stop
	}
}

Actor FTFlameTrailVC
{
	+NOINTERACTION
	Alpha 0.4
	Translation "0:255=%[0,0,0]:[1,0.5,0]"
	Scale 0.25
	RenderStyle Add
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_Jump(255,"F1","F2","F3","F4","F5")
	F1:
		X052 AB 2 bright
		X052 CDEFGH 3 Bright A_ScaleVelocity(0.92)
		X052 IJKLMNO 2 Bright A_ScaleVelocity(0.9)
		X052 PQRS 1 Bright A_ScaleVelocity(0.87)
		Stop
	F2:
		X053 AB 2 bright
		X053 CDEFGHIJ 3 Bright A_ScaleVelocity(0.92)
		X053 KLMN 2 Bright A_ScaleVelocity(0.9)
		X053 OPQRS 1 Bright A_ScaleVelocity(0.87)
		Stop
	F3:
		X054 ABCD 2 bright
		X054 EFGHIJK 3 Bright A_ScaleVelocity(0.92)
		X054 LMNO 2 Bright A_ScaleVelocity(0.9)
		X054 PQRS 2 Bright A_ScaleVelocity(0.87)
		Stop
	F4:
		X055 ABC 2 bright
		X055 DEFGHIJKLMN 3 Bright A_ScaleVelocity(0.92)
		X055 OP 2 Bright A_ScaleVelocity(0.9)
		X055 QRS 2 Bright A_ScaleVelocity(0.87)
		Stop
	F5:
		X056 ABCDE 2 Bright
		X056 FGHIJ 3 Bright A_ScaleVelocity(0.92)
		X056 KLMN 2 Bright A_ScaleVelocity(0.9)
		X056 OPQR 1 Bright A_ScaleVelocity(0.87)
		Stop
	}
}

Actor VCFlameSpawnerFloor
{
	var int user_count;
	+NOINTERACTION
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SetUserVar("user_count",0)
	Looper:
		TNT1 A 0 A_SpawnItemEx("FTFlameTrailVC",random(-8,8),random(-64,64),5,random(3,15),0,random(1,6),0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("FTFlameTrailVC",random(-8,8),random(-64,64),5,0,0,random(1,6),0,SXF_NOCHECKPOSITION,192)
		TNT1 A 0 A_SetUserVar("user_count",user_count+1)
		TNT1 A 1 A_JumpIf(user_count>=20,1)
		Loop
		TNT1 A 0
		Stop
	}
}

Actor VolcanoExplosionFXSpawner
{
	var int user_count;
	+NOINTERACTION
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 AAAAAAAAAA 0 A_SpawnItemEx("VolcanoExplosionBack",frandom(-25,25),0,frandom(-25,25),0,0,0,random(0,359),SXF_NOCHECKPOSITION)
		TNT1 AAAAAAAAAAAAAAAAAAAAAAAAA 1 A_SpawnItemEx("VolcanoExplosionBack",frandom(-25,25),0,frandom(-25,25),0,0,0,random(0,359),SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SetUserVar("user_count",0)
	Smoker:
		TNT1 AAAA 0 A_SpawnItemEx("VolcanicAsh",random(0,5),0,random(10,25),random(1,3),0,random(5,8),random(0,359),SXF_NOCHECKPOSITION,128)
		TNT1 A 0 A_SpawnItemEx("VolcanoExplosionBack",random(-15,15),0,random(-15,15),0,0,0,random(0,359),SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("PBDebris",random(0,3),0,random(0,2),random(15,30),0,random(10,35),random(0,359),SXF_NOCHECKPOSITION,175)
		TNT1 A 1 A_SetUserVar("user_count",user_count+1)
		TNT1 A 0 A_JumpIf(user_count>=190,1)
		Loop
		TNT1 A 0
		Stop
	}
}

Actor VolcanoExplosionBack
{
	+NOINTERACTION
	RenderStyle Add
	Scale 1.15
	Alpha 0.45
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_Jump(255,"s1","s2","s3","s4","s5","s6","s7")
	s1:
		X001 ABCDEFGHIJKLMNOPQRS 3 Bright A_FadeOut(0.01)
		X001 S 1 Bright A_FadeOut(0.03)
		Wait
	s2:
		X002 ABCDEFGHIJKLMNOPQRSTU 3 Bright A_FadeOut(0.01)
		X002 U 1 Bright A_FadeOut(0.03)
		Wait
	s3:
		X003 ABCDEFGHIJLKMNOPQRSTUVWXYZ 3 Bright A_FadeOut(0.01)
		X003 Z 1 Bright A_FadeOut(0.03)
		Wait
	s4:
		X004 ABCDEFGHIJKLMNOPQ 3 Bright A_FadeOut(0.01)
		X004 Q 1 Bright A_FadeOut(0.03)
		Wait
	s5:
		X005 ABCDEFGHIJKLMNOPQRSTUVWX 3 Bright A_FadeOut(0.01)
		X005 X 1 Bright A_FadeOut(0.03)
		Wait
	s6:
		X006 ABCDEFGHIJLKMNOP 3 Bright A_FadeOut(0.01)
		X006 P 1 Bright A_FadeOut(0.03)
		Wait
	s7:
		X007 ABCDEFGHIJ 3 Bright A_FadeOut(0.01)
		X007 J 1 Bright A_FadeOut(0.03)
		Wait
	}
}

Actor VolcanicAsh : TT1
{
	Translation "0:255=%[0,0,0]:[0.5,0.5,0.5]"
	Scale 0.65
}

Actor MeteorExploSpriteBig
{
	+NOINTERACTION
	Scale 1.25
	States
	{
	Spawn:
		X125 ABC 4 Bright
		X125 DEFGHI 3 bright
		X125 JJKKLLMMNNOOPPQQRR 1 Bright A_FadeOut(0.04)
		Wait
	}
}

Actor MeteorExploSprites
{
	+NOINTERACTION
	Scale 0.40
	RenderStyle Add
	States
	{
	Spawn:
		TNT1 A 0 NoDelay A_SetScale(frandom(0.30,0.45))
		TNT1 A 0 A_JumpIf((z-floorz)<=(4.0),"WarpUp")
		Goto Effect
	WarpUp:
		TNT1 A 0 A_Warp(AAPTR_DEFAULT,0,0,random(6,12),0,WARPF_NOCHECKPOSITION|WARPF_TOFLOOR)
		TNT1 A 0 A_ChangeVelocity(0,0,frandom(0.0,4.0),3)
	Effect:
		X125 ABCDEFG random(1,3) Bright
		X125 HIJKLMNOPQR 1 Bright A_FadeOut(0.05)
		Wait
	}
}

Actor EFLMeteorFlamesWeap
{
	+NOINTERACTION
	Speed 0
	Radius 1
	Height 1
	RenderStyle Add
	Alpha 0.35
	Scale 0.5
	Translation "0:255=%[0.0,0.0,0]:[1,0.5,0]"
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_Jump(128,"FT2","FT3","FT4","FT5")
		X003 ABCDE 2 Bright A_FadeOut(0.03)
		TNT1 A 0 A_ScaleVelocity(0.6)
		X003 FGHIJ 2 Bright A_FadeOut(0.03)
		TNT1 A 0 A_ScaleVelocity(0.5)
		X003 KLMNO 2 Bright A_FadeOut(0.03)
		TNT1 A 0 A_ScaleVelocity(0.4)
		X003 PQRST 2 Bright A_FadeOut(0.03)
		TNT1 A 0 A_ScaleVelocity(0.3)
		X003 UVWXYZ 2 Bright A_FadeOut(0.035)
		Wait
	FT2:
		X004 ABCDE 2 Bright A_FadeOut(0.03)
		TNT1 A 0 A_ScaleVelocity(0.6)
		X004 FGHIJ 2 Bright A_FadeOut(0.03)
		TNT1 A 0 A_ScaleVelocity(0.5)
		X004 KLMNO 2 Bright A_FadeOut(0.03)
		TNT1 A 0 A_ScaleVelocity(0.4)
		X004 PQ 2 Bright A_FadeOut(0.03)
		Wait
	FT3:
		X005 ABCDE 2 Bright A_FadeOut(0.015)
		TNT1 A 0 A_ScaleVelocity(0.6)
		X005 FGHIJ 2 Bright A_FadeOut(0.03)
		TNT1 A 0 A_ScaleVelocity(0.5)
		X005 KLMNO 2 Bright A_FadeOut(0.03)
		TNT1 A 0 A_ScaleVelocity(0.4)
		X005 PQRST 2 Bright A_FadeOut(0.03)
		TNT1 A 0 A_ScaleVelocity(0.3)
		X005 UVWXYZ 2 Bright A_FadeOut(0.035)
		Wait
	FT4:
		X006 ABCDE 2 Bright A_FadeOut(0.03)
		TNT1 A 0 A_ScaleVelocity(0.6)
		X006 FGHIJ 2 Bright A_FadeOut(0.03)
		TNT1 A 0 A_ScaleVelocity(0.5)
		X006 KLMNO 2 Bright A_FadeOut(0.03)
		TNT1 A 0 A_ScaleVelocity(0.4)
		X006 P 2 Bright A_FadeOut(0.03)
		Wait
	FT5:
		X015 ABCDE 2 Bright A_FadeOut(0.042)
		TNT1 A 0 A_ScaleVelocity(0.6)
		X015 FGHIJ 2 Bright A_FadeOut(0.042)
		TNT1 A 0 A_ScaleVelocity(0.5)
		X015 KLMNO 2 Bright A_FadeOut(0.042)
		TNT1 A 0 A_ScaleVelocity(0.4)
		X015 PQRST 2 Bright A_FadeOut(0.042)
		TNT1 A 0 A_ScaleVelocity(0.3)
		X015 UVWX 2 Bright A_FadeOut(0.047)
		Wait
	}
}


Actor MeteorSpreader
{
	Speed 20
	Height 1
	Radius 5
	Damage 2
	Projectile
	+THRUACTORS
	+FORCERADIUSDMG
	+EXTREMEDEATH
	+STEPMISSILE
	+BLOODLESSIMPACT
	+BOUNCEONWALLS
	+BOUNCEONFLOORS
	+CANBOUNCEWATER
	//+NOINTERACTION
	MaxStepHeight 128
	BounceFactor 0
	WallBounceFactor 0
	States
	{
	Spawn:
		TNT1 A 0 A_Explode(10,50,0)
		TNT1 A 3 
		TNT1 A 0 A_CustomMissile("TrailUp",0,0,0,2,90)
		TNT1 A 0 A_CustomMissile("TrailDown",0,0,0,2,-90)
		TNT1 A 0 A_PlaySound("weapons/meteorboom")
		TNT1 A 0 A_Explode(30,50,0)
		TNT1 A 3
		TNT1 A 0 A_CustomMissile("TrailUp",0,0,0,2,90)
		TNT1 A 0 A_CustomMissile("TrailDown",0,0,0,2,-90)
		TNT1 A 0 A_Explode(30,50,0)
		TNT1 A 3
		TNT1 A 0 A_CustomMissile("TrailUp",0,0,0,2,90)
		TNT1 A 0 A_CustomMissile("TrailDown",0,0,0,2,-90)
		TNT1 A 0 A_Explode(30,50,0)
		TNT1 A 3
		TNT1 A 0 A_CustomMissile("TrailUp",0,0,0,2,90)
		TNT1 A 0 A_CustomMissile("TrailDown",0,0,0,2,-90)
		TNT1 A 0 A_Explode(30,50,0)
		TNT1 A 3
		TNT1 A 0 A_CustomMissile("TrailUp",0,0,0,2,90)
		TNT1 A 0 A_CustomMissile("TrailDown",0,0,0,2,-90)
		TNT1 A 0 A_Explode(30,50,0)
		TNT1 A 3
		TNT1 A 0 A_CustomMissile("TrailUp",0,0,0,2,90)
		TNT1 A 0 A_CustomMissile("TrailDown",0,0,0,2,-90)
		TNT1 A 0 A_Explode(30,50,0)
		TNT1 A 3
		TNT1 A 0 A_CustomMissile("TrailUp",0,0,0,2,90)
		TNT1 A 0 A_CustomMissile("TrailDown",0,0,0,2,-90)
		TNT1 A 0 A_Explode(30,50,0)
		TNT1 A 3
		TNT1 A 0 A_CustomMissile("TrailUp",0,0,0,2,90)
		TNT1 A 0 A_CustomMissile("TrailDown",0,0,0,2,-90)
		TNT1 A 0 A_Explode(30,50,0)
		TNT1 A 3
		TNT1 A 0 A_CustomMissile("TrailUp",0,0,0,2,90)
		TNT1 A 0 A_CustomMissile("TrailDown",0,0,0,2,-90)
		TNT1 A 0 A_Explode(30,50,0)
		Goto Death
	Death:
		TNT1 A 0
		Stop
	}
}

Actor TrailUp
{
	Speed 2
	Damage 0
	Scale 1.25
	Projectile
	+RIPPER	RipperLevel 1
	+NOCLIP
	+NOINTERACTION
	RenderStyle Add
	Alpha 0.35
	States
	{
	Spawn:
		MSP1 G 0 bright
		Goto Death
	Death:
		MSP1 GHIJKLMNOP 2
		Stop
	}
}

Actor TrailDown : TrailUp
{
	Alpha 0.35
	DeathSound "none"
	States
	{
	Spawn:
		MSP1 G 0 bright
		Goto Death
	}
}

//Volcano Part - Secondary Fire
Actor VolcanoProjectile
{
	Height 4
	Radius 6
	Scale 1.2
	Speed 20
	Damage 500
	Projectile
	+EXTREMEDEATH
	+SKYEXPLODE
	+DONTREFLECT
	DamageType "Fire"
	States
	{
	Spawn:
		MSP1 A 1 A_SpawnItemEx("EFLMeteorFlames",2,0,0,frandom(1,4),frandom(-10,10),frandom(-10,10),0,SXF_NOCHECKPOSITION)
		MSP1 AAA 0 Bright A_SpawnItemEx("EFLMeteorFlames",2,0,0,frandom(1,4),frandom(-10,10),frandom(-10,10),0,SXF_NOCHECKPOSITION)
		MSP1 B 1 A_SpawnItemEx("EFLMeteorFlames",2,0,0,frandom(1,4),frandom(-10,10),frandom(-10,10),0,SXF_NOCHECKPOSITION)
		MSP1 AAA 0 Bright A_SpawnItemEx("EFLMeteorFlames",2,0,0,frandom(1,4),frandom(-10,10),frandom(-10,10),0,SXF_NOCHECKPOSITION)
		MSP1 C 1 A_SpawnItemEx("EFLMeteorFlames",2,0,0,frandom(1,4),frandom(-10,10),frandom(-10,10),0,SXF_NOCHECKPOSITION)
		MSP1 AAA 0 Bright A_SpawnItemEx("EFLMeteorFlames",2,0,0,frandom(1,4),frandom(-10,10),frandom(-10,10),0,SXF_NOCHECKPOSITION)
		MSP1 D 1 A_SpawnItemEx("EFLMeteorFlames",2,0,0,frandom(1,4),frandom(-10,10),frandom(-10,10),0,SXF_NOCHECKPOSITION)
		MSP1 AAA 0 Bright A_SpawnItemEx("EFLMeteorFlames",2,0,0,frandom(1,4),frandom(-10,10),frandom(-10,10),0,SXF_NOCHECKPOSITION)
		MSP1 E 1 A_SpawnItemEx("EFLMeteorFlames",2,0,0,frandom(1,4),frandom(-10,10),frandom(-10,10),0,SXF_NOCHECKPOSITION)
		MSP1 AAA 0 Bright A_SpawnItemEx("EFLMeteorFlames",2,0,0,frandom(1,4),frandom(-10,10),frandom(-10,10),0,SXF_NOCHECKPOSITION)
		MSP1 F 1 A_SpawnItemEx("EFLMeteorFlames",2,0,0,frandom(1,4),frandom(-10,10),frandom(-10,10),0,SXF_NOCHECKPOSITION)
		MSP1 AAA 0 Bright A_SpawnItemEx("EFLMeteorFlames",2,0,0,frandom(1,4),frandom(-10,10),frandom(-10,10),0,SXF_NOCHECKPOSITION)
		Loop
	Death:
		TNT1 A 0 A_CustomMissile("VolcanoGrounder",0,0,0,6)
		TNT1 A 0 A_SpawnItemEx("VCPrimaryFX",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("MonExplosionBig",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		Stop
	}
}

Actor VolcanoGrounder
{
	Speed 0.1
	Damage 0
	Projectile
	+RIPPER	RipperLevel 1
	+DONTREFLECT
	+NOBLOOD
	+FLOORHUGGER
	+NODAMAGE
	DamageType "Fire"
	States
	{
	Spawn:
		TNT1 A 1
		Goto Death
	Death:
		TNT1 A 0 A_CustomMissile("VolcanoC",0,0,0,6)
		Stop
	}
}

Actor VolcanoC
{
	Height 50
	Radius 20
	Mass 0x7FFFFFFFF
	Speed 0
	Damage 0
	Scale 1.2
	Projectile
	+FLOORHUGGER
	+FORCERADIUSDMG
	+EXTREMEDEATH
	+NOCLIP
	+NOBLOCKMAP
	+RIPPER	RipperLevel 1
	+NOINTERACTION
	+INVULNERABLE
	DamageType "Fire"
	DeathType "Extreme"
	States
	{
	Spawn:
		VRIS A 0
		VRIS A 0 A_QuakeEx(8,8,0, 300,0,35,"", QF_SCALEDOWN)
		VRIS ABCDEFGHIJKLMNOPQRSTU 1 //A_Explode(300,512,0) //A_CustomMissile("ExpQuakeSmall",0,0,0)
		VOLC B 0 A_SpawnItemEx("VolcanoEruption",0,0,105,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)//A_CustomMissile("VolcanoEruption",105,0,0,4)
		//VOLC B 0 A_CustomMissile("MeteorRing",115,0,0,4)
		VOLC B 200 bright
		VOLC A 70 bright
		Goto Death
	Death:
		VRIS UTSRQPONMLKJIHGFEDCBA 1
		VRIS AAAAAAAAAA 1 A_FadeOut(0.1)
		Stop
	}
}

Actor VolcanoEruption
{
	Height 4
	Radius 4
	Speed 0
	Scale 1.5
	DeathSound "weapons/volcanoboom"
	Projectile
	+EXTREMEDEATH
	+FULLVOLDEATH
	+FULLVOLACTIVE
	+NOINTERACTION
	+FORCERADIUSDMG
	+INVULNERABLE
	DamageType "Fire"
	DeathType "Extreme"
	Alpha 1
	RenderStyle None //No longer visible. I'm simply keeping it this way to avoid overadjusting the code.
	States
	{
	Spawn:
		TNT1 A 0
		Goto Death
	Death:
		R051 L 0 A_PlaySound("weapons/volcanoboom",7,1,0)
		R051 L 0 A_Explode(3584,768,0)
		R051 L 0 A_QuakeEx(8,8,0, 300,0,35,"", QF_SCALEDOWN)
		TNT1 A 0 A_SpawnItemEx("VCPrimaryFX",0,0,25,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("VolcanoExplosionFXSpawner",0,0,25,0,0,0,0,SXF_NOCHECKPOSITION)
		R051 LLLLLLLLLLLLLLL 0 Bright A_SpawnItemEx("Meteorite",0,0,0,0+random(5,20),0+random(5,20),0+random(15,25),0+random(0,360),SXF_NOCHECKPOSITION|SXF_SETMASTER)
		R051 LLLLLLLL 1 Bright //A_CustomMissile("VolcanoMeteor",0,0+random(0,2),0+random(0,360),2,0+random(1,90))
		TNT1 A 0 A_Explode(128,512,0)
		R051 MMMMMMMM 1 Bright //A_CustomMissile("VolcanoMeteor",0,0+random(0,2),0+random(0,360),2,0+random(1,90))
		TNT1 A 0 A_Explode(128,512,0)
		R051 NNNNNNNN 1 Bright A_CustomMissile("VolcanoMeteor",0,0+random(0,2),0+random(0,360),6,0+random(1,90))
		TNT1 A 0 A_Explode(128,512,0)
		R051 OOOOOOOO 1 Bright A_CustomMissile("VolcanoMeteor",0,0+random(0,2),0+random(0,360),6,0+random(1,90))
		TNT1 A 0 A_Explode(128,512,0)
		R051 PPPPPPPP 1 Bright A_CustomMissile("VolcanoMeteor",0,0+random(0,2),0+random(0,360),6,0+random(1,90))
		TNT1 A 0 A_Explode(128,512,0)
		R051 QQQQQQQQ 1 Bright A_CustomMissile("VolcanoMeteor",0,0+random(0,2),0+random(0,360),6,0+random(1,90))
		TNT1 A 0 A_Explode(128,512,0)
		R051 RRRRRRRR 1 Bright A_CustomMissile("VolcanoMeteor",0,0+random(0,2),0+random(0,360),6,0+random(1,90))
		TNT1 A 0 A_Explode(128,512,0)
		R051 SSSSSSSS 1 Bright A_CustomMissile("VolcanoMeteor",0,0+random(0,2),0+random(0,360),6,0+random(1,90))
		TNT1 A 0 A_Explode(128,512,0)
		R051 TTTTTTTT 1 Bright A_CustomMissile("VolcanoMeteor",0,0+random(0,2),0+random(0,360),6,0+random(1,90))
		TNT1 A 0 A_Explode(128,512,0)
		R051 UUUUUUUU 1 Bright A_CustomMissile("VolcanoMeteor",0,0+random(0,2),0+random(0,360),6,0+random(1,90))
		TNT1 A 0 A_Explode(128,512,0)
		R051 VVVVVVVV 1 Bright A_CustomMissile("VolcanoMeteor",0,0+random(0,2),0+random(0,360),6,0+random(1,90))
		TNT1 A 0 A_Explode(128,512,0)
		R051 WWWWWWWW 1 Bright A_CustomMissile("VolcanoMeteor",0,0+random(0,2),0+random(0,360),6,0+random(1,90))
		TNT1 A 0 A_Explode(128,512,0)
		R051 XXXXXXXX 1 Bright A_CustomMissile("VolcanoMeteor",0,0+random(0,2),0+random(0,360),6,0+random(1,90))
		TNT1 A 0 A_Explode(128,512,0)
		R051 YYYYYYYY 1 Bright A_CustomMissile("VolcanoMeteor",0,0+random(0,2),0+random(0,360),6,0+random(1,90))
		TNT1 A 0 A_Explode(128,512,0)
		R052 AAAAAAAA 1 Bright A_CustomMissile("VolcanoMeteor",0,0+random(0,2),0+random(0,360),6,0+random(1,90))
		TNT1 A 0 A_Explode(128,512,0)
		R052 BBBBBBBB 1 Bright A_CustomMissile("VolcanoMeteor",0,0+random(0,2),0+random(0,360),6,0+random(1,90))
		TNT1 A 0 A_Explode(128,512,0)
		R052 CCCCCCCC 1 Bright A_CustomMissile("VolcanoMeteor",0,0+random(0,2),0+random(0,360),6,0+random(1,90))
		TNT1 A 0 A_Explode(128,512,0)
		R052 DDDDDDDD 1 Bright A_CustomMissile("VolcanoMeteor",0,0+random(0,2),0+random(0,360),6,0+random(1,90))
		TNT1 A 0 A_Explode(128,512,0)
		R052 EEEEEEEE 1 Bright A_CustomMissile("VolcanoMeteor",0,0+random(0,2),0+random(0,360),6,0+random(1,90))
		TNT1 A 0 A_Explode(128,512,0)
		R052 FFFFFFFF 1 Bright A_CustomMissile("VolcanoMeteor",0,0+random(0,2),0+random(0,360),6,0+random(1,90))
		TNT1 A 0 A_Explode(128,512,0)
		//R052 UUUUUUUU 1 Bright A_CustomMissile("VolcanoMeteor",0,0+random(0,2),0+random(0,360),2,0+random(1,90))
		TNT1 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 1 A_CustomMissile("VolcanoMeteor",0,0+random(0,2),0+random(0,360),6,0+random(1,90))
		TNT1 AAAAAAAAAAAAAAAAAA 1 A_CustomMissile("VolcanoMeteor",0,0+random(0,2),0+random(0,360),6,0+random(1,90))
		Stop
	}
}

Actor VolcanoMeteor
{
	Height 7
	Speed 25
	Radius 9
	Scale .75
	Projectile
	+EXTREMEDEATH
	+DONTSPLASH
	-NOGRAVITY
	+SKYEXPLODE
	+FORCERADIUSDMG
	+BLOODLESSIMPACT
	DamageType "Fire"
	BounceType "Doom"
	BounceFactor .4
	SeeSound "volcano/bounce"
	DeathSound "volcano/rockexplo"
	RenderStyle Add
	States
	{
	Spawn:
		MSP1 A 0
		MSP1 A 0 Bright A_Explode(35,128,0)
		MSP1 A 0 Bright A_SpawnItemEx("EFLMeteorFlames",2,0,0,frandom(1,4),frandom(-10,10),frandom(-10,10),0,SXF_NOCHECKPOSITION)
		MSP1 A 2 Bright A_JumpIf(waterlevel>=1,"Death")
		MSP1 A 0 Bright A_Explode(35,128,0)
		MSP1 A 0 Bright A_SpawnItemEx("EFLMeteorFlames",2,0,0,frandom(1,4),frandom(-10,10),frandom(-10,10),0,SXF_NOCHECKPOSITION)
		MSP1 B 2 Bright A_JumpIf(waterlevel>=1,"Death")
		MSP1 A 0 Bright A_Explode(35,128,0)
		MSP1 A 0 Bright A_SpawnItemEx("EFLMeteorFlames",2,0,0,frandom(1,4),frandom(-10,10),frandom(-10,10),0,SXF_NOCHECKPOSITION)
		MSP1 C 2 Bright A_JumpIf(waterlevel>=1,"Death")
		MSP1 A 0 Bright A_Explode(35,128,0)
		MSP1 A 0 Bright A_SpawnItemEx("EFLMeteorFlames",2,0,0,frandom(1,4),frandom(-10,10),frandom(-10,10),0,SXF_NOCHECKPOSITION)
		MSP1 D 2 Bright A_JumpIf(waterlevel>=1,"Death")
		MSP1 A 0 Bright A_Explode(35,128,0)
		MSP1 A 0 Bright A_SpawnItemEx("EFLMeteorFlames",2,0,0,frandom(1,4),frandom(-10,10),frandom(-10,10),0,SXF_NOCHECKPOSITION)
		MSP1 E 2 Bright A_JumpIf(waterlevel>=1,"Death")
		MSP1 A 0 Bright A_Explode(35,128,0)
		MSP1 A 0 Bright A_SpawnItemEx("EFLMeteorFlames",2,0,0,frandom(1,4),frandom(-10,10),frandom(-10,10),0,SXF_NOCHECKPOSITION)
		MSP1 F 2 Bright A_JumpIf(waterlevel>=1,"Death")
		Loop
	Death:
		GRNE A 0 Bright A_Scream
		GRNE A 0 Bright A_Explode(90,192,0)
		TNT1 A 0 A_SpawnItemEx("MonExplosionMediumSimple",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 AAAAAAAAAAAAAAAAA 0 A_SpawnItemEx("EFLIdleFire1",0,0,15,frandom(10,12),0,0,random(0,359),SXF_NOCHECKPOSITION)
		Stop
	}
}

Actor Meteorite : VolcanoMeteor
{
	+RIPPER	RipperLevel 1
	+BLOODLESSIMPACT
	Damage 1
	BounceType "Doom"
	BounceFactor 0.1
	Scale 1.05
	DeathSound "weapons/meteorboom"
	DamageType "Fire"
	States
	{
	Spawn:
		MSP2 A 0 ThrustThingZ(0,7,0,1)
		MSP2 A 0 ThrustThing(0+random(0,360),4,0,1)
		MSP2 A 0 A_JumpIf(waterlevel >= 1,"Death")
		MSP2 ABCD 2 Bright A_CustomMissile("RedPuffW",0,0,0)
		Goto Spawn+2
	Death:
		MSP1 G 0
		MSP1 G 0 A_Scream
		MSP1 G 0 A_Explode(180,128,0)
		MSP1 G 0 A_SpawnItemEx("MonExplosionMediumSimple")
		TNT1 AAAAAAAAAAAAAAAAA 0 A_SpawnItemEx("EFLIdleFire1",0,0,15,frandom(10,12),0,0,random(0,359),SXF_NOCHECKPOSITION)
		Stop
	}
}

Actor MeteorSpreader2 : MeteorSpreader
{
	+NOINTERACTION
	States
	{
	Spawn:
		TNT1 A 3 
		TNT1 A 0 A_CustomMissile("TrailDown",0,0,0,2,0)
		TNT1 A 0 A_Explode(30,64,0)
		TNT1 A 3
		TNT1 A 0 A_CustomMissile("TrailDown",0,0,0,2,0)
		TNT1 A 0 A_Explode(30,64,0)
		TNT1 A 3
		TNT1 A 0 A_CustomMissile("TrailDown",0,0,0,2,0)
		TNT1 A 0 A_Explode(30,64,0)
		Stop
	}
}

Actor MeteorRing : Meteor
{
	Speed 0
	DamageType "Fire"
	States
	{
	Spawn:
		TNT1 A 0
		Goto Death
	}
}

Actor SparkSpraySpawner
{
	Projectile
	+NOINTERACTION
	Speed 0
	States
	{
	Spawn:
		TNT1 AAA 0 Bright A_CustomMissile("SparkSpray",0,0,0+random(0,90),2,0+random(0,90))
		TNT1 AAA 0 Bright A_CustomMissile("SparkSpray",0,0,0+random(90,180),2,0+random(0,90))
		TNT1 AAA 0 Bright A_CustomMissile("SparkSpray",0,0,0+random(180,270),2,0+random(0,90))
		TNT1 AAA 0 Bright A_CustomMissile("SparkSpray",0,0,0+random(270,360),2,0+random(0,90))
		TNT1 AAA 0 Bright A_CustomMissile("SparkSpray",0,0,0+random(0,90),2,0+random(0,-90))
		TNT1 AAA 0 Bright A_CustomMissile("SparkSpray",0,0,0+random(90,180),2,0+random(0,-90))
		TNT1 AAA 0 Bright A_CustomMissile("SparkSpray",0,0,0+random(180,270),2,0+random(0,-90))
		TNT1 AAA 0 Bright A_CustomMissile("SparkSpray",0,0,0+random(270,360),2,0+random(0,-90))
		Stop
	}
}

Actor SparkSpray
{
	Scale 1.25
	Speed 20
	Damage 0
	Projectile
	-NOGRAVITY
	+SKYEXPLODE
	RenderStyle Add
	Gravity .5
	States
	{
	Spawn:
		RKSP AB 4 bright
		Loop
	Death:
		RKSP BCDEFGHIJK 2 bright
		Stop
	}
}

Actor MeteorExplo
{
	Speed 0
	Projectile
	+NOINTERACTION
	RenderStyle Add
	States
	{
	Spawn:
		GRNE A 0 bright
		Goto Death
	Death:
		GRNE ABCDEFGHIJKLMN 3 Bright A_FadeOut(0.02)
		Stop
	}
}

Actor VolcTrail
{
	Projectile
	+NOINTERACTION
	Speed 2
	RenderStyle Add
	States
	{
	Spawn:
		MSP1 G 0 Bright A_PlaySound("volcano/spray")
		Goto Death
	Death:
		MSP1 GHIJKLMNOP 2 Bright A_FadeOut(0.1)
		Stop
	}
}

Actor RockTrail
{
	Projectile
	+NOINTERACTION
	Speed 0
	Scale 1.2
	States
	{
	Spawn:
		MSP1 G 0 Bright A_PlaySound("volcano/spray")
		Goto Death
	Death:
		MSP1 GHIJKLMNOP 3 Bright A_FadeOut(0.1)
		Stop
	}
}

Actor VolcanoCannonDrop : AEoDWeaponDrop
{
	Inventory.MaxAmount 1
	States
	{
	Use:
		TNT1 A 0
		TNT1 A 0 A_SpawnItemEx("DroppedVolcanoCannon",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		Stop
	}
}

Actor DroppedVolcanoCannon
{
	Radius 16
	Height 20
	Translation "192:207=%[0.1,0,0]:[1,0,0]"
	States
	{
	Spawn:
		VOLP A 15
		TNT1 A 0 A_SpawnItemEx("AEoDVolcanoCannonNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
}

Actor AEoDVolcanoCannonNoAmmo : AEoDVolcanoCannonItem
{
	+FLOORCLIP
	+IGNORESKILL	+DONTGIB
	Inventory.Amount 1
	Inventory.PickupMessage "You found the Volcano Cannon! Let salvation come..."
	Inventory.PickupSound "MajorCooke/Weapons/CannonPickup"
	Translation "192:207=%[0.1,0,0]:[1,0,0]"
	States
	{
	Spawn:
		VOLP A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",0) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("RedMana",10,"Ammo")
		TNT1 A 0 A_JumpIfInventory("DarkMana",10,"Ammo3")
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("VolcanoCannonDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDVolcanoCannon",1)
		TNT1 A 0 A_TakeInventory("RedMana",10)
		TNT1 A 0 A_TakeInventory("DarkMana",10)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDVolcanoCannon",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,0,154,0)
		Fail
	Ammo:
		TNT1 A 0 A_JumpIfInventory("DarkMana",10,1)
		Goto Ammo2
		
		TNT1 A 0 A_TakeInventory("RedMana",10)
		TNT1 A 0 A_TakeInventory("DarkMana",10)
		TNT1 A 0 A_JumpIfInventory("AEoDVolcanoCannon",1,2)
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("VolcanoCannonDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDVolcanoCannon",1)
		Stop
	Ammo2:
		TNT1 A 0 A_TakeInventory("RedMana",10)
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("VolcanoCannonDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDVolcanoCannon",1)
		TNT1 A 0 A_TakeInventory("DarkMana",10)
		Stop
	Ammo3:
		TNT1 A 0 A_TakeInventory("DarkMana",10)
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("VolcanoCannonDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDVolcanoCannon",1)
		TNT1 A 0 A_TakeInventory("RedMana",10)
		Stop
	}
}

//==================================================================================
//==================================================================================

//==================================================================================
//==================================================================================

Actor AEoDApocalypseItem : AEoDWeaponPickup 6075
{
	+FLOORCLIP
	+IGNORESKILL	+DONTGIB
	+FLOATBOB
	Scale 0.95
	Inventory.Amount 1
	Inventory.PickupMessage "You found the Apocalypse!"
	Inventory.PickupSound "pickuppiece"
	States
	{
	Spawn:
		02RO A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDApocalypse",1,"Ammo")
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",0) <= 0,"Nothing")
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("ApocalypseDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDApocalypse",1)
		TNT1 A 0 A_PrintBold("\cgSlot 10: Apocalypse")
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDApocalypse",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,0,153,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDApocalypse",1)
		Stop
	}
}

Actor AEoDApocalypse : AEoDWeaponBase // 6075
{ 
	+WEAPON.CHEATNOTWEAPON
	+IGNORESKILL	+DONTGIB
	+FLOATBOB
	Weapon.AmmoType1 "BlueMana"
	Weapon.AmmoType2 "RedMana"
	Weapon.AmmoGive1 100
	Weapon.AmmoGive2 30
	Weapon.AmmoUse1 5
	Weapon.AmmoUse2 30
	Weapon.SelectionOrder 9950
	+FOILINVUL
	Inventory.PickupMessage "You found the Apocalypse!"
	Inventory.PickupSound "pickuppiece"
	Weapon.upsound "weapons/draw"
	Scale 0.95
	Tag "Apocalypse"
	States 
	{ 
	Spawn: 
		02RO A 3
		Loop
	Ready: 
		W02I A 0 A_PlaySound("reilsss/weapons/magicidle4", 6, 1.0, 1)
		W02I A 2 A_WeaponReady
		Goto Ready+1
	Deselect: 
		W02I A 0 A_StopSound(6)
		W02I A 0 	
		W02I A 1 A_Lower
		W02I AA 0 A_Lower
		Goto Deselect+1
	Select: 
		TNT1 A 0 	
		W02I A 1 A_Raise
		TNT1 AA 0 A_Raise
		Loop
	Fire: 
		W02I ABCDE 2
		W02I M 0 A_PlaySound("h2necromancer/boneshot", CHAN_WEAPON, 1.0, 0)
		W02I MN 1
		W02I N 0 A_GunFlash
		W02I N 0 A_GiveInventory("InvulFoiler",1,AAPTR_PLAYER_GETTARGET)
		W02I N 0 A_RailAttack(random(100,280),0,0,none,"red",1,1,"ApocPuff",0,0,0,10,0.9,1.1)
		W02I O 2 A_RailAttack(0,0,1,none,"00 00 00",1,3,"ApocPuff")
		W02I O 0 A_ReFire
		W02I FGA 3
		Goto Ready
	Hold:
		W02I DE 1
		W02I M 0 A_PlaySound("h2necromancer/boneshot", CHAN_WEAPON, 1.0, 0)
		W02I MN 1
		W02I O 2 
		{
			A_GunFlash;
			A_RailAttack(random(100,280),0,0,none,"red",1,1,"ApocPuff",0,0,0,10,0.9,1.1);
			A_RailAttack(0,0,1,none,"00 00 00",1,3,"ApocPuff");
		}
		W02I A 0 A_ReFire("Hold")
		W02I FGA 3
		Goto Ready
	AltFire:
		W02I H 8 A_PlaySound("castspell/fire", CHAN_WEAPON, 1.0, 0)
		W02I IJKL 3 
		W02I QRST 3 
		W02I U 15
		{
			A_GunFlash;
			A_SetBlend("DarkRed",0.4,50);
			A_FireCustomMissile("ApocalypseStarter",0,1,0,0);
		}
		W02I VWXY 3
		W02I P 30
		Goto Ready
	Flash:
		TNT1 A 1 
		Stop
	}
}

Actor InvulFoiler : CustomInventory
{
	+INVENTORY.ALWAYSPICKUP
	+INVENTORY.AUTOACTIVATE
	States
	{
	Use:
		TNT1 A 0 A_JumpIf(CheckClass("AEoDMarine",AAPTR_DEFAULT,0),"End")
		TNT1 A 0 A_JumpIfInventory("PlayerToken",1,"End") //Just in case if Mastemas uses it.
		TNT1 A 0 A_CheckFlag("FRIENDLY","End")
		TNT1 A 0 A_ChangeFlag("INVULNERABLE",0)
	End:
		TNT1 A 0
		Stop
	}
}

Actor InvulFoilerSeq : CustomInventory
{
	+INVENTORY.ALWAYSPICKUP
	+INVENTORY.AUTOACTIVATE
	States
	{
	Use:
		TNT1 A 0 A_CheckFlag("FRIENDLY","End")
		//Skip the whole messy business of checks in order from most likely
		//to least. Cuts down on computation time.
		TNT1 A 0 A_CheckFlag("INVULNERABLE",1)
		Goto End
		//^--Don't bother if the monster wasn't invulnerable, otherwise
		//that's just giving them free invulnerability for nothing.
		TNT1 A 0 A_CheckSight("End")
		//If the player can see it, it can be apoc spray-flamed.
		TNT1 A 0 A_JumpIfInventory("PlayerToken",1,"End") //Just in case if Mastemas uses it.
		TNT1 A 0 A_ChangeFlag("INVULNERABLE",0)
		TNT1 A 0 A_SpawnItemEx("InvulFoilReset",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER)
	End:
		TNT1 A 0
		Stop
	}
}

Actor InvulFoilReset
{
	Projectile
	+NOINTERACTION
	+NOSECTOR
	States
	{
	Spawn:
		TNT1 A 1
		TNT1 A 0 A_GiveInventory("InvulFoilResetter",1,AAPTR_MASTER)
		Stop
	}
}

Actor InvulFoilResetter : CustomInventory
{
	+INVENTORY.ALWAYSPICKUP
	+INVENTORY.AUTOACTIVATE
	States
	{
	Use:
		TNT1 A 0 A_ChangeFlag("INVULNERABLE",1)
		Stop
	}
}

Actor ApocPuff
{
	+NoBlockmap
	+NoGravity
	+ActivatePCross
	+ActivateImpact
	+NoTeleport
	+DropOff
	+PUFFONACTORS
	+FOILINVUL
	DamageType "Holy"
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 1
		Stop
	}
}
Actor ApocGhost
{
	PROJECTILE
	+SEEKERMISSILE
	Radius 8
	Height 6
	Speed 30
	Damage 7
	SeeSound "spiritactive"
	DeathSound "spiritattack"
	Scale 0.7
	States
	{
	Spawn:
		WLP4 A 2 Bright A_SeekerMissile(5,50)
		TNT1 A 0 Bright A_CustomMissile("GibBloodTrailMediumSize",0,0,0)
		WLP4 B 2 Bright A_SeekerMissile(5,50)
		TNT1 A 0 Bright A_CustomMissile("GibBloodTrailMediumSize",0,0,0)
		WLP4 C 2 Bright A_SeekerMissile(5,50)
		TNT1 A 0 Bright A_CustomMissile("GibBloodTrailMediumSize",0,0,0)
		Loop
	Death:
		WLP4 DEFG 4 Bright
		Stop
	}
}

Actor ApocalypseStarter
{
	Projectile
	+NOINTERACTION
	+FULLVOLDEATH
	+FOILINVUL
	+THRUACTORS
	Speed 0
	Radius 1
	Height 1
	DeathSound "Apocalypse/silence"
	Scale 0.2
	States
	{
	Spawn:
		TNT1 A 0 A_Scream
		TNT1 A 2 A_RadiusGive("ApocalypseSprayerStart",4096,RGF_MONSTERS|RGF_OBJECTS,1)
		//TNT1 A 1 A_BFGSpray("ApocSpray",240,15,90,4096,32)
		Stop
	}
}

Actor ApocalypseSprayerStart : CustomInventory
{
	const int MaxAngle = 90;
	const int MaxDistance = 4096;
	+ALWAYSPICKUP
	States
	{
	Pickup:
		TNT1 A 0
		{
			if (health < 1 || A_CheckFlag(FRIENDLY,"Null") || 
				(!A_CheckFlag(SHOOTABLE,"Null") && !A_CheckFlag(VULNERABLE,"Null")))
			{	return bool(false);	}
			
			// It's unoccupied so go ahead and use it without fear.
			if (IsPointerEqual(TracerPtr,NullPtr))
			{
				if (A_CheckProximity("Null","ApocalypseStarter",MaxDistance,1,CPXF_NOZ|CPXF_SETTRACER))
				{
					A_TransferPointer(TracerPtr,DefPtr,TargetPtr,TracerPtr,4);
					if (abs(GetAngle(GAF_RELATIVE|GAF_SWITCH,TracerPtr)) > MaxAngle)
					{	return bool(false);	}
					A_SpawnItemEx("ApocSprayPlayer",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETTARGET|SXF_ORIGINATOR|SXF_TRANSFERPOINTERS);
				}
				
				//And then erase it again once done.
				A_RearrangePointers(DefPtr,DefPtr,NullPtr,4);
			}
			else 
			{
				// We'll need to save the tracer pointer so spawn a temp actor.
				A_SpawnItemEx("PointerSaver",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS|SXF_SETMASTER|SXF_ORIGINATOR);
				if (A_CheckProximity("Null","ApocalypseStarter",MaxDistance,1,CPXF_NOZ|CPXF_SETTRACER))
				{
					A_TransferPointer(TracerPtr,DefPtr,TargetPtr,TracerPtr,4);
					if (abs(GetAngle(GAF_RELATIVE|GAF_SWITCH,TracerPtr)) > MaxAngle)
					{	return bool(false);	}
					A_SpawnItemEx("ApocSprayPlayer",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETTARGET|SXF_ORIGINATOR|SXF_TRANSFERPOINTERS);
				}
				// Restore the pointer now.
				A_GiveToChildren("PointerRestorer",1);
			}
			return bool(true);
		}
		Stop
	}
}

Actor ApocSprayPlayer
{
	enum
	{
		MaxDistance = 4096,
		DistDamage = 6144,
	};
	// Range damage reduction. The higher, the closer you have to be to the targets
	// to deal increased damage.
	const float Negate = 5.5; 
	var int user_damage;
	var int user_s1;
	Projectile
	+NOINTERACTION
	+THRUACTORS
	+FOILINVUL
	+BRIGHT
	+FORCEPAIN
	DamageType "Holy"
	Radius 1
	Height 1
	Speed 0
	States
	{
	Spawn:
		APOC A 0 NoDelay
		{
			// Switch the target and tracer around.
			if (CheckClass("PlayerPawn",TracerPtr,true))
			{	A_RearrangePointers(TracerPtr,DefPtr,TargetPtr,4);	}
			if (CheckClass("PlayerPawn",TargetPtr,true) || A_CheckProximity("Null","PlayerPawn",MaxDistance,1,CPXF_ANCESTOR|CPXF_NOZ|CPXF_SETTARGET))
			{				
				user_damage = (200 + 
					(abs(DistDamage - Clamp((GetDistance(false,TargetPtr) - 128) * Negate,0,DistDamage))*1));
				A_FaceTarget;
				A_Warp(TracerPtr,0,0,0,0,WARPF_NOCHECKPOSITION|WARPF_USECALLERANGLE,"Null",0.1,0.2);
				A_DamageTracer(user_damage,"Holy",DMSS_FOILINVUL|DMSS_AFFECTARMOR,None,None,TargetPtr);
				return state(0);
			}
			return state("Null");
		}
		APOC ABCDEFGHIJKLMNO 2 Bright A_FadeOut(0.03)
		Stop
	}
}

Actor ApocSpray
{
	Projectile
	+THRUACTORS
	+FOILINVUL
	DamageType "Holy"
	Radius 1
	Height 1
	Damage 0
	Speed 0
	States
	{
	Spawn:
		APOC ABCDEFGHIJKLMNO 2 Bright A_FadeOut(0.03)
		Stop
	}
}

Actor ApocalypseDrop : AEoDWeaponDrop
{
	Inventory.MaxAmount 1
	States
	{
	Use:
		TNT1 A 0
		TNT1 A 0 A_StopSound(6)
		TNT1 A 0 A_SpawnItemEx("DroppedApocalypse",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		Stop
	}
}

Actor DroppedApocalypse
{
	Radius 16
	Height 20
	Scale 0.95
	States
	{
	Spawn:
		02RO A 15
		TNT1 A 0 A_SpawnItemEx("AEoDApocalypseNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
}

Actor AEoDApocalypseNoAmmo : AEoDApocalypseItem
{
	+FLOORCLIP
	+FLOATBOB
	+IGNORESKILL	+DONTGIB
	Scale 0.95
	Inventory.Amount 1
	Inventory.PickupMessage "You found the Apocalypse!"
	Inventory.PickupSound "pickuppiece"
	States
	{
	Spawn:
		02RO A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",0) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("BlueMana",50,"Ammo")
		TNT1 A 0 A_JumpIfInventory("RedMana",30,"Ammo3")
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("ApocalypseDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDApocalypse",1)
		TNT1 A 0 A_TakeInventory("BlueMana",50)
		TNT1 A 0 A_TakeInventory("RedMana",30)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDApocalypse",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,0,153,0)
		Fail
	Ammo:
		TNT1 A 0 A_JumpIfInventory("RedMana",30,1)
		Goto Ammo2
		
		TNT1 A 0 A_TakeInventory("BlueMana",50)
		TNT1 A 0 A_TakeInventory("RedMana",30)
		TNT1 A 0 A_JumpIfInventory("AEoDApocalypse",1,2)
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("ApocalypseDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDApocalypse",1)
		Stop
	Ammo2:
		TNT1 A 0 A_TakeInventory("BlueMana",50)
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("ApocalypseDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDApocalypse",1)
		TNT1 A 0 A_TakeInventory("RedMana",30)
		Stop
	Ammo3:
		TNT1 A 0 A_TakeInventory("RedMana",25)
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("ApocalypseDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDApocalypse",1)
		TNT1 A 0 A_TakeInventory("BlueMana",50)
		Stop
	}
}

//==================================================================================
//==================================================================================

//==================================================================================
//==================================================================================

Actor AEoDBFG9000Item : AEoDWeaponPickup //6073
{
	+FLOORCLIP
	+IGNORESKILL	+DONTGIB
	Scale 1
	Inventory.Amount 1
	Inventory.PickupMessage "You got the BFG9000! Hell yes!"
	Inventory.PickupSound "reilsss/weappickup/qsg"
	States
	{
	Spawn:
		M016 Z -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDBFG9000",1,"Ammo")
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",0) <= 0,"Nothing")
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("BFG9000Drop",1)
		TNT1 A 0 A_GiveInventory("AEoDBFG9000",1)
		TNT1 A 0 A_PrintBold("\cgSlot 10: BFG 9000")
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDBFG9000",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,0,146,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDBFG9000",40)
		Stop
	}
}

Actor AEoDBFG9000 : AEoDWeaponBase // 6073
{
	+WEAPON.CHEATNOTWEAPON
	+IGNORESKILL	+DONTGIB
	+WEAPON.AMMO_OPTIONAL
	Weapon.AmmoType1 "PlasmaRod"
	Weapon.AmmoType2 "PlasmaRod"
	Weapon.AmmoGive1 40
	Weapon.AmmoGive2 40
	Weapon.AmmoUse1 40
	Weapon.SelectionOrder 20202
	Inventory.PickupMessage "You got the BFG9000! Hell yes!"
	Inventory.PickupSound "reilsss/weappickup/qsg" //"reilsss/weappickup/bfgs"
	Weapon.upsound "weapons/bfg/draw"
	Scale 1
	Tag "BFG 9000"
	States
	{
	Spawn:
		//BFU4 A -1
		M016 Z -1
		Stop
	Select:
		M016 A 1 A_Raise
		M016 AA 0 A_Raise
		Loop
	Deselect:
		"----" A 0 A_TakeInventory("SineZoom",1000,0)
		"----" A 1 A_Lower
		"----" AA 0 A_Lower
		Loop
	Ready:
		M016 A 0 
		{
			A_PlaySound("reilsss/weapons/bfgidle2", 6, 1.0, 1);
			A_TakeInventory("SineZoom",1000,0);
		}
		M016 BBBBCCCCDDDDCCCCBBBBAAAA 1 bright A_WeaponReady
		Loop
	Fire:
		M016 E 0 bright 
		{
			A_TakeInventory("SineZoom",1000,0);
			A_PlaySound("D4/BFGFire", 5, 1.0, 0);
		}
		M016 EEEFFFGGGHHHIIIJJJKKKLLL 1 bright
		{
			A_GiveInventory("SineZoom",18);
			A_ZoomFactor(sin(90-(CountInv("SineZoom")*0.1)),ZOOM_NOSCALETURNING);
		}
		M016 M 3 bright
		{
			A_TakeInventory("SineZoom",1000,0);
			A_ZoomFactor(1,ZOOM_NOSCALETURNING);
			A_SetBlend("Green",0.5,17);
			A_FireCustomMissile("BFG9000Shot",0,1,4,0);
			A_SetPitch(pitch-8);
		}
		M016 NNNNOOOO 1 bright A_SetPitch(pitch+1)
		M016 PQ 4 bright
		M016 AAA 4 bright
		Goto Ready
	}
}

Actor SineZoom : Inventory { Inventory.MaxAmount 450 }

//-----------------------------------------------------------------
//-----------------------------------------------------------------

const int BFG_LaserRadius = 1024;
Actor BFG9000Shot
{
	var int user_flags;
	var int user_count;
	var int user_c2;
	var int user_a;
	var float user_pitch;
	var int user_c;
	var int user_mini;
	var int user_sin;
	var int user_cos;
	var int user_pos;
	PROJECTILE
	+FORCERADIUSDMG
	+EXTREMEDEATH
	+BRIGHT
	+ROLLSPRITE
	+FORCEXYBILLBOARD
	+NODAMAGETHRUST
	+CANNOTPUSH
	Radius 8
	Height 12
	Speed 40
	Damage 500
	DeathSound "D4/BFGimpact"
	RenderStyle Add
	Scale 0.45
	DamageType "Plasma"
	States
	{
	Spawn:
		//X016 AABBCCDDEEFFGGHHIIJJKKLLMMNNOOPPQQRRSSTTUUVVWWXXYY 1 Bright NoDelay 
		BFE1 B 1 Bright NoDelay
		{
			A_SetScale((sin(user_c2)*0.075)+0.45);
			user_c2 = (user_c2 + random(20,35)) % 360;
			A_SetRoll(roll + 5, SPF_INTERPOLATE);
			A_FaceMovementDirection;
			user_count = (user_count + 1) % 4;
			
			if (CheckClass("PlayerPawn",TargetPtr,1))
			{	
				user_flags = RGF_MONSTERS|RGF_NOTARGET;
				A_Explode(random(16,32),BFG_LaserRadius,0,0,BFG_LaserRadius);
			}
			else
			{	
				user_flags = RGF_MONSTERS|RGF_NOTARGET|RGF_PLAYERS;
				A_Explode(1,BFG_LaserRadius,0,0,BFG_LaserRadius);
			}
			
			if (user_count == 0)
			{
				A_RadiusGive("BFGBeamSpawner",BFG_LaserRadius,user_flags|RGF_CUBE,1,None,None,0,5);	
			}
			A_SpawnItemEx("BFGTrailSpawner",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS|SXF_TRANSFERSCALE|SXF_TRANSFERSPRITEFRAME|SXF_TRANSFERPITCH|SXF_TRANSFERROLL);
			A_SpawnItemEx("BFGLightningGenerator",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION,192);
		}
		Loop
	Death:
		BFE1 C 0
		{
			A_ChangeFlag("CANNOTPUSH",false);
			A_ChangeFlag("NODAMAGETHRUST",false);
			A_QuakeEx(0,0,0,16,0,512,"",QF_SCALEDOWN|QF_SCALEUP,0,0,0,1,4,1,0);
			A_QuakeEx(0,0,0,20,0,512,"",QF_SCALEDOWN|QF_WAVE|QF_SCALEUP,0,0,0,1,4,1.5*randompick(-1,1),frandom(5.5,8.5));
			roll = 0;
			user_pitch = 0;
			user_count = 0;
			user_c2 = 0;
			ScaleX = 0;
			ScaleY = 0;
			A_Explode(random(1220,2660),512,0);
		}
	DLoop:
		BFE1 C 1 bright
		{
			/*
			if (user_a < 360)
			{
				// Weird infinity thingy. Must preserve.
				//(cos(-user_pitch)*10)*sin(user_a),0,(sin(user_pitch)*10)*cos(-user_a),
				//(cos(-user_pitch)*10)*sin(user_a),0,(sin(user_pitch)*10)*cos(-user_a),
				A_SpawnParticle("Green",SPF_FULLBRIGHT|SPF_RELATIVE,70,10,user_a,
				(cos(-user_pitch)*10),0,(sin(user_pitch)*10),(cos(-user_pitch)*10),0,(sin(user_pitch)*10),0,0,0);
				A_SpawnParticle("Green",SPF_FULLBRIGHT|SPF_RELATIVE,70,10,user_a+180,
				(cos(-user_pitch)*10),0,(sin(user_pitch)*10),(cos(-user_pitch)*10),0,(sin(user_pitch)*10),0,0,0);
				A_SpawnParticle("Green",SPF_FULLBRIGHT|SPF_RELATIVE,70,10,user_a,
				10,0,0,10,0,0,0,0,0);
				A_SpawnParticle("Green",SPF_FULLBRIGHT|SPF_RELATIVE,70,10,90,
				(cos(user_a)*10),0,(sin(user_a)*10),(cos(-user_a)*10),0,(sin(user_a)*10),0,0,0);
				A_SpawnParticle("Green",SPF_FULLBRIGHT|SPF_RELATIVE,70,10,0,
				(cos(user_a)*10),0,(sin(user_a)*10),(cos(-user_a)*10),0,(sin(user_a)*10),0,0,0);
				A_SetUserVarFloat(user_pitch,sin(user_a)*35);
				A_SetUserVar(user_a,user_a + 3);
				return state("DLoop");
			} */
			A_SpawnItemEx("BFGLightningGenerator",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION);
			//A_SpawnItemEx("BFGLightningGenerator",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION);
			//A_SpawnItemEx("BFGLightningGenerator",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION);
			user_count += 8;
			user_c2 += 5;
			A_SetScale(sin(user_c2)*1.5,Max((sin(user_count)*1.4),0.0));
			if (ScaleY <= 0.0 || user_count >= 180)	
			{	return state("Null");	}
			return state(0);
		}
		Loop
	}
}

// -----------------------------------------------------------------------------
// This spawns the trails and deals the mass damage to all enemies via A_Explode
// so it can replicate lasering everything around it.

Actor BFGTrailSpawner
{
	var int user_t;
	var float user_scalar;
	Projectile
	+FORCERADIUSDMG
	+EXTREMEDEATH
	+NOINTERACTION
	+NODAMAGETHRUST
	+NOTONAUTOMAP
	+ROLLSPRITE
	+FORCEXYBILLBOARD
	RenderStyle Add
	DamageType "Plasma"
	States
	{
	Spawn:
		BFE1 B 0 NoDelay
		{
			A_FaceMovementDirection;
			A_SpawnItemEx("BFGTrail2",cos(pitch)*10,0,-sin(pitch)*10,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERSCALE|SXF_TRANSFERROLL);
			return state("Enact");
		}
	Enact:
		BFE1 B 1
		{
			user_scalar += frandom(0.005,0.01);
			A_SetScale(ScaleX,ScaleY-user_scalar);
			if (ScaleY <= 0.0)
			{	return state("Null");	}
			return state(0);
		}
		Loop
	}
}

Actor BFGTrail2
{
	var float user_scalar;
	+NOINTERACTION
	+NOTONAUTOMAP
	+ROLLSPRITE
	+FORCEXYBILLBOARD
	RenderStyle Add
	States
	{
	Spawn:
		BFE1 B 1
	Enact:
		BFE1 B 1
		{
			A_SetUserVarFloat(user_scalar, user_scalar + frandom(0.005,0.01));
			A_SetScale(ScaleX,ScaleY-user_scalar);
			if (ScaleY <= 0.0)
			{	return state("Null");	}
			return state(0);
		}
		Loop
	}
}

Actor BFGLightningGenerator
{
	const float AngMin = 5.0;
	const float AngMax = 30.0;
	var int user_c;
	var int user_count;
	var int user_d;
	var int user_limit;
	var int user_branch;
	var int user_size;
	var int user_t;
	var int user_new;
	var float user_amin;
	var float user_amax;
	var float user_pitch;
	+NOINTERACTION
	+NOTONAUTOMAP
	RenderStyle None
	Speed 2
	States
	{
	Spawn:
		TNT1 A 0 NoDelay
		{
		// Branch version. Doesn't spawn further instances of itself and halves
		// everything -- turning, spawn count, you name it.
			if (tid > 0)
			{
				A_SetUserVar(user_t, tid);
				Thing_ChangeTID(0,0);
				A_SetUserVarFloat(user_amin,AngMin/2.0);
				A_SetUserVarFloat(user_amax,AngMax/2.0);
				A_SetUserVar(user_size, 5);
				A_SetUserVar(user_limit,random(15,45));
				A_SetAngle(angle+(random(user_amin*2,user_amax)*randompick(-1,1))/2.0);
				A_SetUserVarFloat(user_pitch,pitch+(random(user_amin*2,user_amax)*randompick(-1,1))/2.0);
			}
			else
			{	
				A_SetUserVarFloat(user_amin,AngMin);
				A_SetUserVarFloat(user_amax,AngMax);
				A_SetUserVar(user_size, 7);	
				A_SetUserVar(user_limit,random(30,90));
				A_SetAngle(random(0,359));
				A_SetUserVarFloat(user_pitch,random(-90,90));
			}
			A_SetUserVar(user_c, random(1,4));
			A_SetUserVar(user_d, user_c);
		}
	Looping:
		TNT1 A 0
		{
			A_Stop;
			if (user_limit <= 0)
			{	return state("Null");	}
			A_SetUserVar(user_limit, user_limit - 1);
			
			if (user_c <= 0)
			{
				
				
				A_Warp(DefPtr,cos(user_pitch)*Speed*user_count,0,-sin(user_pitch)*Speed*user_count,0,WARPF_NOCHECKPOSITION);
				A_SetUserVarFloat(user_pitch, user_pitch+(frandom(user_amin,user_amax)*frandompick(-1,1)));
				//if (user_pitch > 90.0)	{ A_SetUserVarFloat(user_pitch, user_pitch-(abs(user_pitch)%90.0)); A_SetAngle(angle+180); }
				//if (user_pitch < -90.0)	{ A_SetUserVarFloat(user_pitch, user_pitch+(abs(user_pitch)%90.0)); A_SetAngle(angle+180); }
				A_SetAngle(angle+(frandom(user_amin,user_amax)*frandompick(-1,1)));
				A_SetPitch(user_pitch);
				
				if (user_branch > 0)
				{	A_SetUserVar(user_branch,user_branch-1);	}
				if (!user_t && !user_branch)
				{
					A_SpawnItemEx("BFGLightningGenerator",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPITCH,64,1);
					A_SpawnItemEx("BFGLightningGenerator",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPITCH,128,1);
					A_SpawnItemEx("BFGLightningGenerator",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPITCH,192,1);
					A_SetUserVar(user_branch,user_branch+random(1,5));
				}
				
				A_SetUserVar(user_count,0);
				A_SetUserVar(user_c, random(1,4));
				A_SetUserVar(user_d, user_c);
			}
			A_SetUserVar(user_c, user_c-1);
			A_SetUserVar(user_count,user_count+1);
			A_SpawnParticle(A7FF47,SPF_FULLBRIGHT|SPF_RELATIVE,2,user_size,0,
				((cos(-user_pitch)*Speed)*user_count),
				0,
				((sin(user_pitch)*Speed)*user_count),
				0,0,0,0,0,0,1.0,0.5);
					
			
			return state("Looping");
		}
		Loop
	}
}

Actor BFGBeamSpawner : CustomInventory
{
	States
	{
	Pickup:
		TNT1 A 0
		{
			if ((health <= 0) || !A_CheckProximity("Null","BFG9000Shot",BFG_LaserRadius,1,CPXF_CHECKSIGHT) ||
				!A_CheckFlag(SHOOTABLE,"Null") || A_CheckFlag(FRIENDLY,"Null"))
			{	return bool(false);	}

			if (GetCvar(vid_renderer))
			{	A_SpawnItemEx("BFGBeamGZ",0,0,height/2,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETTRACER|SXF_ORIGINATOR);	}
			else
			{	A_SpawnItemEx("BFGBeam",0,0,height/2,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETTARGET);	}
				
			return bool(true);
		}
		Stop
	Failure:
		TNT1 A 0 {	return bool(false);	}
		Fail
	}
}

//==============================================================================
// GZDoom BFG Beam

Actor BFGBeamGZ
{
	enum
	{
		MaxDistance = 2048,
		AngleRandom = 7,
		PitchRandom = 7,
		ChokeMin = 2,
		ChokeMax = 6,
		MaxLife = 4,
	};
	const float StepDistance = 62;
	var int user_fs;
	var float user_pitch;
	var float user_angle;
	var float user_dist[2];
	//[0] = Current distance travelled
	//[1] = How much further to go
	var int user_choke;
	var int user_count;
	+NOINTERACTION
	RenderStyle None
	States
	{
	Spawn:
		TNT1 A 0 NoDelay
		{
			
			if (!A_CheckProximity("Null","BFG9000Shot",BFG_LaserRadius*2,1,CPXF_SETTARGET|CPXF_CHECKSIGHT))
			{	return state("Null");	}
			if (!IsPointerEqual(TracerPtr,NullPtr))
			{
				A_Warp(TargetPtr,0,0,0,0,SXF_NOCHECKPOSITION);
				A_FaceTracer(0,0,0,0,FAF_MIDDLE);
				user_pitch = pitch;
				user_angle = angle;
				user_dist[0] = 0;
				user_dist[1] = Min(MaxDistance,GetDistance(true,TracerPtr));
				user_choke = random(ChokeMin,ChokeMax);
				return state(0);
			}
			return state("Null");
		}
		TNT1 A 1
		{
			while ((user_dist[0] < user_dist[1]) && !IsPointerEqual(TracerPtr,NullPtr) && !A_JumpIfHealthLower(1,"Null",TracerPtr))
			{
				user_fs++;
				if (user_fs >= 150)
				{	return state("Null");	}
				if (user_dist[0] > 0)
				{	A_FaceTracer(0,0,0,0,FAF_MIDDLE);	}
				if (user_dist[0] < (user_dist[1] - StepDistance))
				{
					if (user_choke > 0)
					{
						A_SetPitch(pitch + frandom(-PitchRandom, PitchRandom));
						A_SetAngle(angle + frandom(-AngleRandom, AngleRandom));
						A_SetUserVar(user_choke, user_choke - 1);
					}
					else 
					{	A_SetUserVar(user_choke, random(ChokeMin,ChokeMax));	}
				}
				if ((user_dist[0] < user_dist[1] - (StepDistance / 2.0)) )
				{	A_SpawnItemEx("BFGBeamLaser",cos(pitch) * (StepDistance / 2.0),0,-sin(pitch) * (StepDistance / 2.0),0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPITCH);	}
				A_Warp(DefPtr,cos(pitch) * StepDistance,0,-sin(pitch) * StepDistance,0,WARPF_NOCHECKPOSITION);
				user_dist[0] += StepDistance;
			}
			if (user_count < MaxLife)	
			{
				user_count++;
				return state(0);
			}
			else
			{	return state("Null");	}
			
		}
		Loop
	}
}

Actor BFGBeamLaser : TrailBeam
{
	XScale 0.075
	YScale 0.5 //Don't touch.
	States
	{
	Spawn:
		X163 E 0 NoDelay
		{
			// user_time = time to shrink to nothing
			user_time = 2.0;
			A_SpawnItemEx("BFGBeamLaser",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPITCH|SXF_TRANSFERSCALE|SXF_TRANSFERPOINTERS,tid * 256,1);
		}
		Goto Process
	}
}

//==============================================================================
// ZDoom BFG Beam
Actor BFGBeam
{
	const float Limit = 18.0;
	const float FMin = 0.5;
	const float FMax = 1.0;
	var float user_x[2];
	var float user_y[2];
	var float user_z[2];
	var float user_dist;
	var int user_fs;
	var int user_life;
	var int user_count;
	var int user_minicount;
	var float user_scalar;
	+NOINTERACTION
	+NOBLOCKMAP
	+NOTONAUTOMAP
	RenderStyle None
	Speed 5
	States
	{
	Spawn:
		TNT1 A 1 NoDelay
		{
			if (user_life >= 2 || A_JumpIfHealthLower(1,"Null",TargetPtr) || IsPointerEqual(TargetPtr,NullPtr))
			{	return state("Null");	}
			
			if (A_CheckProximity("Null","BFG9000Shot",BFG_LaserRadius,1,CPXF_SETTRACER|CPXF_CHECKSIGHT))
			{
				user_life++;
				user_count = user_minicount = user_scalar = 0;
				A_FaceTracer(0,0,0,0,FAF_MIDDLE);
				A_Warp(TargetPtr,0,0,0,0,WARPF_USECALLERANGLE|WARPF_NOCHECKPOSITION,"Null",0.5);
				user_dist = GetDistance(true,TracerPtr);
				//A_Warp(TracerPtr,0,0,0,0,WARPF_USECALLERANGLE|WARPF_NOCHECKPOSITION,"Null");
				return state("Beam");
			}
			return state("Null");
		}
		Stop
	Beam:
		TNT1 A 2
		{
			user_fs++;
			if (user_fs >= 500)
			{	A_Log("Too many");	return state("Null");	}
			if (user_count >= user_dist)
			{	return state(0);	}
			
			if (user_count < (speed * 20))
			{	user_scalar = Clamp(user_scalar + (1.0/20.0), 0.0, 1.0);	}
			if (user_count >= (user_dist - (speed * 20)))
			{	user_scalar = Clamp(user_scalar - (1.0/20.0), 0.0, 1.0);	}
			
			if (user_minicount <= 0)
			{
				user_x[1] = frandom(FMin,FMax) * randompick(-1,1);
				user_y[1] = frandom(FMin,FMax) * randompick(-1,1);
				user_z[1] = frandom(FMin,FMax) * randompick(-1,1);
				user_minicount = random(2,4);
			}
			else
			{
				user_x[0] += user_x[1];
				user_y[0] += user_y[1];
				user_z[0] += user_z[1];
				user_minicount++;
			}
			if (user_y[0] > Limit)		{	user_y[0] -= ((abs(user_y[0]) % Limit) * 2);	}
			if (user_y[0] < -Limit)		{	user_y[0] += ((abs(user_y[0]) % Limit) * 2);	}
			
			if (user_z[0] > Limit)		{	user_z[0] -= ((abs(user_z[0]) % Limit) * 2);	}
			if (user_z[0] < -Limit)		{	user_z[0] += ((abs(user_z[0]) % Limit) * 2);	}
			
			A_SpawnParticle(A7FF47,SPF_FULLBRIGHT|SPF_RELATIVE,3,16,0,
				(cos(pitch)*user_count)+(-sin(pitch)*user_x[0]*user_scalar),
				user_y[0]*user_scalar,
				((-sin(pitch)*user_count)+(cos(pitch)*user_z[0]*user_scalar)),
				0,0,0,0,0,0,1.0,0.3);
				user_count += speed;
			return state("Beam");
		}
		Goto Spawn
	}
}

//-------------------------------------------------------
// The main trail behind the energy ball (shadow trail)
Actor BFG9000MainTrail
{
	//Translation "0:255=%[0,0,0]:[0.2,1.0,0.2]"
	var float user_scalar;
	+NOINTERACTION
	RenderStyle Add
	Alpha 0.5
	States
	{
	Spawn:
		BFE1 B 1
		{
			A_SetUserVarFloat(user_scalar, user_scalar + frandom(0.005,0.01));
			A_SetScale(ScaleX,ScaleY-user_scalar);
			if (ScaleY <= 0.0)
			{	return state("Null");	}
			return state(0);
		}
		//X016 ABCDEFGHIJKLMOPQRSTUVWXY 2 A_FadeOut(0.07)
		Loop
	}
}

//-------------------------------------------------------
// The electricity sparks
Actor BFG9000Spark
{
	Translation "0:255=%[0,0,0]:[0.2,1.2,0.2]"
	+NOINTERACTION
	Scale 0.1
	RenderStyle Add
	States
	{
	Spawn:
		TNT1 A 0 NoDelay A_Jump(256,1,2,3,4,5,6,7,8)
		X079 ABCDEFGH 0	A_Jump(256,"Perform")
	Perform:
		"####" "#" 1 Bright 
		{
			A_SetScale(ScaleX+0.01);
			A_FadeOut(0.05);
		}
		Loop
	}
}

//-----------------------------------------------------------
// The small energy trail particles of the projectile in air
Actor BFG9000TrailA
{ 
	+NOINTERACTION
	RenderStyle Add
	Alpha 0.7
	Scale 0.2
	Translation "0:255=%[0,0,0]:[0.2,1.2,0.2]"
	States
	{
	Spawn:
		X026 ABCDEFGHIJKLMNOPQRST 1 A_FadeOut(0.02)
		Wait
	}
}

Actor BFG9000TrailB
{ 
	+NOINTERACTION
	RenderStyle Add
	Alpha 0.7
	Scale 0.1
	Translation "0:255=%[0,0,0]:[0,1.2,0]"
	States
	{
	Spawn:
		X026 ABCDEFGHIJKLMNOPQRST 1 A_FadeOut(0.03)
		Wait
	}
}

//-----------------------------------------------------
// Straight from SuperDoom3 Take II, by DBT
// Idea of code optimization by Major Cooke
// These are the circles when the projectile explodes

//explosion slow
Actor BFGBlastExplo1
{
	var int user_count;
	+FORCEXYBILLBOARD
	+NOINTERACTION
	RenderStyle Add
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SetUserVar("user_count",20)
	SizeLoop:
		TNT1 A 0 A_SetScale((user_count*0.01))
		TNT1 A 0 A_JumpIf(user_count>=95,"LoopEnd") 
		X060 A 2 Bright A_FadeOut(0.06)
		TNT1 A 0 A_SetUserVar("user_count",user_count+5)
		Loop	  
	LoopEnd:
		X060 A 2 Bright A_FadeOut(0.1)
		Wait
  }
}

//explosion2 slow
Actor BFGBlastExplo2
{
	var int user_count;
	+FORCEXYBILLBOARD
	+NOINTERACTION
	RenderStyle Add
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SetUserVar("user_count",20)
	SizeLoop:
		TNT1 A 0 A_SetScale((user_count*0.01))
		TNT1 A 0 A_JumpIf(user_count>=95,"LoopEnd") 
		X060 B 2 Bright A_FadeOut(0.06)
		TNT1 A 0 A_SetUserVar("user_count",user_count+5)
		Loop	  
	LoopEnd:
		X060 B 2 Bright A_FadeOut(0.1)
		Wait
	}
}

//explosion fast bigger
Actor BFGBlastExploBigFast
{
	var int user_count;
	+FORCEXYBILLBOARD
	+NOINTERACTION
	RenderStyle Add
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SetUserVar("user_count",25)
	SizeLoop:
		TNT1 A 0 A_SetScale((user_count*0.01))
		TNT1 A 0 A_JumpIf(user_count>=150,"LoopEnd") 
		X060 A 1 Bright A_FadeOut(0.033)
		TNT1 A 0 A_SetUserVar("user_count",user_count+5)
		Loop	  
	LoopEnd:
		X060 A 1 Bright A_FadeOut(0.1)
		Wait
	}
}

//explosion fast biggest
Actor BFGBlastExploBiggerFast
{
	var int user_count;
	+FORCEXYBILLBOARD
	+NOINTERACTION
	RenderStyle Add
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SetUserVar("user_count",3)
	SizeLoop:
		TNT1 A 0 A_SetScale((user_count*0.01))
		TNT1 A 0 A_JumpIf(user_count>=240,"LoopEnd") 
		X060 A 1 Bright A_FadeOut(0.028)
		TNT1 A 0 A_SetUserVar("user_count",user_count+7)
		Loop	  
	LoopEnd:
		X060 A 1 Bright A_FadeOut(0.1)
		Wait
	}
}





Actor BFG9000BoltTrail
{
	+NOINTERACTION
	Scale 0.4
	RenderStyle Add
	States
	{
	Spawn:
		EBLT ABCDEF 3 Bright
		Stop
	}
}

Actor BFG10Extra1
{
	+NOINTERACTION
	Radius 1
	Height 1
	RenderStyle Add
	Translation "80:111=112:127"
	Scale 0.2
	States
	{
	Spawn:
		PUF2 AA 1 Bright
		TNT1 A 0 A_Jump(165,1)
		Loop
		PUF2 AA 1 Bright
		PUF2 A 1 Bright A_FadeOut
		Wait
	Death:
		TNT1 A 1
		Stop
	}
}

Actor BFG10Extra2
{
	+NOINTERACTION
	Radius 1
	Height 1
	Scale 0.32
	RenderStyle Add
	Translation "80:111=112:127"
	States
	{
	Spawn:
		PUF2 AAAAA 1 Bright
		TNT1 A 0 A_Jump(160,1)
		Loop
		PUF2 AAAA 1 Bright
		PUF2 A 1 Bright A_FadeOut
		Wait
	Death:
		TNT1 A 1
		Stop
	}
}

Actor BFGExtraDMG : BFGExtra replaces BFGExtra { DamageType "Plasma" }

Actor BFGBallSmoke
{
	+NOINTERACTION
	RenderStyle Add
	Alpha 0.7
	Scale 0.65
	Translation "0:255=%[0.0,0.3,0.0]:[0.0,2.0,0.0]"
	States
	{
	Spawn:
		TNT1 A 0
		X003 ABCDE 2 Bright A_FadeOut(0.03)
		TNT1 A 0 A_ScaleVelocity(0.9)
		X003 FGHIJ 2 Bright A_FadeOut(0.03)
		TNT1 A 0 A_ScaleVelocity(0.75)
		X003 KLMNO 2 Bright A_FadeOut(0.03)
		TNT1 A 0 A_ScaleVelocity(0.6)
		X003 PQRST 2 Bright A_FadeOut(0.03)
		TNT1 A 0 A_ScaleVelocity(0.5)
		X003 UVWXYZ 2 Bright A_FadeOut(0.03)
		Stop
	}
}
/*
Actor D3BFGBallMuzzle
{
	const int Flags = WARPF_NOCHECKPOSITION|WARPF_COPYPITCH|WARPF_COPYVELOCITY|WARPF_INTERPOLATE;
	const int Distance = 20;
	const int YOff = 8;
	const int ZOff = 38;
	var int user_t;
	Projectile
	+NOINTERACTION
	Scale 0.30
	Alpha 0.8
	RenderStyle Add
	Translation "0:255=%[0,0,0]:[0,1,0]"
	States
	{
	Spawn:
		TNT1 A 0 NoDelay A_Warp(AAPTR_MASTER,cos(-pitch)*(Distance+4),YOff,ZOff+sin(-pitch)*Distance,0,
			WARPF_NOCHECKPOSITION|WARPF_COPYPITCH)
		//To avoid jumping and ugly visual crap, do it one more time.
		TNT1 A 0 A_Warp(AAPTR_MASTER,cos(-pitch)*(Distance+4),YOff,ZOff+sin(-pitch)*Distance,0,Flags)
	Moving:
		X018 AABBCCDDEEFFGGHHIIJJKKLLMMNNOOPPQQRRSSTTUUVVWWXXYY 1 Bright A_Warp(AAPTR_MASTER,
			cos(-pitch)*(Distance+4),YOff,ZOff+sin(-pitch)*Distance,0,Flags)
		"####" "#" 0 A_SetUserVar(user_t,user_t+1)
		"####" "#" 0 A_JumpIf(user_t < 6,"Moving")
		Stop
	}
}
*/
Actor D3Shockwave : BFGBlastExploBigFast { }

Actor BFG9000Drop : AEoDWeaponDrop
{
	Inventory.MaxAmount 1
	States
	{
	Use:
		TNT1 A 0
		TNT1 A 0 A_StopSound(6)
		TNT1 A 0 A_SpawnItemEx("DroppedBFG9000",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		Stop
	}
}

Actor DroppedBFG9000
{
	Radius 16
	Height 20
	Scale 1
	States
	{
	Spawn:
		BFU4 A 15
		TNT1 A 0 A_SpawnItemEx("AEoDBFG9000NoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
}

Actor AEoDBFG9000NoAmmo : AEoDBFG9000Item
{
	+FLOORCLIP
	+IGNORESKILL	+DONTGIB
	Scale 1
	Inventory.Amount 1
	Inventory.PickupMessage "You got the BFG9000! Hell yes!"
	Inventory.PickupSound "reilsss/weappickup/qsg"
	States
	{
	Spawn:
		//BFU4 A -1
		M016 Z -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",0) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("PlasmaRod",40,"Ammo")
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("BFG9000Drop",1)
		TNT1 A 0 A_GiveInventory("AEoDBFG9000",1)
		TNT1 A 0 A_TakeInventory("PlasmaRod",40)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDBFG9000",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,0,146,0)
		Fail
	Ammo:
		TNT1 A 0 A_TakeInventory("PlasmaRod",40)
		TNT1 A 0 A_JumpIfInventory("AEoDBFG9000",1,2)
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("BFG9000Drop",1)
		TNT1 A 0 A_GiveInventory("AEoDBFG9000",1)
		Stop
	}
}

//==================================================================================
//==================================================================================

//==================================================================================
//==================================================================================

Actor AEoDBioForceGunItem : AEoDWeaponPickup 6058
{
	+FLOORCLIP
	+IGNORESKILL	+DONTGIB
	Inventory.Amount 1
	Inventory.PickupMessage "You Got the Bio Force Gun!"
	Inventory.PickupSound "reilsss/weappickup/bfgs"
	Scale 1.1
	States
	{
	Spawn:
		Q2BR A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDBioForceGun",1,"Ammo")
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",0) <= 0,"Nothing")
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("BioForceGunDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDBioForceGun",1)
		TNT1 A 0 A_PrintBold("\cgSlot 10: Bio Force Gun")
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDBioForceGun",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,0,145,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDBioForceGun",1)
		Stop
	}
}

Actor AEoDBioForceGun : AEoDWeaponBase // 6058
{
	+WEAPON.CHEATNOTWEAPON
	+IGNORESKILL	+DONTGIB
	+FLOORCLIP
	Scale 1.1
	Weapon.AmmoType1 "AECEll"
	Weapon.AmmoType2 "AECEll"
	Weapon.AmmoGive1 80
	Weapon.AmmoUse1 40
	Weapon.AmmoUse2 80
	Weapon.SelectionOrder 18900
	Inventory.PickupMessage "You Got the Bio Force Gun!"
	Inventory.PickupSound "reilsss/weappickup/bfgs"
	Weapon.upsound "weapons/bfg/draw"
	Tag "Bio force gun"
	States
	{
	Spawn:
		Q2BR A 3
		Loop 
	Ready:
		TNT1 A 0 A_PlaySound("reilsss/weapons/bfgidle1", 6, 0.9, 1)
		QBFG AAAAAABBBBBBCCCCCCDDDDDD 1 A_WeaponReady
		Goto Ready+1
	Deselect:
		QBFG A 0 A_StopSound(6)
		QBFG A 0 	
		QBFG A 1 A_Lower
		QBFG AA 0 A_Lower
		Goto Deselect+1
	Select:
		QBFG A 0 	
		QBFG A 1 A_Raise
		QBFG AA 0 A_Raise
		Loop
	Fire:
		QBFG AB 6
		QBFG C 4 A_PlaySound("reilsss/weapons/bfgfire", CHAN_WEAPON, 1.0, 0)
		QBFG D 4
		QBFG ABCD 2 
		QBFG ABCD 2
		QBFG AE 2
		QBFG E 0 A_GunFlash
		QBFG E 0 A_SetBlend("Green",0.75,10)
		QBFG E 0 A_FireCustomMissile("FBFGBall",0,1,4,0)
		QBFG E 0 A_SetPitch(pitch-4)
		QBFG FFFG 1 A_SetPitch(pitch+1)
		QBFG GG 1 A_Refire
		QBFG HHH 1 
		QBFG IJ 2
		
		//Reload
		QBFG J 0 A_PlaySound("reilsss/weapons/bfgreload", 7, 1.0, 0)
		QBFG KLMNOQRSTU 2 //A_ReFire
		QBFG U 0 A_PlaySound("reilsss/weapons/bfgreload", 7, 1.0, 0)
		QBFG V 1 A_FireCustomMissile("GunSmallSmokeSpawner",0,0,5,7)
		QBFG UTSRQONML 2
		QBFG A 0 A_PlaySound("reilsss/weapons/bfgreload", 7, 1.0, 0)
		QBFG A 0 A_CheckReload
		Goto Ready
	AltFire:
		QBFG B 0 A_PlaySound("reilsss/weapons/bfgfire", CHAN_WEAPON, 1.0, 0)
		QBFG CD 4
		QBFG ABCD 2 
		QBFG ABCD 2
		QBFG AE 2
		QBFG E 0 A_GunFlash
		QBFG E 0 A_SetBlend("Green",0.75,10)
		QBFG E 0 A_FireCustomMissile("BFG9000Shot",0,1,4,0)
		QBFG E 0 A_SetPitch(pitch-4)
		QBFG FFFG 1 A_SetPitch(pitch+1)
		QBFG GGHHH 1
		QBFG IJ 3
		
		//Reload
		QBFG A 0 A_PlaySound("reilsss/weapons/bfgreload", 7, 1.0, 0)
		QBFG KLMNOQRSTU 2 
		QBFG U 0 A_PlaySound("reilsss/weapons/bfgreload", 7, 1.0, 0)
		QBFG VVV 1 A_FireCustomMissile("GunSmallSmokeSpawner",0,0,5,7)
		QBFG UTSRQONML 2
		QBFG A 0 A_PlaySound("reilsss/weapons/bfgreload", 7, 1.0, 0)
		QBFG A 0 A_CheckReload
		Goto Ready
	Flash:
		BFGF A 3 Bright A_Light1
		BFGF B 3 Bright A_Light2
		BFGF C 3 Bright A_Light0
		Goto LightDone	
	}
}


Actor FBFGBall : BFGBall
{
	Projectile
	+EXTREMEDEATH
	+FORCERADIUSDMG
	+STRIFEDAMAGE
	Radius 8
	Height 8
	Speed 25
	Damage 200
	DeathSound "q2weapon/bfgballexplo"
	Renderstyle Add
	Alpha 0.75
	DamageType "Plasma"
	States
	{
	Spawn:
		TNT1 AA 0 A_SpawnItemEx("BFG9000TrailBsimple",0,0,10,random(-3,3),random(-3,3),random(-3,3),random(1,360))
		BFS1 A 1 Bright A_CustomMissile("BFG9000TrailAsimple",10+random(10,-10),0+random(10,-10),0+random(22,-22),0)
		TNT1 AA 0 A_SpawnItemEx("BFG9000TrailBsimple",0,0,10,random(-3,3),random(-3,3),random(-3,3),random(1,360))
		BFS1 A 1 Bright A_CustomMissile("BFG9000TrailAsimple",10+random(10,-10),0+random(10,-10),0+random(22,-22),0)
		TNT1 AA 0 A_SpawnItemEx("BFG9000TrailBsimple",0,0,10,random(-3,3),random(-3,3),random(-3,3),random(1,360))
		BFS1 A 1 Bright A_CustomMissile("BFG9000TrailAsimple",10+random(10,-10),0+random(10,-10),0+random(22,-22),0)
		TNT1 AA 0 A_SpawnItemEx("BFG9000TrailBsimple",0,0,10,random(-3,3),random(-3,3),random(-3,3),random(1,360))
		BFS1 A 1 Bright A_CustomMissile("BFG9000TrailAsimple",10+random(10,-10),0+random(10,-10),0+random(22,-22),0)
		TNT1 AA 0 A_SpawnItemEx("BFG9000TrailBsimple",0,0,10,random(-3,3),random(-3,3),random(-3,3),random(1,360))
		BFS1 A 1 Bright A_CustomMissile("BFG9000TrailAsimple",10+random(10,-10),0+random(10,-10),0+random(22,-22),0)
		TNT1 AA 0 A_SpawnItemEx("BFG9000TrailBsimple",0,0,10,random(-3,3),random(-3,3),random(-3,3),random(1,360))
		BFS1 B 1 Bright A_CustomMissile("BFG9000TrailAsimple",10+random(10,-10),0+random(10,-10),0+random(22,-22),0)
		TNT1 AA 0 A_SpawnItemEx("BFG9000TrailBsimple",0,0,10,random(-3,3),random(-3,3),random(-3,3),random(1,360))
		BFS1 B 1 Bright A_CustomMissile("BFG9000TrailAsimple",10+random(10,-10),0+random(10,-10),0+random(22,-22),0)
		TNT1 AA 0 A_SpawnItemEx("BFG9000TrailBsimple",0,0,10,random(-3,3),random(-3,3),random(-3,3),random(1,360))
		BFS1 B 1 Bright A_CustomMissile("BFG9000TrailAsimple",10+random(10,-10),0+random(10,-10),0+random(22,-22),0)
		TNT1 AA 0 A_SpawnItemEx("BFG9000TrailBsimple",0,0,10,random(-3,3),random(-3,3),random(-3,3),random(1,360))
		BFS1 B 1 Bright A_CustomMissile("BFG9000TrailAsimple",10+random(10,-10),0+random(10,-10),0+random(22,-22),0)
		TNT1 AA 0 A_SpawnItemEx("BFG9000TrailBsimple",0,0,10,random(-3,3),random(-3,3),random(-3,3),random(1,360))
		BFS1 B 1 Bright A_CustomMissile("BFG9000TrailAsimple",10+random(10,-10),0+random(10,-10),0+random(22,-22),0)
		TNT1 AA 0 A_SpawnItemEx("BFG9000TrailBsimple",0,0,10,random(-3,3),random(-3,3),random(-3,3),random(1,360))
		BFS1 B 1 Bright A_CustomMissile("BFG9000TrailAsimple",10+random(10,-10),0+random(10,-10),0+random(22,-22),0)
		TNT1 AA 0 A_SpawnItemEx("BFG9000TrailBsimple",0,0,10,random(-3,3),random(-3,3),random(-3,3),random(1,360))
		Loop
	Death:
		TNT1 AAAAAAAAAAAAAAAAAAAAAAAAA 0 A_SpawnItemEx("BFG10Extra2",0,0,10,frandom(-5,5),frandom(-5,5),frandom(-5,5),random(1,360))
		TNT1 AAAAAAAAAAAAAAAAAAAAAAAAA 0 A_SpawnItemEx("BFG10Extra2",0,0,10,frandom(-5,5),frandom(-5,5),frandom(-5,5),random(1,360))
		TNT1 AAAAAAAAAAAAAAAAAAAAAAAAA 0 A_SpawnItemEx("BFG10Extra2",0,0,10,frandom(-5,5),frandom(-5,5),frandom(-5,5),random(1,360))
		BFE1 B 4 A_Explode(random(100,400),128,0)
		BFE1 C 4 Bright
		BFE1 D 4 Bright A_BFGSpray
		BFE1 EF 4 Bright
		Stop
	}
}

//-----------------------------------------------------------
// The small energy trail particles of the projectile in air
Actor BFG9000TrailAsimple
{ 
	+NOINTERACTION
	RenderStyle Add
	Alpha 0.34
	Scale 0.4
	States
	{
	Spawn:
		BFS1 AAAAAAAAAAAAAA 1 Bright A_FadeOut(0.015)
		Wait
	}
}

Actor BFG9000TrailBsimple
{ 
	+NOINTERACTION
	RenderStyle Add
	Alpha 0.34
	Scale 0.2
	States
	{
	Spawn:
		BFS1 AAAAAAAA 1 Bright A_FadeOut(0.02)
		Wait
	}
}

Actor BioForceGunDrop : AEoDWeaponDrop
{
	Inventory.MaxAmount 1
	States
	{
	Use:
		TNT1 A 0
		TNT1 A 0 A_StopSound(6)
		TNT1 A 0 A_SpawnItemEx("DroppedBioForceGun",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		Stop
	}
}

Actor DroppedBioForceGun
{
	Radius 16
	Height 20
	Scale 1.1
	States
	{
	Spawn:
		Q2BR A 15
		TNT1 A 0 A_SpawnItemEx("AEoDBioForceGunNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
}

Actor AEoDBioForceGunNoAmmo : AEoDBioForceGunItem
{
	+FLOORCLIP
	+IGNORESKILL	+DONTGIB
	Scale 1.1
	Inventory.Amount 1
	Inventory.PickupMessage "You Got the Bio Force Gun!"
	Inventory.PickupSound "reilsss/weappickup/bfgs"
	States
	{
	Spawn:
		Q2BR A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",0) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("AECEll",80,"Ammo")
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("BioForceGunDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDBioForceGun",1)
		TNT1 A 0 A_TakeInventory("AECEll",40)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDBioForceGun",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,0,145,0)
		Fail
	Ammo:
		TNT1 A 0 A_TakeInventory("AECEll",80)
		TNT1 A 0 A_JumpIfInventory("AEoDBioForceGun",1,2)
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("BioForceGunDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDBioForceGun",1)
		Stop
	}
}

//========================================================================
//			The Staff of the Darkness Flame
//			-------------------------------
// An ancient and forgotten legend speaks of an unspeakable evil. All
// those who have tried to harness this power have either been utterly
// incinerated in the attempt, or have been driven insane as the darkness
// consumed them.
//
// All but one...
//
// This one being, this demon, was not only able to master this power, but
// to consume it as well. Over the centuries, he has become so embued with
// this power, the power that no one dares mention, lest they themselves
// become tainted by its evil, that he literally became one with the
// darkness.
//
// However, even he was not immune to its corruption, and one day without
// warning, the Hellish dragon he had relied upon for so long, betrayed
// him. The dragon slaughtered him and then roamed unchecked, turning the
// world into a desolate, burned-out ruin, and then finally disappeared.
//
// Eons pass, the remnant rebuilds, and the legend fades from memory.
// However, there are rumors of a powerful wizard who has found a way to
// harness the power that was never meant for the living, and channel it
// into a weapon made fashioned from the bones of that demon long thought
// to be lost. If he is not stopped, the world could once again be plunged
// into darkness.
//
// Then again, the allure of such unbridled power may be difficult to pass
// up should it fall into your possession...
//========================================================================


Actor AEoDDarkFlameStaffItem : AEoDWeaponPickup 6087
{
	+FLOORCLIP
	+IGNORESKILL	+DONTGIB
	+FLOATBOB
	Inventory.Amount 1
	Inventory.PickupMessage "You now possess the Staff of the Darkness Flame!"
	Inventory.PickupSound "weapons/darknessflame/pickup" 
	States
	{
	Spawn:
		DKST A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDDarkFlameStaff",1,"Ammo")
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",0) <= 0,"Nothing")
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("DarkFlameStaffDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDDarkFlameStaff",1)
		TNT1 A 0 A_PrintBold("\cgSlot 10: Dark Flame Staff")
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDDarkFlameStaff",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,0,155,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDDarkFlameStaff",1)
		Stop
	}
}

Actor AEoDDarkFlameStaff : AEoDWeaponBase // 6087
{ 
	+FLOORCLIP
	+IGNORESKILL	+DONTGIB
	+WEAPON.CHEATNOTWEAPON
	+FLOATBOB
	Weapon.AmmoType1 "DarkMana"
	Weapon.AmmoType2 "DarkMana"
	Weapon.AmmoGive1 8
	Weapon.AmmoUse1 8
	Weapon.AmmoUse2 20
	Weapon.SelectionOrder 19700
	Inventory.PickupMessage "You now possess the Staff of the Darkness Flame!"
	Inventory.PickupSound "weapons/darknessflame/pickup" 
	Weapon.upsound "weapons/draw"
	Tag "Dark flame staff"
	States 
	{ 
	Spawn: 
		DKST A -1 
		Loop 
	Ready: 
		DKFL AAAAABBBBBCCCCCDDDDDEEEEEFFFFF 1 A_WeaponReady 
		Goto Ready+1
	Deselect: 
		DKFL A 0 A_StopSound(6)
		DKFL A 0 	
		DKFL A 1 A_Lower 
		DKFL AA 0 A_Lower
		Goto Deselect+1
	Select: 
		DKFL A 0 	
		DKFL A 1 A_Raise
		DKFL AA 0 A_Raise 
		Loop 
	Fire:  
		DKFL D 0 A_PlaySound("DarkFlameStaff/Charge1", 7, 1.0, 0)
		DKFL DEF 5
		DKFL GHIJ 2
		DKFL J 0 A_PlaySound("reilsss/weapons/darkflamestafffire", CHAN_WEAPON, 1.0, 0)
		DKFL J 2
		DKFL J 0 A_GunFlash
		DKFL J 0 A_Recoil(2)
		DKFL J 0 A_SetBlend("10 10 10", 0.75, 15)
		DKFL K 4 Bright A_FireCustomMissile("KESPlayer", 0, 1, 0, 0)
		DKFL EF 3
		Goto Ready 
	AltFire:
		DKFL A 0 A_PlaySound("DarkFlameStaff/Charge2", 7, 1.0, 0)
		DKFL ABCDEF 5
		DKFL L 4
		DKFL L 0 A_Recoil(16)
		DKFL L 0 A_SetBlend("Black", 1, 10)
		DKFL L 0 A_PlaySound("DarkFlameStaff/Fire2", CHAN_WEAPON, 1.0, 0)
		DKFL M 4 A_FireCustomMissile("DarkDragonHead", 0, 1, 0, 0)
		DKFL NOPQ 4
		DKFL ABCDEFABCDEF 4
		Goto Ready 
	}
}

Actor KES
{
	PROJECTILE
	+EXTREMEDEATH
	+NODAMAGETHRUST +CANNOTPUSH
	+FORCERADIUSDMG
	+DONTSPLASH
	+RIPPER
	RipperLevel 2
	+NOTIMEFREEZE
	+NODAMAGE
	Mass 500
	Radius 10
	Height 10
	Speed 20
	Damage 20
	DamageType "Unholy"
	DeathType "Disintegrate"
	DeathSound "DarkFire/Explode"
	Scale 0.6
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_PlaySound("DarkFireSmall/Active",5,0.7,1)
	Movement:
		DKFX AA 1 Bright A_Explode(200,64,0)
		TNT1 AA 0 A_SpawnItemEx("KESBoltTrail",0,random(7,-7),random(5,-5),random(1,2),random(1,2),random(-2,2),random(1,360),SXF_NOCHECKPOSITION)
		DKFX BB 1 Bright A_Explode(200,64,0)
		TNT1 AA 0 A_SpawnItemEx("KESBoltTrail",0,random(7,-7),random(5,-5),random(1,2),random(1,2),random(-2,2),random(1,360),SXF_NOCHECKPOSITION)
		DKFX CC 1 Bright A_Explode(200,64,0)
		TNT1 AA 0 A_SpawnItemEx("KESBoltTrail",0,random(7,-7),random(5,-5),random(1,2),random(1,2),random(-2,2),random(1,360),SXF_NOCHECKPOSITION)
		TNT1 AA 0 A_PlaySound("DarkFire/Active")
		DKFX DD 1 Bright A_Explode(200,64,0)
		TNT1 AA 0 A_SpawnItemEx("KESBoltTrail",0,random(7,-7),random(5,-5),random(1,2),random(1,2),random(-2,2),random(1,360),SXF_NOCHECKPOSITION)
		DKFX EE 1 Bright A_Explode(200,64,0)
		TNT1 AA 0 A_SpawnItemEx("KESBoltTrail",0,random(7,-7),random(5,-5),random(1,2),random(1,2),random(-2,2),random(1,360),SXF_NOCHECKPOSITION)
		DKFX FF 1 Bright A_Explode(200,64,0)
		TNT1 AA 0 A_SpawnItemEx("KESBoltTrail",0,random(7,-7),random(5,-5),random(1,2),random(1,2),random(-2,2),random(1,360),SXF_NOCHECKPOSITION)
		Loop
	Death:
		TNT1 AAAAAAAAAAAAAAAAAA 0 A_SpawnItemEx("KESExplosionSprites",0,0,0,random(3,-3)/(2*1.05),random(3,-3)/(2*1.05),random(3,-3)/(2*1.05),0,SXF_NOCHECKPOSITION)
		TNT1 A 1 A_Explode(350,192,0)
		TNT1 A 0 A_CustomMissile("KESExplosion",0,0,0,4)
		Stop
	}	
}

Actor KESPlayer : KES
{
	+THRUACTORS
	+NODAMAGE //Prevent A_KillChildren from destroying this.
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SpawnItemEx("NewKESFX1",0,0,0,velx,vely,velz,0,SXF_NOCHECKPOSITION|SXF_ABSOLUTEMOMENTUM)
		TNT1 A 0 A_SpawnItemEx("NewKESFX2",0,0,frandom(2.0,4.0),velx,vely,velz,0,SXF_NOCHECKPOSITION|SXF_ABSOLUTEMOMENTUM)
		TNT1 A 0 A_SpawnItemEx("NewKESFX3",0,0,frandom(3.0,6.0),velx,vely,velz,0,SXF_NOCHECKPOSITION|SXF_ABSOLUTEMOMENTUM)
		TNT1 AAAA 0 A_SpawnItemEx("KESBleeder",0,0,0,velx,vely,velz,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS|SXF_ABSOLUTEMOMENTUM)
	Movement:
		
		DKFX AA 1 Bright A_Explode(300,64,0,0,32)
		TNT1 AA 0 A_SpawnItemEx("KESBoltTrail",0,random(7,-7),random(5,-5),random(1,2),random(1,2),random(-2,2),random(1,360),SXF_NOCHECKPOSITION)
		DKFX BB 1 Bright A_Explode(300,64,0,0,32)
		TNT1 AA 0 A_SpawnItemEx("KESBoltTrail",0,random(7,-7),random(5,-5),random(1,2),random(1,2),random(-2,2),random(1,360),SXF_NOCHECKPOSITION)
		DKFX CC 1 Bright A_Explode(300,64,0,0,32)
		TNT1 AA 0 A_SpawnItemEx("KESBoltTrail",0,random(7,-7),random(5,-5),random(1,2),random(1,2),random(-2,2),random(1,360),SXF_NOCHECKPOSITION)
		DKFX DD 1 Bright A_Explode(300,64,0,0,32)
		TNT1 AA 0 A_SpawnItemEx("KESBoltTrail",0,random(7,-7),random(5,-5),random(1,2),random(1,2),random(-2,2),random(1,360),SXF_NOCHECKPOSITION)
		DKFX EE 1 Bright A_Explode(300,64,0,0,32)
		TNT1 AA 0 A_SpawnItemEx("KESBoltTrail",0,random(7,-7),random(5,-5),random(1,2),random(1,2),random(-2,2),random(1,360),SXF_NOCHECKPOSITION)
		DKFX FF 1 Bright A_Explode(300,64,0,0,32)
		TNT1 AA 0 A_SpawnItemEx("KESBoltTrail",0,random(7,-7),random(5,-5),random(1,2),random(1,2),random(-2,2),random(1,360),SXF_NOCHECKPOSITION)
		Loop
	Death:
		TNT1 A 0 A_Explode(650,192,0,0,128)
		TNT1 A 1 A_SpawnItemEx("KESExplosionFX",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER)
		Stop
	}
}

Actor KESBleeder
{
	Projectile
	+RIPPER	RipperLevel 1000000 //It does nothing but pass through enemies, so no big deal.
	+DONTREFLECT
	+PAINLESS
	+NODAMAGETHRUST +CANNOTPUSH
	+NODAMAGE
	Radius 30
	Height 10
	Speed 20
	Damage 0
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 12
		Loop
	Death:
		TNT1 A 0
		Stop
	}
}

Actor KESBoltTrail
{
	Translation "112:127=80:111"
	+NOINTERACTION
	+NOTIMEFREEZE
	Scale 0.3
	RenderStyle Add
	States
	{
	Spawn:
		EBLT ABCDEF 3 Bright
		Stop
	}
}

Actor KESExplosion
{
	Projectile
	+NOCLIP
	+NOGRAVITY
	+FORCERADIUSDMG
	+NODAMAGETHRUST +CANNOTPUSH
	+NOTIMEFREEZE
	+NODAMAGE
	Height 6
	Mass 1
	Radius 8
	Speed 0
	RenderStyle Add
	DamageType "UnholyDisint"
	Scale 1.2
	States
	{
	Spawn:
		XPLO A 0 A_Explode(200,192,0)
		XPLO ABCDEFGHIJKL 3 Bright
		Stop
	}
}

Actor KESExplosionSprites
{
	+NOINTERACTION
	+NOTIMEFREEZE
	RenderStyle Add
	Alpha 0.8
	Scale 0.7
	States
	{
	Spawn:
		TNT1 A 0
		XPLO ABC 3 Bright A_FadeOut(0.04)
		TNT1 A 0 A_ScaleVelocity(0.9)
		XPLO DEF 3 Bright A_FadeOut(0.04)
		TNT1 A 0 A_ScaleVelocity(0.8)
		XPLO GHI 3 Bright A_FadeOut(0.04)
		TNT1 A 0 A_ScaleVelocity(0.7)
		XPLO JK 3 Bright A_FadeOut(0.04)
		Stop
	}
}
Actor KESExplosionSpritesSmall : KESExplosionSprites
{
	+NOINTERACTION
	RenderStyle Add
	Alpha 0.8
	Scale 0.4
}

Actor KESSmall
{
	PROJECTILE
	+EXTREMEDEATH
	+NODAMAGETHRUST +CANNOTPUSH
	+DONTSPLASH
	+RIPPER	RipperLevel 1
	+NOTIMEFREEZE
	+STEPMISSILE
	+NODAMAGE
	MaxStepHeight 32
	Mass 500
	Radius 10
	Height 10
	Speed 15
	Damage 5
	DamageType "UnholyDisint"
	DeathSound "SorcererBigBallExplode"
	Scale 0.25
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_PlaySound("DarkFireSmall/Active",5,0.6,0)
		DKFX AABBCC 1 Bright A_Explode(120,40,0)
		TNT1 A 0 A_PlaySound("DarkFireSmall/Active",5,0.6,0)
		DKFX DDEEFF 1 Bright A_Explode(120,40,0)
		Loop
	Death:
		TNT1 AAAAAAAAA 0 A_SpawnItemEx("KESExplosionSpritesSmall",0,0,0,random(3,-3)/(2*1.95),random(3,-3)/(2*1.95),random(3,-3)/(2*1.95),0,SXF_NOCHECKPOSITION)
		TNT1 A 1 A_Explode(128,96,0)
		TNT1 A 0 A_SpawnItemEx("KESSmallExplosion",0,0,0,0,0,0,0,0,0)
		Stop
	}
}

Actor KESSmallExplosion
{
	Projectile
	+NOINTERACTION
	+FORCERADIUSDMG
	+NODAMAGETHRUST +CANNOTPUSH
	+NOTIMEFREEZE
	Mass 1
	Radius 8
	Speed 0
	Height 6
	RenderStyle Add
	DamageType "UnholyDisint"
	Scale 0.6
	States
	{
	Spawn:
		XPLO A 0 A_Explode(128,96,0)
		XPLO ABCDEFGHIJKL 3 Bright A_FadeOut(0.03)
		Stop
	}
}

Actor DarkDragonHead
{
	var int user_count;
	var int user_angle;
	PROJECTILE
	+EXTREMEDEATH
	+BLOODLESSIMPACT
	+NODAMAGETHRUST +CANNOTPUSH
	+RIPPER	RipperLevel 2
	+SEEKERMISSILE
	+FLOATBOB
	+FOILINVUL
	+DONTSPLASH
	+FORCERADIUSDMG
	+NOTIMEFREEZE
	+NODAMAGE
	Radius 10
	Height 10
	Speed 13
	Damage 20
	Scale 0.5
	DamageType "UnholyDisint"
	States
	{
	Spawn:
		DKDH A 1 A_SeekerMissile(5,5)
		TNT1 A 0 A_Explode(120,100,0)
		TNT1 A 0 A_CStaffMissileSlither
		TNT1 A 0 A_SpawnItemEx("DarkDragonTail",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER)
		DKDH A 1 A_SeekerMissile(5,5)
		TNT1 A 0 A_Explode(120,100,0)
		TNT1 A 0 A_SpawnItemEx("DarkDragonTail",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER)
		Loop
	Death:
		TNT1 A 0 A_ChangeFlag("FLOATBOB",0)
		TNT1 A 0 A_Stop
		TNT1 A 0 A_QuakeEx(5,5,0, 70,0,40,"", QF_SCALEDOWN)
		TNT1 A 0 A_Explode(2048,300,0)
		TNT1 A 0 A_PlaySound("DarkDragon/Explode",6,1.0,0,ATTN_NONE)
		TNT1 A 0 A_SpawnItemEx("DarkDragonExplosion",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
	Spray1:
		TNT1 A 0 A_SpawnItemEx("KESSmall",0,0,0,15,0,0,user_angle+random(-15,15),SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		TNT1 A 0 A_SetUserVar("user_angle",user_angle+12)
		TNT1 A 0 A_JumpIf(user_angle>=360,1)
		Loop
		TNT1 A 16 A_SetUserVar("user_angle",0)
	Spray2:
		TNT1 A 0 A_SpawnItemEx("KESSmall",0,0,0,15,0,0,user_angle+random(-15,15),SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		TNT1 A 0 A_SetUserVar("user_angle",user_angle+12)
		TNT1 A 0 A_JumpIf(user_angle>=360,1)
		Loop
		TNT1 A 10
		Stop
	}
}

Actor DarkDragonTail
{
	var int user_size;
	PROJECTILE
	+NODAMAGETHRUST +CANNOTPUSH
	+FOILINVUL
	+RIPPER	RipperLevel 2
	+EXTREMEDEATH
	+BLOODLESSIMPACT
	+DONTSPLASH
	+NOTIMEFREEZE
	+NODAMAGE
	Radius 10
	Height 10
	Damage 2
	Speed 0
	DamageType "UnholyDisint"
	DeathType Disintegrate
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SetUserVar("user_size",70)
		TNT1 AA 1 A_Explode(120,100,0)
	SizeLoop:
		DKDT A 1 A_Explode(120,100,0)
		DKDT A 0 A_SetScale(scaleX-0.013)
		DKDT A 0 A_SetUserVar("user_size",user_size-1)
		DKDT A 0 A_JumpIf(user_size<=1,"Death")
		Loop
	Death:
		DKDT I 1
		Stop
	}
}

//==============================================================================
//==============================================================================
//Dark Flame Staff Primary FX
//Created by Major Cooke
//==============================================================================
//==============================================================================

Actor NewKESFX1
{
	var int user_weave[4];
	var int user_delay;
	var int user_posneg;
	Projectile
	WeaveIndexXY 0
	WeaveIndexZ 0
	Radius 4
	Height 4
	+THRUACTORS
	+DONTSPLASH
	RenderStyle None
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_Jump(256,"Positive","Negative")
	Positive:
		TNT1 A 0 A_SetUserVar("user_posneg",1)
		Goto Continue
	Negative:
		TNT1 A 0 A_SetUserVar("user_posneg",-1)
		Goto Continue
	Continue:
		TNT1 A 0 A_SetUserArray("user_weave",0,random(1,4)*user_posneg)
		TNT1 A 0 A_SetUserArray("user_weave",1,random(1,4)*user_posneg)
		TNT1 A 0 A_SetUserArray("user_weave",2,frandom(0.5,2.0)*user_posneg)
		TNT1 A 0 A_SetUserArray("user_weave",3,frandom(0.5,2.0)*user_posneg)
	Weaving:
		TNT1 A 0 A_Jump(256,"F5")
	F1:
		TNT1 AAAAA 2 A_SpawnItemEx("KESWhiteCloud",velx+random(-5,5),0,velz+random(-2,2),0,0,0,0,SXF_NOCHECKPOSITION|SXF_ABSOLUTEMOMENTUM)
		TNT1 A 0 A_Weave(user_weave[0],user_weave[1],user_weave[2],user_weave[3])
		Loop
	F2:
		TNT1 AAAA 2 A_SpawnItemEx("KESWhiteCloud",velx+random(-5,5),0,velz+random(-2,2),0,0,0,0,SXF_NOCHECKPOSITION|SXF_ABSOLUTEMOMENTUM)
		TNT1 A 0 A_Weave(user_weave[0],user_weave[1],user_weave[2],user_weave[3])
		Loop
	F3:
		TNT1 AAA 2 A_SpawnItemEx("KESWhiteCloud",velx+random(-5,5),0,velz+random(-2,2),0,0,0,0,SXF_NOCHECKPOSITION|SXF_ABSOLUTEMOMENTUM)
		TNT1 A 0 A_Weave(user_weave[0],user_weave[1],user_weave[2],user_weave[3])
		Loop
	F4:
		TNT1 AA 2 A_SpawnItemEx("KESWhiteCloud",velx+random(-5,5),0,velz+random(-2,2),0,0,0,0,SXF_NOCHECKPOSITION|SXF_ABSOLUTEMOMENTUM)
		TNT1 A 0 A_Weave(user_weave[0],user_weave[1],user_weave[2],user_weave[3])
		Loop
	F5:
		TNT1 A 2 A_SpawnItemEx("KESWhiteCloud",velx+random(-5,5),0,velz+random(-2,2),0,0,0,0,SXF_NOCHECKPOSITION|SXF_ABSOLUTEMOMENTUM)
		TNT1 A 0 A_Weave(user_weave[0],user_weave[1],user_weave[2],user_weave[3])
		Loop
	Death:
		TNT1 A 1
		Stop
	}
}

Actor NewKESFX2
{
	var int user_weave[4];
	var int user_delay;
	var int user_posneg;
	Projectile
	WeaveIndexXY 8
	WeaveIndexZ 55
	Radius 4
	Height 4
	+THRUACTORS
	+DONTSPLASH
	RenderStyle None
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_Jump(256,"Positive","Negative")
	Positive:
		TNT1 A 0 A_SetUserVar("user_posneg",1)
		Goto Continue
	Negative:
		TNT1 A 0 A_SetUserVar("user_posneg",-1)
		Goto Continue
	Continue:
		TNT1 A 0 A_SetUserArray("user_weave",0,random(2,5)*user_posneg)
		TNT1 A 0 A_SetUserArray("user_weave",1,random(2,5)*user_posneg)
		TNT1 A 0 A_SetUserArray("user_weave",2,frandom(1.0,2.0)*user_posneg)
		TNT1 A 0 A_SetUserArray("user_weave",3,frandom(1.0,2.0)*user_posneg)
	Weaving:
		TNT1 A 0 A_Jump(256,"F4","F5")
	F1:
		TNT1 AAAAA 2 A_SpawnItemEx("KESGreyCloud",velx+random(-5,5),0,velz+random(-2,2),0,0,0,0,SXF_NOCHECKPOSITION|SXF_ABSOLUTEMOMENTUM)
		TNT1 A 0 A_Weave(user_weave[0],user_weave[1],user_weave[2],user_weave[3])
		Loop
	F2:
		TNT1 AAAA 2 A_SpawnItemEx("KESGreyCloud",velx+random(-5,5),0,velz+random(-2,2),0,0,0,0,SXF_NOCHECKPOSITION|SXF_ABSOLUTEMOMENTUM)
		TNT1 A 0 A_Weave(user_weave[0],user_weave[1],user_weave[2],user_weave[3])
		Loop
	F3:
		TNT1 AAA 2 A_SpawnItemEx("KESGreyCloud",velx+random(-5,5),0,velz+random(-2,2),0,0,0,0,SXF_NOCHECKPOSITION|SXF_ABSOLUTEMOMENTUM)
		TNT1 A 0 A_Weave(user_weave[0],user_weave[1],user_weave[2],user_weave[3])
		Loop
	F4:
		TNT1 AA 2 A_SpawnItemEx("KESGreyCloud",velx+random(-5,5),0,velz+random(-2,2),0,0,0,0,SXF_NOCHECKPOSITION|SXF_ABSOLUTEMOMENTUM)
		TNT1 A 0 A_Weave(user_weave[0],user_weave[1],user_weave[2],user_weave[3])
		Loop
	F5:
		TNT1 A 2 A_SpawnItemEx("KESGreyCloud",velx+random(-5,5),0,velz+random(-2,2),0,0,0,0,SXF_NOCHECKPOSITION|SXF_ABSOLUTEMOMENTUM)
		TNT1 A 0 A_Weave(user_weave[0],user_weave[1],user_weave[2],user_weave[3])
		Loop
	Death:
		TNT1 A 1
		Stop
	}
}

Actor NewKESFX3
{
	var int user_weave[4];
	var int user_delay;
	var int user_posneg;
	Projectile
	WeaveIndexXY 8
	WeaveIndexZ 8
	Radius 4
	Height 4
	+THRUACTORS
	+DONTSPLASH
	RenderStyle None
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_Jump(256,"Positive","Negative")
	Positive:
		TNT1 A 0 A_SetUserVar("user_posneg",1)
		Goto Continue
	Negative:
		TNT1 A 0 A_SetUserVar("user_posneg",-1)
		Goto Continue
	Continue:
		TNT1 A 0 A_SetUserArray("user_weave",0,random(3,6)*user_posneg)
		TNT1 A 0 A_SetUserArray("user_weave",1,random(3,6)*user_posneg)
		TNT1 A 0 A_SetUserArray("user_weave",2,frandom(1.5,3.0)*user_posneg)
		TNT1 A 0 A_SetUserArray("user_weave",3,frandom(1.5,3.0)*user_posneg)
	Weaving:
		TNT1 A 0 A_Jump(256,"F4","F5")
	F1:
		TNT1 AAAAA 2 A_SpawnItemEx("KESBlackCloud",velx+random(-5,5),0,velz+random(-2,2),0,0,0,0,SXF_NOCHECKPOSITION|SXF_ABSOLUTEMOMENTUM)
		TNT1 A 0 A_Weave(user_weave[0],user_weave[1],user_weave[2],user_weave[3])
		Loop
	F2:
		TNT1 AAAA 2 A_SpawnItemEx("KESBlackCloud",velx+random(-5,5),0,velz+random(-2,2),0,0,0,0,SXF_NOCHECKPOSITION|SXF_ABSOLUTEMOMENTUM)
		TNT1 A 0 A_Weave(user_weave[0],user_weave[1],user_weave[2],user_weave[3])
		Loop
	F3:
		TNT1 AAA 2 A_SpawnItemEx("KESBlackCloud",velx+random(-5,5),0,velz+random(-2,2),0,0,0,0,SXF_NOCHECKPOSITION|SXF_ABSOLUTEMOMENTUM)
		TNT1 A 0 A_Weave(user_weave[0],user_weave[1],user_weave[2],user_weave[3])
		Loop
	F4:
		TNT1 AA 2 A_SpawnItemEx("KESBlackCloud",velx+random(-5,5),0,velz+random(-2,2),0,0,0,0,SXF_NOCHECKPOSITION|SXF_ABSOLUTEMOMENTUM)
		TNT1 A 0 A_Weave(user_weave[0],user_weave[1],user_weave[2],user_weave[3])
		Loop
	F5:
		TNT1 A 2 A_SpawnItemEx("KESBlackCloud",velx+random(-5,5),0,velz+random(-2,2),0,0,0,0,SXF_NOCHECKPOSITION|SXF_ABSOLUTEMOMENTUM)
		TNT1 A 0 A_Weave(user_weave[0],user_weave[1],user_weave[2],user_weave[3])
		Loop
	Death:
		TNT1 A 1
		Stop
	}
}

Actor KESWhiteCloud
{
	+NOINTERACTION
	RenderStyle Translucent
	Translation "0:255=%[0,0,0]:[2.0,2.0,2.0]"
	Scale 0.15
	Alpha 0.75
	States
	{
	Spawn:
		TNT1 A 0 
		//TNT1 A 0 A_Jump(230,4,5,6,7,8,9,10,11,12,13)
		//X105 ABCDEFGHIJKLMNOPQRSTUVWX 2 Bright A_FadeOut(0.03)
		//TNT1 A 0 A_ScaleVelocity(0.5)
		//Goto Spawn+2
		X116 ABCDEFGHIJKLMNOPQRSTUVWXYZ 2 Bright A_FadeOut(0.03)
		Wait
	}
}

Actor KESGreyCloud : KESWhiteCloud
{
	Translation "0:255=%[0,0,0]:[0.5,0.5,0.5]"
}

Actor KESBlackCloud : KESWhiteCloud
{
	Translation "0:255=%[0,0,0]:[0.15,0.15,0.15]"
}

Actor KESExplosionFX
{
	+NOINTERACTION
	RenderStyle Translucent
	Translation "0:255=%[0,0,0]:[0.15,0.15,0.15]"
	Scale 0.7
	States
	{
	Spawn:
		X121 A 0
		X121 A 0 A_SpawnItemEx("KESExplosionSmallBack",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		X121 A 0 A_SpawnItemEx("KESExplosionMirage",0,0,0,3,0,0,0,SXF_NOCHECKPOSITION)
		X121 A 0 A_SpawnItemEx("KESExplosionMirage",0,0,0,0,0,3,0,SXF_NOCHECKPOSITION)
		X121 A 0 A_SpawnItemEx("KESExplosionMirage",0,0,0,0,0,-3,0,SXF_NOCHECKPOSITION)
		X121 A 0 A_SpawnItemEx("KESExplosionMirage",0,0,0,3,0,0,90,SXF_NOCHECKPOSITION)
		X121 A 0 A_SpawnItemEx("KESExplosionMirage",0,0,0,3,0,0,180,SXF_NOCHECKPOSITION)
		X121 A 0 A_SpawnItemEx("KESExplosionMirage",0,0,0,3,0,0,270,SXF_NOCHECKPOSITION)
		X121 AAAAAAAAAAAAAA 0 A_SpawnItemEx("KESExploCloud1",frandom(0,60),0,frandom(-30,30),frandom(-6,6),0,frandom(-6,6),random(0,359),SXF_NOCHECKPOSITION)
		X121 AAAAAAAAAAAAAAAAAAAAAAAAAA 0 A_SpawnItemEx("KESExploCloud1",frandom(0,60),0,frandom(-30,30),frandom(-6,6),0,frandom(-6,6),random(0,359),SXF_NOCHECKPOSITION,162)
		X121 A 0 A_SpawnItemEx("KESExploSnakeTrailSmall",0,0,0,frandom(4,12),0,random(-8,8),random(0,359),SXF_NOCHECKPOSITION)
		X121 AAAAA 0 A_SpawnItemEx("KESExploSnakeTrailSmall",0,0,0,frandom(4,12),0,random(-8,8),random(0,359),SXF_NOCHECKPOSITION,210)
		X121 ABCDEFGHIJKLMNOPQRSTUV 1 Bright A_SetScale(ScaleX+(0.001))
		Stop
	}
}

Actor KESExplosionMirage
{
	+NOINTERACTION
	RenderStyle Add
	Scale 0.7
	States
	{
	Spawn:
		X121 A 0
		X121 ABCDEFGHIJKLMNOPQRSTUV 1 Bright A_FadeOut(0.03)
		Wait
	}
}

Actor KESExplosionSmallBack
{
	var int user_count;
	var int user_sub;
	+NOINTERACTION
	RenderStyle Add
	Scale 0.6
	Alpha 0.75
	States
	{
	Spawn:
		X122 A 0
		X122 A 1 A_SetScale(ScaleX+(0.16))
		X122 B 1 A_SetScale(ScaleX+(0.15))
		X122 C 1 A_SetScale(ScaleX+(0.14))
		X122 D 1 A_SetScale(ScaleX+(0.13))
		X122 E 1 A_SetScale(ScaleX+(0.12))
		X122 F 1 A_SetScale(ScaleX+(0.11))
		X122 G 1 A_SetScale(ScaleX+(0.10))
		X122 H 1 A_SetScale(ScaleX+(0.09))
		X122 I 1 A_SetScale(ScaleX+(0.08))
		X122 J 1 A_SetScale(ScaleX+(0.07))
		X122 K 1 A_SetScale(ScaleX+(0.06))
		X122 L 1 A_SetScale(ScaleX+(0.05))
		X122 M 1 A_SetScale(ScaleX+(0.04))
		X122 N 1 A_SetScale(ScaleX+(0.03))
		X122 O 1 A_SetScale(ScaleX+(0.02))
		X122 P 1 A_SetScale(ScaleX+(0.02))
	Fading:
		X122 A 0 A_SetScale(ScaleX+(0.02))	X122 A 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.02))	X122 B 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.02))	X122 C 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.02))	X122 D 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.02))	X122 E 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.02))	X122 F 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.02))	X122 G 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.02))	X122 H 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.02))	X122 I 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.02))	X122 J 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.02))	X122 K 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.02))	X122 L 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.02))	X122 M 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.02))	X122 N 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.02))	X122 O 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.02))	X122 P 1 Bright A_FadeOut(0.02)
		Loop
	}
}

Actor KESExploCloud1
{
	+NOINTERACTION
	RenderStyle Translucent
	Alpha 0.0
	Scale 1.2
	Translation "0:255=%[0,0,0]:[0.15,0.15,0.15]"
	States
	{
	Spawn:
		TNT1 A 0
		X110 BHS 0 A_JumpIf(random(1,12) == 1,"Playoff")
		X108 TKEO 0 A_JumpIf(random(1,9) == 1, "Playoff")
		X105 WRC 0 A_JumpIf(random(1,5) == 1, "Playoff")
		X104 JB 0 A_JumpIf(random(1,2) == 1, "Playoff")
		Goto Playoff
	Playoff:
		"####" "#" 1 A_FadeTo(0.60,0.02,0)
		"####" "#" 0 A_ScaleVelocity(0.95)
		"####" "#" 0 A_JumpIf(alpha>=0.30,"C1")
		Loop
	C1:
		"####" "######" 1 A_ScaleVelocity(0.98)
		"####" "#" 1 A_FadeOut(0.04)
		Wait
	}
}

Actor KESExploCloud2 : KESExploCloud1 { Scale 0.2 }

Actor KESExploSnakeTrailSmall
{
	var int user_count;
	var int user_weave[5];
	WeaveIndexZ 12
	Projectile
	+THRUACTORS
	+DONTSPLASH
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_Jump(256,"S1","S2")
	S1:
		TNT1 A 0 A_SetUserArray("user_weave",4,1)
		Goto Continue
	S2:
		TNT1 A 0 A_SetUserArray("user_weave",4,-1)
		Goto Continue
	Continue:
		TNT1 A 0 A_SetUserArray("user_weave",0,random(1,2)*user_weave[4])
		TNT1 A 0 A_SetUserArray("user_weave",1,random(1,2)*user_weave[4])
		TNT1 A 0 A_SetUserArray("user_weave",2,frandom(1,3)*user_weave[4])
		TNT1 A 0 A_SetUserArray("user_weave",3,frandom(1,3)*user_weave[4])
		TNT1 A 0 A_SetUserVar("user_count",random(90,210))
	Movement:
		TNT1 A 0 A_SpawnItemEx("KESExploCloud2",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 1 A_Weave(user_weave[0],user_weave[1],user_weave[2],user_weave[3])
		TNT1 A 0 A_SetUserVar("user_count",user_count-1)
		TNT1 A 0 A_JumpIf(user_count<=0,"Death")
		Loop
	Death:
		TNT1 A 0
		Stop
	}
}

//==============================================================================
//==============================================================================
//Dark Flame Staff Alt FX
//Created by Major Cooke
//==============================================================================
//==============================================================================

Actor DarkDragonExplosion
{
	+NOINTERACTION
	RenderStyle Add
	Alpha 0.99
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_CheckCeiling("MoveDown")
		TNT1 A 0 A_CheckFloor("MoveUp")
		Goto Resume
	MoveDown:
		TNT1 A 0 A_Warp(AAPTR_DEFAULT,0,0,-15,0,WARPF_NOCHECKPOSITION)
		Goto Resume
	MoveUp:
		TNT1 A 0 A_Warp(AAPTR_DEFAULT,0,0,5,0,WARPF_NOCHECKPOSITION)
		Goto Resume
	Resume:
		X119 A 0 A_SpawnItemEx("DDHExplosionSmallShockwave",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		X119 A 0 A_SpawnItemEx("KESExplosionSmallBack",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		//X119 A 0 A_SpawnItemEx("DDHLightningGenerator",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		X119 AAAAAAAAAAAAAAAAAAAAAAAAA 0 A_SpawnItemEx("KESExploCloud1",frandom(30,120),0,frandom(-30,30),frandom(-6,6),0,frandom(-6,6),random(0,359),SXF_NOCHECKPOSITION)
		X119 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 0 A_SpawnItemEx("KESExploCloud1",frandom(30,120),0,frandom(-30,30),frandom(-6,6),0,frandom(-6,6),random(0,359),SXF_NOCHECKPOSITION,192)
		X119 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 0 A_SpawnItemEx("KESExploCloud1",frandom(30,120),0,frandom(-30,30),frandom(-6,6),0,frandom(-6,6),random(0,359),SXF_NOCHECKPOSITION,210)
		X119 AAA 0 A_SpawnItemEx("KESExploSnakeTrailSmall",0,0,0,frandom(4,12),0,random(-8,8),random(0,359),SXF_NOCHECKPOSITION)
		X119 AAAAAAAAAAA 0 A_SpawnItemEx("KESExploSnakeTrailSmall",0,0,0,frandom(4,12),0,random(-8,8),random(0,359),SXF_NOCHECKPOSITION,210)
		X119 A 0 A_SpawnItemEx("DDHCloudSpewer",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		X119 ABCDEFGHIJKLMNOPQRSTUVWXYZ 1 Bright //A_SpawnItemEx("KESExploCloud1",frandom(30,120),0,frandom(-30,30),frandom(-6,6),0,frandom(-6,6),random(0,359),SXF_NOCHECKPOSITION)
		X120 ABCDEFGHIJKLMNOPQRSTUVW 1 Bright A_FadeOut(0.04)
		Wait
	}
}

Actor DDHCloudSpewer
{
	var int user_count;
	+NOINTERACTION
	RenderStyle None
	States
	{
	Spawn:
		TNT1 A 0
	Spew:
		TNT1 AA 0 A_SpawnItemEx("KESExploCloud1",frandom(30,120),0,frandom(-30,30),frandom(-6,6),0,frandom(-6,6),random(0,359),SXF_NOCHECKPOSITION)
		TNT1 AAAA 0 A_SpawnItemEx("KESExploCloud1",frandom(30,120),0,frandom(-30,30),frandom(-6,6),0,frandom(-6,6),random(0,359),SXF_NOCHECKPOSITION,192)
		TNT1 A 0 A_SetUserVar("user_count",user_count+1)
		TNT1 A 1 A_JumpIf(user_count>=50,1)
		Loop
		TNT1 A 0
		Stop
	}
}

Actor DDHLightningGenerator
{
	var int user_x[3];
	var int user_z[3];
	var int user_angle[3];
	var int user_count[2];
	var int user_z2;
	+NOINTERACTION
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_CheckFloor("Floored")
		TNT1 A 0 A_CheckCeiling("Ceilinged")
		Goto Resume
	Floored:
		TNT1 A 0 A_SetUserVar("user_z2",5)
		Goto Resume
	Ceilinged:
		TNT1 A 0 A_SetUserVar("user_z2",-5)
		Goto Resume
	Resume:
		TNT1 A 0 A_SetUserArray("user_angle",0,random(0,359))
		TNT1 A 0 A_SetUserArray("user_angle",1,random(0,359))
		TNT1 A 0 A_SetUserArray("user_angle",2,random(0,359))
		TNT1 A 0 A_Warp(AAPTR_DEFAULT,0,0,user_z2,0,WARPF_NOCHECKPOSITION|WARPF_STOP)
	Lightning:
		TNT1 A 0 A_SpawnItemEx("DDHLightning",0,0,0,0,0,0,user_angle[0],SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("DDHLightning",0,0,0,0,0,0,user_angle[1],SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("DDHLightning",0,0,0,0,0,0,user_angle[2],SXF_NOCHECKPOSITION)
		TNT1 A 1 A_SetUserArray("user_count",0,user_count[0]+1)
		TNT1 A 0 A_JumpIf(user_count[0]>=10,1)
		Loop
		TNT1 A 0 A_JumpIf(user_count[1]>=2,"End")
		TNT1 A 0 A_SetUserArray("user_count",1,user_count[1]+1)
		TNT1 A 9 A_SetUserArray("user_count",0,0)
		Loop
	End:
		TNT1 A 0
		Stop
	}
}

Actor DDHLightning
{
	var int user_failsafe;
	var int user_count;
	var int user_vel[3];
	Projectile
	+THRUACTORS
	+DONTSPLASH
	Radius 4
	Height 4
	States
	{
	Spawn:
		TNT1 A 0
	Velocity:
		TNT1 A 0 A_SetUserVar("user_count",0)
		TNT1 A 0 A_SetUserArray("user_vel",0,random(1,3))
		TNT1 A 0 A_SetUserArray("user_vel",1,frandom(-3.0,3.0))
		TNT1 A 0 A_SetUserArray("user_vel",2,frandom(-3.0,3.0))
	Warping:
		TNT1 A 0 A_SpawnItemEx("DDHLightningPuff",0,0,0,0,0,0,0,0,32)
		TNT1 A 0 A_Jump(256,2,3,4)
		TNT1 A 0 A_Warp(AAPTR_DEFAULT,user_vel[0],user_vel[1],user_vel[2],0,WARPF_STOP,1)
		Goto Death
		
		TNT1 A 0 A_Warp(AAPTR_DEFAULT,user_vel[0],user_vel[1],user_vel[2],0,WARPF_STOP,1)
		Goto Death
		
		TNT1 A 0 A_Warp(AAPTR_DEFAULT,user_vel[0],user_vel[1],user_vel[2],0,WARPF_STOP,1)
		Goto Death
		
		TNT1 A 0 A_Warp(AAPTR_DEFAULT,user_vel[0],user_vel[1],user_vel[2],0,0,"Warp2")
		Goto Death
	Warp2:
		TNT1 A 0 A_SetUserVar("user_failsafe",user_failsafe+1)
		TNT1 A 0 A_JumpIf(user_failsafe>=4000,"Death")
		TNT1 A 0 A_SetUserVar("user_count",user_count+1)
		TNT1 A 0 A_JumpIf(user_count>=random(25,45),"Velocity")
		Loop
	Death:
		TNT1 A 0
		Stop
	}
}

Actor DDHLightningPuff
{
	+NOINTERACTION
	Alpha 0.25
	RenderStyle "Stencil"
	StencilColor Black
	States
	{
	Spawn:
		TNT1 A 0
		PLSE B 0 A_SetScale(frandom(0.35,0.65))
		PLSE B 0 A_Jump(256,1,2,3)
		PLSE B 2 bright
		Stop
		PLSE C 2 bright
		Stop
		PLSE D 2 bright
		Stop
	}
}
		
Actor DDHExplosionSmallShockwave
{
	var int user_count;
	var int user_sub;
	+NOINTERACTION
	RenderStyle Add
	XScale 0.6
	YScale 0.2
	Alpha 0.95
	States
	{
	Spawn:
		X122 A 0
		X122 ABCD 1 Bright A_SetScale(ScaleX+(0.21),ScaleY+(0.01))
		X122 EFG 1 Bright A_SetScale(ScaleX+(0.17),ScaleY+(0.01))
		X122 HIJK 1 Bright A_SetScale(ScaleX+(0.12),ScaleY+(0.01))
		X122 LMNOP 1 Bright A_SetScale(ScaleX+(0.1),ScaleY+(0.01))
	Fading:
		X122 A 0 A_SetScale(ScaleX+(0.06),ScaleY+(0.01))	X122 A 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.06),ScaleY+(0.01))	X122 B 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.06),ScaleY+(0.01))	X122 C 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.06),ScaleY+(0.01))	X122 D 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.06),ScaleY+(0.01))	X122 E 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.06),ScaleY+(0.01))	X122 F 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.06),ScaleY+(0.01))	X122 G 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.06),ScaleY+(0.01))	X122 H 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.06),ScaleY+(0.01))	X122 I 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.06),ScaleY+(0.01))	X122 J 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.06),ScaleY+(0.01))	X122 K 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.06),ScaleY+(0.01))	X122 L 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.06),ScaleY+(0.01))	X122 M 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.06),ScaleY+(0.01))	X122 N 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.06),ScaleY+(0.01))	X122 O 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.06),ScaleY+(0.01))	X122 P 1 Bright A_FadeOut(0.02)
		Loop
	}
}

Actor DarkFlameStaffDrop : AEoDWeaponDrop
{
	Inventory.MaxAmount 1
	States
	{
	Use:
		TNT1 A 0
		TNT1 A 0 A_StopSound(6)
		TNT1 A 0 A_SpawnItemEx("DroppedDarkFlameStaff",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		Stop
	}
}

Actor DroppedDarkFlameStaff
{
	Radius 16
	Height 20
	States
	{
	Spawn:
		DKST A 15
		TNT1 A 0 A_SpawnItemEx("AEoDDarkFlameStaffNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
}

Actor AEoDDarkFlameStaffNoAmmo : AEoDDarkFlameStaffItem
{
	+FLOORCLIP
	+IGNORESKILL	+DONTGIB
	+FLOATBOB
	Inventory.Amount 1
	Inventory.PickupMessage "You now possess the Staff of the Darkness Flame!"
	Inventory.PickupSound "weapons/darknessflame/pickup" 
	States
	{
	Spawn:
		DKST A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",0) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("DarkMana",8,"Ammo")
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("DarkFlameStaffDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDDarkFlameStaff",1)
		TNT1 A 0 A_TakeInventory("DarkMana",8)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDDarkFlameStaff",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,0,155,0)
		Fail
	Ammo:
		TNT1 A 0 A_TakeInventory("DarkMana",8)
		TNT1 A 0 A_JumpIfInventory("AEoDDarkFlameStaff",1,2)
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("DarkFlameStaffDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDDarkFlameStaff",1)
		Stop
	}
}


//==================================================================================
//==================================================================================

//==================================================================================
//==================================================================================

Actor AEoDNovaItem : AEoDWeaponPickup 6074
{
	+FLOORCLIP
	+FLOATBOB
	+IGNORESKILL	+DONTGIB
	Scale 0.3
	Inventory.Amount 1
	Inventory.PickupMessage "You found the Nova Staff!"
	Inventory.PickupSound "pickuppiece"
	States
	{
	Spawn:
		01RO A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDNova",1,"Ammo")
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",0) <= 0,"Nothing")
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("NovaDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDNova",1)
		TNT1 A 0 A_PrintBold("\cgSlot 10: Nova Staff")
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDNova",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,0,152,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDNova",1)
		Stop
	}
}

Actor AEoDNova : AEoDWeaponBase // 6074
{
	+IGNORESKILL	+DONTGIB
	+WEAPON.CHEATNOTWEAPON
	+FLOATBOB
	Weapon.AmmoType1 "BlueMana"
	Weapon.AmmoType2 "RedMana"
	Weapon.AmmoGive1 50
	Weapon.AmmoGive2 25
	Weapon.AmmoUse1 4
	Weapon.AmmoUse2 30
	Weapon.SelectionOrder 9191
	Inventory.PickupMessage "You found the Nova Staff!"
	Inventory.PickupSound "pickuppiece" 
	Weapon.upsound "weapons/draw"
	Scale 0.3
	Tag "Nova"
	States
	{
	Spawn:
		01RO A 3
		Loop
	Ready: 
		W01I A 3 A_WeaponReady
		Loop
	Deselect: 
		TNT1 A 0 	
		W01I A 1 A_Lower
		TNT1 AA 0 A_Lower
		Loop
	Select:
		TNT1 A 0 	
		W01I A 1 A_Raise
		TNT1 AA 0 A_Raise
		Loop
	Fire:
		W01I BC 3
		W01I GH 1
		TNT1 A 0 A_SetBlend("White",0.1,8) 
		TNT1 A 0 A_SetPitch(pitch-1.5)
		TNT1 A 0 A_PlaySound("weapons/sigilhit", CHAN_WEAPON, 1.0, 0)
		W01I I 1 A_FireBullets(1,1,1,random(40,70),"NovaPuff",1)
		W01I J 1 
		W01I KL 1 A_SetPitch(pitch+0.75)
		TNT1 A 0 A_ReFire
		W01I EF 8
		Goto Ready
	Hold:
		TNT1 A 0 A_SetBlend("White",0.1,8)
		TNT1 A 0 A_SetPitch(pitch-1.5)
		TNT1 A 0 A_PlaySound("weapons/sigilhit", CHAN_WEAPON, 1.0, 0)
		W01I I 1 A_FireBullets(1,1,1,random(40,70),"NovaPuff",1)
		W01I J 1 
		W01I KL 1 A_SetPitch(pitch+0.75)
		TNT1 A 0 A_ReFire
		W01I EF 8
		Goto Ready
	AltFire:
		W01I A 25 A_PlaySound("castspell/electric", CHAN_WEAPON, 1.0, 0)
		W01I B 9 
		W01I C 6
		TNT1 A 0 A_SetBlend("White",1,50)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",0,1,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",5,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",10,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",15,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",20,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",25,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",30,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",35,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",40,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",45,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",50,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",55,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",60,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",65,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",70,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",75,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",80,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",85,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",90,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",95,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",100,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",105,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",110,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",115,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",120,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",125,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",130,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",135,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",140,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",145,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",150,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",155,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",160,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",165,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",170,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",175,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",180,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",-5,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",-10,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",-15,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",-20,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",-25,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",-30,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",-35,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",-40,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",-45,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",-50,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",-55,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",-60,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",-65,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",-70,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",-75,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",-80,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",-85,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",-90,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",-95,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",-100,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",-105,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",-110,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",-115,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",-120,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",-125,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",-130,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",-135,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",-140,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",-145,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",-150,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",-155,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",-160,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",-165,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",-170,0,0,0)
		TNT1 A 0 A_FireCustomMissile("NovaLightning",-175,0,0,0)
		W01I DEF 9	
		W01I A 30
		Goto Ready
	}
}

Actor NovaPuff
{
	+NoBlockmap
	+NoGravity
	+ActivatePCross
	+ActivateImpact
	+NoTeleport
	+DropOff
	+PUFFONACTORS
	DamageType "Electric"
	Radius 3
	Height 5
	Speed 0
	+FOILINVUL
	Translation "0:255=%[0,0,0]:[0.75,0.75,2.0]"
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SpawnItemEx("NovaLightningFinger",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION,220)
		TNT1 AAAAAAAAAAA 0 A_SpawnItemEx("PsychLightningSpark",0,0,0,frandom(1,4),0,frandom(3,-3),random(0,359),SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION,64)
		ZAP1 ABCDEFEDCBA 1 Bright A_FadeOut(0.03)
		Stop
	}
}

Actor NovaLightningParticle : PsychLightningSpark //see WepClass3.AED
{
	Scale 0.24
}


Actor NovaLightningFinger
{
	var int user_failsafe;
	var int user_count;
	var int user_vel[3];
	Projectile
	+THRUACTORS
	+DONTSPLASH
	+FORCERADIUSDMG
	+EXTREMEDEATH
	+PAINLESS
	DamageType "Electric"
	Radius 4
	Height 4
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_Explode(128,10,0)
		TNT1 A 0 A_PlaySound("Thunderstorm/lightning")
		TNT1 A 0 A_JumpIf(z >= ceilingz || z <= floorz,"Death")
		TNT1 A 0 A_CheckSight("Death")
	Velocity:
		TNT1 A 0 
		TNT1 A 0 A_SetUserVar("user_count",0)
		TNT1 A 0 A_SetUserArray("user_vel",0,frandom(0.75,2.0))
		TNT1 A 0 A_SetUserArray("user_vel",1,frandom(-3.0,3.0))
		TNT1 A 0 A_SetUserArray("user_vel",2,frandom(-3.0,3.0))
	Warping:
		TNT1 A 0 A_SpawnItemEx("NovaLightningFingerTrail",0,0,0,0,0,0,0,0,33)
		TNT1 A 0 A_Jump(128,2)
		TNT1 A 0 A_Warp(AAPTR_DEFAULT,user_vel[0],user_vel[1]*frandom(1.0,3.0),user_vel[2]*frandom(1.0,3.0),0,WARPF_STOP,1)
		Goto Death
		
		TNT1 A 0 A_Warp(AAPTR_DEFAULT,user_vel[0],user_vel[1]*frandom(1.0,3.0),user_vel[2]*frandom(1.0,3.0),0,0,"Warp2")
		Goto Death
	Warp2:
		TNT1 A 0 A_JumpIf(z >= ceilingz || z <= floorz,"Death")
		TNT1 A 0 A_CheckSight("Death")
		TNT1 A 0 A_SetUserVar("user_failsafe",user_failsafe+1)
		TNT1 A 0 A_JumpIf(user_failsafe>=500,"Death")
		TNT1 A 0 A_SetUserVar("user_count",user_count+1)
		TNT1 A 0 A_JumpIf(user_count>=random(3,10),"Velocity")
		Loop
	Death:
		TNT1 A 0 
		Stop
	}
}

Actor NovaLightningFingerTrail
{
	+NOINTERACTION
	Alpha 0.8
	Scale 0.05
	RenderStyle Add 
	+FOILINVUL
	Translation "0:255=%[0,0,0]:[0.75,0.75,2.0]"
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SetScale(frandom(0.05,0.1))
		TNT1 A 0 A_Jump(256,"S1","S2","S3","S4","S5","S6","S7","S8")
	S1:	X079 A 0	
	Goto Perform
	S2:	X079 B 0	
	Goto Perform
	S3:	X079 C 0	
	Goto Perform
	S4:	X079 D 0	
	Goto Perform
	S5:	X079 E 0	
	Goto Perform
	S6:	X079 F 0	
	Goto Perform
	S7:	X079 G 0	
	Goto Perform
	S8: X079 H 0	
	Goto Perform
	Perform:
		"####" "#" 1 Bright
		"####" "#" 0 A_FadeOut(0.03)
		Loop
	}

}


Actor NovaPuffExtra
{
	Translation "112:127=192:207"
	+NOINTERACTION
	Scale 0.3
	RenderStyle Add
	States
	{
	Spawn:
		EBLT ABCDEF 3 Bright
		Stop
	}
}


Actor NovaLightning
{
	RipperLevel 2
	+RIPPER
	+BLOODLESSIMPACT
	+DONTREFLECT
	+FOILINVUL
	PROJECTILE
	+SeekerMissile
	SeeSound "Nova/seesound"
	Mass 1
	Radius 8
	Height 6
	Speed 12
	Damage 30
	DeathSound ""
	DamageType "Electric"
	Translation "0:255=%[0,0,0]:[0.75,0.75,2.0]"
	Scale 0.4
	States
	{
	Spawn:
		NOVA A 0 Bright A_seekerMissile(5,5)
		NOVA A 0 Bright A_Explode(30,16,0)
		NOVA AAA 1 A_CustomMissile("NovaLightningTrail",0,0,0)
		NOVA A 0 Bright A_seekerMissile(5,5)
		NOVA A 0 Bright A_Explode(30,16,0)
		NOVA BBB 1 A_CustomMissile("NovaLightningTrail",0,0,0)
		NOVA A 0 Bright A_seekerMissile(5,5)
		NOVA A 0 Bright A_Explode(30,16,0)
		NOVA CCC 1 A_CustomMissile("NovaLightningTrail",0,0,0)
		NOVA A 0 Bright A_seekerMissile(5,5)
		NOVA A 0 Bright A_Explode(30,16,0)
		NOVA DDD 1 A_CustomMissile("NovaLightningTrail",0,0,0)
		NOVA A 0 Bright A_seekerMissile(5,5)
		NOVA A 0 Bright A_Explode(30,16,0)
		NOVA EEE 1 A_CustomMissile("NovaLightningTrail",0,0,0)
		NOVA A 0 Bright A_seekerMissile(5,5)
		NOVA A 0 Bright A_Explode(30,16,0)
		NOVA FFF 1 A_CustomMissile("NovaLightningTrail",0,0,0)
		NOVA A 0 Bright A_seekerMissile(5,5)
		NOVA A 0 Bright A_Explode(30,16,0)
		NOVA GGG 1 A_CustomMissile("NovaLightningTrail",0,0,0)
		NOVA A 0 Bright A_seekerMissile(5,5)
		NOVA A 0 Bright A_Explode(30,16,0)
		NOVA HHH 1 A_CustomMissile("NovaLightningTrail",0,0,0)
		Loop
	Death:
		NOVA A 0 Bright A_Explode(30,16,0)
		TNT1 A 0 A_SpawnItemEx("NovaLightningFinger",-10,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION,230)
		TNT1 A 1
		Stop
	}
}

Actor NovaLightningTrail
{
	Projectile
	+NOINTERACTION
	Speed 0
	RenderStyle Add
	Translation "0:255=%[0,0,0]:[0.75,0.75,2.0]"
	Scale 0.38
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_Jump(230,2,3,4,5,6)
		NOVA ABCDEFGH 2 Bright A_FadeOut
		Goto Spawn+2
	}
}

Actor NovaDrop : AEoDWeaponDrop
{
	Inventory.MaxAmount 1
	States
	{
	Use:
		TNT1 A 0
		TNT1 A 0 A_SpawnItemEx("DroppedNova",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		Stop
	}
}

Actor DroppedNova
{
	Radius 16
	Height 20
	Scale 0.3
	States
	{
	Spawn:
		01RO A 15
		TNT1 A 0 A_SpawnItemEx("AEoDNovaNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
}

Actor AEoDNovaNoAmmo : AEoDNovaItem
{
	+FLOORCLIP
	+IGNORESKILL	+DONTGIB
	+FLOATBOB
	Scale 0.3
	Inventory.Amount 1
	Inventory.PickupMessage "You found the Nova Staff!"
	Inventory.PickupSound "pickuppiece"
	States
	{
	Spawn:
		01RO A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",0) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("BlueMana",50,"Ammo")
		TNT1 A 0 A_JumpIfInventory("RedMana",25,"Ammo3")
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("NovaDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDNova",1)
		TNT1 A 0 A_TakeInventory("BlueMana",50)
		TNT1 A 0 A_TakeInventory("RedMana",25)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDNova",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,0,152,0)
		Fail
	Ammo:
		TNT1 A 0 A_JumpIfInventory("RedMana",25,1)
		Goto Ammo2
		
		TNT1 A 0 A_TakeInventory("BlueMana",50)
		TNT1 A 0 A_TakeInventory("RedMana",25)
		TNT1 A 0 A_JumpIfInventory("AEoDNova",1,2)
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("NovaDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDNova",1)
		Stop
	Ammo2:
		TNT1 A 0 A_TakeInventory("BlueMana",50)
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("NovaDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDNova",1)
		TNT1 A 0 A_TakeInventory("RedMana",25)
		Stop
	Ammo3:
		TNT1 A 0 A_TakeInventory("RedMana",25)
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("NovaDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDNova",1)
		TNT1 A 0 A_TakeInventory("BlueMana",50)
		Stop
	}
}

//==================================================================================
//==================================================================================

//==================================================================================
//==================================================================================

Actor AEoDQSGItem : AEoDWeaponPickup 6002
{
	+FLOORCLIP
	+IGNORESKILL	+DONTGIB
	Scale 0.35
	Inventory.Amount 1
	Inventory.PickupMessage "You got the Quantum Singularity Generator!"
	Inventory.PickupSound "reilsss/weappickup/qsg"
	States
	{
	Spawn:
		ZIEP A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDQSG",1,"Ammo")
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",0) <= 0,"Nothing")
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("QSGDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDQSG",1)
		TNT1 A 0 A_PrintBold("\cgSlot 10: Quantum Singularity Generator")
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDQSG",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,0,150,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDQSG",1)
		Stop
	}
}

Actor AEoDQSG : AEoDWeaponBase // 6002
{
	+WEAPON.CHEATNOTWEAPON
	+IGNORESKILL	+DONTGIB
	Weapon.Kickback 150
	Weapon.AmmoType1 "PlasmaRod"
	Weapon.AmmoType2 "PlasmaRod"
	Weapon.AmmoGive1 80
	Weapon.AmmoUse1 10
	Weapon.AmmoUse2 200
	Weapon.SelectionOrder 11350
	Inventory.PickupMessage "You got the Quantum Singularity Generator!"
	Inventory.PickupSound "reilsss/weappickup/qsg"
	AttackSound "weapons/zerofire"
	Weapon.upsound "weapons/bfg/draw"
	Scale 0.35
	Tag "Quantum singularity generator"
	States
	{
	Spawn:
		ZIEP A -1
		Loop
	Ready:
		TNT1 AAAAAAAAAAA 0 // [Ms] lolz
		TNT1 A 0 A_PlaySound("reilsss/weapons/qsgidle", 6, 1.0, 1)
		TNT1 A 0 A_GiveInventory("InfinityRefire",1)
		TNT1 A 0 A_JumpIfInventory("ZeroIdle",1,2)
		TNT1 A 0 
		ZIEX AAAABBBBCCCC 1 A_WeaponReady
		ZIEX BBBBAAA 1 A_WeaponReady
		ZIEX ABBBBCCCCBB 1 A_WeaponReady
		TNT1 A 0
		ZIEX BBAAA 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("ZeroIdle",7,2)
		TNT1 A 0 A_GiveInventory("ZeroIdle",1)
		Goto Ready+13
		
		TNT1 A 0 A_TakeInventory("ZeroIdle",99)
		Goto Ready+13
	Deselect:
		TNT1 A 0 A_TakeInventory("ZeroIdle",99)
		TNT1 A 0 A_StopSound(6)
		TNT1 A 0 	
		ZIEX A 1 A_Lower
		TNT1 AA 0 A_Lower
		Goto Deselect+2
	Select:
		TNT1 A 0 	
		ZIEX A 1 A_Raise
		TNT1 AA 0 A_Raise
		Loop
	Fire:
		ZIEX DEF 1
		ZIEX G 1
		TNT1 A 0 A_GunFlash
		TNT1 A 0 A_SetBlend("22 00 88",0.1,8) 
		TNT1 A 0 A_FireCustomMissile("GunSmokeSpawner",0,0,6,2)
		TNT1 A 0 
		TNT1 A 0 A_PlaySound("reilsss/weapons/novaaltfire", CHAN_WEAPON, 0.75, 0)
		TNT1 A 0 A_FireCustomMissile("ZeroBeam",0,1,7,0)
		ZIEX H 2 Bright A_SetPitch(pitch-3)
		ZIEX IJ 2 Bright A_SetPitch(pitch+1.5)
		ZIEX KL 2
		ZIEX VWXYZ 2
		ZIEX A 1 A_ReFire
		Goto Ready+13
	AltFire: 
		ZIEX DEF 5
		TNT1 A 0 A_PlaySound("reilsss/weapons/qsgloadandfire", CHAN_WEAPON, 1.0, 0)
		ZIEX MNOPQ 5
		ZIEX R 1 
		TNT1 A 0 Bright A_LightInverse  
		ZIEX R 0 A_FireCustomMissile("InfinityShot",0,1,7,0) 
		ZIEX R 3 A_SetPitch(pitch-5)
		TNT1 A 0 A_SetPitch(pitch+1)
		ZIEX R 1 A_Light0  
		TNT1 A 0 A_SetPitch(pitch+1)
		ZIEX S 1 A_LightInverse  
		ZIEX S 1 A_SetPitch(pitch+1)
		ZIEX S 1 A_Light0 
		ZIEX S 4 A_SetPitch(pitch+1)
		ZIEX TU 4
		ZIEX VWXYZ 6
		ZIEX A 75
		Goto Ready+13
	Flash:   
		TNT1 A 2 Bright A_Light2
		TNT1 A 2 Bright A_Light1
		TNT1 A 1 Bright A_Light0
		Stop
	}
}

Actor InfinityRefire : PuzzleItem
{
	-INVBAR
	Inventory.MaxAmount 1
	Inventory.Icon TNT1A0
	States
	{
	Spawn:
		TNT1 A 4
		Loop
	}
}

Actor ZeroIdle : PuzzleItem
{
	-INVBAR
	Inventory.MaxAmount 99
	Inventory.Icon TNT1A0
	States
	{
	Spawn:
		TNT1 A 4
		Loop
	}
}


//*******************************************
Actor ZeroBeam : FastProjectile
{
	Projectile
	+EXTREMEDEATH
	+FORCEXYBILLBOARD
	+DONTREFLECT
	Speed 100
	Damage 35
	SeeSound "" 
	DeathSound "" 
	Scale 0.5
	RenderStyle Translucent
	Radius 6
	Height 2
	Alpha 0.6
	Translation "0:255=%[0.15,0.15,1.0]:[0.0,0.0,0.01]"
	MissileType "ZeroTrail"
	DamageType "PlasmaDisint"
	States
	{
	Spawn:	//Warning: Confusion ahead. "Positions" are based on numeric keypad number locs
		VPXS A 0 BRIGHT
		VPXS A 0 Bright A_SpawnItem("ZeroZag",-50)
		Goto Spawn+32	//Pos5
		
		//Position 1
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner1",-25)
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner1",1)
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner1",25)
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner1",50)
		VPXS A 1 Bright
		VPXS A 0 Bright A_Jump(128,1)
		Goto Spawn+2 //Pos2
		VPXS A 0 Bright 
		Goto Spawn+24 //Pos4
		
		//Position 2
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner2",-25)
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner2",1)
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner2",25)
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner2",50)
		VPXS A 1 Bright 
		VPXS A 0 Bright A_Jump(170,1)
		Goto Spawn+2 //Pos1
		VPXS A 0 Bright A_Jump(128,1)
		Goto Spawn+17 //Pos3
		VPXS A 0 Bright 
		Goto Spawn+32 //Pos5
		
		//Position 3
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner3",-25)
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner3",1)
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner3",25)
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner3",50)
		VPXS A 1 Bright 
		VPXS A 0 Bright A_Jump(128,1)
		Goto Spawn+9 //Pos2
		VPXS A 0 Bright 
		Goto Spawn+41 //Pos6
		
		//Position 4
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner4",-25)
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner4",1)
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner4",25)
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner4",50)
		VPXS A 1 Bright 
		VPXS A 0 Bright A_Jump(170,1)
		Goto Spawn+2 //Pos1
		VPXS A 0 Bright A_Jump(128,1)
		Goto Spawn+32 //Pos5
		VPXS A 0 Bright 
		Goto Spawn+49 //Pos7
		
		//Position 5
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner5",-25)
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner5",1)
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner5",25)
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner5",50)
		VPXS A 1 Bright 
		VPXS A 0 Bright A_Jump(192,1)
		Goto Spawn+9 //Pos2
		VPXS A 0 Bright A_Jump(170,1)
		Goto Spawn+24 //Pos4
		VPXS A 0 Bright A_Jump(128,1)
		Goto Spawn+41 //Pos6
		VPXS A 0 BRIGHT
		Goto Spawn+56 //Pos8
		
		//Position 6
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner6",-25)
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner6",1)
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner6",25)
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner6",50)
		VPXS A 1 Bright 
		VPXS A 0 Bright A_Jump(170,1)
		Goto Spawn+17 //Pos3
		VPXS A 0 Bright A_Jump(128,1)
		Goto Spawn+32 //Pos5
		VPXS A 0 Bright 
		Goto Spawn+64 //Pos9
		
		//Position 7
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner7",-25)
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner7",1)
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner7",25)
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner7",50)
		VPXS A 1 Bright 
		VPXS A 0 Bright A_Jump(128,1)
		Goto Spawn+24 //Pos4
		VPXS A 0 Bright 
		Goto Spawn+56 //Pos8
		
		//Position 8
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner8",-25)
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner8",1)
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner8",25)
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner8",50)
		VPXS A 1 Bright 
		VPXS A 0 Bright A_Jump(170,1)
		Goto Spawn+32 //Pos5
		VPXS A 0 Bright A_Jump(128,1)
		Goto Spawn+49 //Pos7
		VPXS A 0 Bright 
		Goto Spawn+64 //Pos9
		
		//Position 9
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner9",-25)
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner9",1)
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner9",25)
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner9",50)
		VPXS A 1 Bright 
		VPXS A 0 Bright A_Jump(170,1)
		Goto Spawn+41 //Pos6
		VPXS A 0 Bright A_Jump(128,1) 
		Goto Spawn+55 //Pos8
		
		//Secret Attack (Split Missile)
		TNT1 A 1 Bright A_PlaySound("weapons/zerodiffuse")
		TNT1 A 1 Bright A_CustomMissile("ZeroBeam",0,0,random(-15,-25),6)
		TNT1 A 1 Bright A_CustomMissile("ZeroBeam",0,0,random(15,25),6)
		Stop
	Death:
		TNT1 A 0 Bright A_Jump(128,2)
		TNT1 A 1 Bright A_CustomMissile("ZeroDiffusor",0,0,random(-15,-25),6)
		Stop
		TNT1 A 1 Bright A_CustomMissile("ZeroDiffusor",0,0,random(15,25),6)
		Stop
	}
}

Actor ZeroTrail : PlasmaBall
{ 
	+NOINTERACTION
	+FORCEXYBILLBOARD
	Damage 0
	Speed 1
	SeeSound ""
	DeathSound ""
	Alpha 0.5
	Scale 0.5
	States
	{
	Spawn:
		WPLT ABCDEFGHIJKLMNOPQRSTU 1 Bright A_FadeOut(0.05)
		Stop
	Death:
		TNT1 A 1
		Stop
	}
}

Actor ZeroZag : PlasmaBall
{ 
	Speed 0
	SeeSound "" 
	DeathSound "" 
	+NOINTERACTION
	+FORCEXYBILLBOARD
	RenderStyle Translucent
	Alpha 0.6
	Scale 0.35
	DamageType "Plasma"
	Translation "0:255=%[0.15,0.15,1.0]:[0.0,0.0,0.01]"
	States
	{
	Spawn:
		VPXS ABCDEFGHIJKLMNOPQRSTUVWXYZ 1 Bright A_FadeOut(0.015)
		VPXZ ABC 1 Bright A_FadeOut(0.015)
		Stop
	Death:
		TNT1 A 1
		Stop
	}
}

Actor ZeroZagSpawner1 : PlasmaBall
{ 
	+NOINTERACTION
	Damage 0
	Speed 0
	SeeSound ""
	DeathSound ""
	States
	{
	Spawn:
		TNT1 A 0 
		TNT1 A 1 A_SpawnItemEx("ZeroZag",0,random(-12,-4),random(-12,-4),0,0,0,0,SXF_NOCHECKPOSITION) 
		Stop
	Death:
		TNT1 A 1
		Stop
	}
}

Actor ZeroZagSpawner2 : ZeroZagSpawner1
{ 
	States
	{
	Spawn:
		TNT1 A 0 
		TNT1 A 1 A_SpawnItemEx("ZeroZag",0,random(-12,-4),random(-4,4),0,0,0,0,SXF_NOCHECKPOSITION) 
		Stop
	}
}

Actor ZeroZagSpawner3 : ZeroZagSpawner1
{ 
	States
	{
	Spawn:
		TNT1 A 0 
		TNT1 A 1 A_SpawnItemEx("ZeroZag",0,random(-12,-4),random(4,12),0,0,0,0,SXF_NOCHECKPOSITION) 
		Stop
	}
}

Actor ZeroZagSpawner4 : ZeroZagSpawner1
{ 
	States
	{
	Spawn:
		TNT1 A 0 
		TNT1 A 1 A_SpawnItemEx("ZeroZag",0,random(4,4),random(-12,-4),0,0,0,0,SXF_NOCHECKPOSITION) 
		Stop
	}
}

Actor ZeroZagSpawner5 : ZeroZagSpawner1
{ 
	States
	{
	Spawn:
		TNT1 A 0 
		TNT1 A 1 A_SpawnItemEx("ZeroZag",0,random(-4,4),random(-4,4),0,0,0,0,SXF_NOCHECKPOSITION) 
		Stop
	}
}

Actor ZeroZagSpawner6 : ZeroZagSpawner1
{ 
	States
	{
	Spawn:
		TNT1 A 0 
		TNT1 A 1 A_SpawnItemEx("ZeroZag",0,random(-4,4),random(4,12),0,0,0,0,SXF_NOCHECKPOSITION) 
		Stop
	}
}

Actor ZeroZagSpawner7 : ZeroZagSpawner1
{ 
	States
	{
	Spawn:
		TNT1 A 0 
		TNT1 A 1 A_SpawnItemEx("ZeroZag",0,random(4,12),random(-12,-4),0,0,0,0,SXF_NOCHECKPOSITION) 
		Stop
	}
}

Actor ZeroZagSpawner8 : ZeroZagSpawner1
{ 
	States
	{
	Spawn:
		TNT1 A 0 
		TNT1 A 1 A_SpawnItemEx("ZeroZag",0,random(4,12),random(-4,4),0,0,0,0,SXF_NOCHECKPOSITION) 
		Stop
	}
}

Actor ZeroZagSpawner9 : ZeroZagSpawner1
{ 
	States
	{
	Spawn:
		TNT1 A 0 
		TNT1 A 1 A_SpawnItemEx("ZeroZag",0,random(4,12),random(4,12),0,0,0,0,SXF_NOCHECKPOSITION) 
		Stop
	}
}

Actor ZeroDiffusor : ZeroBeam
{
	RipperLevel 2
	+RIPPER
	+EXTREMEDEATH
	+FORCEXYBILLBOARD
	Speed 100
	Damage 35
	SeeSound "weapons/zerodiffuse" 
	DeathSound "weapons/zeroexplode"
	Scale 0.5
	DamageType "PlasmaDisint"
	States
	{
	Spawn:
		VPXS A 0 BRIGHT
		VPXS A 0 Bright A_SpawnItem("ZeroZag",-50)
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner5",-25)
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner5",1)
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner5",25)
		VPXS A 0 Bright A_SpawnItem("ZeroZagSpawner5",50)
		VPXS A 1 Bright A_CustomMissile("ZeroTrail",0,0,0,0)
		Loop
	Death:
		VPXS A 1 BRIGHT
		VPXS BCDEFGH 1 BRIGHT
		VPXS I 1 Bright A_Explode(50,50,0)
		VPXS JKLMNOPQRSTUVWXYZ 1 BRIGHT
		VPXZ A 1 Bright A_SetTranslucent(.75,1)
		VPXZ B 1 Bright A_SetTranslucent(.5,1)
		VPXZ C 1 Bright A_SetTranslucent(.25,1)
		Stop
	}
}

//*******************************************
Actor InfinityShot : PlasmaBall
{
	var int user_count;
	+NODAMAGETHRUST +CANNOTPUSH
	+EXTREMEDEATH
	+FORCEXYBILLBOARD
	+FORCERADIUSDMG
	+SEEKERMISSILE
	Speed 10
	Damage 0
	Radius 7
	Height 13
	SeeSound "" 
	DeathSound "weapons/infinityhit" 
	RenderStyle Shaded
	StencilColor Black
	DamageType "PlasmaDisint"
	Alpha 0.99
	Scale 0.5
	States
	{
	Spawn:
		VORT A 0 Bright 
		VORT A 1 Bright
		VORT A 1 Bright A_PlaySound("weapons/infinityidle", 6, 1,1)
		VORT BCDEFGHIJK 1 Bright 
		VORT A 0 Bright A_CustomMissile("InfinityTrail",0,0,0,0)
		VORT A 0 Bright A_CustomMissile("InfinityWaveSmall",0,0,0,0)
		VORT LM 1 Bright A_Explode(2,128,0) //change to IMPLODE
		VORT A 0 Bright A_CustomMissile("InfinityTrail",0,0,0,0)
		VORT NL 1 Bright A_Explode(2,128,0) //change to IMPLODE
		VORT A 0 Bright A_CustomMissile("InfinityTrail",0,0,0,0)
		VORT MN 1 Bright A_Explode(2,128,0) //change to IMPLODE
		Goto Spawn+13
	Death:
		VORT O 0 A_SetUserVar("user_count",0)
		VORT O 0 Bright A_SpawnItemEx("InfinityPortalFX",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		VORT O 0 Bright A_StopSound(CHAN_AUTO)
		TNT1 A 0 A_PlaySound("quake4/Weapons/DMG/EnergyLoop",6,1,1)
		VORT O 0 Bright A_Explode(1024,256,0)
		Shooting:
		TNT1 A 0 A_SpawnItemEx("InfinityTargeter",0,0,1,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		TNT1 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 1 A_Explode(8,256,1,200,0)
		TNT1 A 0 A_SetUserVar("user_count",user_count+1)
		TNT1 A 0 A_JumpIf(user_count>=17,1)
		Loop
		TNT1 A 0
		Stop
	}
}

Actor InfinityTargeter
{
	Projectile
	+NOCLIP
	+SEEKERMISSILE
	Height 1
	Radius 1
	States
	{
	Spawn:
		TNT1 A 0
	Looper:
		TNT1 A 0 A_SeekerMissile(90,90,1,256)
		TNT1 A 0 A_JumpIfTargetInLOS("Shooter",360,JLOSF_PROJECTILE)
		Stop
	Shooter:
		TNT1 A 0 A_FaceTracer
		TNT1 A 0 A_PlaySound("reilsss/weapons/novaaltfire", CHAN_WEAPON, 0.75, 0)
		TNT1 A 0 A_CustomMissile("ZeroBeamSeeker",6,0,0,6)
		TNT1 A 0 
		Stop
	}
}

Actor ZeroBeamSeeker : ZeroBeam
{
	Damage 20
	+SEEKERMISSILE
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SeekerMissile(90,90,3,256)
		TNT1 A 0 A_FaceTracer
		Goto "Super::Spawn"
	}
}

Actor InfinityVortex : PlasmaBall
{
	+NOINTERACTION
	+EXTREMEDEATH
	+DONTSPLASH
	+NODAMAGETHRUST +CANNOTPUSH
	+FORCEXYBILLBOARD
	+FORCERADIUSDMG
	+PAINLESS
	DamageType "PlasmaDisint"
	Speed 0
	Radius 1
	Height 1
	Reactiontime 17 // Was orginally 5 but gets charged up to be syncron to the sound
	SeeSound "" 
	DeathSound "" 
	Renderstyle Translucent
	Translation "0:255=%[0.08,0.08,0.5]:[0.0,0.0,0.0]"
	Alpha 0.6
	Scale 0.8
	States
	{
	Spawn:
		TNT1 A 0 Bright 
		VOIP A 1 Bright Thing_ChangeTID(0,879)
		VOIP A 1 Bright A_PlaySound("reilsss/weapons/qsgblackhole", 8, 1.0, 0) //could be made so it plays on the whole map on full volume?
		TNT1 A 0 A_CustomMissile("InfinityWaveVoip",9,0,0,0)
		VOIP AABBCC 1 Bright A_Explode(16,344,1) //Reilsss note: I increase the Radius from 192 to 512
		TNT1 A 0 A_CustomMissile("InfinityWaveVoip",9,0,0,0)
		VOIP DDEE 1 Bright A_Explode(16,344,1)	//to make the weapon a bit more dramatic
		TNT1 A 0 A_CustomMissile("InfinityWaveMedia",9,0,0,0)
		VOIP AABBCC 1 Bright A_Explode(16,344,1)
		TNT1 A 0 A_CustomMissile("InfinityWaveVoip",9,0,0,0)
		VOIP DDEE 1 Bright A_Explode(16,344,1)
		TNT1 A 0 A_SpawnItemEx("InfinityVortexGhost1",0,0,0,0,0,0,0,0)
		TNT1 A 0 A_CustomMissile("InfinityWaveVoip",9,0,0,0)
		VOIP AABBCC 1 Bright A_Explode(16,344,1)
		TNT1 A 0 A_CustomMissile("InfinityWaveVoip",9,0,0,0)
		VOIP DDEE 1 Bright A_Explode(16,344,1)
		TNT1 A 0 A_CustomMissile("InfinityWaveMedia",9,0,0,0)
		VOIP AABBCC 1 Bright A_Explode(16,344,1)
		TNT1 A 0 A_CustomMissile("InfinityWaveVoip",9,0,0,0)
		VOIP DDEE 1 Bright A_Explode(16,344,1)
		TNT1 A 0 A_CustomMissile("InfinityWaveVoip",9,0,0,0)
		VOIP AABBCC 1 Bright A_Explode(16,344,1) 
		TNT1 A 0 A_CustomMissile("InfinityWaveMedia",9,0,0,0)
		VOIP DDEE 1 Bright A_Explode(16,344,1)
		TNT1 A 0 A_CustomMissile("InfinityWaveVoip",9,0,0,0)
		VOIP AABBCC 1 Bright A_Explode(16,344,1)
		TNT1 A 0 A_CustomMissile("InfinityWaveVoip",9,0,0,0)
		VOIP DDEE 1 Bright A_Explode(16,344,1)	
		TNT1 A 0 A_CountDown
		Goto Spawn+3
	Death:
		TNT1 A 0 A_SpawnItemEx("InfinityVortexGhost1",0,0,0,0,0,0,0,0)
		TNT1 A 0 A_CustomMissile("InfinityShock",9,0,0,0)
		VOIP AABBCC 1 Bright A_Explode(32,512,1)	//change to IMPLODE  256 to 768
		TNT1 A 0 A_CustomMissile("InfinityWaveMedia",9,0,0,0)
		VOIP DDEE 1 Bright A_Explode(32,512,1)	//change to IMPLODE  
		TNT1 A 0 A_CustomMissile("InfinityShock",9,0,0,0)
		VOIP AABBCC 1 Bright A_Explode(32,512,1)	//change to IMPLODE  
		TNT1 A 0 A_CustomMissile("InfinityShock",9,0,0,0)
		VOIP DDEE 1 Bright A_Explode(32,512,1)	//change to IMPLODE 
		TNT1 A 0 A_SpawnItemEx("InfinityExplosion",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 4
		Stop
	}
}

Actor InfinityExplosion
{
	+NOINTERACTION
	+FORCERADIUSDMG
	+NODAMAGETHRUST +CANNOTPUSH
	Radius 1
	Height 2
	Renderstyle Translucent
	Alpha 0.6
	Scale 0.8
	DamageType "PlasmaDisint"
	States
	{
	Spawn:

		TNT1 A 0
		TNT1 A 0 Bright A_PlayWeaponSound("weapons/infinitydispel")
		TNT1 A 0 A_Explode(1024,768,1)
		TNT1 A 0 A_BFGSpray
		TNT1 A 0 Bright A_StopSoundEx("Auto")
		TNT1 A 0 Bright A_CustomMissile("InfinityShock",9,0,0,0)
		VORX A 2 Bright A_RadiusThrust(200,768,1)
		VORX A 3 BRIGHT
		TNT1 A 0 Bright A_SpawnDebris("InfinityByte")
		TNT1 A 0 Bright A_CustomMissile("InfinityShock",9,0,0,0)
		VORX BC 5 BRIGHT
		TNT1 A 0 Bright A_CustomMissile("InfinityShock",9,0,0,0)
		VORX DE 5 BRIGHT
		TNT1 A 0 Bright A_CustomMissile("InfinityShock",9,0,0,0)
		VORX FG 5 BRIGHT
		TNT1 A 0 Bright A_CustomMissile("InfinityShock",9,0,0,0)
		VORX HI 5 BRIGHT
		TNT1 A 0 Bright A_CustomMissile("InfinityShock",9,0,0,0)
		VORX J 1 Bright A_FadeOut
		Wait
	}
}

Actor InfinityVortexGhost1
{
	Projectile
	Speed 0
	Damage 0
	RenderStyle Translucent
	Alpha 0.55
	Scale 0.8
	Translation "0:255=%[0.08,0.08,0.5]:[0.0,0.0,0.0]"
	States
	{
	Spawn:
		VOIP FGHIJKLMNOPQ 3 Bright
		VOIP QPONMLKJIHGF 3 Bright
		Stop
	}
}

Actor InfinityTrail
{
	+DONTSPLASH
	+NOGRAVITY
	+NOBLOCKMAP
	+FLOORCLIP
	+FORCEXYBILLBOARD
	Radius 1
	Height 1
	RenderStyle Translucent
	Translation "80:95=0:0", "96:111=246:240", "5:8=240:241", "3:3=241:241"
	Alpha	.1
	Scale	.5
	States
	{
	Spawn:
		SMOK ABCDEFGHIJKLMNOPQ 1 Bright 
		Stop
	}
}

Actor InfinityTrail2
{
	+DONTSPLASH
	+NOGRAVITY
	+NOBLOCKMAP
	+FLOORCLIP
	+FORCEXYBILLBOARD
	Radius 1
	Height 1
	RenderStyle Translucent
	Translation "80:95=0:0", "96:111=246:240", "5:8=240:241", "3:3=241:241"
	Alpha .3
	Scale .5
	States
	{
	Spawn:
		SMOK ABCDEFGHIJKLMNOPQ 1 Bright 
		Stop
	}
}

Actor InfinityWaveSmall
{
	+DONTSPLASH
	+NOGRAVITY
	+NOBLOCKMAP
	+FLOORCLIP
	+FORCEXYBILLBOARD
	Radius 1
	Height 1
	RenderStyle Translucent
	Translation "112:127=246:240"
	Alpha .5
	Scale .2
	States
	{
	Spawn:
		SHOK R 1 Bright A_SetTranslucent(0.1)
		SHOK Q 1 Bright A_SetTranslucent(0.2) 
		SHOK P 1 Bright A_SetTranslucent(0.3) 
		SHOK O 1 Bright A_SetTranslucent(0.4)
		SHOK N 1 Bright A_SetTranslucent(0.5)
		SHOK MLKJIHGFEDCBA 1 Bright 
		Stop
	}
}

Actor InfinityWaveMedia : InfinityWaveSmall
{
	Scale	.5
	States
	{
	Spawn:
		VORT A 0 Bright A_CustomMissile("InfinityTrail2",0,0,0,0)
		SHOK R 1 Bright A_SetTranslucent(0.1)
		SHOK Q 1 Bright A_SetTranslucent(0.2) 
		VORT A 0 Bright A_CustomMissile("InfinityTrail2",0,0,0,0)
		SHOK P 1 Bright A_SetTranslucent(0.3) 
		SHOK O 1 Bright A_SetTranslucent(0.4)
		VORT A 0 Bright A_CustomMissile("InfinityTrail2",0,0,0,0)
		SHOK N 1 Bright A_SetTranslucent(0.5)
		SHOK MLKJIHGFEDCBA 1 Bright 
		Stop
	}
}

Actor InfinityWaveLarge : InfinityWaveMedia { Scale	.8 }

Actor InfinityWaveVoip : InfinityWaveSmall
{
	Alpha	.2
	Scale	.25
}

Actor InfinityShock
{
	+DONTSPLASH
	+NOGRAVITY
	+NOBLOCKMAP
	+FLOORCLIP
	+FORCEXYBILLBOARD
	Radius 1
	Height 1
	RenderStyle Translucent
	Translation "112:127=246:240"
	Alpha	0.5
	States
	{
	Spawn:
		SHOK ABCDEFGHIJKLMNOPQR 1 Bright 
		Stop
	}
}

Actor InfinityByte
{
	+missile
	BounceType "Doom"
	+FLOORCLIP
	+DONTSPLASH
	+NOTELEPORT
	+FORCEXYBILLBOARD
	Health 50
	Radius 3
	Height 6
	speed 10
	Mass	8
	Alpha 1
	Scale 0.1
	States
	{
	Spawn:
		VOIP ABCDEFGHIJKL 1 Bright 
		VOIP ABCDEFGHIJKLABCDEFGH 1 Bright A_FadeOut(0.05)
		Stop
	Death:
		VOIP ABCDEFGHIJKLABCDEFGH 1 Bright A_FadeOut(0.05)
		Stop
	}
}

Actor QSGDrop : AEoDWeaponDrop
{
	Inventory.MaxAmount 1
	States
	{
	Use:
		TNT1 A 0
		TNT1 A 0 A_StopSound(6)
		TNT1 A 0 A_SpawnItemEx("DroppedQSG",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		Stop
	}
}

Actor DroppedQSG
{
	Radius 16
	Height 20
	Scale 0.35
	States
	{
	Spawn:
		ZIEP A 15
		TNT1 A 0 A_SpawnItemEx("AEoDQSGNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
}

Actor AEoDQSGNoAmmo : AEoDQSGItem
{
	+FLOORCLIP
	+IGNORESKILL	+DONTGIB
	Scale 0.35
	Inventory.Amount 1
	Inventory.PickupMessage "You got the Quantum Singularity Generator!"
	Inventory.PickupSound "reilsss/weappickup/qsg"
	States
	{
	Spawn:
		ZIEP A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",0) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("PlasmaRod",80,"Ammo")
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("QSGDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDQSG",1)
		TNT1 A 0 A_TakeInventory("PlasmaRod",80)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDQSG",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,0,150,0)
		Fail
	Ammo:
		TNT1 A 0 A_TakeInventory("PlasmaRod",80)
		TNT1 A 0 A_JumpIfInventory("AEoDQSG",1,2)
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("QSGDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDQSG",1)
		Stop
	}
}

//==================================================================================
//==================================================================================

//==================================================================================
//==================================================================================

Actor AEoDDarkMatterGunItem : AEoDWeaponPickup 6088
{
	+FLOORCLIP
	+IGNORESKILL	+DONTGIB
	Scale 0.25
	Inventory.Amount 1
	Inventory.PickupMessage "You got the Dark Matter Gun!!"
	Inventory.PickupSound "reilsss/weappickup/qsg"
	States
	{
	Spawn:
		Q4DM A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDDarkMatterGun",1,"Ammo")
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",0) <= 0,"Nothing")
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("DarkMatterGunDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDDarkMatterGun",1)
		TNT1 A 0 A_PrintBold("\cgSlot 10: Dark Matter Gun")
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDDarkMatterGun",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,0,147,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDDarkMatterGun",1)
		Stop
	}
}

Actor AEoDDarkMatterGun : AEoDWeaponBase // 6088
{
	+FLOORCLIP
	+IGNORESKILL	+DONTGIB
	+CHEATNOTWEAPON
	Weapon.Kickback 100
	Weapon.AmmoType1 "AECell"
	Weapon.AmmoType2 "AECell"
	Weapon.AmmoGive1 80
	Weapon.AmmoUse1 20
	Weapon.AmmoUse2 200
	Inventory.PickupMessage "You got the Dark Matter Gun!!"
	Inventory.PickupSound "reilsss/weappickup/qsg"
	Weapon.upsound "weapons/bfg/draw"
	Scale 0.25
	Weapon.Kickback 2
	Tag "Dark Matter Gun"
	States
	{
	Spawn:
		Q4DM A -1
		Loop
	Deselect:
		TNT1 A 0 A_StopSound(6)
		DMG1 A 0 A_TakeInventory("DMGunCheck",13)
		TNT1 A 0 //ACS_NamedExecute("s799",0,0,0,0)
		DMG1 A 1 A_Lower
		TNT1 AA 0 A_Lower
		Goto Deselect+1
	Select:
		DMG1 A	 0 A_TakeInventory("DMGunCheck",13)
		TNT1 A 0 //ACS_NamedExecute("s799",0,8,0,0)
		DMG1 A 1 A_Raise
		TNT1 AA 0 A_Raise
		Loop
	Ready:
		TNT1 A 0 A_JumpIfInventory("AECell",1,"ReadyAmmo")
	ReadyNoAmmo:
		DMG1 A 2 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("AECell",1,"ReReady")
		Loop
	ReReady: //The black hole growing animation, after the weapon didnt have ammo
		TNT1 A 0 A_PlaySound("reilsss/weapons/fusionidle1", 6, 1.0, 1)
		DMG1 ABCDEFGHIJKLMNOPQRSTUVWXYZ 2 A_WeaponReady
		DMG2 ABCDEFGHIJKLMNOPQRSTUV 2 A_WeaponReady
		Goto ReadyAmmo
	ReadyAmmo:
		TNT1 A 0 A_PlaySound("reilsss/weapons/fusionidle1", 6, 1.0, 1)
		DMGA ABCDEFGHIJKLMNOPQRSTUVWXYZ 2 A_WeaponReady
	ReadyAmmoContinuation:
		DMGB ABCDEFGHIJKLMNOPQRSTUV 2 A_WeaponReady
		Goto ReadyAmmo
	Fire:
		TNT1 A 0 A_PlaySound("darkmattergun/fire2", CHAN_WEAPON, 1.0, 0)
		TNT1 A 0 A_FireCustomMissile("DarkMatterProjectile",0,1,5,4)
		DMG1 N 1 Offset(10,42) A_SetPitch(pitch-5)
		DMG1 N 1 
		DMG1 O 1 
		DMG1 O 1 Offset(9,41) A_SetPitch(pitch+1)
		DMG1 P 1 Offset(8,40) A_SetPitch(pitch+1)
		DMG1 P 1 Offset(7,39) A_SetPitch(pitch+1)
		DMG1 Q 1 Offset(6,38) A_SetPitch(pitch+1)
		DMG1 Q 1 Offset(5,37) A_SetPitch(pitch+1)
		DMG1 R 1 Offset(4,36)
		DMG1 R 1 Offset(3,35)
		DMG1 S 1 Offset(2,34)
		DMG1 S 1 Offset(1,33)
		TNT1 A 0 A_WeaponReady(WRF_NOFIRE)
		DMG1 TUVWXYZ 2 A_Refire
		DMG2 ABCDEFGHIJKLMNOPQRSTUV 2 A_Refire
		Goto Ready
	AltFire:
		TNT1 A 0 A_StopSound(6)
		TNT1 A 0 Bright A_GunFlash
		TNT1 A 0 A_FireCustomMissile("DMGShotPlayer", 0, 1, 4) //DarkMatterBall2
		TNT1 A 0 Radius_Quake(4, 4, 0, 1, 0)
		TNT1 A 0 A_SetBlend("blue",0.5,25)
		TNT1 A 0 A_PlaySound("reilsss/weapons/darkmattercannonfire", CHAN_WEAPON, 1.0, 0)
		DMG1 A 7 Offset(50,1)  A_SetPitch(pitch-15)
		DMG1 AAAAAAAAAAAAAAAAAAAAAAAAA 1 Offset(52,1) A_SetPitch(pitch+0.6)
		DMG1 AAAAAAAAAAAAAAAAAAAAAAAAA 1 Offset(52,1)
		TNT1 A 0 A_JumpIfnoAmmo("Ready") 
		DMG1 B 2 Offset(51,1)
		DMG1 C 2 Offset(51,1)
		DMG1 D 2 Offset(51,2)
		DMG1 E 2 Offset(51,2)
		DMG1 F 2 Offset(50,3)
		DMG1 G 2 Offset(50,3)
		TNT1 A 0 A_PlaySound("reilsss/weapons/darkmattercannoncharge", 5, 1.0, 0)
		DMG1 H 2 Offset(49,4)
		DMG1 I 2 Offset(49,4)
		DMG1 J 2 Offset(48,5)
		DMG1 K 2 Offset(47,5)
		DMG1 L 2 Offset(46,6)
		DMG1 M 2 Offset(45,6)
		DMG1 N 2 Offset(44,7)
		DMG1 O 2 Offset(43,7)
		DMG1 P 2 Offset(42,8)
		DMG1 Q 2 Offset(41,8)
		DMG1 R 2 Offset(40,9)
		DMG1 S 2 Offset(39,9)
		DMG1 T 2 Offset(38,10)
		DMG1 U 2 Offset(37,10)
		DMG1 V 2 Offset(36,11)
		DMG1 W 2 Offset(35,11)
		DMG1 X 2 Offset(34,12)
		DMG1 Y 2 Offset(33,12)
		DMG1 Z 2 Offset(32,13)
		
		DMG2 A 1 Offset(31,14)
		DMG2 A 1 Offset(30,14)
		DMG2 B 1 Offset(29,15)
		DMG2 B 1 Offset(28,15)
		DMG2 C 1 Offset(27,16)
		DMG2 C 1 Offset(26,16)
		DMG2 D 1 Offset(25,17)
		DMG2 D 1 Offset(24,17)
		DMG2 E 1 Offset(23,18)
		DMG2 E 1 Offset(22,18)
		DMG2 F 1 Offset(21,19)
		DMG2 F 1 Offset(20,19)
		DMG2 G 1 Offset(19,20)
		DMG2 G 1 Offset(18,20)
		DMG2 H 1 Offset(17,21)
		DMG2 H 1 Offset(16,21)
		DMG2 I 1 Offset(15,22)
		DMG2 I 1 Offset(14,22)
		DMG2 J 1 Offset(13,23)
		DMG2 J 1 Offset(12,23)
		DMG2 K 1 Offset(11,24)
		DMG2 K 1 Offset(10,24)
		DMG2 L 1 Offset(9,25)
		DMG2 L 1 Offset(8,25)
		DMG2 M 1 Offset(7,26)
		DMG2 M 1 Offset(6,27)
		DMG2 N 1 Offset(5,28)
		DMG2 N 1 Offset(4,29)
		DMG2 O 1 Offset(3,30)
		DMG2 O 1 Offset(2,31)
		DMG2 P 1 Offset(1,31)
		DMG2 P 1 A_WeaponReady(WRF_NOFIRE)

		DMG2 QRSTUV 1 A_WeaponReady(WRF_NOFIRE)
		DMGA ABCDEFGHIJKL 1 A_WeaponReady(WRF_NOFIRE)
		TNT1 A 0 A_PlaySound("reilsss/weapons/fusionidle1", 6, 1.0, 1)
		DMGA MNOPQRSTUVWXYZ 1 A_WeaponReady(WRF_NOFIRE)
		TNT1 A 0 A_ReFire
		Goto ReadyAmmoContinuation
	Flash:
		TNT1 A 0 A_Light1
		TNT1 A 3 A_Light1
		TNT1 A 0 A_Light0
		stop  
	} 
}

Actor DMGRailFX
{
	var int user_failsafe;
	var int user_count;
	Projectile
	+DONTREFLECT
	Radius 4
	Height 4
	Speed 1
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_ScaleVelocity(4)
	Warping:
		TNT1 AAA 0 A_SpawnItemEx("DMGRailParticle1",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_Warp(AAPTR_DEFAULT,velx,vely,velz,0,WARPF_ABSOLUTEOFFSET,1)
		Goto Death
		
		TNT1 AAA 0 A_SpawnItemEx("DMGRailParticle1",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION,253)
		TNT1 A 0 A_Warp(AAPTR_DEFAULT,velx,vely,velz,0,WARPF_ABSOLUTEOFFSET,1)
		Goto Death
		
		TNT1 AAA 0 A_SpawnItemEx("DMGRailParticle1",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION,253)
		TNT1 A 0 A_Warp(AAPTR_DEFAULT,velx,vely,velz,0,WARPF_ABSOLUTEOFFSET,1)
		Goto Death
		
		TNT1 AAA 0 A_SpawnItemEx("DMGRailParticle1",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION,253)
		TNT1 A 0 A_Warp(AAPTR_DEFAULT,velx,vely,velz,0,WARPF_ABSOLUTEOFFSET,1)
		Goto Death
		
		TNT1 AAA 0 A_SpawnItemEx("DMGRailParticle1",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION,253)
		TNT1 A 0 A_Warp(AAPTR_DEFAULT,velx,vely,velz,0,WARPF_ABSOLUTEOFFSET,1)
		Goto Death
	Counting:
		TNT1 A 0 A_SetUserVar("user_failsafe",user_failsafe+1)
		TNT1 A 0 A_JumpIf(user_failsafe>=5000,"Death")
		Goto Warping
	Death:
		TNT1 A 0
		Stop
	}
}

Actor DMGRailParticle1
{
	var int user_count;
	+NOINTERACTION
	RenderStyle Translucent
	Alpha 1
	Scale 0.02
	Translation "0:255=%[0,0,0]:[0.2,0.0,0.2]"
	States
	{
	Spawn:
		X078 B 0
		X078 B 0 A_ChangeVelocity(frandom(-1,1),frandom(-1.5,1.5),frandom(-1.5,1.5),1)
	Fading:
		X078 B 0 A_ScaleVelocity(0.98)
		X078 B 0 A_SetScale(ScaleX-(0.001))
		X078 B 1 Bright A_FadeTo(0.6,0.01,1)
		X078 B 0 A_JumpIf(ScaleX<=0,1)
		Loop
		TNT1 A 0
		Stop
	}
}



Actor DMGShotPlayer
{
	var int user_count;
	Projectile
	Speed 12
	Radius 10
	Height 16
	+RIPPER	RipperLevel 1
	+FORCERADIUSDMG
	+DONTREFLECT
	+SKYEXPLODE
	+NODAMAGETHRUST +CANNOTPUSH
	Damage 30
	DamageType "Plasma"
	DeathType "Disintegrate"
	RenderStyle Add
	Scale 0.6
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SetUserVar("user_count",0)
		TNT1 A 0 A_PlaySound("quake4/Weapons/DMG/ProjectileLoop",6,1,1)
	Travel:
		Q27A ABCDEFGHIJKLMNOPQRSTUVWXYZ 2 Light("DMGDarkness") Bright 
		{
			A_Explode(250,160,0,0,40);
			A_RadiusThrust(-100,200);
			A_SpawnItemEx("DMGTrail",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERSPRITEFRAME);
		}
		Q27B ABCDEFGHIJKLMNOP 2 Light("DMGDarkness") Bright 
		{
			A_Explode(250,160,0,0,40);
			A_RadiusThrust(-100,200);
			A_SpawnItemEx("DMGTrail",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERSPRITEFRAME);
		}
		Loop
	Death:
		TNT1 A 0 A_PlaySound("quake4/Weapons/DMG/EnergyLoop",6,1,1)
		TNT1 A 0 A_Explode(512,384,0,0,256)
		TNT1 A 0 A_SpawnItemEx("DMGExplosionFX",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
	Afterburner:
		TNT1 AAAA 1 A_RadiusThrust(-200,(256+64),RTF_AFFECTSOURCE|RTF_NOIMPACTDAMAGE,64)
		TNT1 A 0 A_Explode(128,256,1,1,64)
		TNT1 A 0 A_SetUserVar("user_count",user_count+1)
		TNT1 A 0 A_JumpIf(user_count>=50,"FinalExplo")
		Loop
	FinalExplo:
		TNT1 A 0 A_PlaySound("quake4/Misc/ExploEnergyBig",5,1,0,0.3)
		TNT1 A 0 A_PlaySound("quake4/Misc/ExploOnRockDebris",6,1,0,0.3)
		TNT1 A 0 A_Explode(random(200,1600),512,0,0,256)
		TNT1 A 1 A_Explode(256,512)	//once again, to hurt player
		Stop
	}
}

Actor DMGTrail
{
	+NOINTERACTION
	Scale 0.6
	RenderStyle Add
	Alpha 0.7
	States
	{
	Spawn:
		"####" "#" 1 Bright A_FadeOut(0.03)
		Wait
	}
}



Actor DarkMatterPuff
{
	+DONTSPLASH
	+EXTREMEDEATH
	DamageType "PlasmaDisint"
	States
	{
	Spawn:
		TNT1 A 0
		Stop
	}
}


Actor DMGunCheck : Inventory { Inventory.MaxAmount 13 }
  
Actor DarkMatterProjectile
{
	Radius 11
	Height 8
	Speed 32
	Damage 15
	Scale 0.5
	Projectile
	+RANDOMIZE
	+EXTREMEDEATH
	+FORCERADIUSDMG
	RenderStyle Translucent
	Alpha 0.625
	DamageType "PlasmaDisint"
	SeeSound "DMGFIRST"
	DeathSound "DMGBLXP"
	Obituary "%o was absorbed, then dissolved, by %k's dark matter gun."
	Translation "0:255=%[0.0,0.0,0.01]:[0.3,0.0,0.6]"
	States
	{
	Spawn:
		BDMG A 0 NoDelay A_PlaySound("DMGBLOOP",5,1,true)
		BDMG AA 0 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG A 1 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG AA 0 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG A 1 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG AA 0 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG A 1 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG BB 0 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG B 1 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG BB 0 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG B 1 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG BB 0 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG B 1 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG CC 0 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG C 1 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG CC 0 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG C 1 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG CC 0 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG C 1 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG DD 0 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG D 1 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG DD 0 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG D 1 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG DD 0 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG D 1 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG EE 0 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG E 1 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG EE 0 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG E 1 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG EE 0 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG E 1 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG FF 0 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG F 1 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG FF 0 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG F 1 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG FF 0 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG F 1 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG GG 0 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG G 1 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG GG 0 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG G 1 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG GG 0 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG G 1 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG HH 0 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG H 1 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG HH 0 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG H 1 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG HH 0 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		BDMG H 1 Bright A_SpawnItemEx("DarkMatterGunProj1Trail",0,0,0,frandom(-1,1),frandom(-1,1),frandom(-1,1),0,SXF_NOCHECKPOSITION,0)
		Goto Spawn+1
	Death:
		TNT1 A 0 A_SpawnItemEx("DMVaporSpawner",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_Explode(128,128,0)
		TNT1 A 15 A_StopSoundEx("soundslot5")
		Stop
	}
}

Actor DarkMatterGunProj1Trail : DarkMatterTrail1
{
	RenderStyle translucent
	Scale 0.25
	Alpha 0.5
	PROJECTILE
	Translation "0:255=%[0.0,0.0,0.01]:[0.3,0.0,0.6]"
	States
	{
	Spawn:
		BDMG A 2 Bright A_FadeOut(0.04)
		Loop
	}
}

Actor DMVaporSpawner
{
	+NOINTERACTION
	RenderStyle none
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 AAAAAAAAAAAAAAAAAAAAAAAAA 0 A_SpawnItemEx("DMVapor",0,0,0,frandom(4,-4),frandom(4,-4),frandom(4,-4),random(0,359),SXF_NOCHECKPOSITION)
		PLAY A 2
		PLAY BCDEF 4
		Stop
	}
}

Actor DMVapor
{
	PROJECTILE
	+NOINTERACTION
	+RANDOMIZE
	Damage 0
	Speed 0
	Radius 2
	Height 2
	RenderStyle Translucent
	Scale 0.65
	Alpha 0.5
	BounceType "Doom"
	Translation "0:255=%[0.0,0.0,0.01]:[0.3,0.0,0.6]"
	States
	{
	Spawn:
		PUF2 MNOPQRSTUVWXYZ 1 Bright A_FadeOut(0.018)
		PUF3 ABC 2 A_FadeOut(0.018)
		Stop
	}
}

//==================================================================================
//==================================================================================
// New Dark Matter Gun FX - Major Cooke
// Further edit by DBT
//==================================================================================
//==================================================================================

Actor DMGExplosionFX
{
	var int user_angle;
	var int user_count;
	+NOINTERACTION
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SetUserVar("user_angle",0)
		TNT1 A 0 A_SetUserVar("user_count",0)
		TNT1 A 0 A_SpawnItemEx("DMGSuction",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
	ShockEmission:
		TNT1 A 0 A_SpawnItemEx("DMGShockwave1up",5,0,4,10,0,0,user_angle,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("DMGShockwave1down",5,0,-4,10,0,0,user_angle+5,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SetUserVar("user_angle",user_angle+10)
		TNT1 A 0 A_JumpIf(user_angle>=359,"ParticleMaelstrom")
		Loop
	ParticleMaelstrom:
		TNT1 AAAAAAA 0 A_SpawnItemEx("DMGParticle1",0,0,0,random(25,150),0,random(-150,150),random(0,359),SXF_NOCHECKPOSITION,210)
		TNT1 A 1 A_SetUserVar("user_count",user_count+1)
		TNT1 A 0 A_JumpIf(user_count>=125,1)
		Loop
		TNT1 A 0
		Stop
	}
}

Actor DMGShockwave1up
{
	var int user_scale;
	+NOINTERACTION
	RenderStyle Add
	Scale 0.3
	States
	{
	Spawn:
		TNT1 A 0 NoDelay A_SetScale(ScaleX*randompick(-1,1),ScaleY*randompick(-1,1))
		X048 A 0 A_SetUserVar("user_scale",scaleX*100)
	Moving:
		X048 A 1 Bright A_SetScale((user_scale*0.01))
		X048 A 0 A_SetUserVar("user_scale",user_scale+1)
		X048 A 0 A_FadeOut(0.02)
		Loop
	}
}

Actor DMGShockwave1down : DMGShockwave1up
{ }

Actor DMGParticle1
{
	var int user_count;
	+NOINTERACTION
	RenderStyle Add
	Scale 0.15
	Alpha 0
	States
	{
	Spawn:
		TNT1 A 0 NoDelay A_SetScale(ScaleX*randompick(-1,1),ScaleY*randompick(-1,1))
		X048 ABCDE 0 A_JumpIf(random(1,5) == 1,"Playoff")
	Playoff:
		"####" "#" 2
		"####" "#" 0 A_ScaleVelocity(0.01)
		"####" "#" 0 A_ScaleVelocity(-1)
	Movement:
		"####" "#" 0 Bright A_FadeIn(0.02)
		"####" "#" 0 Bright A_ScaleVelocity(1.04) //I'm doing this wrong... Aren't I...
		"####" "#" 0 Bright A_SetUserVar("user_count",user_count+1)
		"####" "#" 1 Bright A_JumpIf(user_count>=50,1)
		Loop
	Freeflyer:
		"####" "#" 15 Bright 
		Stop
	}
}

Actor DMGSuctionSizer
{
	var int user_c;
	var int user_x;
	+NOINTERACTION
	RenderStyle None
	States
	{
	Spawn:
		TNT1 A 1 NoDelay A_SetUserVar(user_x,400)
	Waiting:
		TNT1 A 0 A_SetUserVar(user_x,user_x-2)
		TNT1 A 1 A_SetScale((user_x/100.0),0,AAPTR_MASTER)
		TNT1 A 0 A_JumpIf(user_x > 0, "Waiting")
		Stop
	}
}

Actor DMGSuction
{
	var int user_angle;
	+NOINTERACTION
	RenderStyle Add
	Alpha 0.0
	Scale 4.0
	States
	{
	Spawn:
		TNT1 A 0 NoDelay A_SetScale(ScaleX*randompick(-1,1),ScaleY*randompick(-1,1))	//one hell of a big code, true, but in game, this looks very nice -DBT
		Q27A A 0 A_SpawnItemEx("DMGSuctionSizer",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER|SXF_ORIGINATOR)
		Q27A ABCDEFGHIJ 1 Bright Light("DMGDarkness") A_FadeIn(0.1,FTF_CLAMP)
		Q27A KLMNOPQRSTUVWXYZ 1 Bright Light("DMGDarkness") A_JumpIf(ScaleX <= 0.0,"Death")
	Looping:
		Q27B ABCDEFGHIJKLMNOPQRSTUVWX 1 Bright Light("DMGDarkness") A_JumpIf(ScaleX <= 0.0,"Death")
		Q27A ABCDEFGHIJKLMNOPQRSTUVWXYZ 1 Bright Light("DMGDarkness") A_JumpIf(ScaleX <= 0.0,"Death")
		Loop
	Death:
		TNT1 A 0 A_RemoveChildren(1,RMVF_EVERYTHING,"DMGSuctionSizer")
		TNT1 AAAAAAAAAAAAAAAAAAAAA 0 A_SpawnItemEx("DMGSuckPopper",0,0,0,frandom(7,-7),0,frandom(7,-7),random(0,359),SXF_NOCHECKPOSITION)
		TNT1 AAAAAAAAAAAAAAAAAAAAA 0 A_SpawnItemEx("DMGSuckPopper",0,0,0,frandom(7,-7),0,frandom(7,-7),random(0,359),SXF_NOCHECKPOSITION)
		TNT1 A 1
		Stop
	}
}

Actor DMGSuckPopper
{
	var int user_scale;
	+NOINTERACTION
	Scale 0.6
	Translation "0:255=%[0,0,0]:[1,1,1]"
	RenderStyle Add
	States
	{
	Spawn:
		TNT1 A 0 NoDelay A_SetScale(ScaleX*randompick(-1,1),ScaleY*randompick(-1,1))
		Q27B AEILRV 0 A_JumpIf(random(1,9) == 1,"PreSizing")
		Q27A DFO 0 A_JumpIf(random(1,3) == 1, "PreSizing")
	PreSizing:
		"####" "#" 0 A_SetUserVar("user_scale",scaleX*100)
	Sizing:
		"####" "#" 2 A_SetScale((user_scale*0.01))
		"####" "#" 0 A_SetUserVar("user_scale",user_scale+6)
		"####" "#" 0 A_FadeOut(0.03)
		Loop
	}
}

Actor DarkMatterGunDrop : AEoDWeaponDrop
{
	Inventory.MaxAmount 1
	States
	{
	Use:
		TNT1 A 0
		TNT1 A 0 A_StopSound(6)
		TNT1 A 0 A_SpawnItemEx("DroppedDarkMatterGun",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		Stop
	}
}

Actor DroppedDarkMatterGun
{
	Radius 16
	Height 20
	Scale 0.25
	States
	{
	Spawn:
		Q4DM A 15
		TNT1 A 0 A_SpawnItemEx("AEoDDarkMatterGunNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
}

Actor AEoDDarkMatterGunNoAmmo : AEoDDarkMatterGunItem
{
	+FLOORCLIP
	+IGNORESKILL	+DONTGIB
	Scale 0.25
	Inventory.Amount 1
	Inventory.PickupMessage "You got the Dark Matter Gun!!"
	Inventory.PickupSound "reilsss/weappickup/qsg"
	States
	{
	Spawn:
		Q4DM A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",0) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("AECell",80,"Ammo")
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("DarkMatterGunDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDDarkMatterGun",1)
		TNT1 A 0 A_TakeInventory("AECell",80)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDDarkMatterGun",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,0,147,0)
		Fail
	Ammo:
		TNT1 A 0 A_TakeInventory("AECell",80)
		TNT1 A 0 A_JumpIfInventory("AEoDDarkMatterGun",1,2)
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("DarkMatterGunDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDDarkMatterGun",1)
		Stop
	}
}

//==================================================================================
//==================================================================================

//==================================================================================
//==================================================================================

Actor AEoDFusionCannonItem : AEoDWeaponPickup 6112
{
	+FLOORCLIP
	+IGNORESKILL	+DONTGIB
	Scale 0.7
	Inventory.Amount 1
	Inventory.PickupMessage "You got the Fusion Generator Prototype" 
	Inventory.PickupSound "reilsss/weappickup/qsg"
	States
	{
	Spawn:
		R053 I -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDFusionCannon",1,"Ammo")
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",0) <= 0,"Nothing")
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("FusionCannonDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDFusionCannon",1)
		TNT1 A 0 A_PrintBold("\cgSlot 10: Fusion Cannon")
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDFusionCannon",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,0,149,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDFusionCannon",1)
		Stop
	}
}

Actor AEoDFusionCannon : AEoDWeaponBase // 6112
{
	+FLOORCLIP
	+IGNORESKILL	+DONTGIB
	+WEAPON.CHEATNOTWEAPON
	Weapon.Kickback 100
	Weapon.AmmoType1 "AECell"
	Weapon.AmmoType2 "AECell"
	Weapon.AmmoGive1 80
	Weapon.AmmoUse1 40
	Weapon.AmmoUse2 200			 //80 cells for killing just about anything was certainly not enough
	Weapon.SelectionOrder 19500
	Inventory.PickupMessage "You got the Fusion Generator Prototype" 
	Inventory.PickupSound "reilsss/weappickup/qsg"
	Weapon.upsound "weapons/bfg/draw"
	Scale 0.7
	Tag "Fusion cannon"
	states
	{
	Spawn:
		R053 I -1
		Loop
	Select:
		TNT1 A 0 	
		R059 A 1 A_Raise
		TNT1 AA 0 A_Raise
		Loop
	Deselect:
		TNT1 A 0 A_StopSound(6)
		TNT1 A 0 	
		R059 A 1 A_Lower 
		TNT1 AA 0 A_Lower
		Goto Deselect+1
	Ready:
		TNT1 A 0 A_PlaySound("reilsss/weapons/fusionidle1", 6, 1.0, 1)
		R059 ABCDEF 3 A_WeaponReady
		Goto Ready+1
	Fire: 
		TNT1 A 0 A_PlaySound("reilsss/weapons/fusioncannonfire", CHAN_WEAPON, 1.0, 0)
		R059 FGHIJKLMNO 2
		R059 P 4 A_Light2
		R059 Q 4 A_Light1
		TNT1 A 0 A_Recoil(4)
		R059 R 0 A_FireCustomMissile("FusionBall",-1,1,8,0)
		R059 R 0 A_SetPitch(pitch-16)
		R059 RRRR 1 A_SetPitch(pitch+1)
		TNT1 A 0 A_Light0
		R059 SSSSTTTTUUUV 1 A_SetPitch(pitch+1)
		R059 V 2
		R059 WXYZ 3
		R059 A 4
		Goto Ready+6
	AltFire: 
		TNT1 A 0 A_PlaySound("reilsss/weapons/fusioncannonaltfire", CHAN_WEAPON, 1.0, 0)
		R059 FGHIJKLMNO 4
		R059 P 4 A_Light2
		R059 Q 4 A_Light1
		TNT1 A 0 A_Recoil(10)
		R059 R 0 A_FireCustomMissile("FusionSun",-1,1,7,0)
		R059 R 0 A_SetPitch(pitch-16)
		R059 RRRR 1 A_SetPitch(pitch+1)
		TNT1 A 0 A_Light0
		R059 SSSSTTTTUUUV 1 A_SetPitch(pitch+1)
		R059 V 2
		R059 WXYZ 3
		R059 A 4
		Goto Ready+6
	} 
}

Actor FusionBall
{
	PROJECTILE
	+FORCERADIUSDMG
	+SEEKERMISSILE
	+DONTREFLECT
	Radius 6
	Height 8
	Speed 30
	Damage 200
	RENDERSTYLE ADD
	ALPHA 0.90
	Damagetype "Plasma"
	DeathSound "reilsss/weapons/bfg9kexplosion"
	States
	{
	Spawn:
		R057 AB 4 Bright A_SeekerMissile(45,45)
		R057 A 0 A_SpawnItem("FusionBallTrail",0,0,0)
		R057 A 4 Bright A_SeekerMissile(45,45,SMF_LOOK,200)
		TNT1 A 0 Bright A_Explode(128,64,0)
		TNT1 A 0 A_SpawnItem("FusionBallTrail",0,0,0)
		TNT1 A 0 Bright A_Jump(160,3)
		TNT1 AAA 0 Bright A_CustomMissile("FusionLite",0,0,Random(0,360))
		R057 B 4 Bright A_SeekerMissile(45,45,SMF_LOOK,200)
		TNT1 A 0 Bright A_Explode(128,64,0)
		TNT1 A 0 A_SpawnItem("FusionBallTrail",0,0,0)
		TNT1 A 0 Bright A_Jump(160,3)
		TNT1 AAA 0 Bright A_CustomMissile("FusionLite",0,0,Random(0,360))
		Goto Spawn+4
	Death:
		TNT1 A 0 A_Scream 
		R057 C 0 Bright A_SpawnItemEx("FusionPFX",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		R057 C 4 Bright 
		R057 D 0 Bright A_Explode(850,512,0)
		TNT1 A 0 Bright A_CustomMissile("FusionBall2",0,0,18+random(-18,18),6)
		TNT1 A 0 Bright A_CustomMissile("FusionBall2",0,0,36+random(-18,18),6)
		TNT1 A 0 Bright A_CustomMissile("FusionBall2",0,0,54+random(-18,18),6)
		TNT1 A 0 Bright A_CustomMissile("FusionBall2",0,0,72+random(-18,18),6)
		TNT1 A 0 Bright A_CustomMissile("FusionBall2",0,0,90+random(-18,18),6)
		TNT1 A 0 Bright A_CustomMissile("FusionBall2",0,0,108+random(-18,18),6)
		TNT1 A 0 Bright A_CustomMissile("FusionBall2",0,0,126+random(-18,18),6)
		TNT1 A 0 Bright A_CustomMissile("FusionBall2",0,0,144+random(-18,18),6)
		TNT1 A 0 Bright A_CustomMissile("FusionBall2",0,0,144+random(-18,18),6)
		TNT1 A 0 Bright A_CustomMissile("FusionBall2",0,0,162+random(-18,18),6)
		TNT1 A 0 Bright A_CustomMissile("FusionBall2",0,0,183+random(-18,18),6)
		TNT1 A 0 Bright A_CustomMissile("FusionBall2",0,0,197+random(-18,18),6)
		TNT1 A 0 Bright A_CustomMissile("FusionBall2",0,0,216+random(-18,18),6)
		TNT1 A 0 Bright A_CustomMissile("FusionBall2",0,0,234+random(-18,18),6)
		TNT1 A 0 Bright A_CustomMissile("FusionBall2",0,0,252+random(-18,18),6)
		TNT1 A 0 Bright A_CustomMissile("FusionBall2",0,0,270+random(-18,18),6)
		TNT1 A 0 Bright A_CustomMissile("FusionBall2",0,0,288+random(-18,18),6)
		TNT1 A 0 Bright A_CustomMissile("FusionBall2",0,0,306+random(-18,18),6)
		TNT1 A 0 Bright A_CustomMissile("FusionBall2",0,0,324+random(-18,18),6)
		TNT1 A 0 Bright A_CustomMissile("FusionBall2",0,0,342+random(-18,18),6)
		R057 DEFG 4 Bright
		R057 H 3 Bright
		Stop
	}
}

Actor FusionBall2
{
	PROJECTILE
	RipperLevel 2
	+FORCERADIUSDMG
	+RIPPER
	Radius 8
	Height 4
	Speed 16
	Damage 1
	SeeSound "reilsss/weapons/soulreaverfire"
	DeathSound "reilsss/weapons/ioncannonexplosion"
	RENDERSTYLE ADD
	DamageType "Plasma"
	ALPHA 0.90
	States
	{
	Spawn:
		R057 IJ 4 Bright A_SpawnItem ("FusionBall2Trail",0,0,0)
		Loop
	Death:
		R057 K 1 Bright
		R057 K 3 Bright A_Explode(32,32,0)
		R057 LM 4 Bright
		Stop
	}
}

Actor FusionLite
{
	PROJECTILE
	-FORCERADIUSDMG
	Radius 8
	Height 12
	Speed 32
	Damage 15
	DamageType "Plasma"
	SeeSound "reilsss/weapons/ligthingrodaltfire"
	DeathSound "reilsss/weapons/ligthingrodfire" 
	RENDERSTYLE ADD
	ALPHA 0.85
	States
	{
	Spawn:
		R058 AAABBBCCC 1 Bright A_SpawnItem ("FusionLiteTrail",0,0,0)
		Loop
	Death:
		R058 DEFGHIJKLMNO 1 Bright
		Stop
	}
}

Actor FusionLiteTrail
{
	PROJECTILE
	+NOINTERACTION
	Radius 1
	Height 1
	RENDERSTYLE ADD
	ALPHA 0.67
	States
	{
	Spawn:
		R058 ABC 3 Bright
		Stop
	}
}

Actor FusionBallTrail
{
	PROJECTILE
	+NOINTERACTION
	Radius 1
	Height 1
	RENDERSTYLE ADD
	ALPHA 0.67
	Scale 0.75
	States
	{
	Spawn:
		R057 ABABAB 3 Bright A_FadeOut(0.1)
		Stop
	}
}

Actor FusionBall2Trail
{
	PROJECTILE
	+NOINTERACTION
	Radius 1
	Height 1
	RENDERSTYLE ADD
	ALPHA 0.67
	Scale 0.75
	States
	{
	Spawn:
		R057 IJIJIJ 3 Bright A_FadeOut(0.1)
		Stop
	}
}

Actor FusionSunTrail
{
	PROJECTILE
	+NOINTERACTION
	Radius 1
	Height 1
	RENDERSTYLE ADD
	ALPHA 0.9
	Scale 0.5
	States
	{
	Spawn:
		R053 AAABBBCCC 2 Bright A_FadeOut(0.05)
		Loop
	}
}

Actor FusionSun
{
	PROJECTILE
	+SEEKERMISSILE
	+EXTREMEDEATH
	+FULLVOLDEATH
	+FORCERADIUSDMG
	+DONTREFLECT
	Radius 8
	Height 10
	Speed 8
	Damage 200
	DamageType "Plasma"
	DeathSound "reilsss/weapons/fusionexplosion"
	RENDERSTYLE ADD
	ALPHA 0.90
	Scale 0.50
	States
	{
	Spawn:
		R053 A 3 Bright A_SeekerMissile(45,45,SMF_LOOK)
		TNT1 AAAA 0 A_SpawnItemEx("FTFlameTrailMini",random(-24,24),random(10,-5),random(0,20),0,0,frandom(0,2),0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItem ("FusionSunTrail",0,0,0)
		TNT1 A 0 Bright A_Explode(64,64,0)
		R053 B 3 Bright A_SeekerMissile(45,45,SMF_LOOK)
		TNT1 AAAA 0 A_SpawnItemEx("FTFlameTrailMini",random(-24,24),random(10,-5),random(0,20),0,0,frandom(0,2),0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItem ("FusionSunTrail",0,0,0)
		TNT1 A 0 Bright A_Explode(64,64,0)
		R053 C 3 Bright A_SeekerMissile(45,45,SMF_LOOK)
		TNT1 AAAA 0 A_SpawnItemEx("FTFlameTrailMini",random(-24,24),random(10,-5),random(0,20),0,0,frandom(0,2),0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItem ("FusionSunTrail",0,0,0)
		TNT1 A 0 Bright A_Explode(64,64,0)
		Goto Spawn
	Death:
		TNT1 A 0 A_Scream 
		TNT1 A 0 A_SpawnItemEx("FusionShockwave",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER)
		TNT1 A 0 A_SpawnItemEx("FusionMainExplo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 10 A_SpawnItemEx("Fusionboom2",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER)
		Stop 
	}
}
Actor FusionMainExplo 	// Fireish explosion animation
{
	+NOINTERACTION
	Scale 3.5
	States
	{
	Spawn:
		X111 ABCDEFGHIJKLMNOPQRSTUVWXYZ 2 Bright
		Stop
	}
}
Actor FusionShockwave
{
	var int user_count;
	var int user_sub;
	+NOINTERACTION
	RenderStyle Add
	XScale 0.12
	YScale 0.4
	Alpha 0.95
	Translation "0:255=%[0,0,0]:[1.5,0.7,0.0]"
	States
	{
	Spawn:
		X122 A 0
		X122 ABCD 1 Bright A_SetScale(ScaleX+(0.42),ScaleY+(0.02))
		X122 EFG 1 Bright A_SetScale(ScaleX+(0.34),ScaleY+(0.02))
		X122 HIJK 1 Bright A_SetScale(ScaleX+(0.24),ScaleY+(0.02))
		X122 LMNOP 1 Bright A_SetScale(ScaleX+(0.2),ScaleY+(0.02))
	Fading:
		X122 A 0 A_SetScale(ScaleX+(0.12),ScaleY+(0.02))	X122 A 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.12),ScaleY+(0.02))	X122 B 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.12),ScaleY+(0.02))	X122 C 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.12),ScaleY+(0.02))	X122 D 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.12),ScaleY+(0.02))	X122 E 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.12),ScaleY+(0.02))	X122 F 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.12),ScaleY+(0.02))	X122 G 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.12),ScaleY+(0.02))	X122 H 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.12),ScaleY+(0.02))	X122 I 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.12),ScaleY+(0.02))	X122 J 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.12),ScaleY+(0.02))	X122 K 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.12),ScaleY+(0.02))	X122 L 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.12),ScaleY+(0.02))	X122 M 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.12),ScaleY+(0.02))	X122 N 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.12),ScaleY+(0.02))	X122 O 1 Bright A_FadeOut(0.02)
		X122 A 0 A_SetScale(ScaleX+(0.12),ScaleY+(0.02))	X122 P 1 Bright A_FadeOut(0.02)
		Loop
	}
}

//*******************************************
Actor FusionBoom2
{   
	var int user_angle;
	PROJECTILE
	+FORCERADIUSDMG
	+NOINTERACTION
	+EXTREMEDEATH
	Speed 0
	Scale 2
	DamageType "Plasma"
	RenderStyle None
	Alpha 1
	States
	{
	Spawn:
		TNT1 A 0 NoDelay A_Explode(random(3072,8192),796,0)
		TNT1 A 0 A_QuakeEx(8,8,0, 40,0,35,"", QF_SCALEDOWN)
		TNT1 A 0 A_SpawnItemEx("NewExplosionBig",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER)
		TNT1 A 0 A_CustomMissile("RedeemerExplosionGenerator",12,-1,315,6)
		TNT1 A 0 A_SetUserVar("user_angle",0)
	Looper:	
		TNT1 A 0 A_JumpIf(user_angle>=359,"EndLoop")
		TNT1 A 0 A_CustomMissile("FusionFireWall",0,0,user_angle+random(5,-5),6)
		TNT1 A 0 A_SetUserVar("user_angle",user_angle+15)
		Loop
	EndLoop:
		CB02 A 0 Bright A_CustomMissile("FusionBall3",32,1,45,6)
		CB02 A 0 Bright A_CustomMissile("FusionBall3",25,1,0,6)
		CB02 A 0 Bright A_CustomMissile("FusionBall3",12,1,135,6)
		CB02 A 0 Bright A_CustomMissile("FusionBall3",4,1,90,6)
		CB02 A 0 Bright A_CustomMissile("FusionBall3",1,-1,225,6)
		CB02 ABCDEF 5 Bright A_Explode(64,512,0)
		CB02 GHIJKL 6 Bright A_Explode(64,512,0)
		CB02 MNOPQRS 4 Bright A_Explode(64,512,0) 
		Stop
	}
}

//*******************************************
Actor FusionFireWall
{
	var int user_count;
	Projectile
	+FLOORHUGGER
	+FORCERADIUSDMG
	+RIPPER
	RipperLevel 2
	Radius 8
	Height 12
	Damage 7
	Speed 20
	Obituary "%o was dissolved by a Fusion Flamewall."
	DeathSound "reilsss/weapons/fusionfire"
	DamageType "Fire"
	+NODAMAGETHRUST +CANNOTPUSH
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 AA 0 A_SpawnItemEx("IncendiaryFlamelet1",random(-10,25),random(-35,35),random(0,30),random(1,10),0,frandom(0.2,3),0,SXF_NOCHECKPOSITION)
		TNT1 AAA 0 A_SpawnItemEx("IncendiaryFlamelet1",random(-10,25),random(-35,35),random(0,30),random(1,10),0,frandom(0.2,3),0,SXF_NOCHECKPOSITION,220)
		TNT1 A 0 A_SpawnItemEx("FlmThrwrSmoke5",random(-10,25),random(-35,35),random(20,40),0,0,frandom(0.2,3),0,SXF_NOCHECKPOSITION,128)
		TNT1 A 1 A_Explode(random(1,5),256,1,0,128)
		Loop
	Death:
		TNT1 A 0 A_SpawnItemEx("PBExplosionSpawnerSmokeless",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_Explode(96,64,0)
		Stop
	}
}

//*******************************************
Actor FusionBall3
{
	PROJECTILE
	+EXTREMEDEATH
	+FORCERADIUSDMG
	+DONTREFLECT
	Radius 12
	Height 8
	Speed 10
	Damage 50
	RENDERSTYLE ADD
	ALPHA 0.90
	DamageType "Plasma"
	DeathSound "reilsss/weapons/bfg9kexplosion"
	States
	{
	Spawn:
		R057 A 4 Bright A_Explode(40,64,0)
		R057 A 0 A_SeekerMissile(45,45,SMF_LOOK,200)
		TNT1 A 0 A_SpawnItem("FusionBallTrail",0,0,0)
		R057 B 4 Bright A_Explode(40,64,0)
		R057 A 0 A_SeekerMissile(45,45,SMF_LOOK,200)
		TNT1 A 0 A_SpawnItem("FusionBallTrail",0,0,0)
		Loop
	Death:
		TNT1 A 0 A_Scream 
		R057 C 5 Bright 
		R057 D 0 Bright A_Explode(128,128,0)
		TNT1 A 0 Bright A_CustomMissile("FusionLite2",0,0,18,6)
		TNT1 A 0 Bright A_CustomMissile("FusionBall4",0,0,36,6)
		TNT1 A 0 Bright A_CustomMissile("FusionLite2",0,0,54,6)
		TNT1 A 0 Bright A_CustomMissile("FusionBall4",0,0,72,6)
		TNT1 A 0 Bright A_CustomMissile("FusionLite2",0,0,90,6)
		TNT1 A 0 Bright A_CustomMissile("FusionBall4",0,0,108,6)
		TNT1 A 0 Bright A_CustomMissile("FusionLite2",0,0,126,6)
		TNT1 A 0 Bright A_CustomMissile("FusionBall4",0,0,144,6)
		TNT1 A 0 Bright A_CustomMissile("FusionLite2",0,0,144,6)
		TNT1 A 0 Bright A_CustomMissile("FusionBall4",0,0,162,6)
		TNT1 A 0 Bright A_CustomMissile("FusionLite2",0,0,183,6)
		TNT1 A 0 Bright A_CustomMissile("FusionBall4",0,0,197,6)
		TNT1 A 0 Bright A_CustomMissile("FusionLite2",0,0,216,6)
		TNT1 A 0 Bright A_CustomMissile("FusionBall4",0,0,234,6)
		TNT1 A 0 Bright A_CustomMissile("FusionLite2",0,0,252,6)
		TNT1 A 0 Bright A_CustomMissile("FusionBall4",0,0,270,6)
		TNT1 A 0 Bright A_CustomMissile("FusionLite2",0,0,288,6)
		TNT1 A 0 Bright A_CustomMissile("FusionBall4",0,0,306,6)
		TNT1 A 0 Bright A_CustomMissile("FusionLite2",0,0,324,6)
		TNT1 A 0 Bright A_CustomMissile("FusionBall4",0,0,342,6)
		R057 DEFG 5 Bright
		R057 HI 3 Bright
		Stop
	}
}

Actor FusionBall4
{
	PROJECTILE
	+FORCERADIUSDMG
	+RIPPER
	RipperLevel 2
	+DONTREFLECT
	Radius 8
	Height 8
	Speed 16
	Damage 1
	DamageType "Plasma"
	SeeSound "reilsss/weapons/soulreaverfire"
	DeathSound "reilsss/weapons/ioncannonexplosion" 
	RENDERSTYLE ADD
	ALPHA 0.90
	States
	{
	Spawn:
		R057 IJ 4 Bright A_SpawnItem("FusionBall2Trail",0,0,0)
		Loop
	Death:
		R057 K 1 Bright
		R057 K 3 Bright A_Explode(16,16,0)
		R057 LM 4 Bright
		Stop
	}
}

Actor FusionLite2
{
	PROJECTILE
	-FORCERADIUSDMG
	Radius 8
	Height 12
	Speed 32
	Damage 7
	DamageType "Plasma"
	SeeSound "reilsss/weapons/ligthingrodaltfire"
	DeathSound "reilsss/weapons/ligthingrodfire" 
	RENDERSTYLE ADD
	ALPHA 0.85
	States
	{
	Spawn:
		R058 AAABBBCCC 1 Bright A_SpawnItem ("FusionLiteTrail",0,0,0)
		Loop
	Death:
		R058 DEFGHIJKLMNO 1 Bright
		Stop
	}
}


Actor FusionCannonDrop : AEoDWeaponDrop
{
	Inventory.MaxAmount 1
	States
	{
	Use:
		TNT1 A 0
		TNT1 A 0 A_StopSound(6)
		TNT1 A 0 A_SpawnItemEx("DroppedFusionCannon",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		Stop
	}
}

Actor DroppedFusionCannon
{
	Radius 16
	Height 20
	Scale 0.7
	States
	{
	Spawn:
		R053 I 15
		TNT1 A 0 A_SpawnItemEx("AEoDFusionCannonNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
}

Actor AEoDFusionCannonNoAmmo : AEoDFusionCannonItem
{
	+FLOORCLIP
	+IGNORESKILL	+DONTGIB
	Scale 0.7
	Inventory.Amount 1
	Inventory.PickupMessage "You got the Fusion Generator Prototype" 
	Inventory.PickupSound "reilsss/weappickup/qsg"
	States
	{
	Spawn:
		R053 I -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",0) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("AECell",80,"Ammo")
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("FusionCannonDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDFusionCannon",1)
		TNT1 A 0 A_TakeInventory("AECell",80)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDFusionCannon",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,0,149,0)
		Fail
	Ammo:
		TNT1 A 0 A_TakeInventory("AECell",80)
		TNT1 A 0 A_JumpIfInventory("AEoDFusionCannon",1,2)
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("FusionCannonDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDFusionCannon",1)
		Stop
	}
}

//==================================================================================
//==================================================================================
//The Inferno Syphon -- Originally by Reilsss, completely remade by Major Cooke.
//The Weapon of Chance
//Come one, come all! If ye be feelin' a lucky bastard, then try your luck with the Inferno Syphon!
//Ye may just get lucky enough tah' hit the jack pot on this one if yah get... Yes, that'd be right, boy... 
//...Lucky!

/*
This device is neither holy nor unholy, but belonging to that of a cult
revolving around the Death Bringer's beliefs. Another priceless artifact stolen
by Hell's forces long ago, it has been used to convert life into ammunition and
concecrate ground with Death's natural flames for a small period of time.

Few know how to use it, and fewer still comprehend it's true purpose. The wizard
Lich King has attempted to use it on a few occasions, but it does not work to
his desires, despite his extreme powers. Rumor has it that this weapon was
intended only for the living, the reverse of the Darkness. Death may even be
denying any hellspawn or heavensent the right to use this, so as to discover a
human worthy of defending their home planet from destruction...

Empowered with both light and darkness, this weapon can convert the very essence
of the wielder's enemies into ammunition, save for one... One who does not need
it, the one of strength, protection, and knowledge of the Three.
*/

//==================================================================================
//==================================================================================

Actor AEoDInfernoItem : AEoDWeaponPickup 6111
{
	+FLOORCLIP
	+IGNORESKILL	+DONTGIB
	+FLOATBOB
	Inventory.Amount 1
	Inventory.PickupMessage "You found the inferno syphon! You lucky bastard..."
	Inventory.PickupSound "weaponbuild" 
	States
	{
	Spawn:
		RP01 A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDInferno",1,"Ammo")
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",0) <= 0,"Nothing")
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("InfernoDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDInferno",1)
		TNT1 A 0 A_PrintBold("\cgSlot 10: Inferno Syphon")
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDInferno",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,0,156,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDInferno",1)
		Stop
	}
}

Actor AEoDInferno : AEoDWeaponBase // 6111
{ 
	+FLOORCLIP
	+IGNORESKILL	+DONTGIB
	+WEAPON.CHEATNOTWEAPON 
	+INVENTORY.FANCYPICKUPSOUND
	+FLOATBOB
	Weapon.AmmoType1 "DarkMana"
	Weapon.AmmoType2 "DarkMana"
	Weapon.AmmoGive1 25
	Weapon.AmmoGive2 0
	Weapon.AmmoUse1 4
	Weapon.AmmoUse2 10
	Weapon.SelectionOrder 11840
	Obituary "%k turned %o's life into syphoned mana."
	Inventory.PickupMessage "You found the inferno syphon! You lucky bastard..."
	Inventory.PickupSound "weaponbuild" 
	Weapon.upsound "weapons/draw"
	Tag "Inferno syphon"
	States 
	{ 
	Spawn: 
		RP01 A 10
		Loop
	Ready: 
		TNT1 A 0 A_PlaySound("MajorCooke/Weapons/Inferno/IdleHum", 6, 0.5, 1)
		RW01 A 1 A_WeaponReady 
		Goto Ready+1
	Deselect: 
		TNT1 A 0 A_StopSound(6)
		TNT1 A 0 	
		RW01 A 1 A_Lower 
		TNT1 AA 0 A_Lower
		Goto Deselect+1
	Select: 
		TNT1 A 0 	
		RW01 A 1 A_Raise
		TNT1 AA 0 A_Raise 
		Loop
	Fire:
		RW01 A 8 bright
		RW01 A 0 A_Jump(32,"DarkSyphonFire")
		RW01 A 0 A_Jump(256,"GreenSyphonFire","BlueSyphonFire","RedSyphonFire","DarkSyphonFire") //2nd most common
	BlueSyphonFire:
		RW01 H 0 Bright A_SetBlend("Blue",0.25,10)
		RW01 H 0 Bright A_PlayWeaponSound("MajorCooke/Weapons/Inferno/PrimaryFire")
		RW01 H 0 Bright A_FireCustomMissile("BlueSyphonMissile",0,1,0)
		RW01 H 0 Bright A_FireCustomMissile("BlueSyphonMissile",5,0,0)
		RW01 H 0 Bright A_FireCustomMissile("BlueSyphonMissile",-5,0,0)
		RW01 H 0 Bright A_FireCustomMissile("BlueSyphonMissile",10,0,0)
		RW01 H 5 Bright A_FireCustomMissile("BlueSyphonMissile",-10,0,0)
		RW01 A 12 bright
		Goto Ready
	GreenSyphonFire:
		RW01 G 0 Bright A_SetBlend("Green",0.25,10)
		RW01 G 0 Bright A_PlayWeaponSound("MajorCooke/Weapons/Inferno/PrimaryFire")
		RW01 G 0 Bright A_FireCustomMissile("GreenSyphonMissile",0,1,0)
		RW01 G 0 Bright A_FireCustomMissile("GreenSyphonMissile",7.5,0,0)
		RW01 G 5 Bright A_FireCustomMissile("GreenSyphonMissile",-7.5,0,0)
		RW01 A 12 bright
		Goto Ready
	RedSyphonFire:
		RW01 F 0 Bright A_SetBlend("Red",0.25,10)
		RW01 F 0 Bright A_PlayWeaponSound("MajorCooke/Weapons/Inferno/PrimaryFire")
		RW01 F 0 Bright A_FireCustomMissile("RedSyphonMissile",2.5,1,0)
		RW01 F 5 Bright A_FireCustomMissile("RedSyphonMissile",-2.5,0,0)
		RW01 A 12 bright
		Goto Ready
	DarkSyphonFire:
		RW01 I 0 Bright A_SetBlend("Black",0.25,10)
		RW01 I 0 Bright A_PlayWeaponSound("MajorCooke/Weapons/Inferno/PrimaryFire")
		RW01 I 5 Bright A_FireCustomMissile("DarkSyphonMissile",0,1,0)
		RW01 A 12 bright
		Goto Ready
	AltFire:
		RW01 A 8 bright
		RW01 I 0 Bright A_Recoil(20)
		RW01 I 0 Bright A_SetBlend("Black",0.8,50)
		RW01 I 0 Bright A_PlayWeaponSound("MajorCooke/Weapons/Inferno/AltFire")
		RW01 I 5 Bright A_FireCustomMissile("ShadowSpireMissile",0,1,0)
		RW01 A 45 bright
		Goto Ready
	}
}

Actor DarkSyphonMissile 
{
	Height 8
	Radius 16
	Speed 12
	Scale 1.15
	Projectile
	+SKYEXPLODE
	+EXTREMEDEATH
	+FORCERADIUSDMG
	+DONTREFLECT
	+FORCEPAIN
	+SEEKERMISSILE
	+FOILINVUL
	Translation "0:255=%[0,0,0]:[0,0,0.3]"
	Damage 25
	DamageType "Unholy"
	DeathType "Disintegrate"
	SeeSound "MajorCooke/Weapons/Inferno/SSAttack"
	DeathSound "MajorCooke/Weapons/Inferno/ExploGeneral"
	RenderStyle Translucent
	Alpha .75
	States
	{
	Spawn:
		VO02 A 1 Bright A_SeekerMissile(10,10,SMF_LOOK|SMF_PRECISE,256)
		VO02 A 0 Bright A_CustomMissile("SyphonDarkShockwave",0,0,0,2)
		VO02 BC 1 Bright A_SeekerMissile(10,10,SMF_LOOK|SMF_PRECISE,256)
		VO02 D 0 A_Explode(6,256,0)
		//VO02 D 0 A_RadiusGive("SyphonDarkManaDropper",256,RGF_MONSTERS,1)
		VO02 D 1 Bright A_SeekerMissile(10,10,SMF_LOOK|SMF_PRECISE,256)
		VO02 D 0 Bright A_CustomMissile("SyphonDarkShockwave",0,0,0,2)
		VO02 EF 1 Bright A_SeekerMissile(10,10,SMF_LOOK|SMF_PRECISE,256)
		VO02 G 0 A_Explode(6,256,0)
		VO02 G 0 A_RadiusGive("SyphonDarkManaDropper",256,RGF_MONSTERS,1)
		VO02 G 1 Bright A_SeekerMissile(10,10,SMF_LOOK|SMF_PRECISE,256)
		VO02 G 0 Bright A_CustomMissile("SyphonDarkShockwave",0,0,0,2)
		VO02 HI 1 Bright A_SeekerMissile(10,10,SMF_LOOK|SMF_PRECISE,256)
		VO02 J 0 A_Explode(6,256,0)
		//VO02 J 0 A_RadiusGive("SyphonDarkManaDropper",256,RGF_MONSTERS,1)
		VO02 J 1 Bright A_SeekerMissile(10,10,SMF_LOOK|SMF_PRECISE,256)
		VO02 J 0 Bright A_CustomMissile("SyphonDarkShockwave",0,0,0,2)
		VO02 KL 1 Bright A_SeekerMissile(10,10,SMF_LOOK|SMF_PRECISE,256)
		VO02 A 0 A_Explode(6,256,0)
		//VO02 A 0 A_RadiusGive("SyphonDarkManaDropper",256,RGF_MONSTERS,1)
		Loop
	Death:
		VORX A 0 A_Scream
		VO02 D 0 A_RadiusGive("SyphonDarkManaDropper",256,RGF_MONSTERS,1)
		VORX A 0 A_Explode(256,256,0)
		VORX B 1 A_Explode(5,64,0)
		VORX CDEFGHIJLKMNOP 1 bright
		Stop
	}
}
  
Actor RedSyphonMissile : DarkSyphonMissile
{
	Radius 8
	Height 6
	Scale .90
	Alpha .5
	Translation "0:255=%[0,0,0]:[1,0,0]"
	DamageType "Fire"
	DeathType "Disintegrate"
	-FORCEPAIN
	States
	{
	Spawn:
			VO02 A 1 Bright A_SeekerMissile(10,10,SMF_LOOK|SMF_PRECISE,256)
			VO02 A 0 Bright A_CustomMissile("SyphonRedShockwave",0,0,0,2)
			VO02 BC 1 Bright A_SeekerMissile(10,10,SMF_LOOK|SMF_PRECISE,256)
			VO02 D 0 A_Explode(3,205,0)
			//VO02 D 0 A_RadiusGive("SyphonRedManaDropper",256,RGF_MONSTERS,1)
			VO02 D 1 Bright A_SeekerMissile(10,10,SMF_LOOK|SMF_PRECISE,256)
			VO02 D 0 Bright A_CustomMissile("SyphonRedShockwave",0,0,0,2)
			VO02 EF 1 Bright A_SeekerMissile(10,10,SMF_LOOK|SMF_PRECISE,256)
			VO02 G 0 A_Explode(3,205,0)
			VO02 G 0 A_RadiusGive("SyphonRedManaDropper",256,RGF_MONSTERS,1)
			VO02 G 1 Bright A_SeekerMissile(10,10,SMF_LOOK|SMF_PRECISE,256)
			VO02 G 0 Bright A_CustomMissile("SyphonRedShockwave",0,0,0,2)
			VO02 HI 1 Bright A_SeekerMissile(10,10,SMF_LOOK|SMF_PRECISE,256)
			VO02 J 0 A_Explode(3,205,0)
			//VO02 D 0 A_RadiusGive("SyphonRedManaDropper",256,RGF_MONSTERS,1)
			VO02 J 1 Bright A_SeekerMissile(10,10,SMF_LOOK|SMF_PRECISE,256)
			VO02 J 0 Bright A_CustomMissile("SyphonRedShockwave",0,0,0,2)
			VO02 KL 1 Bright A_SeekerMissile(10,10,SMF_LOOK|SMF_PRECISE,256)
			VO02 A 0 A_Explode(3,205,0)
			//VO02 D 0 A_RadiusGive("SyphonRedManaDropper",256,RGF_MONSTERS,1)
			Loop
	Death:
			VORX A 0 A_Scream
			VORX A 0 A_Explode(128,205,0)
			VO02 D 0 A_RadiusGive("SyphonRedManaDropper",256,RGF_MONSTERS,2)
			VORX A 1 Bright A_CustomMissile("SyphonRedShockwave",0,0,0,2)
			VORX BC 1 bright
			VORX D 1 Bright A_CustomMissile("SyphonRedShockwave",0,0,0,2)
			VORX EF 1 bright
			VORX G 1 Bright A_CustomMissile("SyphonRedShockwave",0,0,0,2)
			VORX HI 1 bright
			VORX J 1 Bright A_CustomMissile("SyphonRedShockwave",0,0,0,2)
			VORX KL 1 bright
			VORX M 1 Bright A_CustomMissile("SyphonRedShockwave",0,0,0,2)
			VORX NO 1 bright
			VORX P 1 Bright A_CustomMissile("SyphonRedShockwave",0,0,0,2)
			Stop
	}
}
 
Actor GreenSyphonMissile : DarkSyphonMissile
{
	Radius 5
	Height 4
	Scale .65
	Alpha .45
	Translation "0:255=%[0,0,0]:[0,1,0]"
	DamageType "Plasma"
	DeathType "Disintegrate"
	-FORCEPAIN
	States
	{
	Spawn:
		VO02 A 1 Bright A_SeekerMissile(10,10,SMF_LOOK|SMF_PRECISE,256)
		VO02 A 0 Bright A_CustomMissile("SyphonGreenShockwave",0,0,0,2)
		VO02 BC 1 Bright A_SeekerMissile(10,10,SMF_LOOK|SMF_PRECISE,256)
		VO02 D 0 A_Explode(2,128,0)
		//VO02 D 0 A_RadiusGive("SyphonGreenManaDropper",256,RGF_MONSTERS,1)
		VO02 D 1 Bright A_SeekerMissile(10,10,SMF_LOOK|SMF_PRECISE,256)
		VO02 D 0 Bright A_CustomMissile("SyphonGreenShockwave",0,0,0,2)
		VO02 EF 1 Bright A_SeekerMissile(10,10,SMF_LOOK|SMF_PRECISE,256)
		VO02 G 0 A_Explode(2,128,0)
		VO02 D 0 A_RadiusGive("SyphonGreenManaDropper",256,RGF_MONSTERS,1)
		VO02 G 1 Bright A_SeekerMissile(10,10,SMF_LOOK|SMF_PRECISE,256)
		VO02 G 0 Bright A_CustomMissile("SyphonGreenShockwave",0,0,0,2)
		VO02 HI 1 Bright A_SeekerMissile(10,10,SMF_LOOK|SMF_PRECISE,256)
		VO02 J 0 A_Explode(2,128,0)
		//VO02 D 0 A_RadiusGive("SyphonGreenManaDropper",256,RGF_MONSTERS,1)
		VO02 J 1 Bright A_SeekerMissile(10,10,SMF_LOOK|SMF_PRECISE,256)
		VO02 J 0 Bright A_CustomMissile("SyphonGreenShockwave",0,0,0,2)
		VO02 KL 1 Bright A_SeekerMissile(10,10,SMF_LOOK|SMF_PRECISE,256)
		VO02 A 0 A_Explode(2,128,0)
		//VO02 D 0 A_RadiusGive("SyphonGreenManaDropper",256,RGF_MONSTERS,1)
		Loop
	Death:
		VORX A 0 A_Scream
		VO02 A 0 A_RadiusGive("SyphonGreenManaDropper",256,RGF_MONSTERS,2)
		VORX A 0 A_Explode(90,128,0)
		VORX A 1 Bright A_CustomMissile("SyphonGreenShockwave",0,0,0,2)
		VORX BC 1 bright
		VORX D 1 Bright A_CustomMissile("SyphonGreenShockwave",0,0,0,2)
		VORX EF 1 bright
		VORX G 1 Bright A_CustomMissile("SyphonGreenShockwave",0,0,0,2)
		VORX HI 1 bright
		VORX J 1 Bright A_CustomMissile("SyphonGreenShockwave",0,0,0,2)
		VORX KL 1 bright
		VORX M 1 Bright A_CustomMissile("SyphonGreenShockwave",0,0,0,2)
		VORX NO 1 bright
		VORX P 1 Bright A_CustomMissile("SyphonGreenShockwave",0,0,0,2)
		Stop
	}
}
 
Actor BlueSyphonMissile : DarkSyphonMissile
{
	Radius 3
	Height 2
	Scale .5
	Alpha .4
	Translation "0:255=%[0,0,0]:[0,0,1]"
	DamageType "Ice"
	DeathType "Disintegrate"
	-FORCEPAIN
	States
	{
	Spawn:
		VO02 A 1 Bright A_SeekerMissile(10,10,SMF_LOOK|SMF_PRECISE,256)
		VO02 A 0 Bright A_CustomMissile("SyphonBlueShockwave",0,0,0,2)
		VO02 BC 1 Bright A_SeekerMissile(10,10,SMF_LOOK|SMF_PRECISE,256)
		VO02 D 0 A_Explode(1,95,0)
		//VO02 D 0 A_RadiusGive("SyphonBlueManaDropper",256,RGF_MONSTERS,1)
		VO02 D 1 Bright A_SeekerMissile(10,10,SMF_LOOK|SMF_PRECISE,256)
		VO02 D 0 Bright A_CustomMissile("SyphonBlueShockwave",0,0,0,2)
		VO02 EF 1 Bright A_SeekerMissile(10,10,SMF_LOOK|SMF_PRECISE,256)
		VO02 G 0 A_Explode(1,95,0)
		VO02 H 0 A_RadiusGive("SyphonBlueManaDropper",256,RGF_MONSTERS,1)
		VO02 G 1 Bright A_SeekerMissile(10,10,SMF_LOOK|SMF_PRECISE,256)
		VO02 G 0 Bright A_CustomMissile("SyphonBlueShockwave",0,0,0,2)
		VO02 HI 1 Bright A_SeekerMissile(10,10,SMF_LOOK|SMF_PRECISE,256)
		VO02 J 0 A_Explode(1,95,0)
		//VO02 J 0 A_RadiusGive("SyphonBlueManaDropper",256,RGF_MONSTERS,1)
		VO02 J 1 Bright A_SeekerMissile(10,10,SMF_LOOK|SMF_PRECISE,256)
		VO02 J 0 Bright A_CustomMissile("SyphonBlueShockwave",0,0,0,2)
		VO02 KL 1 Bright A_SeekerMissile(10,10,SMF_LOOK|SMF_PRECISE,256)
		VO02 A 0 A_Explode(1,95,0)
		//VO02 A 0 A_RadiusGive("SyphonBlueManaDropper",256,RGF_MONSTERS,1)
		Loop
	Death:
		VORX A 0 A_Scream
		VORX A 0 A_Explode(59,95,0)
		VORX A 0 A_RadiusGive("SyphonBlueManaDropper",256,RGF_MONSTERS,2)
		VORX A 1 Bright A_CustomMissile("SyphonBlueShockwave",0,0,0,2)
		VORX BC 1 bright
		VORX D 1 Bright A_CustomMissile("SyphonBlueShockwave",0,0,0,2)
		VORX EF 1 bright
		VORX G 1 Bright A_CustomMissile("SyphonBlueShockwave",0,0,0,2)
		VORX HI 1 bright
		VORX J 1 Bright A_CustomMissile("SyphonBlueShockwave",0,0,0,2)
		VORX KL 1 bright
		VORX M 1 Bright A_CustomMissile("SyphonBlueShockwave",0,0,0,2)
		VORX NO 1 bright
		VORX P 1 Bright A_CustomMissile("SyphonBlueShockwave",0,0,0,2)
		Stop
	}
}

Actor SyphonDarkManaDropper : CustomInventory
{
	+INVENTORY.ALWAYSPICKUP
	States
	{
	Pickup:
		TNT1 A 0 A_CheckFlag("FRIENDLY","End")
		TNT1 A 0 A_CheckFlag("NOINTERACTION","End")
		TNT1 A 0 A_CheckFlag("NONSHOOTABLE","End")
		TNT1 A 0 A_CheckFlag("SHOOTABLE",1)
		Goto End
	Dropper:
		//TNT1 A 0 A_DropItem("SmallDarkMana",0,192)
		TNT1 A 0 A_DropItem("DarkManaOrb",random(2,5),208)
		Stop
	End:
		TNT1 A 0
		Stop
	}
}

Actor SyphonRedManaDropper : CustomInventory
{
	+INVENTORY.ALWAYSPICKUP
	States
	{
	Pickup:
		TNT1 A 0 A_CheckFlag("FRIENDLY","End")
		TNT1 A 0 A_CheckFlag("NOINTERACTION","End")
		TNT1 A 0 A_CheckFlag("NONSHOOTABLE","End")
		TNT1 A 0 A_CheckFlag("SHOOTABLE",1)
		Goto End
	Dropper:
		TNT1 A 0 A_DropItem("RedManaOrb",random(3,9),96)
		//TNT1 A 0 A_DropItem("BigRedMana",0,24)
		Stop
	End:
		TNT1 A 0
		Stop
	}
}

Actor SyphonGreenManaDropper : CustomInventory
{
	+INVENTORY.ALWAYSPICKUP
	States
	{
	Pickup:
		TNT1 A 0 A_CheckFlag("FRIENDLY","End")
		TNT1 A 0 A_CheckFlag("NOINTERACTION","End")
		TNT1 A 0 A_CheckFlag("NONSHOOTABLE","End")
		TNT1 A 0 A_CheckFlag("SHOOTABLE",1)
		Goto End
	Dropper:
		TNT1 A 0 A_DropItem("GreenManaOrb",random(8,16),48)
		//TNT1 A 0 A_DropItem("BigGreenMana",0,16)
		Stop
	End:
		TNT1 A 0
		Stop
	}
}

Actor SyphonBlueManaDropper : CustomInventory
{
	+INVENTORY.ALWAYSPICKUP
	States
	{
	Pickup:
		TNT1 A 0 A_CheckFlag("FRIENDLY","End")
		TNT1 A 0 A_CheckFlag("NOINTERACTION","End")
		TNT1 A 0 A_CheckFlag("NONSHOOTABLE","End")
		TNT1 A 0 A_CheckFlag("SHOOTABLE",1)
		Goto End
	Dropper:
		TNT1 A 0 A_DropItem("BlueMana",random(15,30),24)
		//TNT1 A 0 A_DropItem("BigBlueMana",0,8)
		Stop
	End:
		TNT1 A 0
		Stop
	}
}

Actor SDMDropper : RandomSpawner
{
	+NOINTERACTION
	+NOTELESTOMP
	DropItem "SmallDarkMana" 192 8
	DropItem "DarkMana" 64 2
}
Actor SRMDropper : RandomSpawner
{
	+NOINTERACTION
	+NOTELESTOMP
	DropItem "RedMana" 40 20
	DropItem "BigRedMana" 20 5
}
Actor SGMDropper : RandomSpawner
{
	+NOINTERACTION
	+NOTELESTOMP
	DropItem "GreenMana" 30 15
	DropItem "BigGreenMana" 15 3
}
Actor SBMDropper : RandomSpawner
{
	+NOINTERACTION
	+NOTELESTOMP
	DropItem "BlueMana" 20 10
	DropItem "BigBlueMana" 10 2
}
 
//---------------------
//Secondary Fire
//---------------------
Actor ShadowSpireMissile
{
	Speed 10
	Height 15
	Radius 10
	Scale 1.15
	Projectile
	+SKYEXPLODE
	+EXTREMEDEATH
	+FORCERADIUSDMG
	+DONTREFLECT
	Obituary "%o found out the hard way that %k is able to cast shadow spires."
	Translation "200:207=240:247"
	Damage 25
	DamageType "Disintegrate"
	SeeSound "MajorCooke/Weapons/Inferno/SSAttack"
	DeathSound "MajorCooke/Weapons/Inferno/ExploDeath"
	States
	{
	Spawn:
		VO02 A 1 Bright A_CustomMissile("SyphonDarkShockwave",0,0,0,2)
		VO02 BC 1 bright
		VO02 D 1 Bright A_CustomMissile("SyphonDarkShockwave",0,0,0,2)
		VO02 EF 1 bright
		VO02 G 1 Bright A_CustomMissile("SyphonDarkShockwave",0,0,0,2)
		VO02 HI 1 bright
		VO02 J 1 Bright A_CustomMissile("SyphonDarkShockwave",0,0,0,2)
		VO02 KL 1 bright
		Loop
	Death:
		VORX A 0
		VORX A 0 A_Scream
		VORX A 0 A_Explode(512,256,0)
		VORX BCDEFGHIJLKMNOP 1 Bright A_SpawnItemEx("ShadowSpireFlameSpawner",0,0,5,0+random(1,5),0+random(1,5),0+random(5,10),0+random(0,360),SXF_NOCHECKPOSITION|SXF_SETMASTER)
		TNT1 AAAAAAAAAAAAAAA 1 A_SpawnItemEx("ShadowSpireFlameSpawner",0,0,5,0+random(1,5),0+random(1,5),0+random(5,10),0+random(0,360),SXF_NOCHECKPOSITION|SXF_SETMASTER)
		Stop
	}
}
 
Actor ShadowDistortion
{
	Projectile
	+NOINTERACTION
	Speed 0
	Height 1
	Radius 1
	Scale .5
	DeathSound "MajorCooke/Weapons/Inferno/ExploGeneral"
	States
	{
	Spawn:
		VORX A 0
		Goto Death
	Death:
		TNT1 A 0 A_Jump(192,2)
		VORX A 0 A_Scream
		VORX A 1 Bright A_CustomMissile("SyphonBlueShockwave",0,0,0,2)
		VORX BCDEFGHIJLKMNOP 1 bright
		Stop
	}
}
Actor ShadowSpireFlameSpawner
{
	Projectile
	-NOGRAVITY
	+RIPPER
	RipperLevel 4
	+DONTREFLECT
	+EXTREMEDEATH
	+DONTSPLASH
	Radius 8
	Height 6
	Damage 15
	Speed 15
	RenderStyle Add
	DamageType "TempestLightning"
	DeathType "Disintegrate"
	States
	{
	Spawn:
		FFL2 E 0 ThrustThingZ(0,11,0,1)
		FFL2 E 0 ThrustThing(0+random(0,360),4,0,1)
		FFL2 FGHIJKLMNOPQ 2 A_Explode(30,64,0)
		Goto Spawn+1
	Death:
		FFL2 E 0
		FFL2 E 0 A_CustomMissile("ShadowSpireFlame1",0,0,0+random(0,359),6)
		Stop
	}
}
 
Actor ShadowSpireFlame1
{
	Radius 8
	Height 6
	Mass 0x7FFFFFFF
	Speed 1
	PROJECTILE
	-SOLID
	+NODAMAGETHRUST +CANNOTPUSH
	+FLOORHUGGER
	+BOUNCEONWALLS
	+DONTSPLASH
	+EXTREMEDEATH
	+NOBLOOD
	+FLOORCLIP
	+FORCERADIUSDMG
	+THRUACTORS
	DamageType "Disintegrate"
	ReactionTime 25
	States
	{
	Spawn:
		FFL2 EFG 2 A_Explode(15,64,0)
		FFL2 G 0 A_CountDown
		FFL2 G 0 A_CustomMissile("SyphonBlueShockwave",0,0,0)
		FFL2 HIJ 2 A_Explode(15,64,0)
		FFL2 G 0 A_CountDown
		FFL2 G 0 A_CustomMissile("SyphonBlueShockwave",0,0,0)
		FFL2 KLM 2 A_Explode(15,64,0)
		FFL2 G 0 A_CountDown
		FFL2 G 0 A_CustomMissile("SyphonBlueShockwave",0,0,0)
		FFL2 NOP 2 A_Explode(15,64,0)
		FFL2 G 0 A_CountDown
		FFL2 G 0 A_CustomMissile("SyphonBlueShockwave",0,0,0)
		FFL2 QEF 2 A_Explode(15,64,0)
		FFL2 G 0 A_CountDown
		FFL2 G 0 A_CustomMissile("SyphonBlueShockwave",0,0,0)
		FFL2 GHI 2 A_Explode(15,64,0)
		FFL2 G 0 A_CountDown
		FFL2 G 0 A_CustomMissile("SyphonBlueShockwave",0,0,0)
		FFL2 JKL 2 A_Explode(15,64,0)
		FFL2 G 0 A_CountDown
		FFL2 G 0 A_CustomMissile("SyphonBlueShockwave",0,0,0)
		FFL2 MNO 2 A_Explode(15,64,0)
		FFL2 G 0 A_CountDown
		FFL2 G 0 A_CustomMissile("SyphonBlueShockwave",0,0,0)
		FFL2 PQE 2 A_Explode(15,64,0)
		FFL2 G 0 A_CountDown
		FFL2 G 0 A_CustomMissile("SyphonBlueShockwave",0,0,0)
		FFL2 FGH 2 A_Explode(15,64,0)
		FFL2 G 0 A_CountDown
		FFL2 G 0 A_CustomMissile("SyphonBlueShockwave",0,0,0)
		FFL2 IJK 2 A_Explode(15,64,0)
		FFL2 G 0 A_CountDown
		FFL2 G 0 A_CustomMissile("SyphonBlueShockwave",0,0,0)
		FFL2 LMN 2 A_Explode(15,64,0)
		FFL2 G 0 A_CountDown
		FFL2 G 0 A_CustomMissile("SyphonBlueShockwave",0,0,0)
		FFL2 OPQ 2 A_Explode(15,64,0)
		FFL2 G 0 A_CountDown
		FFL2 G 0 A_CustomMissile("SyphonBlueShockwave",0,0,0)
		Loop
	Death:
		FFL2 E 0 A_Jump(192,"SpawnPhase2")
		FFL2 E 0 A_Jump(128,"SpawnPhase3")
		FFL2 E 0 A_Jump(64,"SpawnPhase4")
		FFL2 E 0 A_Jump(48,"SpawnPhase5")
		Goto FailureToSplit
	SpawnPhase2:
		FFL2 EE 0 A_SpawnItemEx("ShadowSpireFlame2",0,0,0,1,0,0,random(-80,80),SXF_NOCHECKPOSITION,0)
		Stop
	SpawnPhase3:
		FFL2 EE 0 A_SpawnItemEx("ShadowSpireFlame3",0,0,0,1,0,0,random(-80,80),SXF_NOCHECKPOSITION,0)
		Stop
	SpawnPhase4:
		FFL2 EE 0 A_SpawnItemEx("ShadowSpireFlame4",0,0,0,1,0,0,random(-80,80),SXF_NOCHECKPOSITION,0)
		Stop
	SpawnPhase5:
		FFL2 EE 0 A_SpawnItemEx("ShadowSpireFlame5",0,0,0,1,0,0,random(-80,80),SXF_NOCHECKPOSITION,0)
		Stop
	FailureToSplit:
		FFL2 E 0 A_SpawnItemEx("ShadowDistortion",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER)
		FFL2 E 0 A_SpawnItemEx("SyphonRedShockwave",0,0,0)
		Stop
	}
}
 
Actor ShadowSpireFlame2 : ShadowSpireFlame1
{
	States
	{
	Death:
		FFL2 E 0 A_Jump(192,"SpawnPhase3")
		FFL2 E 0 A_Jump(128,"SpawnPhase4")
		FFL2 E 0 A_Jump(64,"SpawnPhase5")
		Goto FailureToSplit
	SpawnPhase3:
		FFL2 EE 0 A_SpawnItemEx("ShadowSpireFlame3",0,0,0,1,0,0,random(-80,80),SXF_NOCHECKPOSITION,0)
		Stop
	SpawnPhase4:
		FFL2 EE 0 A_SpawnItemEx("ShadowSpireFlame4",0,0,0,1,0,0,random(-80,80),SXF_NOCHECKPOSITION,0)
		Stop
	SpawnPhase5:
		FFL2 EE 0 A_SpawnItemEx("ShadowSpireFlame5",0,0,0,1,0,0,random(-80,80),SXF_NOCHECKPOSITION,0)
		Stop
	FailureToSplit:
		FFL2 E 0 A_SpawnItemEx("ShadowDistortion",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER)
		FFL2 E 0 A_SpawnItemEx("SyphonRedShockwave",0,0,0)
		FFL2 RST 2 bright
		Stop
	}
}
 
Actor ShadowSpireFlame3 : ShadowSpireFlame1
{
	States
	{
	Death:
		FFL2 E 0 A_Jump(129,"SpawnPhase4")
		FFL2 E 0 A_Jump(64,"SpawnPhase5")
		Goto FailureToSplit
	SpawnPhase4:
		FFL2 EE 0 A_SpawnItemEx("ShadowSpireFlame4",0,0,0,1,0,0,random(-80,80),SXF_NOCHECKPOSITION,0)
		Stop
	SpawnPhase5:
		FFL2 EE 0 A_SpawnItemEx("ShadowSpireFlame5",0,0,0,1,0,0,random(-80,80),SXF_NOCHECKPOSITION,0)
		Stop
	FailureToSplit:
		FFL2 E 0 A_SpawnItemEx("ShadowDistortion",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER)
		FFL2 E 0 A_SpawnItemEx("SyphonRedShockwave",0,0,0)
		FFL2 RST 2 bright
		Stop
	}
}
 
Actor ShadowSpireFlame4 : ShadowSpireFlame1
{
	States
	{
	Death:
		FFL2 E 0 A_Jump(129,"SpawnPhase5")
		Goto FailureToSplit
	SpawnPhase5:
		FFL2 EE 0 A_SpawnItemEx("ShadowSpireFlame5",0,0,0,1,0,0,random(-80,80),SXF_NOCHECKPOSITION,0)
		Stop
	FailureToSplit:
		FFL2 E 0 A_SpawnItemEx("ShadowDistortion",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER)
		FFL2 E 0 A_SpawnItemEx("SyphonRedShockwave",0,0,0)
		FFL2 RST 2 bright
		Stop
	}
}
 
Actor ShadowSpireFlame5 : ShadowSpireFlame1
{
	States
	{
	Death:
		FFL2 E 0 A_SpawnItemEx("SyphonRedShockwave",0,0,0)
		FFL2 R 0 Bright A_SpawnItemEx("ShadowDistortion",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER)
		Stop
	}
}
 
//----------
//Effects
//----------
 
Actor SyphonDarkShockwave
{
	Projectile
	+NOINTERACTION
	+NOLIFTDROP
	Speed 0
	Height 1
	Radius 1
	Scale .95
	Translation "0:255=%[0,0,0]:[0,0,0.3]"//"120:127=240:247", "112:119=200:207"
	RenderStyle Translucent
	Alpha 0.8
	States
	{
	Spawn:
		SHOK ABCDEFGH 1 BRIGHT
		SHOK IJKLMNOPQR 1 Bright A_FadeOut(0.1)
		Stop
	Death:
		TNT1 A 0
		Stop
	}
}
 
Actor SyphonHolyShockwave : SyphonDarkShockwave
{
	Translation "0:255=%[0,0,0]:[1,1,1]"
}
 
Actor SyphonRedShockwave : SyphonDarkShockwave
{
	Translation "0:255=%[0,0,0]:[1,0,0]"
	Scale .85
	RenderStyle Translucent
	Alpha 0.5
}
 
Actor SyphonGreenShockwave : D3Shockwave
{
	RenderStyle Translucent
	Translation "0:255=%[0,0,0]:[0,1,0]"
	Alpha .4
	Scale .65
}
 
Actor SyphonBlueShockwave : SyphonDarkShockwave
{
	Scale .5
	Translation "0:255=%[0,0,0]:[0,0,1]"
	RenderStyle Translucent
	Alpha .25
}

Actor InfernoDrop : AEoDWeaponDrop
{
	Inventory.MaxAmount 1
	States
	{
	Use:
		TNT1 A 0
		TNT1 A 0 A_StopSound(6)
		TNT1 A 0 A_SpawnItemEx("DroppedInferno",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		Stop
	}
}

Actor DroppedInferno
{
	Radius 16
	Height 20
	States
	{
	Spawn:
		RP01 A 15
		TNT1 A 0 A_SpawnItemEx("AEoDInfernoNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
}

Actor AEoDInfernoNoAmmo : AEoDInfernoItem
{
	+FLOORCLIP
	+FLOATBOB
	+IGNORESKILL	+DONTGIB
	Inventory.Amount 1
	Inventory.PickupMessage "You found the inferno syphon! You lucky bastard..."
	Inventory.PickupSound "weaponbuild" 
	States
	{
	Spawn:
		RP01 A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",0) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("DarkMana",15,"Ammo")
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("InfernoDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDInferno",1)
		TNT1 A 0 A_TakeInventory("DarkMana",15)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDInferno",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,0,156,0)
		Fail
	Ammo:
		TNT1 A 0 A_TakeInventory("DarkMana",15)
		TNT1 A 0 A_JumpIfInventory("AEoDInferno",1,2)
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("InfernoDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDInferno",1)
		Stop
	}
}

//==================================================================================
//==================================================================================

//==================================================================================
//==================================================================================

Actor AEoDRedeemerItem : AEoDWeaponPickup 6071
{
	+FLOORCLIP
	+IGNORESKILL	+DONTGIB
	Scale 0.15
	Inventory.Amount 1
	Inventory.PickupMessage "You picked up the redeemer! Fun times ahead..."
	Inventory.PickupSound "reilsss/weappickup/redeemer"
	States
	{
	Spawn:
		R051 K -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDRedeemer",1,"Ammo")
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",0) <= 0,"Nothing")
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("RedeemerDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDRedeemer",1)
		TNT1 A 0 A_PrintBold("\cgSlot 10: Redeemer")
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDRedeemer",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,0,148,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDRedeemer",1)
		Stop
	}
}

Actor AEoDRedeemer : AEoDWeaponBase // 6071
{
	+FLOORCLIP
	+IGNORESKILL	+DONTGIB
	+WEAPON.CHEATNOTWEAPON
	Weapon.AmmoType1 "AERocket"
	Weapon.AmmoType2 "AERocket"
	Weapon.AmmoGive1 6
	Weapon.AmmoUse1 31
	Weapon.AmmoUse2 31
	Weapon.SelectionOrder 19550
	Inventory.PickupMessage "You picked up the redeemer! Fun times ahead..."
	Inventory.PickupSound "reilsss/weappickup/redeemer"
	Weapon.upsound "weapons/rlan/draw"
	Scale 0.15
	Tag "Redeemer"
	States
	{
	Spawn:
		R051 K -1
		Loop
	Ready:
		R051 A 1 A_WeaponReady
		Loop
	Deselect:
		TNT1 A 0 	
		R051 A 1 A_Lower
		TNT1 AA 0 A_Lower
		Loop
	Select:
		TNT1 A 0 	
		R051 A 1 A_Raise
		TNT1 AA 0 A_Raise
		Loop
	Fire:
		TNT1 A 0 A_PlaySound("reilsss/weapons/redeemerfire", CHAN_WEAPON, 1.0, 0)
		TNT1 A 0 A_Light2
		TNT1 A 0 A_Recoil(10)
		R051 B 0 Bright A_FireCustomMissile("RedeemerRocket",0,1,5,5)
		R051 BB 1 A_SetPitch(pitch-5)
		TNT1 A 0 A_Light0
		TNT1 A 0 A_CheckReload
		R051 CCDDEEFF 1 A_SetPitch(pitch+0.5)
		R051 HHHHIIIIIIII 1 A_SetPitch(pitch+0.5)
		R051 HJ 4
		R051 A 25
		Goto Ready
	AltFire:
		TNT1 A 0 A_PlaySound("reilsss/weapons/redeemerfire", CHAN_WEAPON, 1.0, 0)
		TNT1 A 0 A_Light2
		TNT1 A 0 A_Recoil(10)
		R051 B 0 Bright A_FireCustomMissile("RedeemerSeekerRocket",0,1,5,5)
		R051 BB 1 A_SetPitch(pitch-5)
		TNT1 A 0 A_Light0
		TNT1 A 0 A_CheckReload
		R051 CCDDEEFF 1 A_SetPitch(pitch+0.5)
		R051 HHHHIIIIIIII 1 A_SetPitch(pitch+0.5)
		R051 HJ 4
		R051 A 25
		Goto Ready
	}
}

Actor RedeemerSeekerRocket
{
	PROJECTILE
	+EXTREMEDEATH
	+FORCERADIUSDMG
	+SEEKERMISSILE
	Radius 5
	Height 5
	Speed 22
	Damage 100
	SeeSound "weapons/devlnch"
	DeathSound "reilsss/weapons/redeemerexplosion"
	Scale 0.8
	States
	{
	Spawn:
		MI13 A 1 Bright A_SeekerMissile(5,5,SMF_LOOK)
		TNT1 A 0 A_CustomMissile("QRockTrail",0,0,0,0)
		TNT1 A 0 A_CustomMissile("BarbasRocket1Trail2",random(3,-3),random(3,-3),0)
		TNT1 AA 0 A_CustomMissile("BarbasRocket1Trail1",random(3,-3),random(3,-3),0)
		MI13 A 1 Bright A_SeekerMissile(5,5,SMF_LOOK)
		TNT1 A 0 A_CustomMissile("QRockTrail",0,0,0,0)
		TNT1 A 0 A_CustomMissile("BarbasRocket1Trail2",random(3,-3),random(3,-3),0)
		TNT1 AA 0 A_CustomMissile("BarbasRocket1Trail1",random(3,-3),random(3,-3),0)
		MI13 A 1 Bright A_SeekerMissile(5,5,SMF_LOOK)
		TNT1 A 0 A_CustomMissile("QRockTrail",0,0,0,0)
		TNT1 A 0 A_CustomMissile("BarbasRocket1Trail2",random(3,-3),random(3,-3),0)
		TNT1 AA 0 A_CustomMissile("BarbasRocket1Trail1",random(3,-3),random(3,-3),0)
		Loop
	Death:
		TNT1 A 0 A_SpawnItemEx("RedeemerExplosionSpawner",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER)
		TNT1 A 0 A_Explode((random(3,7)*1000),768,0)
		TNT1 A 0 A_Explode(512,512) //This damages the player.
		Stop
	}
}

Actor RedeemerRocket
{
	PROJECTILE
	+EXTREMEDEATH
	+FORCERADIUSDMG
	Radius 5
	Height 5
	Speed 30
	Damage 200
	SeeSound "weapons/devlnch"
	DeathSound "reilsss/weapons/redeemerexplosion"
	Scale 0.8
	States
	{
	Spawn:
		MI13 A 1 Bright A_CustomMissile("QRockTrail",0,0,0,0)
		TNT1 A 0 A_CustomMissile("BarbasRocket1Trail2",random(3,-3),random(3,-3),0)
		TNT1 AA 0 A_CustomMissile("BarbasRocket1Trail1",random(3,-3),random(3,-3),0)
		Loop
	Death:
		TNT1 A 0 A_SpawnItemEx("RedeemerExplosionSpawner",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER)
		TNT1 A 0 A_Explode((random(3,7)*1000),768,0)
		TNT1 A 0 A_Explode(512,512) //This damages the player.
		Stop
	}
}

Actor RedeemerExplosionSpawner
{
	Projectile
	+NOINTERACTION
	RenderStyle None
	States
	{
	Spawn:
		TNT1 A 0 NoDelay A_SpawnItemEx("RedeemerExplosion",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER)
		TNT1 A 0 A_PlaySound("BoneDuster/AltFire",CHAN_AUTO,0.5,0,ATTN_NONE)
		TNT1 A 0 A_PlaySound("BoneDuster/AltFire",CHAN_AUTO,1,0)
		Stop
	}
}

Actor RedeemerExplosion
{
	var int user_degrees;
	PROJECTILE
	+EXTREMEDEATH
	+FORCERADIUSDMG
	+NOINTERACTION
	RenderStyle None
	States
	{
	Spawn:
		TNT1 A 0 NoDelay A_SpawnItemEx("RedeemerMushroom",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("RedeemerRingFX",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_QuakeEx(8,8,0,40,0,512,"",QF_SCALEDOWN)
		TNT1 A 0 A_QuakeEx(7,7,0,40,0,512*2,"",QF_SCALEDOWN)
		TNT1 A 0 A_QuakeEx(6,6,0,40,0,512*3,"",QF_SCALEDOWN)
		TNT1 A 0 A_QuakeEx(5,5,0,40,0,512*4,"",QF_SCALEDOWN)
		TNT1 A 0 A_QuakeEx(4,4,0,40,0,512*5,"",QF_SCALEDOWN)
		TNT1 A 0 A_QuakeEx(3,3,0,40,0,512*6,"",QF_SCALEDOWN)
		TNT1 A 0 A_SetUserVar("user_degrees",0)
	Loop1:
		TNT1 A 0 A_SpawnItemEx("RedeemerSmoke",0,0,20,random(6,7),0,0,user_degrees,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SetUserVar("user_degrees",user_degrees+10)
		TNT1 A 0 A_JumpIf(user_degrees>=360,"EndLoop1")
		Loop
	EndLoop1:
		TNT1 A 0 A_SetUserVar("user_degrees",0)
		TNT1 A 18
	Loop2:
		TNT1 A 0 A_SpawnItemEx("RedeemerSmokeSmaller",0,0,127,random(4,5),0,0,user_degrees,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SetUserVar("user_degrees",user_degrees+10)
		TNT1 A 0 A_JumpIf(user_degrees>=360,"EndLoop2")
		Loop
	EndLoop2:
		TNT1 A 35
		Stop
	}
}

Actor RedeemerRingFX
{
	var int user_degrees;
	+NOINTERACTION
	States
	{
	Spawn:
		TNT1 A 0
	Ringing:
		TNT1 A 0 A_SpawnItemEx("RedeemerShockParticle",0,0,60,40,0,0,user_degrees,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("RedeemExplosionMediumSprite",0,0,12,20,0,0,user_degrees+random(-4,4),SXF_NOCHECKPOSITION)
		TNT1 AAA 0 A_SpawnItemEx("RedeemExplosionMediumSprite",0,0,12,20,0,0,user_degrees+random(-4,4),SXF_NOCHECKPOSITION,200)
		TNT1 A 0 A_SetUserVar("user_degrees",user_degrees+2)
		TNT1 A 0 A_JumpIf(user_degrees>=360,"EndLoop")
		Loop
	EndLoop:
		TNT1 A 1
		Stop
	}
}

Actor RedeemerShockParticle
{
	+NOINTERACTION
	Translation "0:255=%[0,0,0]:[1,0.45,0]"
	RenderStyle Add
	Scale 0.25
	States
	{
	Spawn:
		X099 A 0
		X099 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 1 A_SetScale(ScaleX+0.01)
	Looper:
		"####" "#" 0 A_ScaleVelocity(0.96)
		"####" "#" 0 A_SetScale(ScaleX+0.01)
		"####" "#" 1 A_FadeOut(0.02)
		Loop
	}
}

Actor RedeemerSmoke : TT1 
{
	var int user_counter;
	+NOINTERACTION
	RenderStyle Translucent
	Alpha 0.85
	Scale 0.8
	States
	{
	Behavior:
		"####" "#" 0 A_SetUserVar("user_counter",0)
		"####" "#" 0 A_JumpIf(user_counter>=25,"MoveUp")
		"####" "#" 1 A_FadeOut(0.01)
		"####" "#" 0 A_ScaleVelocity(0.95)
		"####" "#" 0 A_SetUserVar("user_counter",user_counter+1)
		Goto Behavior+1
	MoveUp:
		"####" "##########" 1 A_ScaleVelocity(0.7)
		"####" "#" 0 A_ChangeVelocity(0,0,0.4,1)
		"####" "#" 1 A_FadeOut(0.01)
		Goto BehaviorCont
	BehaviorCont:
		"####" "#" 1 A_FadeOut(0.01)
		"####" "#" 0 A_ScaleVelocity(1.02)
		Loop
	//Note to DBT: Currently, the smoke looks like it's lagging. I've commented it
	//as the original below and fixed this so it stops going to MoveUp.
	/*Behavior:
		"####" "#" 0 A_SetUserVar("user_counter",0)
		"####" "#" 0 A_JumpIf(user_counter>=17,"MoveUp")
		"####" "#" 1 A_FadeOut(0.01)
		"####" "#" 0 A_ScaleVelocity(0.97)
		"####" "#" 0 A_SetUserVar("user_counter",user_counter+1)
		Goto Behavior+1
	MoveUp:
		"####" "#" 0 A_ChangeVelocity(0,0,0.4,1)
		"####" "#" 1 A_FadeOut(0.01)
		"####" "#" 0 A_ScaleVelocity(0.2)
		Goto Behavior+2*/
	}
}
Actor RedeemerSmokeSmaller : RedeemerSmoke 
{
	Scale 0.4
	States
	{
	Behavior:
		"####" "#" 1 A_FadeOut(0.01)
		"####" "#" 0 A_ScaleVelocity(0.95)
		Loop
	}
}

Actor NukeBaseSpawner
{
	Projectile
	+NOINTERACTION
	RenderStyle Add
	Scale 1.15
	States
	{
	Spawn:
		CB02 AB 6 bright
		CB02 C 4 Bright A_SpawnItemEx("NukeBaseSmall",0,0,50,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER)
		CB02 C 4 Bright A_SpawnItemEx("NukeBaseSmaller",0,0,100,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER)
		CB02 D 8 Bright A_SpawnItemEx("NukeHead",0,0,165,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER)
		CB02 EFG 8 bright
		CB02 HIJK 5 bright
		CB02 LMNOPQRS 4 bright
		Stop
	}
}

Actor NukeBaseSmall
{
	Projectile
	+NOINTERACTION
	RenderStyle Add
	Scale 0.75
	States
	{
	Spawn:
		CB02 AB 5 bright
		CB02 CDEFG 7 bright
		CB02 HIJK 6 bright
		CB02 LMNOPQRS 4 bright
		Stop
	}
}

Actor NukeBaseSmaller : NukeBaseSmall
{
	Scale 0.5
	States
	{
	Spawn:
		CB02 AB 6 bright
		CB02 CCCCCCC 1 Bright A_SpawnItemEx("RingEmitter",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER)
		CB02 DEFG 7 bright
		CB02 HIJK 6 bright
		CB02 LMNOPQRS 4 bright
		Stop
	}
}

Actor NukeHead
{
	Projectile
	+NOINTERACTION
	RenderStyle Add
	Scale 1.3
	States
	{
	Spawn:
		CB02 AB 6 bright
		CB02 CDEFG 7 bright
		CB02 HIJK 5 bright
		CB02 LMNOPQRS 4 bright
		Stop
	}
}

Actor RingEmitter : NukeHead
{
	RenderStyle None
	Scale 1
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 AAAAAAAA 1 A_CustomMissile("RingPuff",0,0,0+random(0,360),6)
		Stop
	}
}

Actor RingPuff : PortalFX1
{
	Speed 20
	+NOINTERACTION
	States
	{
	Spawn:
		CB02 ABCDEFGHIJKL 3 Bright A_ScaleVelocity(0.90)
		CB02 MNOPQRS 2 Bright A_ScaleVelocity(0.90)
		Stop
	}
}

Actor RPGFirebombExp4
{
	Projectile
	+FORCERADIUSDMG
	+EXTREMEDEATH
	-NOGRAVITY
	Radius 4
	RenderStyle Add
	BounceType "Hexen"
	BounceCount 1
	BounceFactor 0
	WallBounceFactor 0
	Alpha 0.7
	Scale 0.25
	Height 8
	Speed 15
	Damage 15
	Obituary "%o was killed by a Nuclear Firebomb explosion."
	ReactionTime 50
	States
	{
	Spawn:
		FRME A 0
		FRME A 0 A_StopSound
		TNT1 A 0 A_CheckCeiling("CeilingHit")
		TNT1 A 0 ThrustThingZ(0,20,0,1)
		FRME A 1 Bright
		Goto Spawn+4
	CeilingHit:		//it doesnt have a Z thrust
		Goto Death
	Death:
		TNT1 AAAAAA 0 A_SpawnItemEx("ExplosionMediumSprite",0,0,0,random(3,-3)/(2*1.05),random(3,-3)/(2*1.05),random(4,1)/(2*1.05),0,SXF_NOCHECKPOSITION)
		GRNE A 0 A_PlaySound("reilsss/weapons/hefirebombexplosion")
		GRNE A 0 Bright A_Explode(64,128,1)
		Stop
	}
}


Actor RedeemerExplosionGenerator
{
	Projectile
	+EXTREMEDEATH
	+THRUACTORS
	+FORCERADIUSDMG
	Radius 6
	Height 4
	Speed 32
	Damage 6
	Obituary "%o was annihilated by a Nuclear Blast."
	DeathSound "reilsss/weapons/fusionsmallexplo"
	BounceType "Doom"
	BounceFactor 0
	WallBounceFactor 0
	RenderStyle None
	Scale 0.9
	States
	{
	Spawn:
		TNT1 AAA 1
		R055 A 1 A_SpawnItemEx("RedeemerSmallExplosion1",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 AAA 1
		R055 A 1 A_SpawnItemEx("RedeemerSmallExplosion1",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 AAA 1
		R055 A 1 A_SpawnItemEx("RedeemerSmallExplosion1",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		Stop
	Death:
		TNT1 A 0 A_SetTranslucent(0.7,1)
		R055 A 4 Bright A_Explode(112,112,1)
		R055 B 5 Bright
		R055 CDE 6 Bright
		R055 F 5 Bright
		R055 G 4 Bright
		Stop
	}
}

Actor RedeemerSmallExplosion1
{
	Projectile
	+THRUACTORS
	+EXTREMEDEATH
	+FORCERADIUSDMG
	Speed 0
	Radius 6
	Height 4
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_PlaySound("reilsss/weapons/fusionsmallexplo")
		TNT1 A 0 A_Explode(128,128,1)
		TNT1 A 15 A_SpawnItemEx("RedeemerExplosionmedium",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		Stop
	}
}



Actor RedeemerSmallExplosion2 : RedeemerSmallExplosion1
{
   	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_PlaySound("reilsss/weapons/fusionsmallexplo")
		TNT1 A 0 A_Explode(112,96,1)
		TNT1 A 15 A_SpawnItemEx("RedeemerExplosionmedium",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		Stop
	}
}


Actor RedeemerSmallExplosion3 : RedeemerSmallExplosion1
{
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_PlaySound("reilsss/weapons/fusionsmallexplo")
		TNT1 A 0 A_Explode(104,64,1)
		TNT1 A 15 A_SpawnItemEx("RedeemerExplosionmedium",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		Stop
	}
}

Actor RedeemerExplosionmedium
{
	+NOINTERACTION
	RenderStyle None
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SpawnItemEx("ExploMediumBack1",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_CheckFloor("InFloor")
	InAir:	//when it spawns in the air
		TNT1 AAAAAAAA 0 A_SpawnItemEx("ExplosionMediumSprite",0,0,0,random(3,-3)/(2*1.05),random(3,-3)/(2*1.05),random(3,-3)/(2*1.05),0,SXF_NOCHECKPOSITION)
		TNT1 A 10
		Stop
	InFloor:
		TNT1 AAAAAAAA 0 A_SpawnItemEx("ExplosionMediumSprite",0,0,0,random(3,-3)/(2*1.05),random(3,-3)/(2*1.05),random(4,1)/(2*1.05),0,SXF_NOCHECKPOSITION)
		TNT1 A 10
		Stop
	}
}


Actor RedeemerFireSpawner
{
	PROJECTILE
	+THRUACTORS
	+BLOODLESSIMPACT
	Radius 1
	Height 1
	Damage 20
	Speed 15
	RENDERSTYLE NONE
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 AAAAA 5 Bright A_CustomMissile("RedeemerFireExplosion",0,0,0,4)
		Stop
	}
}

Actor RedeemerFireExplosion
{
	PROJECTILE
	+EXTREMEDEATH
	+FORCERADIUSDMG
	+THRUACTORS
	Radius 0
	Height 1
	DamageType Fire
	RENDERSTYLE ADD
	ALPHA 0.95
	Scale 0.67
	SeeSound "weapons/boom1"
	States
	{
	Spawn:
		TNT1 A 0 A_Explode(192,128)
		TNT1 AAAAAAAA 0 A_SpawnItemEx("ExplosionMediumSprite",0,0,0,random(3,-3)/(2*1.05),random(3,-3)/(2*1.05),random(4,1)/(2*1.05),0,SXF_NOCHECKPOSITION)
		Stop
	}
}

Actor RedeemerFireFlare
{
	PROJECTILE
	-NOGRAVITY
	+EXTREMEDEATH
	+FORCERADIUSDMG
	+THRUACTORS
	Gravity 1.6
	Radius 8
	Height 11
	Speed 35
	Damage 35
	DeathSound "weapons/bang1"
	RENDERSTYLE ADD
	ALPHA 0.95
	States
	{
	Spawn:
		TNT1 A 1 Bright A_SpawnItemEx("RedeemerFireFX",0,0,0,0,0,0,0,SXF_ABSOLUTEMOMENTUM)
		Loop
	Death:
		FRFX HIJ 2 Bright
		FRFX J 0 A_Explode(64,64,0)
		FRFX J 0 A_SpawnItemEx("DropFire",0,0,0,0,0,0,0,SXF_SETMASTER,128)
		FRFX KLMNO 2 Bright
		Stop
	}
}

Actor RedeemerFireFX
{   
	PROJECTILE
	+NOINTERACTION
	Radius 0
	Height 1
	Speed 0
	RENDERSTYLE ADD
	ALPHA 0.85
	States
	{
	Spawn:
		TNT1 A 3 Bright
		PYFX ABCDE 3 Bright
		Stop 
	}
}

Actor RedeemerSmokeFX
{   
	PROJECTILE
	+NOINTERACTION
	Radius 2
	Height 2
	Speed 3
	RENDERSTYLE Add
	ALPHA 0.50
	Scale 0.50
	States
	{
	Spawn:
		W006 RRRRRSSSSSTTTTTUUUUUVVVVV 2 
		W006 W 1 A_FadeOut(0.10)
		Wait
	}
}

Actor RedeemerDrop : AEoDWeaponDrop
{
	Inventory.MaxAmount 1
	States
	{
	Use:
		TNT1 A 0
		TNT1 A 0 A_SpawnItemEx("DroppedRedeemer",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		Stop
	}
}

Actor DroppedRedeemer
{
	Radius 16
	Height 20
	Scale 0.15
	States
	{
	Spawn:
		R051 K 15
		TNT1 A 0 A_SpawnItemEx("AEoDRedeemerNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
}

Actor AEoDRedeemerNoAmmo : AEoDRedeemerItem
{
	+FLOORCLIP
	+IGNORESKILL	+DONTGIB
	Scale 0.15
	Inventory.Amount 1
	Inventory.PickupMessage "You picked up the redeemer! Fun times ahead..."
	Inventory.PickupSound "reilsss/weappickup/redeemer"
	States
	{
	Spawn:
		R051 K -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",0) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("AERocket",6,"Ammo")
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("RedeemerDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDRedeemer",1)
		TNT1 A 0 A_TakeInventory("AERocket",6)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDRedeemer",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,0,148,0)
		Fail
	Ammo:
		TNT1 A 0 A_TakeInventory("AERocket",6)
		TNT1 A 0 A_JumpIfInventory("AEoDRedeemer",1,2)
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("RedeemerDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDRedeemer",1)
		Stop
	}
}

//==============================================================================
//==============================================================================
//							HELL and HEAVEN's hand
// Nobody was sure of its existance, some people thought it was a myth, others 
// said it was a rumor, but the only thing they were sure of, was its power. 
// Destruction and massacre surrounds the name, and the long history of this 
// device. Being half sacred and half wretched, this weapon can protect the 
// user and give to it an amazing amount of destructive power. Rumors have it, 
// only one being was capable of using the true power of this weapon, a creature
// that remains in the shadows, waiting for the moment to finally arise.

// Without one influence, the other would dominate and destroy the holder. Three
// massive powers twist maddeningly inside the weapon, with its upholstry and
// physical manifestations being that of Life. Constructed from bone, and flesh
// of uncountable species throughout the universe, their essence of life is used
// to hold within the third essence of Death while the purest holy and raw
// unholy powers contend with each other. 

// The Hand of God has shown that it is merely the smallest of gateways, touched 
// by God Himself, which radiates with his wrath against the unruly. Apparently, 
// this device manages to utilize that same ability to wrench open the gate a 
// little further, allowing so much more of His anger out, slamming the heathen 
// with unmatched and infinitely more terrifying strength. Only the purest of
// beings will not be ravaged by His fury.

// For the protection, only the Dark One has proven to know how to mitigate God's
// Wrath (if even a little), as Lucifer was once a grand arch-angel. As the 
// champion of Darkness, only God can get through his protective abilities. The
// tiny drop of Darkness imbued within combines to further the user's protection,
// reflecting most projectiles while completely rendering them invulnerable and
// immortal, the sheer undefeatable object so long as the protection is present.
// Lucifer's unholy gaze is directly on the user, bringing to bear pain to anyone
// who gets too close.

// Lastly, Death's aspect knows where to hit them where it hurts. By channelling 
// spirits of vengeance with untold knowledge, they can penetrate through any
// shield and cut down any foe, save for the one he gave this power to originally.

// The Death Bringer's sigil can be switched at any time to change modes, and his
// hand guides the user as if they have had all his experience with it. With only
// the conscience of the wearer, (s)he alone will control the fate of the outcome
// at long last...
//==============================================================================
//==============================================================================
// Graphics edit by Major Cooke
//==============================================================================
//==============================================================================

Actor AEoDHellHeavenHandItem : AEoDWeaponPickup 6066
{
	+FLOORCLIP
	+IGNORESKILL	+DONTGIB
	Inventory.Amount 1
	Inventory.PickupSound "DMage/death" 
	Inventory.PickupMessage "You are now worthy of the Great one's strength, the Dark one's protection, and the Eternal one's knowledge! Behold the HELL AND HEAVEN HAND!"
	States
	{
	Spawn:
		HELG A -1
		Loop
	Pickup:
		TNT1 A 0 A_TakeInventory("HHHModeChecker",20)
		TNT1 A 0 A_JumpIfInventory("AEoDHellHeavenHand",1,"Ammo")
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",0) <= 0,"Nothing")
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("HellHeavenHandDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDHellHeavenHand",1)
		TNT1 A 0 A_PrintBold("\cgSlot 10: Hell & Heaven Hand")
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDHellHeavenHand",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+3
		
		TNT1 A 0 ACS_NamedExecute("s798",0,0,160,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDHellHeavenHand",1)
		Stop
	}
}



Actor AEoDHellHeavenHand : AEoDWeaponBase // 6066
{ 
	+FLOORCLIP
	+WEAPON.CHEATNOTWEAPON
	+IGNORESKILL	+DONTGIB
	+WEAPON.AMMO_OPTIONAL
	+WEAPON.ALT_AMMO_OPTIONAL
	Weapon.AmmoType "RedMana"
	Weapon.AmmoType2 "DarkMana"
	Weapon.AmmoGive1 200
	Weapon.AmmoGive2 100
	Weapon.AmmoUse 50
	Weapon.AmmoUse2 1
	Weapon.SelectionOrder 19999
	Weapon.UpSound "weapons/draw"
	+WEAPON.CHEATNOTWEAPON 
	+INVENTORY.FANCYPICKUPSOUND
	+WEAPON.NOAUTOFIRE
	Inventory.PickupSound "DMage/death" 
	Inventory.PickupMessage "You are now worthy of the Great one's strength, the Dark one's protection, and the Eternal one's knowledge! Behold the HELL AND HEAVEN HAND!"
	Obituary "%o was judged by %k, and has been deemed unworthy."
	Tag "Hell and Heaven Hand"
	States 
	{ 
	Spawn: 
		HELG A 10
		Loop
	Ready: 
		UNK1 A 0 A_TakeInventory("HHHAudioToken",1000,0)
		UNK1 A 0 A_TakeInventory("HHHCheck",2)
		UNK1 A 0 A_JumpIfInventory("PowerInvulBase",1,2)
		UNK1 A 0 A_UnSetReflectiveInvulnerable
		UNK1 A 0 A_JumpIfInventory("PowerNoSeek",1,2)
		UNK1 A 0 A_SetRipMin(666) 
		UNK1 A 0 A_ChangeFlag("DONTTHRUST",0)
		UNK1 A 0 A_JumpIfInventory("HHHModeChecker",2,4) //Jump to Protection side
		UNK1 A 0 A_JumpIfInventory("HHHModeChecker",1,2) //Jump to Strength side
	Ready1:
		UNK1 D 1 A_WeaponReady //Knowledge side lit
		Goto Ready1
	Ready2:
		UNK1 C 1 A_WeaponReady //Strength side lit
		Goto Ready2
	Ready3:
		UNK1 B 1 A_WeaponReady //Protection side lit
		Goto Ready3
	Deselect:
		UNK2 B 0 A_RemoveChildren(1,RMVF_EVERYTHING,"HHHAmmoTaker")
		UNK1 A 0 A_StopSound(CHAN_WEAPON)
		UNK1 A 0 A_StopSound(CHAN_LISTENERZ)
		TNT1 A 0 	
		UNK1 A 0 A_ChangeFlag("DONTTHRUST",0)
		UNK2 B 0 A_StopSound(CHAN_WEAPON)
		UNK2 B 0 A_StopSound(CHAN_LISTENERZ)
		UNK2 B 0 A_JumpIfInventory("PowerNoSeek",1,3)
		UNK2 B 0 A_ChangeFlag("DONTRIP",0)
		UNK2 B 0 A_ChangeFlag("NORADIUSDMG",0)
		UNK2 B 0 A_ChangeFlag("NODAMAGE",0)
		UNK2 B 0 A_JumpIfInventory("PentagramIsOn",1,2)
		UNK2 B 0 A_UnSetReflectiveInvulnerable
		UNK2 B 0 A_TakeInventory("PowerPlayerGrounder",1)
		UNK2 B 0 A_TakeInventory("PGrounder",1)
	Desel2:
		UNK1 A 1 A_Lower 
		TNT1 AA 0 A_Lower
		Loop
	Select: 
		TNT1 A 0 	
		UNK1 A 1 A_Raise
		TNT1 AA 0 A_Raise 
		Loop
	AltFire:
		UNK1 A 0
		UNK1 A 0 A_JumpIfInventory("HHHModeChecker",2,"ProtectionToKnowledge")
		UNK1 A 0 A_JumpIfInventory("HHHModeChecker",1,"StrengthToProtection")
		KnowledgeToStrength: //gives 1 checker
		UNK1 A 2 A_GiveInventory("HHHModeChecker",1)
		UNK1 C 0 A_PlaySound("hhh/modeswitch",CHAN_WEAPON,1,0)
		Goto Ready
		StrengthToProtection: //now 2 checkers
		UNK1 A 2 A_GiveInventory("HHHModeChecker",1)
		UNK1 B 0 A_PlaySound("hhh/modeswitch",CHAN_WEAPON,1,0)
		Goto Ready
		ProtectionToKnowledge: //no checkers
		UNK1 A 2 A_TakeInventory("HHHModeChecker",10)
		UNK1 D 0 A_PlaySound("hhh/modeswitch",CHAN_WEAPON,1,0)
		Goto Ready
	Fire:
		UNK2 A 0 A_JumpIfInventory("HHHModeChecker",2,"FireProtection")
		UNK2 A 0 A_JumpIfInventory("HHHModeChecker",1,"FireStrength")
		Goto FireKnowledge
	FireKnowledge:
		UNK1 A 0 A_JumpIfInventory("RedMana",1,1)
		Goto Ready
		
		UNK1 A 0 A_JumpIfInventory("PowerInvulBase",1,2)
		UNK1 A 0 A_SetInvulnerable
		UNK1 A 0 A_GiveInventory("PowerEternalTimeFreeze",1)
		UNK1 A 0 A_PlaySound("hhh/charge1",CHAN_WEAPON | CHAN_LISTENERZ | CHAN_NOPAUSE,1,0)
		UNK1 EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE 1 Bright A_FireCustomMissile("HHHKnowledgePSpawnerSingle",0,0,0,0)
		UNK1 EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE 1 Bright A_FireCustomMissile("HHHKnowledgePSpawnerSingle",0,0,0,0)
		UNK1 EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE 1 Bright A_FireCustomMissile("HHHKnowledgePSpawnerSingle",0,0,0,0) //111
		UNK1 GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG 1 Bright A_FireCustomMissile("HHHKnowledgePSpawnerDouble",0,0,0,0) //35
		UNK2 F 4 Bright A_LightInverse
		UNK2 A 0 A_TakeInventory("PowerEternalTimeFreeze",1)
		UNK2 F 0 A_PlaySound("hhh/channel2",CHAN_WEAPON | CHAN_LISTENERZ,1,1)
		UNK2 F 0 A_Light0
		UNK2 F 0 A_JumpIfInventory("PowerInvulBase",1,2)
		UNK2 F 0 A_UnSetInvulnerable
		UNK2 FFFFFFFFFFFFFF 2 Bright A_FireCustomMissile("EternalMissile",0,0)
		UNK2 F 2 Bright A_FireCustomMissile("EternalMissile",0,1)
		UNK2 C 0 A_ReFire("KnowledgeHold")
		UNK2 C 0 A_StopSound(CHAN_WEAPON)
		UNK2 C 0 A_PlayWeaponSound("hhh/charge2")
		UNK2 C 0 A_JumpIfInventory("PowerInvulBase",1,2)
		UNK1 C 0 A_UnSetInvulnerable
		UNK1 FGE 5 bright
		Goto Ready
	KnowledgeHold:
		UNK2 FFF 2 Bright A_FireCustomMissile("EternalMissile",0,0)
		UNK2 C 0 A_ReFire("Hold2")
		UNK2 C 0 A_StopSound(CHAN_WEAPON)
		UNK2 C 0 A_PlayWeaponSound("hhh/charge2")
		UNK2 C 0 A_JumpIfInventory("PowerInvulBase",1,2)
		UNK1 C 0 A_UnSetInvulnerable
		UNK1 FGE 5 bright
		Goto Ready
	Hold2:
		UNK2 FFF 2 Bright A_FireCustomMissile("EternalMissile",0,0)
		UNK2 C 0 A_ReFire("Hold3")
		UNK2 C 0 A_StopSound(CHAN_WEAPON)
		UNK2 C 0 A_PlayWeaponSound("hhh/charge2")
		UNK2 C 0 A_JumpIfInventory("PowerInvulBase",1,2)
		UNK1 C 0 A_UnSetInvulnerable
		UNK1 FGE 5 bright
		Goto Ready
	Hold3:
		UNK2 FFF 2 Bright A_FireCustomMissile("EternalMissile",0,0)
		UNK2 C 0 A_ReFire("Hold4")
		UNK2 C 0 A_StopSound(CHAN_WEAPON)
		UNK2 C 0 A_PlayWeaponSound("hhh/charge2")
		UNK2 C 0 A_JumpIfInventory("PowerInvulBase",1,2)
		UNK1 C 0 A_UnSetInvulnerable
		UNK1 FGE 5 bright
		Goto Ready
	Hold4:
		UNK2 FFF 2 Bright A_FireCustomMissile("EternalMissile",0,0)
		UNK2 C 0 A_ReFire("Hold5")
		UNK2 C 0 A_StopSound(CHAN_WEAPON)
		UNK2 C 0 A_PlayWeaponSound("hhh/charge2")
		UNK2 C 0 A_JumpIfInventory("PowerInvulBase",1,2)
		UNK1 C 0 A_UnSetInvulnerable
		UNK1 FGE 5 bright
		Goto Ready
	Hold5:
		UNK2 FFF 2 Bright A_FireCustomMissile("EternalMissile",0,0)
		UNK2 C 0 A_ReFire("Hold6")
		UNK2 C 0 A_StopSound(CHAN_WEAPON)
		UNK2 C 0 A_PlayWeaponSound("hhh/charge2")
		UNK2 C 0 A_JumpIfInventory("PowerInvulBase",1,2)
		UNK1 C 0 A_UnSetInvulnerable
		UNK1 FGE 5 bright
		Goto Ready
	Hold6:
		UNK2 FF 2 Bright A_FireCustomMissile("EternalMissile",0,0)
		UNK2 F 2 Bright A_FireCustomMissile("EternalMissile",0,1)
		UNK2 C 0 A_ReFire("KnowledgeHold")
		UNK2 C 0 A_StopSound(CHAN_WEAPON)
		UNK2 C 0 A_PlayWeaponSound("hhh/charge2")
		UNK2 C 0 A_JumpIfInventory("PowerInvulBase",1,2)
		UNK1 C 0 A_UnSetInvulnerable
		UNK1 FGE 5 bright
		Goto Ready
	FireProtection:
		UNK2 A 0 A_JumpIfInventory("PowerEconomizer",1,3)
		UNK2 A 0 A_JumpIfInventory("InfiniteAmmo",1,2)
		UNK2 A 0 A_JumpIfInventory("DarkMana",1,1)
		Goto Ready
		
		UNK2 B 0 A_SpawnItemEx("HHHAmmoTaker",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER)
		UNK2 B 0 A_JumpIfInventory("HHHAudioSpawned",1,"Audio2")
	Audio1:
		UNK2 B 0 A_GiveInventory("HHHAudioToken",2)
		UNK2 B 0 A_JumpIfInventory("HHHAudioSpawned",1,"Audio2")
		UNK2 B 0 A_SpawnItemEx("HHHProtectionAudio",3150,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER)
		UNK2 B 0 A_GiveInventory("HHHAudioSpawned",1)
		Goto FireProtC
	Audio2:
		UNK2 B 0 A_TakeInventory("HHHAudioToken",1000)
		UNK2 B 0 A_GiveInventory("HHHAudioToken",2)
	FireProtC:
		UNK2 B 4 Bright A_GiveInventory("HHHProtectionOn",1)
		UNK2 B 9 Bright A_FireCustomMissile("ProtectionShover", 0, 0, 0, 0)
		UNK2 B 0 A_ReFire("ProtectionHold")
		UNK2 B 0 A_StopSound(CHAN_WEAPON)
		UNK2 B 0 A_StopSound(CHAN_LISTENERZ)
		UNK2 B 0 A_GiveInventory("HHHProtectionOff",1)
		Goto Ready
		
		UNK2 B 0 
		Goto Ready 
	ProtectionHold:
		UNK2 B 0 A_JumpIfInventory("PowerEconomizer",1,3)
		UNK2 B 0 A_JumpIfInventory("InfiniteAmmo",1,2)
		UNK2 B 0 A_JumpIfInventory("DarkMana",1,1)
		Goto Ready
		
		UNK2 B 0 A_FireCustomMissile("ProtectionShover", 0, 0, 0, 0)
		UNK2 B 0 A_ChangeFlag(DONTRIP,1)
		UNK2 B 13 Bright A_GiveInventory("HHHProtectionOn",1)
		UNK2 B 0 A_ReFire("ProtectionHold")
		UNK2 B 0 A_TakeInventory("HHHAudioToken",1000)
		UNK2 B 0 A_StopSound(CHAN_WEAPON)
		UNK2 B 0 A_StopSound(CHAN_LISTENERZ)
		UNK2 B 0 A_GiveInventory("HHHProtectionOff",1)
		UNK2 B 0 A_RemoveChildren(1,RMVF_EVERYTHING,"HHHAmmoTaker")
		Goto Ready
		
		UNK2 B 0 A_RemoveChildren(1,RMVF_EVERYTHING,"HHHAmmoTaker")
		Goto Ready
	FireStrength:
		UNK1 C 8 Bright A_Light1
		UNK2 C 8 Bright A_Light2
		UNK2 C 0 A_PlaySound("hhh/fire1",7|CHAN_LISTENERZ|CHAN_NOPAUSE,1,0,ATTN_NONE)
		UNK2 C 0 A_LightInverse
		UNK2 C 0 Bright A_FireCustomMissile("GodsWrath", 0, 1, 0, 0)
		UNK2 C 0 Bright A_FireCustomMissile("GodsWrath", 10, 0, 0, 0)
		UNK2 C 0 Bright A_FireCustomMissile("GodsWrath", 20, 0, 0, 0)
		UNK2 C 0 Bright A_FireCustomMissile("GodsWrath", 30, 0, 0, 0)
		UNK2 C 0 Bright A_FireCustomMissile("GodsWrath", 40, 0, 0, 0)
		UNK2 C 0 Bright A_FireCustomMissile("GodsWrath", 50, 0, 0, 0)
		UNK2 C 0 Bright A_FireCustomMissile("GodsWrath", 60, 0, 0, 0)
		UNK2 C 0 Bright A_FireCustomMissile("GodsWrath", 70, 0, 0, 0)
		UNK2 C 0 Bright A_FireCustomMissile("GodsWrath", 80, 0, 0, 0)
		UNK2 C 0 Bright A_FireCustomMissile("GodsWrath", 90, 0, 0, 0)
		UNK2 C 0 Bright A_FireCustomMissile("GodsWrath", 100, 0, 0, 0)
		UNK2 C 0 Bright A_FireCustomMissile("GodsWrath", 110, 0, 0, 0)
		UNK2 C 0 Bright A_FireCustomMissile("GodsWrath", 120, 0, 0, 0)
		UNK2 C 0 Bright A_FireCustomMissile("GodsWrath", 130, 0, 0, 0)
		UNK2 C 0 Bright A_FireCustomMissile("GodsWrath", 140, 0, 0, 0)
		UNK2 C 0 Bright A_FireCustomMissile("GodsWrath", 150, 0, 0, 0)
		UNK2 C 0 Bright A_FireCustomMissile("GodsWrath", 160, 0, 0, 0)
		UNK2 C 0 Bright A_FireCustomMissile("GodsWrath", 170, 0, 0, 0)
		UNK2 C 0 Bright A_FireCustomMissile("GodsWrath", 180, 0, 0, 0)
		UNK2 C 0 Bright A_FireCustomMissile("GodsWrath", -10, 0, 0, 0)
		UNK2 C 0 Bright A_FireCustomMissile("GodsWrath", -20, 0, 0, 0)
		UNK2 C 0 Bright A_FireCustomMissile("GodsWrath", -30, 0, 0, 0)
		UNK2 C 0 Bright A_FireCustomMissile("GodsWrath", -40, 0, 0, 0)
		UNK2 C 0 Bright A_FireCustomMissile("GodsWrath", -50, 0, 0, 0)
		UNK2 C 0 Bright A_FireCustomMissile("GodsWrath", -60, 0, 0, 0)
		UNK2 C 0 Bright A_FireCustomMissile("GodsWrath", -70, 0, 0, 0)
		UNK2 C 0 Bright A_FireCustomMissile("GodsWrath", -80, 0, 0, 0)
		UNK2 C 0 Bright A_FireCustomMissile("GodsWrath", -90, 0, 0, 0)
		UNK2 C 0 Bright A_FireCustomMissile("GodsWrath", -100, 0, 0, 0)
		UNK2 C 0 Bright A_FireCustomMissile("GodsWrath", -110, 0, 0, 0)
		UNK2 C 0 Bright A_FireCustomMissile("GodsWrath", -120, 0, 0, 0)
		UNK2 C 0 Bright A_FireCustomMissile("GodsWrath", -130, 0, 0, 0)
		UNK2 C 0 Bright A_FireCustomMissile("GodsWrath", -140, 0, 0, 0)
		UNK2 C 0 Bright A_FireCustomMissile("GodsWrath", -150, 0, 0, 0)
		UNK2 C 0 Bright A_FireCustomMissile("GodsWrath", -160, 0, 0, 0)
		UNK2 C 0 Bright A_FireCustomMissile("GodsWrath", -170, 0, 0, 0)
		UNK2 C 4 Offset(0,40) bright
		UNK2 C 4 Offset(0,40) Bright A_Light0
		UNK1 C 8 Bright Offset(0,35)
		UNK1 C 0
		Goto Ready
	}
}

Actor HHHAudioToken : Inventory
{	Inventory.MaxAmount 2	Inventory.InterhubAmount 0	}

Actor HHHAudioSpawned : Inventory
{	Inventory.MaxAmount 1	Inventory.InterhubAmount 0	}

Actor HHHProtectionAudio
{
	var int user_d;
	+NOINTERACTION
	+NOTIMEFREEZE
	States
	{
	Spawn:
		TNT1 A 0 NoDelay A_PlaySound("HHH/fire2main",5,1,1)
		TNT1 A 0 A_PlaySound("HHH/fire2chant",6,0.7,1)
		TNT1 A 0 A_PlaySound("DemonMorph/Loop",7,0.6,1)
		TNT1 A 0 A_SetUserVar(user_d,90)
	MoveIn:
		TNT1 A 0 A_Warp(AAPTR_MASTER,(user_d)-3000,0,16,180,WARPF_NOCHECKPOSITION|WARPF_INTERPOLATE|WARPF_COPYINTERPOLATION)
		TNT1 A 1 A_SetUserVar(user_d,user_d+90)
		TNT1 A 0 A_JumpIf(user_d >= (35*90), "Play")
		TNT1 A 0 A_JumpIfInventory("HHHAudioToken",2,"MoveIn",AAPTR_MASTER)
		Goto Out
	Play:
		TNT1 A 1 A_Warp(AAPTR_MASTER,0,0,16,0,WARPF_NOCHECKPOSITION)
		TNT1 A 0 A_JumpIfInventory("HHHAudioToken",2,"Play",AAPTR_MASTER)
		TNT1 A 0 A_JumpIfInventory("PowerDemonMorph",1,"STFU",AAPTR_MASTER)
		Goto Out
	Out:
		TNT1 A 0 A_Warp(AAPTR_MASTER,(user_d)-3000,0,16,180,WARPF_NOCHECKPOSITION|WARPF_INTERPOLATE|WARPF_COPYINTERPOLATION)
		TNT1 A 1 A_SetUserVar(user_d,user_d-90)
		TNT1 A 0 A_JumpIf(user_d <= (90), "End")
		TNT1 A 0 A_JumpIfInventory("HHHAudioToken",2,"MoveIn",AAPTR_MASTER)
		Goto Out
	STFU:
		TNT1 A 0 A_StopSound(5)
		TNT1 A 0 A_StopSound(6)
		TNT1 A 0 A_StopSound(7)
	End:
		TNT1 A 0 A_TakeInventory("HHHAudioSpawned",2000,0,AAPTR_MASTER)
		TNT1 A 0 A_TakeInventory("HHHAudioToken",2000,0,AAPTR_MASTER)
		Stop
	}
}

Actor HHHAmmoTaker
{
	+NOINTERACTION
	States
	{
	Spawn:
		TNT1 A 70
		TNT1 A 0 A_JumpIfInventory("InfiniteAmmo",1,"Spawn",AAPTR_MASTER)
		TNT1 A 0 A_JumpIfInventory("PowerEconomizer",1,"Spawn",AAPTR_MASTER)
		TNT1 A 0 A_TakeInventory("DarkMana",1,1,AAPTR_MASTER)
		Loop
	}
}

Actor HHHProtectionOn : CustomInventory
{
	+INVENTORY.ALWAYSPICKUP
	States
	{
	Pickup:
		TNT1 A 0 A_SetReflectiveInvulnerable
		TNT1 A 0 A_ChangeFlag("NOPAIN",1)
		TNT1 A 0 A_ChangeFlag("NODAMAGE",1)
		TNT1 A 0 A_ChangeFlag("DONTTHRUST",1)
		TNT1 A 0 A_ChangeFlag(DONTRIP,1)
		TNT1 A 0 A_JumpIfInventory("Unrideable",1,2)
		TNT1 A 0 A_GiveInventory("Unrideable",1)
		TNT1 A 0 A_JumpIfInventory("HHHCheck",1,2)
		TNT1 A 0 A_GiveInventory("HHHCheck",1)
		TNT1 A 0 A_GiveInventory("HHHHealth",1)
		TNT1 A 0 A_JumpIfInventory("BasicArmor",664,2)
		TNT1 A 0 A_GiveInventory("HHHArmor",2)
		Stop
		TNT1 A 0 A_GiveInventory("UltimateArmor",1)
		Stop
	}
}

Actor HHHProtectionOff : CustomInventory
{
	+INVENTORY.ALWAYSPICKUP
	+INVENTORY.AUTOACTIVATE
	Inventory.MaxAmount 0
	States
	{
	Use:
		TNT1 A 0 A_JumpIf(CheckClass("DemonPlayerMorph",AAPTR_DEFAULT,0),"End")
		TNT1 A 0 A_ChangeFlag("NODAMAGE",0)
		TNT1 A 0 A_ChangeFlag("NOPAIN",0)
		TNT1 A 0 A_ChangeFlag("DONTTHRUST",0)
		TNT1 A 0 A_TakeInventory("Unrideable",1)
		TNT1 A 0 A_JumpIfInventory("PowerInvulBase",1,2)
		TNT1 A 0 A_UnsetInvulnerable
		TNT1 A 0 A_UnsetReflective
		TNT1 A 0 A_JumpIfInventory("PowerNoSeek",1,3)
		TNT1 A 0 A_SetRipMin(1)
		TNT1 A 0 A_ChangeFlag("DONTRIP",0)
		TNT1 A 0 A_TakeInventory("HHHCheck",10000)
		Stop
	End:
		TNT1 A 0
		Stop
	}
}

Actor HHHKnowledgePSpawnerSingle
{
	Projectile
	+NOINTERACTION
	+NOTIMEFREEZE
	Translation "0:255=%[0.5,1.0,2.0]:[0.5,0.55,1.6]"
	Speed 10
	Scale 0.25
	RenderStyle Add
	Alpha 0.1
	States
	{
	Spawn:
		TNT1 A 1
		TNT1 A 0 A_Stop
//		X013 B 1 Bright A_CustomMissile("HHHKnowledgeParticle",0,0,0+random(0,360),6,0+random(-90,90))
		TNT1 A 0 A_SpawnItemEx("HHHKnowledgeParticle",20,0,0,random(-15,15),random(-15,15),random(-15,15),0,SXF_NOCHECKPOSITION)
//		X013 CDEFGHIJKLMNOPQRSTUVWXY 1 bright
		Stop
	}
}

Actor HHHKnowledgePSpawnerDouble
{
	Projectile
	+NOINTERACTION
	+NOTIMEFREEZE
	Translation "0:255=%[0.5,1.0,2.0]:[0.5,0.55,1.6]"
	Scale 0.25
	Alpha 0.1
	Speed 10
	RenderStyle Add
	States
	{
	Spawn:
		TNT1 A 1
		TNT1 A 0 A_Stop
		X013 BB 0 Bright A_SpawnItemEx("HHHKnowledgeParticle",20,0,0,random(-15,15),random(-15,15),random(-15,15),0,SXF_NOCHECKPOSITION)
		X013 BCDEFGHIJKLMNOPQRSTUVWXY 1 bright
		Stop
	}
}

Actor HHHKnowledgeParticle
{
	Projectile
	+NOINTERACTION
	+NOTIMEFREEZE
//	Speed 15
	Scale 0.03
	Alpha 0.0
	RenderStyle Add
	States
	{
	Spawn:
		TNT1 A 1 A_ChangeVelocity(0+random(10,80),0,0,3)
		TNT1 A 0 A_ScaleVelocity(0.20)
		X099 AAAAAAAAAA 1 A_FadeIn(0.05)
		X099 A 2 A_ScaleVelocity(-1.0)
		X099 AAAA 2 A_ScaleVelocity(1.25)
		Stop
		//X029 A 2 A_FadeOut(0.1)
	}
}

Actor HHHArmor : ArmorBonus
{
	Armor.SaveAmount 2
	Armor.MaxSaveAmount 666
	Inventory.Icon ARM1A1
} 

Actor HHHHealth : HealthBonus
{
	Inventory.Amount 2
	Inventory.MaxAmount 666
}

Actor PowerPlayerGrounder : PowerProtection //Used to stop the player from being forced around by projectiles.
{
	DamageFactor 0.0
	DamageFactor "Normal", 0.0
	DamageFactor "Exit", 0.0
	DamageFactor "Suicide", 0.0
	DamageFactor "InstantDeath", 0.0
	DamageFactor "Telefrag", 0.0
	DamageFactor "Voodoo", 0.0
	+NOTELEFRAG
	//Powerup.Duration 9999999999
}

Actor PGrounder : PowerupGiver
{
	Powerup.Duration 9999999999
	Inventory.PickupMessage ""
	Inventory.MaxAmount 1
	powerup.type "PlayerGrounder"	
	+INVENTORY.AUTOACTIVATE
}

Actor ProtectionShover
{
	Projectile
	+DONTREFLECT
	+FORCERADIUSDMG
	+EXTREMEDEATH
	+NOINTERACTION
	Radius 1
	Height 1
	Speed 0
	States
	{
	Spawn:
		TNT1 A 0
		Goto Death
	Death:
		TNT1 A 0 A_Explode(50,256,0,0,128)
		Stop
	}
}

Actor HHHPentagramEffect
{
	Projectile
	+THRUACTORS
	+NOCLIP
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 1 A_Warp(AAPTR_TARGET,0,0,0,0,WARPF_NOCHECKPOSITION|WARPF_INTERPOLATE|WARPF_USECALLERANGLE|WARPF_TOFLOOR)
		Stop
	}
}

Actor Reverser : Inventory
{
	Inventory.Amount 1
	Inventory.MaxAmount 1
}

Actor PowerEternalTimeFreeze : PowerTimeFreezer { }

Actor EternalTimeEffector : PowerupGiver
{
	Inventory.PickupMessage ""
	//inventory.Icon "HARTRUN4"
	Inventory.MaxAmount 1
	Inventory.PickupSound "hhh/charge1"
	Inventory.UseSound "hhh/charge1"
	powerup.type "EternalTimeFreeze"
	powerup.duration 9999
	//Powerup.Color "0 0 0" 0.5
	+INVENTORY.FANCYPICKUPSOUND
	+INVENTORY.ALWAYSPICKUP
	+INVENTORY.AUTOACTIVATE
	+NOTIMEFREEZE
	States
	{
	Spawn:
		TNT1 A -1
		Stop
	Use:
		TNT1 A 1
		Stop
	}
}

Actor EternalMissile : FastProjectile
{
	Projectile
	+DONTREFLECT
	+NOTIMEFREEZE
	+SEEKERMISSILE
	+HITTRACER
	Damage 0
	Speed 200
	Radius 6
	Height 5
	MissileType "EternalMTrail1"
	States
	{
	Spawn:
		TNT1 A 0 A_FaceTracer
		TNT1 A 1 A_SeekerMissile(90,90,SMF_LOOK,256)
		Loop
	Death:
		TNT1 A 0 A_CheckFlag("NODAMAGE",1,AAPTR_TRACER)
		Goto Finish
		
		TNT1 A 0 A_JumpIf(CheckClass("FDeathBringerThanatos",AAPTR_TRACER,0) ||
							CheckClass("PlayerPawn",AAPTR_TRACER,1),"Finish")
		//TNT1 A 0 A_SetHealth(health-666,AAPTR_TRACER)
	Finish:
		TNT1 A 1 A_CustomMissile("EternalCometSpawner",0,0,0,6)
		Stop
	}
}

Actor EternalCometSpawner
{
	Projectile
	+FLOORHUGGER
	//+SPAWNFLOOR
	+THRUACTORS
	+BLOODLESSIMPACT
	+NOTIMEFREEZE
	RenderStyle None
	Radius 1
	Height 1
	Speed 0
	Damage 0
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SpawnItemEx("EternalCExplosion",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER)
		TNT1 A 0 A_SpawnItemEx("EternalComet",0,0,0,0,0,40,0,SXF_NOCHECKPOSITION|SXF_SETMASTER)
		TNT1 A 30
		Stop
	}
}

Actor EternalComet
{
	Projectile
	+THRUACTORS
	+FORCERADIUSDMG
	+EXTREMEDEATH
	+NODAMAGETHRUST +CANNOTPUSH
	+PAINLESS
	+NOTIMEFREEZE
	+FOILINVUL
	+RANDOMIZE
	Speed 0
	Radius 1
	Height 1
	RenderStyle Add
	DamageType "Extreme"
	PainType "Telefrag"
	DeathType "Telefrag"
	States
	{
	Spawn:
		X027 A 0
		X027 A 0 A_Explode(150,100,0)
		X027 A 1 Bright A_SpawnItemEx("EternalCometTrail",0,0,0,random(-4,4),random(-4,4),-20,0,SXF_NOCHECKPOSITION)
		X027 B 0 A_Explode(150,100,0)
		X027 B 1 Bright A_SpawnItemEx("EternalCometTrail",0,0,0,random(-4,4),random(-4,4),-20,0,SXF_NOCHECKPOSITION)
		X027 C 0 A_Explode(150,100,0)
		X027 C 1 Bright A_SpawnItemEx("EternalCometTrail",0,0,0,random(-4,4),random(-4,4),-20,0,SXF_NOCHECKPOSITION)
		X027 D 0 A_Explode(150,100,0)
		X027 D 1 Bright A_SpawnItemEx("EternalCometTrail",0,0,0,random(-4,4),random(-4,4),-20,0,SXF_NOCHECKPOSITION)
		X027 E 0 A_Explode(150,100,0)
		X027 E 1 Bright A_SpawnItemEx("EternalCometTrail",0,0,0,random(-4,4),random(-4,4),-20,0,SXF_NOCHECKPOSITION)
		X027 F 0 A_Explode(150,100,0)
		X027 F 1 Bright A_SpawnItemEx("EternalCometTrail",0,0,0,random(-4,4),random(-4,4),-20,0,SXF_NOCHECKPOSITION)
		X027 G 0 A_Explode(150,100,0)
		X027 G 1 Bright A_SpawnItemEx("EternalCometTrail",0,0,0,random(-4,4),random(-4,4),-20,0,SXF_NOCHECKPOSITION)
		X027 H 0 A_Explode(150,100,0)
		X027 H 1 Bright A_SpawnItemEx("EternalCometTrail",0,0,0,random(-4,4),random(-4,4),-20,0,SXF_NOCHECKPOSITION)
		X027 I 0 A_Explode(150,100,0)
		X027 I 1 Bright A_SpawnItemEx("EternalCometTrail",0,0,0,random(-4,4),random(-4,4),-20,0,SXF_NOCHECKPOSITION)
		X027 J 0 A_Explode(150,100,0)
		X027 J 1 Bright A_SpawnItemEx("EternalCometTrail",0,0,0,random(-4,4),random(-4,4),-20,0,SXF_NOCHECKPOSITION)
		X027 K 0 A_Explode(150,100,0)
		X027 K 1 Bright A_SpawnItemEx("EternalCometTrail",0,0,0,random(-4,4),random(-4,4),-20,0,SXF_NOCHECKPOSITION)
		Goto Spawn+1
	Death:
		TNT1 A 0 A_Explode(666,256,0)
		TNT1 A 0 A_SpawnItemEx("EternalCExplosion",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER)
		Stop
	}
}

Actor EternalCExplosion
{
	+NOINTERACTION
	+NODAMAGETHRUST +CANNOTPUSH
	+EXTREMEDEATH
	+FORCERADIUSDMG
	+NOTIMEFREEZE
	+FOILINVUL
	RenderStyle None
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_Explode(666,333,0)
		TNT1 AAAAA 0 A_SpawnItemEx("EternalPuffs",0,0,0,random(6,-6)/(2*1.05),random(6,-6)/(2*1.05),random(6,-6)/(2*1.05),0,SXF_NOCHECKPOSITION)
		TNT1 A 35 A_QuakeEx(5,5,0, 35,0,100,"", QF_SCALEDOWN)
		Stop
	}
}

Actor EternalCExplosion2 : EternalCExplosion
{
	DamageType Disintegrate
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_Explode(512,768,0)
		TNT1 AA 0 A_SpawnItemEx("EternalPuffs",0,0,0,random(6,-6)/(2*1.05),random(6,-6)/(2*1.05),random(6,-6)/(2*1.05),0,SXF_NOCHECKPOSITION)
		TNT1 A 10 A_QuakeEx(2,2,0, 10,0,20,"", QF_SCALEDOWN)
		Stop
	}
}

Actor EternalPuffs : BFGBallSmoke
{
	+NOTIMEFREEZE
	Scale 1
	Speed 6
	Translation "0:255=%[0.4,0.3,0.1]:[1.0,1.1,2.0]"
}

Actor EternalCometTrail
{
	Projectile
	+NOTIMEFREEZE
	+NOINTERACTION
	Speed 8
	RenderStyle Add
	Scale 2.0
	Alpha 0.7
	States
	{
	Spawn:
		X032 ABCDEFGHIJKLMNOABCDEFGHIJKLMNO 1 A_ScaleVelocity(0.05)
		X032 ABCDEFGHIJKLMNO 1 A_FadeOut(0.05)
		Goto Spawn+30
	}
}
	
Actor EternalMTrail1
{
	Projectile
	+NOTIMEFREEZE
	+NOINTERACTION
	Alpha 0.35
	Speed 1
	RenderStyle Add
	States
	{
	Spawn:
		X032 A 0
		X032 A 0 ThrustThing(0+random(0,360),4,0,0)
		X032 A 0 ThrustThingZ(0,random(0,4),random(0,1),1)
		X032 ABCDEFGHIJKLMNO 1 A_FadeOut(0.05)
		Goto Spawn+3
	Death:
		TNT1 A 0
		Stop
	}
}

Actor HHHCheck : Inventory
{
	Inventory.Amount 1
	Inventory.MaxAmount 3
	Inventory.InterHubAmount 0
}

Actor HHHModeChecker : Inventory
{
	Inventory.Amount 1
	Inventory.MaxAmount 2
}

Actor HHHHAX : CustomInventory
{
	+INVENTORY.ALWAYSPICKUP
	+INVENTORY.AUTOACTIVATE
	States
	{
	Use:
		TNT1 A 0 A_CheckFlag("FRIENDLY","End")
		TNT1 A 0 A_CheckFlag("NODAMAGE",1)
		Stop
		TNT1 A 0 A_JumpIf(CheckClass("FDeathBringerThanatos",AAPTR_DEFAULT) ||
						CheckClass("PlayerPawn",AAPTR_DEFAULT),"End")
		TNT1 A 0 A_JumpIfHealthLower(667,2)
		TNT1 A 0 A_SetHealth(health-666) //Remember, A_SetHealth cannot kill.
		Stop
		TNT1 A 0 A_SetHealth(1)
		Stop
	End:
		TNT1 A 0 A_RailWait
		Stop
	}
}

//The Wrath of God is upon you! Repent, Heathen, or SUFFER!
Actor GodsWrath
{
	Radius 4
	Height 4
	Speed 28
	Damage 256
	SeeSound "hhh/fire1"
	DeathSound "weapons/explode1"
	DamageType "HolyNoResist"
	DeathType "Disintegrate"
	PROJECTILE
	+EXTREMEDEATH
	+RIPPER
	RipperLevel 666
	+FLOORHUGGER
	+DONTSPLASH
	+FORCERADIUSDMG
	+DONTREFLECT
	+NOTIMEFREEZE
	+FOILINVUL
	+THRUACTORS
	+OLDRADIUSDMG //Ignores z distance for explosion radius. No more of those WOGPW hacks.
	Translation "0:255=%[0,0,0]:[1,1,1]"
	RENDERSTYLE ADD
	States
	{
	Spawn:
		TNT1 A 0 A_CustomMissile("EternalPuffs",0,0,0+random(0,360),2,0+random(0,90))
		TNT1 A 0 A_RadiusGive("HHHHAX",666,RGF_MONSTERS,1)
		TNT1 A 1 A_Explode(666,768,0,0,666)
		Loop
	Death:
		TNT1 AAAAAA 0 A_CustomMissile("EternalPuffs",0,0,0+random(0,360),2,0+random(0,90))
		TNT1 A 0 A_ChangeFlag("NODAMAGETHRUST",1)
		TNT1 A 1 A_Explode(1000000,1024,0,0,512)
		Stop
	}
}

Actor WOGPW
{
	Radius 16
	Height 3
	Speed 0
	Scale 0.4
	Damage 180
	DamageType Disintegrate
	Projectile
	+RIPPER
	RipperLevel 666
	+BLOODLESSIMPACT
	+DONTREFLECT
	+FOILINVUL
	+NoBlockmap
	+LowGravity
	+ActivatePCross
	+ActivateImpact
	+NoTeleport
	+DropOff
	+DontFall
	+NOTIMEFREEZE
	+NOPAIN
	+NODAMAGETHRUST +CANNOTPUSH
	+DONTSPLASH
	RenderStyle None
	States
	{
	Spawn:
		AASX ZZZZ 0
		BAL1 A 4 ThrustThingZ(0,250,0,1)
		BAL1 A 4 ThrustThingZ(0,2,0,1)
		BAL1 A 4 ThrustThingZ(0,2,0,1)
		BAL1 A 4 ThrustThingZ(0,1,0,1)
		BAL1 A 4 ThrustThingZ(0,1,0,1)
		BAL1 AAAA 4 
		Goto Spawn+9
	Death:
		TNT1 A 1
		Stop
	}
}

Actor WOGP2W
{
	Radius 16
	Height 3
	Speed 0
	Scale 0.4
	Damage 180
	DamageType Disintegrate
	Projectile
	+RIPPER
	RipperLevel 666
	+BLOODLESSIMPACT
	+DONTREFLECT
	+FOILINVUL
	+NoBlockmap
	+LowGravity
	+ActivatePCross
	+ActivateImpact
	+NoTeleport
	+DropOff
	+DontFall
	+NOPAIN
	+NOTIMEFREEZE
	+NODAMAGETHRUST +CANNOTPUSH
	+DONTSPLASH
	RenderStyle None
	States
	{
	Spawn:
		AASX ZZZZ 0
		BAL1 A 4 ThrustThingZ(0,-250,0,1)
		BAL1 A 4 ThrustThingZ(0,-2,0,1)
		BAL1 A 4 ThrustThingZ(0,-2,0,1)
		BAL1 A 4 ThrustThingZ(0,-1,0,1)
		BAL1 A 4 ThrustThingZ(0,-1,0,1)
		BAL1 AAAA 4 
		Goto Spawn+9
	Death:
		TNT1 A 1
		Stop
	}
}

Actor WOGPS
{
	Radius 16
	Height 10
	Speed 60
	Scale 0.4
	Damage 100
	DamageType Disintegrate
	Projectile
	+RIPPER
	RipperLevel 666
	+BLOODLESSIMPACT
	+DONTREFLECT
	+FOILINVUL
	+NoBlockmap
	+LowGravity
	+ActivatePCross
	+ActivateImpact
	+NoTeleport
	+DropOff
	+DontFall
	+NOPAIN
	+NOTIMEFREEZE
	+NODAMAGETHRUST +CANNOTPUSH
	+DONTSPLASH
	RenderStyle None
	States
	{
	Spawn:
		BAL1 AAA 2 
		Stop
	Death:
		TNT1 A 1
		Stop
	}
}

Actor GodsWrathTrail
{
	Radius 8
	Height 6
	Speed 0
	DontHurtShooter
	Damage 0
	PROJECTILE
	+FLOORHUGGER
	+DONTSPLASH
	Scale 0.7
	RENDERSTYLE ADD
	States
	{
	Spawn:
		FRTF ABCDEFGHIJKLMO 2 Bright
		Goto Death
	Death:
		TNT1 A 2 Bright 
		Stop
	}
}

Actor HellHeavenHandDrop : AEoDWeaponDrop
{
	Inventory.MaxAmount 1
	States
	{
	Use:
		TNT1 A 0
		TNT1 A 0 A_UnSetInvulnerable
		TNT1 A 0 A_UnSetReflectiveInvulnerable
		TNT1 A 0 A_TakeInventory("PowerEternalTimeFreeze",1)
		TNT1 A 0 A_TakeInventory("PowerPlayerGrounder",1)
		TNT1 A 0 A_StopSound(CHAN_WEAPON)
		TNT1 A 0 A_StopSound(CHAN_LISTENERZ)
		TNT1 A 0 A_SpawnItemEx("DroppedHellHeavenHand",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		Stop
	}
}

Actor DroppedHellHeavenHand
{
	Radius 16
	Height 20
	States
	{
	Spawn:
		HELG A 15
		TNT1 A 0 A_SpawnItemEx("AEoDHellHeavenHandNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
}

Actor AEoDHellHeavenHandNoAmmo : AEoDHellHeavenHandItem
{
	+FLOORCLIP
	+IGNORESKILL	+DONTGIB
	Inventory.Amount 1
	Inventory.PickupSound "DMage/death" 
	Inventory.PickupMessage "You are now worthy of the Great one's strength, the Dark one's protection, and the Eternal one's knowledge! Behold the HELL AND HEAVEN HAND!"
	States
	{
	Spawn:
		HELG A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",0) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("RedMana",50,"Ammo")
		TNT1 A 0 A_JumpIfInventory("DarkMana",20,"Ammo3")
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("HellHeavenHandDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDHellHeavenHand",1)
		TNT1 A 0 A_TakeInventory("RedMana",50)
		TNT1 A 0 A_TakeInventory("DarkMana",20)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDHellHeavenHand",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,0,160,0)
		Fail
	Ammo:
		TNT1 A 0 A_JumpIfInventory("DarkMana",20,1)
		Goto Ammo2
		
		TNT1 A 0 A_TakeInventory("RedMana",50)
		TNT1 A 0 A_TakeInventory("DarkMana",20)
		TNT1 A 0 A_JumpIfInventory("AEoDHellHeavenHand",1,2)
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("HellHeavenHandDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDHellHeavenHand",1)
		Stop
	Ammo2:
		TNT1 A 0 A_TakeInventory("RedMana",50)
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("HellHeavenHandDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDHellHeavenHand",1)
		TNT1 A 0 A_TakeInventory("DarkMana",20)
		Stop
	Ammo3:
		TNT1 A 0 A_TakeInventory("DarkMana",20)
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("HellHeavenHandDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDHellHeavenHand",1)
		TNT1 A 0 A_TakeInventory("RedMana",50)
		Stop
	}
}

//==================================================================================
//==================================================================================
// "And I heard, as it were, the noise of thunder:
// 	One of the four beasts saying: "Come and see." And I saw.
// 	And behold, a white horse.
// 	And I heard a voice in the midst of the four beasts,
//	And I looked and behold: a pale horse.
//	And his name, that sat on him, was Death...
//	...and Hell followed with him."
//==================================================================================
//==================================================================================
Actor AEoDDeathsHandItem : AEoDWeaponPickup //6055
{
	+FLOORCLIP
	+IGNORESKILL	+DONTGIB
	Inventory.Amount 1
	Inventory.PickupMessage "You have found Death's Hand!"
	Inventory.PickupSound "weaponbuild"
	States
	{
	Spawn:
		WDHD A -1 Bright
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDDeathsHand",1,"Ammo")
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",0) <= 0,"Nothing")
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("DeathsHandDrop",1)
		TNT1 A 0 A_PrintBold("\cgSlot 10: Death's Hand")
		TNT1 A 0 A_GiveInventory("AEoDDeathsHand",1)
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDDeathsHand",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,0,157,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDDeathsHand",1)
		Stop
	}
}
 
Actor AEoDDeathsHand : AEoDWeaponBase // 6055
{
	+FLOORCLIP
	+IGNORESKILL	+DONTGIB
	+WEAPON.CHEATNOTWEAPON
	Inventory.PickupMessage "You have found Death's Hand!"
	Inventory.PickupSound "weaponbuild"
	Weapon.UpSound "weapons/draw"
	Weapon.AmmoType "RedMana"
	Weapon.AmmoType2 "DarkMana"
	Weapon.AmmoGive 50
	Weapon.AmmoGive2 20
	Weapon.AmmoUse 40
	Weapon.AmmoUse2 10
	Weapon.SelectionOrder 19900
	+WEAPON.CHEATNOTWEAPON
	Tag "Death's hand"
	States
	{
	Spawn:
		WDHD A -1 Bright
		Loop
	Ready:
		LEFG AAAAABBBBBCCCCCDDDDD 1 A_WeaponReady
		Loop
	Deselect:
		TNT1 A 0 	
		LEFG A 1 A_Lower
		LEFG AA 0 A_Lower
		Loop
	Select:
		TNT1 A 0 	
		LEFG A 1 A_Raise
		LEFG AA 0 A_Raise
		Loop
	Fire:
		LEFG EF 4 Bright
		LEFG G 4 Bright A_SetBlend("LightGoldenrod",0.7,10)
		TNT1 A 0 A_SetPitch(pitch-1.5)
		TNT1 A 0 A_PlaySound("diablo2/paladincast/holybolt",CHAN_BODY)
		TNT1 A 0 A_PlaySound("diablo2/paladincast/might",CHAN_WEAPON)
		LEFG H 4 Bright A_FireCustomMissile("DeathsHandMeteor",0,1)
		TNT1 A 0 A_SetPitch(pitch+1.5)
		LEFG IJKL 4 Bright
		Goto Ready
	AltFire:
		LEFG EF 4 Bright
		LEFG G 4 Bright A_SetBlend("White",0.7,10)
		TNT1 A 0 A_SetPitch(pitch-1.5)
		LEFG H 4 Bright A_FireCustomMissile("DeathsHandSeeker",0,3,0)
		TNT1 A 0 A_SetPitch(pitch+1.5)
		LEFG IJKGHIJKL 4 Bright
		Goto Ready
	}
}
 
Actor DeathsHandSeeker
{
	Radius 4
	Height 8
	Speed 16
	Projectile
	+SeekerMissile
	+BOUNCEONFLOORS
	+CANBOUNCEWATER
	+EXTREMEDEATH
	+NODAMAGETHRUST +CANNOTPUSH
	+DONTREFLECT
	+HITTRACER
	BounceFactor 1.0
	Scale 0.25
	Damage 7
	SeeSound "diablo2/paladincast/redemption"
	DeathSound "diablo2/paladincast/fanaticism"
	RenderStyle None
	States
	{
	Spawn:
		WHIT C 1 Bright A_SpawnItemEx("DeathDarkLightFX",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		WHIT C 0 Bright A_SeekerMissile(10,20,3,200)
		Loop
	Crash:
	XDeath:
		TNT1 A 0 A_Warp(AAPTR_TRACER,0,0,0,0,WARPF_USECALLERANGLE|WARPF_NOCHECKPOSITION|WARPF_STOP)
	Death:
		TNT1 A 0 A_SpawnItemEx("DthPillarSpawnerP",72,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_ABSOLUTEANGLE)
		TNT1 A 0 A_SpawnItemEx("DthPillarSpawnerP",72,0,0,0,0,0,30,SXF_NOCHECKPOSITION|SXF_ABSOLUTEANGLE)
		TNT1 A 0 A_SpawnItemEx("DthPillarSpawnerP",72,0,0,0,0,0,60,SXF_NOCHECKPOSITION|SXF_ABSOLUTEANGLE)
		TNT1 A 0 A_SpawnItemEx("DthPillarSpawnerP",72,0,0,0,0,0,90,SXF_NOCHECKPOSITION|SXF_ABSOLUTEANGLE)
		TNT1 A 0 A_SpawnItemEx("DthPillarSpawnerP",72,0,0,0,0,0,120,SXF_NOCHECKPOSITION|SXF_ABSOLUTEANGLE)
		TNT1 A 0 A_SpawnItemEx("DthPillarSpawnerP",72,0,0,0,0,0,150,SXF_NOCHECKPOSITION|SXF_ABSOLUTEANGLE)
		TNT1 A 0 A_SpawnItemEx("DthPillarSpawnerP",72,0,0,0,0,0,180,SXF_NOCHECKPOSITION|SXF_ABSOLUTEANGLE)
		TNT1 A 0 A_SpawnItemEx("DthPillarSpawnerP",72,0,0,0,0,0,210,SXF_NOCHECKPOSITION|SXF_ABSOLUTEANGLE)
		TNT1 A 0 A_SpawnItemEx("DthPillarSpawnerP",72,0,0,0,0,0,240,SXF_NOCHECKPOSITION|SXF_ABSOLUTEANGLE)
		TNT1 A 0 A_SpawnItemEx("DthPillarSpawnerP",72,0,0,0,0,0,270,SXF_NOCHECKPOSITION|SXF_ABSOLUTEANGLE)
		TNT1 A 0 A_SpawnItemEx("DthPillarSpawnerP",72,0,0,0,0,0,300,SXF_NOCHECKPOSITION|SXF_ABSOLUTEANGLE)
		TNT1 A 0 A_SpawnItemEx("DthPillarSpawnerP",72,0,0,0,0,0,330,SXF_NOCHECKPOSITION|SXF_ABSOLUTEANGLE)
		WHIT C 10 BRIGHT
		Stop
	}
}
 
Actor DthPillarSpawnerP
{
	Projectile
	Speed 35
	Damage 0
	RenderStyle None
	+NOINTERACTION
	States
	{
	Spawn:
		TNT1 A 1
		TNT1 A 0 A_PlaySound("wyvern/fire")
		TNT1 A 0 A_CustomMissile("DthPillarBaseP",0,0,0)
		TNT1 A 0 A_CustomMissile("DthPillarTopP",0,0,0)
		Stop
	}
}
 
Actor DthPillarBaseP
{
	Projectile
	Speed 0
	Damage 0
	+FLOORHUGGER
	+NOCLIP
	States
	{
	Spawn:
		SRBA EEEEFFFFGGGGHHHHIIII 1 A_CustomMissile("b3p",5,0,0)		//20
	Looping:
		SRBA J 1 A_FadeOut(0.05,FTF_CLAMP)
		SRBA J 0 A_CustomMissile("b3p",5,0,0)
		"####" "#" 0 A_JumpIf(alpha <= 0.0, 1)
		Loop
		TNT1 AAAAAAAAAA 1 A_CustomMissile("b3p",5,0,0)
		TNT1 AAAAAAAAAA 1 A_CustomMissile("b3p",5,0,0)
		Stop
	}
}
 
Actor DthPillarTopP
{
	Projectile
	Speed 0
	Damage 0
	+CEILINGHUGGER
	+NOCLIP
	+SPAWNCEILING
	States
	{
	Spawn:
		SRBA EEEEFFFFGGGGHHHHIIII 1 A_CustomMissile("b4p",-5,0,0)		//20
	Looping:
		SRBA J 1 A_FadeOut(0.05,FTF_CLAMP)
		SRBA J 0 A_CustomMissile("b4p",-5,0,0)
		"####" "#" 0 A_JumpIf(alpha <= 0.0, 1)
		Loop
		TNT1 AAAAAAAAAA 1 A_CustomMissile("b4p",-5,0,0)
		TNT1 AAAAAAAAAA 1 A_CustomMissile("b4p",-5,0,0)
		Stop
	}
}
 
Actor b3p
{
	Radius 1
	Height 1
	Speed 0
	Scale 0.4
	Damage 0
	RenderStyle Add
	Alpha 0.6
	Projectile
	+THRUACTORS
	+BLOODLESSIMPACT
	+LowGravity
	+EXTREMEDEATH
	+NODAMAGETHRUST +CANNOTPUSH
	+DONTREFLECT
	+DONTSPLASH
	+DontFall
	+NoTarget
	+FORCERADIUSDMG
	+FOILINVUL
	DamageType "PillarDamage"
	Translation "192:207=0:0"
	States
	{
	Spawn:
		AASX ZZZZ 0
		BTND A 0 Bright ThrustThingZ(0,50,0,1)
		BTND AAAA 1 Bright A_Explode(3,48,0,0,48)
		BTND H 0 Bright ThrustThingZ(0,2,0,1)
		BTND HHHH 1 Bright A_Explode(3,48,0,0,48)
		BTND C 0 Bright ThrustThingZ(0,2,0,1)
		BTND CCCC 1 Bright A_Explode(3,48,0,0,48)
		BTND F 0 Bright ThrustThingZ(0,1,0,1)
		BTND FFFF 1 Bright A_Explode(3,48,0,0,48)
		BTND I 0 Bright ThrustThingZ(0,1,0,1)
		BTND IIII 1 Bright A_Explode(3,48,0,0,48)
	Looping:
		BTND EEEEGGGGDDDDBBBBEEEE 1 Bright A_Explode(3,48,0,0,48)
		Loop
	Death:
		TNT1 A 1
		Stop
	}
}
 
Actor b4p : b3p
{
	States
	{
	Spawn:
		AASX ZZZZ 0
		BTND G 0 Bright ThrustThingZ(0,-50,0,1)
		BTND GGGG 1 Bright A_Explode(1,48,0,0,48)
		BTND B 0 Bright ThrustThingZ(0,-2,0,1)
		BTND BBBB 1 Bright A_Explode(1,48,0,0,48)
		BTND H 0 Bright ThrustThingZ(0,-2,0,1)
		BTND HHHH 1 Bright A_Explode(1,48,0,0,48)
		BTND C 0 Bright ThrustThingZ(0,-1,0,1)
		BTND CCCC 1 Bright A_Explode(1,48,0,0,48)
		BTND I 0 Bright ThrustThingZ(0,-1,0,1)
		BTND IIII 1 Bright A_Explode(1,48,0,0,48)
	Looping:
		BTND EEEEFFFFAAAAHHHHDDDD 4 Bright A_Explode(1,48,0,0,48)
		Loop
	}
}

Actor DeathsHandMeteorSpawner
{
	Radius 7
	Projectile
	Speed 0
	Damage 0
	+DONTREFLECT
	+RIPPER
	RipperLevel 3
	+BLOODLESSIMPACT
	+CEILINGHUGGER
	+SPAWNCEILING
	+PAINLESS
	+THRUACTORS
	RenderStyle None
	States
	{
	Spawn:
		PLAY A 0
		Stop
		}
}

Actor DeathsHandMeteor
{
	var int user_angle;
	var int user_z;
	var int user_target;
	Projectile
	Radius 6
	Height 12
	Speed 40
	Damage 250  //because is much faster now, hence, spending less time ripping a monster
	+FOILINVUL
	+RIPPER
	RipperLevel 3
	+BLOODLESSIMPACT
	+EXTREMEDEATH
	+NODAMAGETHRUST +CANNOTPUSH
	+FORCERADIUSDMG
	+DONTREFLECT
	+PAINLESS
	+SEEKERMISSILE
	+SCREENSEEKER
	//+NOINTERACTION
	+SKYEXPLODE
	+ICESHATTER
	+SCREENSEEKER
	+THRUACTORS
	//+CEILINGHUGGER
	RenderStyle Add
	DamageType "TempestLightning"
	DeathType "Ice"
	States
	{
	Spawn:
		TNT1 A 0 NoDelay A_TransferPointer(AAPTR_TARGET,AAPTR_DEFAULT,AAPTR_TARGET|AAPTR_PLAYER_GETTARGET,AAPTR_TRACER,4)
		TNT1 A 0 A_SeekerMissile(90,90,SMF_LOOK,256,25)
	SC1:
		TNT1 A 0 A_Warp(AAPTR_TRACER,0,0,0,0,WARPF_NOCHECKPOSITION,1)
		Stop
		TNT1 A 0 A_Warp(AAPTR_DEFAULT,x,y,ceilingz-(height+1),0,WARPF_NOCHECKPOSITION|WARPF_USECALLERANGLE|WARPF_ABSOLUTEPOSITION|WARPF_STOP,"SC2")
	SC2:
		TNT1 A 0 A_ChangeFlag("CEILINGHUGGER",0)
		TNT1 A 0 A_ChangeVelocity(0,0,-speed,CVF_REPLACE)
	Moving:
		TNT1 A 0 A_SpawnItemEx("DHSpiralParticle",25,0,0,0,0,0,user_angle,SXF_NOCHECKPOSITION) //DthSATrail1
		TNT1 A 0 A_SpawnItemEx("DHSpiralParticle",25,0,15,0,0,0,user_angle-15,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("DHSpiralParticle",25,0,30,0,0,0,user_angle-30,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("DHSpiralParticle",-25,0,0,0,0,0,user_angle,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("DHSpiralParticle",-25,0,15,0,0,0,user_angle-15,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("DHSpiralParticle",-25,0,30,0,0,0,user_angle-30,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SetUserVar("user_angle",user_angle+45)
		//TNT1 A 0 A_Warp(AAPTR_TRACER,0,0,z-floorz,0,WARPF_USECALLERANGLE|WARPF_NOCHECKPOSITION|WARPF_TOFLOOR)
		X029 A 1 Light("WhiteBigPoint2") A_Explode(64,50,0)
		TNT1 A 0 A_ChangeFlag("THRUACTORS",0)
		Loop
	Death:
		TNT1 A 0 A_SpawnItemEx("DthHndExploder",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("PBExplosionSpawner",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("ThunderBoltShooter",0,0,10,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		TNT1 A 0 A_SpawnItemEx("DeathsHandPrimaryFX",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("DeathsHandShockwave1",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("DeathsHandShockwave2",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_ChangeFlag("PAINLESS",0)
		TNT1 A 0 A_CheckFloor("FloorDeath")
		TNT1 A 0 A_Explode(random(800,3072),350,0)
		TNT1 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 0 A_SpawnItemEx("DfAExpParticle",0,0,0,frandom(5.5,-5.5),frandom(5.5,-5.5),frandom(5.5,-5.5),0,SXF_NOCHECKPOSITION)
		Goto "DeathCont"	   
	FloorDeath:
		TNT1 A 0 A_Explode(random(1024,2048),350,0)
		Goto "DeathCont"	   
	DeathCont:
		TNT1 A 0 A_SetDamageType("IceShatter") //Just to ensure they all shatter.
		TNT1 A 10 A_Explode(1,350,0,0,350)
		Stop
	Silent:
		TNT1 A 0
		Stop
	}
}
		
Actor DthHndExploder	//the one that hurts the player
{
	Projectile
	+NOINTERACTION
	+FOILINVUL
	+FORCERADIUSDMG
	+EXTREMEDEATH
	+ICESHATTER
	DeathType "Ice"
	States
	{	  
	Spawn:
		TNT1 A 0
		TNT1 A 2 A_Explode(200,256)  //only being too close could kill a full health player.
		Stop
	}
}
	
	
Actor ThunderBoltShooter
{
	Projectile
	+NOINTERACTION
	States
	{
	Spawn:
		TNT1 A 0 
		TNT1 AAAAAAAAAAAAAAAAAAAA 0 A_SpawnItemEx("DeathsThunderBoltLightning",0,0,0,170,0,frandom(-20.0,20.0),random(0,359),SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		TNT1 AAAAAAAAAA 0 A_SpawnItemEx("DeathsThunderBoltLightning",0,0,0,170,0,frandom(-20.0,20.0),random(0,359),SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		TNT1 A 2
		TNT1 AAAAAAAAAAAAAAAAAAAA 0 A_SpawnItemEx("DeathsThunderBoltLightning",0,0,0,170,0,frandom(-20.0,20.0),random(0,359),SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		TNT1 AAAAAAAAAA 0 A_SpawnItemEx("DeathsThunderBoltLightning",0,0,0,170,0,frandom(-20.0,20.0),random(0,359),SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		TNT1 A 2
		TNT1 AAAAAAAAAAAAAAAAAAAA 0 A_SpawnItemEx("DeathsThunderBoltLightning",0,0,0,170,0,frandom(-20.0,20.0),random(0,359),SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		TNT1 AAAAAAAAAA 0 A_SpawnItemEx("DeathsThunderBoltLightning",0,0,0,170,0,frandom(-20.0,20.0),random(0,359),SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		TNT1 A 2
		TNT1 AAAAAAAAAAAAAAAAAAAA 0 A_SpawnItemEx("DeathsThunderBoltLightning",0,0,0,170,0,frandom(-20.0,20.0),random(0,359),SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		TNT1 AAAAAAAAAA 0 A_SpawnItemEx("DeathsThunderBoltLightning",0,0,0,170,0,frandom(-20.0,20.0),random(0,359),SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		TNT1 A 2
		TNT1 AAAAAAAAAAAAAAAAAAAA 0 A_SpawnItemEx("DeathsThunderBoltLightning",0,0,0,170,0,frandom(-20.0,20.0),random(0,359),SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		TNT1 AAAAAAAAAA 0 A_SpawnItemEx("DeathsThunderBoltLightning",0,0,0,170,0,frandom(-20.0,20.0),random(0,359),SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		Stop
	}
}
	
Actor DeathsThunderBoltLightning : FastProjectile
{
	Speed 170
	Radius 8
	Height 12
	Damage 2
	RenderStyle Add
	DamageType "Electric"
	MissileType "ThunderBoltLightTrail"
	MissileHeight 8
	ReactionTime 12
	Scale 0.3
	States
	{
	Spawn:
		//TNT1 A 0 A_ChangeVelocity(170,0,random(-10,10),CVF_RELATIVE|CVF_REPLACE)
	//Looping:
		TNT1 A 1 A_CountDown
		Loop
	Death:
		TNT1 A 0 A_Jump(256,"Type1","Type2","Type3","Type4","Type5")
	Type1:
		ZAP9 A 1 Bright A_FadeOut(0.3)
		Wait
	Type2:
		ZAP9 B 1 Bright A_FadeOut(0.3)
		Wait
	Type3:
		ZAP9 C 1 Bright A_FadeOut(0.3)
		Wait
	Type4:
		ZAP9 D 1 Bright A_FadeOut(0.3)
		Wait
	Type5:
		ZAP9 E 1 Bright A_FadeOut(0.3)
		Wait
	}
}
	
Actor DeathsHandShockwave1
{
	var int user_angle;
	+NOINTERACTION
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SetUserVar("user_angle",0)
	Looper:
		TNT1 A 0 A_JumpIf(user_angle>=360,"EndLoop")
		TNT1 A 0 A_SpawnItemEx("DHSwave2Particle2",0,0,10,15,0,frandom(0,1),user_angle,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SetUserVar("user_angle",user_angle+7)
		Loop
	Endloop:
		TNT1 A 10
		Stop
	}

}

Actor DeathsHandShockwave2
{
	var int user_angle;
	+NOINTERACTION
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SetUserVar("user_angle",0)
	Looper:
		TNT1 A 0 A_JumpIf(user_angle>350,"EndLoop")
		TNT1 A 0 A_SpawnItemEx("DHSwave2Particle",0,0,10,7,0,0,user_angle,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SetUserVar("user_angle",user_angle+10)
		Loop
	Endloop:
		TNT1 A 10
		Stop
	}

}

Actor DHSwave2Particle
{
	+NOINTERACTION
	RenderStyle Add
	Translation "0:255=%[0,0,0]:[1.5,0.7,0.0]"
	States
	{
	Spawn:
		TNT1 A 0 
		TNT1 A 0 A_Jump(230,4,5,6,7,8,9,10,11,12,13)
		X102 ABCDEFGHIJKLMNOPQRSTUV 2 Bright A_FadeOut(0.03)
		TNT1 A 0 A_ScaleVelocity(0.5)
		Goto Spawn+2
	}
	
}
Actor DHSwave2Particle2
{
	+NOINTERACTION
	RenderStyle Add
	Translation "0:255=%[0,0,0]:[0.37,0.44,0.1]"
	States
	{
	Spawn:
		TNT1 A 0 
		TNT1 A 0 A_Jump(230,4,5,6,7,8,9,10)
		X102 ABCDEFGHIJKLMNOPQRSTUVXY 2 Bright A_FadeOut(0.03)
		TNT1 A 0 A_ScaleVelocity(0.3)
		Goto Spawn+2
	}
	
}

Actor DeathsHandShockWave
{
	Speed 5
	Damage 5
	Radius 12
	Height 16
	RenderStyle Translucent
	Alpha 0.2
	Scale 0.8
	PROJECTILE
   +BLOODLESSIMPACT
	+NODAMAGETHRUST +CANNOTPUSH
	DamageType "TempestLightning"
	+RIPPER	RipperLevel 1
	Translation "80:111=215:222"
	States
	{
	Spawn:
		HSHK CCAABBCCC 4
	Death:
		HSHK C 1
		Stop
	}
}
 
Actor DeathsHandDrop : AEoDWeaponDrop
{
	Inventory.MaxAmount 1
	States
	{
	Use:
		TNT1 A 0
		TNT1 A 0 A_SpawnItemEx("DroppedDeathsHand",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		Stop
	}
}
 
Actor DroppedDeathsHand
{
	Radius 16
	Height 20
	States
	{
	Spawn:
		WDHD A 15 Bright
		TNT1 A 0 A_SpawnItemEx("AEoDDeathsHandNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
}
 
Actor AEoDDeathsHandNoAmmo : AEoDDeathsHandItem
{
	+FLOORCLIP
	+IGNORESKILL	+DONTGIB
	Inventory.Amount 1
	Inventory.PickupMessage "You have found Death's Hand!"
	Inventory.PickupSound "weaponbuild"
	States
	{
	Spawn:
		WDHD A -1 Bright
		Loop
	Pickup:
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",0) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("RedMana",30,"Ammo")
		TNT1 A 0 A_JumpIfInventory("DarkMana",10,"Ammo3")
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("DeathsHandDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDDeathsHand",1)
		TNT1 A 0 A_TakeInventory("RedMana",30)
		TNT1 A 0 A_TakeInventory("DarkMana",10)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDDeathsHand",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,0,157,0)
		Fail
	Ammo:
		TNT1 A 0 A_JumpIfInventory("DarkMana",10,1)
		Goto Ammo2
		
		TNT1 A 0 A_TakeInventory("RedMana",30)
		TNT1 A 0 A_TakeInventory("DarkMana",10)
		TNT1 A 0 A_JumpIfInventory("AEoDDeathsHand",1,2)
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("DeathsHandDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDDeathsHand",1)
		Stop
	Ammo2:
		TNT1 A 0 A_TakeInventory("RedMana",30)
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("DeathsHandDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDDeathsHand",1)
		TNT1 A 0 A_TakeInventory("DarkMana",10)
		Stop
	Ammo3:
		TNT1 A 0 A_TakeInventory("DarkMana",10)
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("DeathsHandDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDDeathsHand",1)
		TNT1 A 0 A_TakeInventory("RedMana",30)
		Stop
	}
}



//======================================================================================
//======================================================================================

//======================================================================================
//======================================================================================
Actor AEoDPenetratorItem : AEoDWeaponPickup
{
	+FLOORCLIP
	+IGNORESKILL	+DONTGIB
	Scale 0.2
	Inventory.Amount 1
	Inventory.PickupMessage "You picked up the Penetrator! Let's go grinding!"
	Inventory.PickupSound "BS/Bouncer/Pickup"
	States
	{
	Spawn:
		D015 J -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDPenetrator",1,"Ammo")
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",0) <= 0,"Nothing")
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("PenetratorDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDPenetrator",1)
		TNT1 A 0 A_PrintBold("\cgSlot 10: Penetrator")
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDPenetrator",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,0,151,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDPenetrator",1)
		Stop
	}
}


Actor PenetratorDrop : AEoDWeaponDrop
{
	Inventory.MaxAmount 1
	States
	{
	Use:
		TNT1 A 0
		TNT1 A 0 A_SpawnItemEx("DroppedPenetrator",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		Stop
	}
}


Actor DroppedPenetrator
{
	Radius 16
	Height 20
	Scale 0.2
	States
	{
	Spawn:
		D015 J 15
		TNT1 A 0 A_SpawnItemEx("AEoDPenetratorNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
} 



Actor AEoDPenetratorNoAmmo : AEoDPenetratorItem
{
	+IGNORESKILL	+DONTGIB
	States
	{
	Spawn:
		D015 J -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",0) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("ASTF",30,"Ammo")
		TNT1 A 0 A_JumpIfInventory("AERocket",6,"Ammo3")
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("PenetratorDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDPenetrator",1)
		TNT1 A 0 A_TakeInventory("ASTF",30)
		TNT1 A 0 A_TakeInventory("AERocket",6)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDPenetrator",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,0,151,0)
		Fail
	Ammo:
		TNT1 A 0 A_JumpIfInventory("AERocket",6,1)
		Goto Ammo2
		
		TNT1 A 0 A_TakeInventory("ASTF",30)
		TNT1 A 0 A_TakeInventory("AERocket",6)
		TNT1 A 0 A_JumpIfInventory("AEoDPenetrator",1,2)
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("PenetratorDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDPenetrator",1)
		Stop
	Ammo2:
		TNT1 A 0 A_TakeInventory("ASTF",30)
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("PenetratorDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDPenetrator",1)
		TNT1 A 0 A_TakeInventory("AERocket",6)
		Stop
	Ammo3:
		TNT1 A 0 A_TakeInventory("AERocket",6)
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("PenetratorDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDPenetrator",1)
		TNT1 A 0 A_TakeInventory("ASTF",30)
		Stop
	}
}


Actor AEoDPenetrator : AEoDWeaponBase
{
	+WEAPON.AMMO_OPTIONAL
	+WEAPON.ALT_AMMO_OPTIONAL
	Weapon.AmmoGive1 30
	Weapon.AmmoGive2 6
	Weapon.AmmoType1 "ASTF"
	Weapon.AmmoType2 "AERocket"
	Weapon.AmmoUse1 20
	Weapon.AmmoUse2 5
	Weapon.SelectionOrder 20100
	Weapon.UpSound "BS/Bouncer/Raise"
	Inventory.PickupMessage "You picked up the Penetrator! Let's go grinding!"
	Inventory.PickupSound "BS/Bouncer/Pickup"
	Tag "Penetrator"
	Scale 0.2
	States
	{
	Spawn: 
		D015 J -1
		Stop
	Ready:
		D015 A 0 A_JumpIfInventory("ChargeShotToken",1,"ReadyCharge")
		D015 A 0 A_PlaySound("BS/Penetrator/Idle",5,0.5,1)
		D015 A 1 A_WeaponReady
		Loop
	ReadyCharge:
		D015 A 0 A_PlaySound("BS/Penetrator/ChargeLoop",5,1,1)
		D015 A 0 A_QuakeEx(0,1,1,35,0,5,"",QF_SCALEDOWN|QF_RELATIVE)
		D015 AA 1 A_WeaponReady
		D015 A 0 A_JumpIfInventory("ChargeShotToken",1,"ReadyCharge")
		Goto Ready
	Select:
		TNT1 A 0 	
		D015 A 1 A_Raise
		D015 AA 0 A_Raise
		Loop
	Deselect:
		TNT1 A 0 	
		D015 A 0 A_TakeInventory("PenetratorTargetToken",1000,0)
		D015 A 0 A_StopSound(5)
		D015 A 1 A_Lower
		D015 AA 0 A_Lower
		Loop
	Fire:
		D011 A 0 A_JumpIfInventory("PenetratorTargetToken",1,"TargetFire")
		D011 G 0 A_JumpIfInventory("PowerEconomizer",1,"FireOK")
		D011 G 0 A_JumpIfInventory("InfiniteAmmo",1,"FireOK")
		D011 G 0 A_JumpIfInventory("ChargeShotToken",1,"CheckAmmoChargedShot")
	CheckAmmoNormalShot:
		D011 G 0 A_JumpIfInventory("ASTF",20,1)
		Goto Ready
		
		D011 G 0 A_JumpIfInventory("AERocket",5,1)
		Goto Ready
		
		D011 G 0 A_TakeInventory("ASTF",20,1)
		D011 G 0 A_TakeInventory("AERocket",5,1)
		Goto FireOK
	CheckAmmoChargedShot:
		D011 G 0 A_JumpIfInventory("ASTF",30,1)
		Goto Ready
		
		D011 G 0 A_JumpIfInventory("AERocket",6,1)
		Goto Ready
		
		D011 G 0 A_TakeInventory("ASTF",30,1)
		D011 G 0 A_TakeInventory("AERocket",6,1)
		Goto FireCharge
	FireOK:
		D011 G 0 A_JumpIfInventory("ChargeShotToken",1,"FireCharge")
		D011 G 0 A_FireCustomMissile("PenetratorDrill",0,0,6)
		D011 G 0 A_PlaySound("BS/Penetrator/Fire",CHAN_WEAPON,1,0)
		D011 G 0 A_GunFlash
		D011 GH 1 Bright A_SetPitch(pitch-4)
		D011 IJK 1 Bright
		D015 CC 1
		D015 CCCCCCCC 1 A_SetPitch(pitch+1)
		D015 D 0 A_PlaySound("BS/Penetrator/Reload",6,1,0)
		D015 DEFG 4
		D015 H 0 A_PlaySound("BS/Penetrator/ReloadClamp",7,1,0)
		D015 HI 4
		Goto Ready
	TargetFire:
		D015 A 0 A_FireBullets(0,0,1,0,"PenetratorTargetTP")
		D015 A 15 A_TakeInventory("PenetratorTargetToken",1000,0)
		Goto Ready
	FireCharge:
		D011 G 0 A_TakeInventory("ChargeShotToken",1000,0)
		D011 G 0 A_FireCustomMissile("PenetratorDrillCharged",0,0,6)
		D011 G 0 A_PlaySound("BS/Penetrator/AltFireToOff",CHAN_WEAPON,1,0)
		D011 G 0 A_GunFlash
		D011 GH 1 Bright A_SetPitch(pitch-4)
		D011 IJK 1 Bright
		D015 CC 1
		D015 CCCCCCCC 1 A_SetPitch(pitch+1)
		D015 D 0 A_PlaySound("BS/Penetrator/Reload",6,1,0)
		D015 DEFG 4
		D015 H 0 A_PlaySound("BS/Penetrator/ReloadClamp",7,1,0)
		D015 HI 4
		Goto Ready
	AltFire:
		D015 A 0 A_TakeInventory("PenetratorTargetToken",1000,0)
		D015 A 1 Offset(0,42)
		D015 A 1 Offset(0,52)
		D015 A 1 Offset(0,62)
		D015 A 1 Offset(0,72)
		D015 A 1 Offset(0,82)
		D015 A 0 A_JumpIfInventory("ChargeShotToken",1,2)
		D015 A 0 A_GiveInventory("ChargeShotToken",1)
		Goto AltOn
		
		D015 A 0 A_TakeInventory("ChargeShotToken",1000,0)
		Goto AltOff
	AltOn:
		D015 A 0 A_StopSound(5)
		D015 A 8 Offset(0,82) A_PlaySound("BS/Penetrator/AltToggle",6,1,0)
		D015 A 1 Offset(0,72) A_PlaySound("BS/Penetrator/AltSpeedUp",7,1,0)
		D015 A 1 Offset(0,62)
		D015 A 1 Offset(0,52)
		D015 A 1 Offset(0,42)
		D015 A 1 Offset(0,32)
		Goto Ready
	AltOff:
		D015 A 0 A_StopSound(5)
		D015 A 8 Offset(0,82) A_PlaySound("BS/Penetrator/AltToggle",6,1,0)
		D015 A 1 Offset(0,72) A_PlaySound("BS/Penetrator/AltSlowDown",7,1,0)
		D015 A 1 Offset(0,62)
		D015 A 1 Offset(0,52)
		D015 A 1 Offset(0,42)
		D015 A 1 Offset(0,32)
		Goto Ready
	Flash:
		D015 BC 3
		Stop

	}
}

Actor ChargeShotToken : Inventory
{	Inventory.MaxAmount 1	}

//-------------------------------------------------------
// Normal Shot
Actor PenetratorDrill : FastProjectile
{
	var int user_ripper;
	+RIPPER	RipperLevel 1
	+DONTREFLECT
	+SEEKERMISSILE
	+FOILINVUL
	+NOBOSSRIP
	+SKYEXPLODE
	+EXTREMEDEATH
	+HITTRACER
	Speed 70
	Damage 35
	Radius 6
	Height 6
	Scale 0.65
	MissileType "PenetratorDrillTrail"
	MissileHeight 8
	States
	{
	Spawn:
		R021 G 0 NoDelay A_SeekerMissile(0,0)
	Movement:
		R021 G 1
		Loop
	Death:
		R021 G 0 A_Stop 
		R021 G 350 A_PlaySound("BS/Penetrator/DrillExplode")
		R021 G 1 A_FadeOut(0.02)
		Wait
	Crash:
	XDeath:
		TNT1 A 0 A_SpawnItemEx("DrillerGrinding",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		Stop
	}
}

Actor DrillerGrinding
{
	var int user_angle[2];
	var int user_ripper;
	var int user_z;
	Projectile
	+NOCLIP
	+SEEKERMISSILE
	+DONTREFLECT
	+FORCERADIUSDMG
	+FOILINVUL
	+EXTREMEDEATH
	+NOEXPLODEFLOOR
	Radius 6
	Height 6
	Speed 1
	States
	{
	Spawn:
		TNT1 A 0 NoDelay A_SetUserArray(user_angle,0,angle)
		TNT1 A 0 A_SetUserVar(user_z,z)
		TNT1 A 0 A_Warp(AAPTR_TRACER,0,0,0,0,WARPF_NOCHECKPOSITION)
		TNT1 A 0 A_SetUserArray(user_angle,1,angle)
		TNT1 A 0 A_SetUserVar(user_z,user_z-z)
		TNT1 A 0 A_Warp(AAPTR_TRACER,0,0,user_z,user_angle[0]-user_angle[1],WARPF_NOCHECKPOSITION,"Grind",0,-0.75)
		Goto End
	Grind:
		R021 G 0 A_FaceTracer
		R021 GGG 0 A_CustomRailgun(random(4,8),0,none,none,3,0,0,"DrillerPuff")
		R021 G 1 A_SetUserVar("user_ripper",user_ripper+1)
		R021 G 0 A_JumpIf(user_ripper>=(35*4),"End")
		R021 G 0 A_JumpIfHealthLower(1,"End",AAPTR_TRACER)
		"####" "#" 0 A_Warp(AAPTR_TRACER,0,0,user_z,user_angle[0]-user_angle[1],WARPF_NOCHECKPOSITION|WARPF_INTERPOLATE,"Grind",0,-0.75)
		Goto End
	End:
		TNT1 A 0 A_SpawnItemEx("NewExplosionSmall",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION) 
		TNT1 A 10 A_PlaySound("BS/Penetrator/DrillExplode")
		Stop
	}
}

Actor DrillerPuff
{
	+FOILINVUL
	+NOBLOCKMAP
	+PUFFGETSOWNER
	Projectile
	States
	{
	Spawn:
		TNT1 A 0
		Stop
	}
}

//------------------------------------------------------
// Charged shot

Actor PenetratorDrillCharged : FastProjectile
{
	var int user_limit;
	Projectile
	+SEEKERMISSILE
	+DONTREFLECT
	+FOILINVUL
	+FORCERADIUSDMG
	+EXTREMEDEATH
	+BLOODSPLATTER
	Damage 100
	Radius 6
	Height 6
	Speed 70
	Scale 0.6
	MissileType "PenetratorDrillTrail"
	MissileHeight 8
	States
	{
	Spawn:
		R021 G 0
		R021 G 0 A_SeekerMissile(0,0,2)
	Movement:
		R021 G 1
		Loop
	Death:
		TNT1 A 1 A_SpawnItemEx("PenetratorDrillPhase2",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		Stop
	}
}

Actor PenetratorDrillTrail
{
	+NOINTERACTION
	RenderStyle Add
	Scale 0.2
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_Jump(210,4,8,12,16,18)
		X105 ABCDEFGHIJKLMNOPQRSTUVWX 2 A_FadeOut(0.04)
		Goto Spawn+2
	}
}

Actor PenetratorDrillPhase2
{
	var int user_count;
	Projectile
	Radius 8
	Height 8
	Speed 0
	Scale 0.65	
	FloatBobPhase 2
	+THRUACTORS
	+CANBOUNCEWATER
	+SEEKERMISSILE
	+BOUNCEONWALLS
	+BOUNCEONFLOORS
	+BOUNCEONCEILINGS
	+ALLOWBOUNCEONACTORS
	+DONTREFLECT
	+CANBOUNCEWATER
	+SKYEXPLODE
	+EXTREMEDEATH
	RenderStyle None
	States
	{
	Spawn:
		R021 G 0 NoDelay A_GiveInventory("PenetratorTargetToken",1,AAPTR_TARGET)
		R021 G 0 A_CheckFloor("BumpUp")
		R021 G 0 A_CheckCeiling("BumpDown")
		Goto Cont
	BumpUp:
		"----" A 0 A_Warp(AAPTR_DEFAULT,0,0,4,0,WARPF_NOCHECKPOSITION,"Cont")
		Goto Cont
	BumpDown:
		"----" A 0 A_Warp(AAPTR_DEFAULT,0,0,-4,0,WARPF_NOCHECKPOSITION,"Cont")
		Goto Cont
	Cont:
		R021 G 0 A_SpawnItemEx("PenetratorImpacter",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS|SXF_SETMASTER|SXF_ORIGINATOR)
	Waiting:
		R021 G 1 Bright A_SetUserVar("user_count",user_count+1)
		R021 G 0 A_JumpIf(user_count>=(35*5),2)
		R021 G 0 A_JumpIfInventory("PenetratorTargetToken",1,"Waiting",AAPTR_TARGET)
		Goto Shot
		
		R021 G 0 A_TakeInventory("PenetratorTargetToken",1000,0,AAPTR_TARGET)
	Shot:
		R021 G 0 A_RemoveChildren(1,RMVF_EVERYTHING,"PenetratorImpacter")
		R021 G 0 A_SpawnItemEx("PenetratorHaterade",5,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_ISTRACER|SXF_SETTRACER|SXF_ORIGINATOR)
		R021 G 0 Bright A_GiveInventory("PenetratorTargetSpawner",1,AAPTR_TARGET)
		R021 GGGGG 1 A_Teleport("ShotSuccess","PenetratorTargetTP","None",TF_FORCED|TF_OVERRIDE|TF_NOFOG|TF_USESPOTZ,0,0,AAPTR_TRACER)
		Goto ShotCont
	ShotSuccess:
		"####" "#" 0 A_SpawnItemEx("PenetratorTarget",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
	ShotCont:
		R021 G 0 A_FaceTracer(0,0,0,0,FAF_TOP)
		R021 G 0 A_SeekerMissile(90,90,SMF_PRECISE)
		R021 G 1 A_SpawnItemEx("PenetratorDrill2",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS|SXF_TRANSFERPITCH)
		R021 G 0 A_RemoveChildren(1,RMVF_EVERYTHING,"PenetratorHaterade")
		Stop
	}
}

Actor PenetratorImpacter
{
	Projectile
	+BLOODSPLATTER
	+RIPPER	RipperLevel 666
	+DONTREFLECT
	+EXTREMEDEATH
	+BOUNCEONFLOORS
	+BOUNCEONWALLS
	+BOUNCEONCEILINGS
	+CANBOUNCEWATER
	+FLOATBOB
	Scale 0.65
	Radius 8
	Height 8
	Damage 10
	
	FloatBobPhase 2
	States
	{
	Spawn:
		R021 G 0
		"----" AAAAAA 35
		Stop
	}
}

Actor PenetratorTargetSpawner : CustomInventory
{
	+INVENTORY.ALWAYSPICKUP
	States
	{
	Pickup:
		TNT1 A 0 A_FireBullets(0,0,1,0,"PenetratorTargetTP",0)
		Stop
	}
}

Actor PenetratorHaterade
{
	Monster
	+NONSHOOTABLE
	+NODAMAGE
	+THRUACTORS
	+NOGRAVITY
	-COUNTKILL
	+NOTELEPORT
	+NOTELESTOMP
	+ALWAYSTELEFRAG
	+NOINTERACTION
	Radius 0
	Height 1
	RenderStyle None
	States
	{
	Spawn:
		TNT1 A 6
		Stop
	}
}
		
Actor PenetratorTargetTP : SpecialSpot
{
	+PUFFGETSOWNER
	+NOTELESTOMP
	-TELESTOMP
	+BLOODLESSIMPACT
	+PAINLESS
	+NOINTERACTION
	+PUFFONACTORS
	+ALWAYSPUFF
	Damage 0
	Radius 4
	Height 1
	RenderStyle None
	States
	{
	Spawn:
		TNT1 A 6
		Stop
	}
}
	


Actor PenetratorTarget
{
	var int user_count;
	+FORCEXYBILLBOARD
	+NOINTERACTION
	Radius 1
	Height 1
	RenderStyle Add
	Alpha 0.0
	Translation "0:255=%[0,0,0]:[2.0,0,0]"
	States
	{
	Spawn:
		TNT1 A 0 NoDelay A_Warp(AAPTR_TRACER,0,0,0,0,WARPF_NOCHECKPOSITION)
		TNT1 A 0 A_Stop
		TNT1 A 2 A_SetUserVar("user_count",50)
	Death:
	SizeLoop:
		X060 A 0 A_SetScale((user_count*0.01))
		X060 A 0 A_JumpIf(user_count<=0.05,"LoopEnd") 
		X060 A 1 Bright A_FadeTo(1.0,0.05,FTF_CLAMP)
		X060 A 0 A_SetUserVar("user_count",user_count-3)
		Loop	  
	LoopEnd:
		X060 A 1 Bright A_FadeOut(0.1)
		Wait
	}
}

Actor PenetratorDrill2 : FastProjectile
{
	var int user_ripper;
	+RIPPER	RipperLevel 1
	+DONTREFLECT
	+SEEKERMISSILE
	+FOILINVUL
	+NOBOSSRIP
	+SKYEXPLODE
	+EXTREMEDEATH
	+HITTRACER
	Speed 70
	Damage 35
	Radius 4
	Height 4
	Scale 0.65
	MissileType "PenetratorDrillTrail"
	MissileHeight 8
	States
	{
	Spawn:
		R021 G 0 NoDelay A_FaceTracer(0,0,0,0,FAF_TOP)
		"----" A 0 A_SeekerMissile(90,90,SMF_PRECISE)
	Movement:
		R021 G 35 bright
		Loop
	Death:
		"----" A 0 A_PlaySound("BS/Penetrator/DrillExplode")
		R021 G 350 A_Stop
		R021 G 1 A_FadeOut(0.02)
		Wait
	Crash:
	XDeath:
		TNT1 A 0 A_CheckFlag("SHOOTABLE","Success",AAPTR_TRACER)
		TNT1 A 0 A_SpawnItemEx("NewExplosionSmall",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION) 
		TNT1 A 0 A_PlaySound("BS/Penetrator/DrillExplode")
		Stop
	Success:
		TNT1 A 0 A_SpawnItemEx("DrillerGrinding",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		Stop
	}
}

Actor PenetratorTargetToken : Inventory
{	Inventory.MaxAmount 1	Inventory.InterhubAmount 0	}
		
Actor DrillRipperTrail
{
	Projectile
	+RIPPER	RipperLevel 1
	+DONTREFLECT
	+FOILINVUL
	+EXTREMEDEATH
	Radius 6
	Height 6
	Speed 0
	Damage 2
	RenderStyle None
	States
	{
	Spawn:
		TNT1 AAAAAAAAAAA 1
		Stop
	}
}

//==============================================================================
//==============================================================================
// 								The Soul Reaper
//					 Weapon from Painkiller Hell and Damnation
//						Ripped and Coded by Major Cooke
//==============================================================================
//==============================================================================

/*	
	Yet another fabled weapon from the Grim Reaper, also known as Death.
	When Death met Daniel Garner on the lonely road after beating Lucifer
	and saving Purgatory, as well as Alastor for the last time, he offered
	him a way to Heaven at long last. Naturally, Daniel was mistrustful of
	Death until he showed him that it was he who carried him up to Purgatory
	once he died, giving him a token of the dancing doll found on his
	dashboard.
	
	The only price he would have to pay, is to gather seven thousand souls.
	Unfortunately, much of the history of Daniel after the instatement of
	said agreement was lost, but there are scraps of the modder's journals
	that occasionally contain the rant about "stupid fucking story" and
	why "Death was a complete god damn panzy" in it.
	
	Apparently, the modder who ripped the weapon from Painkiller thought
	the story was worthy of a raspberry award with a goldenized turd sealed
	on top of it... however, he couldn't stop using the Soul Reaper enough
	because of how fucking awesome that was, at least.
*/

Actor AEoDSoulReaperItem : AEoDWeaponPickup
{
	+FLOORCLIP
	+IGNORESKILL	+DONTGIB
	Inventory.Amount 1
	Inventory.PickupMessage "The Soul Reaper is yours! Let the feast begin..."
	Inventory.PickupSound "PainKiller/PickupNew"
	Scale 0.2
	States
	{
	Spawn:
		M011 Z -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDSoulReaper",1,"Ammo")
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",0) <= 0,"Nothing")
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("SoulReaperDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDSoulReaper",1)
		TNT1 A 0 A_PrintBold("\cgSlot 10: Soul Reaper")
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDSoulReaper",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,0,158,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDSoulReaper",1)
		Stop
	}
}

Actor AEoDSoulReaper : AEoDWeaponBase
{
	+WEAPON.ALT_AMMO_OPTIONAL
	+WEAPON.NOAUTOAIM
	Weapon.AmmoGive1 60
	Weapon.AmmoGive2 50
	Weapon.AmmoType1 "ASTF"
	Weapon.AmmoType2 "GreenMana"
	Weapon.AmmoUse1 15
	Weapon.AmmoUse2 1
	Weapon.SelectionOrder 9830
	Weapon.UpSound "PainKiller/PickupNew"
	Inventory.PickupMessage "The Soul Reaper is yours! Let the feast begin..."
	Inventory.PickupSound "PainKiller/PickupNew"
	Tag "Soul Reaper"
	Scale 0.2
	States
	{
	Spawn:
		M011 Z -1
		Stop
	Select:
		M011 A 0 A_GiveInventory("SoulReaperToken",1)
	SelLoop:
		M011 A 1 A_Raise
		M011 AA 0 A_Raise
		Loop
	Deselect:
		//M011 A 0 A_RadiusGive("SoulSeekOff",16383,RGF_MONSTERS|RGF_NOSIGHT,1) //A_GiveInventory("SoundStopper",1)
	DesLoop:
		M011 A 0 A_TakeInventory("SoulReaperToken",10000)
		M011 A 0 A_TakeInventory("SoulReaperAltToken",10000)
		M011 A 1 A_Lower
		M011 AA 0 A_Lower
		Loop
	Ready:
		M011 AAAAA 1 A_WeaponReady(WRF_ALLOWRELOAD)
		M011 A 0 A_TakeInventory("SoulReaperAltToken",1000)
		Loop
	Fire:
		"####" A 0 A_JumpIfInventory("SoulReaperAltToken",1,"TCheck")
	FireCont:
		"####" A 0 A_FireCustomMissile("SoulReaperBlade",0,1,3)
		"####" B 0 A_PlaySound("SoulReaper/Fire",CHAN_WEAPON,1)
		"####" BBB 1 Bright A_SetPitch(pitch-1)
		"####" BBBB 1 A_SetPitch(pitch+0.25)
		"####" CCCCCCDD 1 A_SetPitch(pitch+0.25)
		"####" DDDEEEEFFFF 2
		"####" "#" 0 A_ReFire("FireCont")
		Goto Ready
	AltFire:
		//"####" A 0 A_RadiusGive("SoulSeekOn",2048,RGF_MONSTERS|RGF_NOSIGHT)
		"####" A 0 A_GiveInventory("SoulReaperAltToken",1)
		"####" A 0 A_PlaySound("SoulReaper/soulbeamloop",CHAN_WEAPON,1,1)
		"####" "#" 0 A_Refire("AltHold")
	AltHold:
		//"####" A 0 A_RadiusGive("SoulSeekOn",2048,RGF_MONSTERS|RGF_NOSIGHT)
		"####" A 0 Offset(2,33) Bright A_FireCustomMissile("SoulReaperBeam",0,0,9,2)
		"####" A 1 Offset(2,33) Bright A_WeaponReady(WRF_NOSECONDARY|WRF_DISABLESWITCH|WRF_NOBOB)
		"####" A 0 Offset(1,32) Bright A_FireCustomMissile("SoulReaperBeam",0,0,9,2)
		"####" A 1 Offset(1,32) Bright A_WeaponReady(WRF_NOSECONDARY|WRF_DISABLESWITCH|WRF_NOBOB)
		"####" A 0 A_Refire("AltHold")
		
		"####" A 0 A_TakeInventory("SoulReaperAltToken",1000,0)
		//"####" A 0 A_RadiusGive("SoulSeekOff",16383,RGF_MONSTERS|RGF_NOSIGHT)
		"####" A 0 A_PlaySound("SoulReaper/soulbeamend",CHAN_WEAPON,1,0)
		Goto Ready
	TCheck:
		"####" A 0 A_TakeInventory("SoulReaperAltToken",1000,0)
	TertiaryFire:
		"####" "#" 0 A_JumpIfInventory("SRBConverterOut",1,"FireCont")
		"####" "#" 0 A_JumpIfInventory("PowerEconomizer",1,"TerFireSuccess")
		"####" "#" 0 A_JumpIfInventory("InfiniteAmmo",1,"TerFireSuccess")
		"####" "#" 0 A_JumpIfInventory("GreenMana",1,1)
		Goto FireCont
	TerFireSuccess:
		"####" B 0 A_GiveInventory("SRBConverterOut",1)
		"####" B 0 A_FireCustomMissile("SoulReaperBladeConverter",0,0,4)
		"####" B 0 A_PlaySound("SoulReaper/FireBig",CHAN_WEAPON,1)
		"####" B 1 Bright A_SetPitch(pitch-1)
		//"####" B 0 Bright A_GiveInventory("SoulReaperInf",1)
		"####" BBBB 1 A_SetPitch(pitch+0.25)
		"####" CCCCCCDD 1 A_SetPitch(pitch+0.25)
		"####" DDDEEEEFFFF 2 A_WeaponReady(WRF_NOPRIMARY|WRF_NOSECONDARY|WRF_NOSWITCH|WRF_NOBOB)
		"####" "#" 0 A_Refire("AltFire")
		Goto Ready
	}
}

Actor SoulReaperInf : CustomInventory
{
	+INVENTORY.ALWAYSPICKUP
	+INVENTORY.AUTOACTIVATE
	Inventory.MaxAmount 0
	States
	{
	Use:
		TNT1 A 0 A_JumpIfInventory("InfiniteAmmo",1,"Success")
		TNT1 A 0 A_JumpIfInventory("PowerEconomizer",1,"Success")
		Stop
	Success:
		TNT1 A 0 A_GiveInventory("GreenMana",1)
		Stop
	}
}

Actor SoulReaperBladeConverter
{
	var int user_amount;
	var int user_strength;
	var int user_inf;
	Projectile
	+HITTRACER
	+DONTREFLECT
	+SKYEXPLODE
	+EXPLODEONWATER
	+CAUSEPAIN
	+FORCEPAIN
	+FORCERADIUSDMG
	+BRIGHT
	Speed 50
	Damage 0
	Radius 15
	Height 4
	Scale 0.10
	DeathType "Extreme"
	Translation "0:255=%[0,0,0]:[1,2,1]"
	States
	{
	Spawn:
		M011 G 1 A_SpawnItemEx("SRBTrail",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION|SXF_TRANSFERSCALE|SXF_TRANSFERSPRITEFRAME)
		Loop
	Crash:
	XDeath:
		"####" "#" 0 A_Stop
		"####" "#" 0 A_ChangeFlag("NOINTERACTION",1)
		"####" "#" 0 A_TakeInventory("SRBConverterOut",1000,0,AAPTR_TARGET)
		"####" "#" 0 A_JumpIfInventory("InfiniteAmmo",1,"Inf",AAPTR_TARGET)
		"####" "#" 0 A_JumpIfInventory("PowerEconomizer",1,"Inf",AAPTR_TARGET)
		TNT1 A 0 A_JumpIf(CheckClass("PlayerPawn",AAPTR_DEFAULT,1),"ExplosionEffect")
		"####" "#" 0 A_JumpIf(CheckClass("SpyCrab",AAPTR_TRACER,1) || 
							CheckClass("HTC2BlackBear",AAPTR_TRACER,1) ||
							CheckClass("BerthaBear",AAPTR_TRACER,1) ||
							CheckClass("FBeggar",AAPTR_TRACER,1) ||
							CheckClass("Bvictim",AAPTR_TRACER,1) ||
							CheckClass("HLScientist",AAPTR_TRACER,1) ||
							CheckClass("HL2Citizen",AAPTR_TRACER,1) ||
							CheckClass("FPeasant",AAPTR_TRACER,1) ||
							CheckClass("FBeggar",AAPTR_TRACER,1) ||
							CheckClass("FRat",AAPTR_TRACER,1) ||
							CheckClass("HLBabyHeadcrab",AAPTR_TRACER,1) ||
							CheckClass("FMiniSpider1",AAPTR_TRACER,1) ||
							CheckClass("FMiniSpider2",AAPTR_TRACER,1) ||
							CheckClass("FMiniSpider3",AAPTR_TRACER,1) ||
							CheckClass("LILCaleb",AAPTR_TRACER,1), "Destroy") 
		Goto DGood
	Inf:
		"####" "#" 0 
		{
			A_SetUserVar(user_inf,1);
			A_SetUserVar(user_strength,400);
		}
	DGood:
		"####" "#" 0
		{
			if (CountInv("GreenMana",AAPTR_TARGET) > 400)
			{
				A_SetUserVar(user_strength,400);
			}
			else
			{
				A_SetUserVar(user_strength,CountInv("GreenMana",AAPTR_TARGET));
			}
			A_TakeInventory("GreenMana",400,TIF_NOTAKEINFINITE,TargetPtr);
		}
		Goto CheckMonster
	//==========================================================================
	//End Loop.
	//==========================================================================
		CheckMonster:
			"####" "#" 0 A_CheckFlag("ISMONSTER","CheckAEoD",AAPTR_TRACER)
			Goto Destroy
		CheckAEoD:
			
			"####" "#" 0 A_JumpIfInventory("AEoDToken",1,"CheckBlacklist",AAPTR_TRACER)
			//If testing is required for specific monsters, comment this out.
			Goto Destroy
		CheckBlacklist:
			"####" "#" 0 A_JumpIf(CheckClass("WeepingAngel",AAPTR_TRACER,1),"SpecialDestroy")
			Goto Choose
	Choose:
		"####" "#" 0 A_CheckFlag("FRIENDLY","Restore",AAPTR_TRACER)
		"####" "#" 0 A_CheckFlag("NODAMAGE","Convert",AAPTR_TRACER)
		"####" "#" 0 A_Jump(64,"DemonMorph")
		"####" "#" 0 A_Jump(150,"Convert")
		Goto Destroy
		
		SpecialDestroy:
			TNT1 A 0 A_DropItem("DemonMorphPowerup",1,256)
			Goto Destroy
		Destroy:
			TNT1 A 0 A_JumpIf(CheckClass("FDeathBringerThanatos",AAPTR_DEFAULT,0),"DBTAttention")
			TNT1 A 0 A_CheckFlag("NODAMAGE","ReturnMana",AAPTR_TRACER)
			TNT1 A 0 A_DamageTracer(100000,"DemonMorph",DMSS_FOILBUDDHA|DMSS_FOILINVUL|DMSS_NOFACTOR)
			Goto Explosion
		DBTAttention: //Just to turn DBT's attention back to the player.
			TNT1 A 0 A_DamageTracer(10,"NEIN")
			Goto Explosion
		//==========================================================================
		Convert:
			"####" "#" 0 A_CheckFlag("FRIENDLY","Restore",AAPTR_TRACER)
			"####" "#" 0 A_JumpIf(	CheckClass("FDeathBringerThanatos",AAPTR_TRACER,1),"Restore")
		Restore:
			"####" "#" 0 A_SpawnItemEx("SRBMaxController",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
			Goto Explosion
		//==========================================================================
		DemonMorph:
			"####" "#" 0 A_DropItem("DemonMorphPowerup",1,256)
			Goto Explosion
			
	//==========================================================================
	//End of 400 Green Mana.
	//==========================================================================
	//399 green mana or less.
	ConvertSmall:
		"####" "#" 0 A_Jump(128,"DmgSmaller")
		"####" "#" 0 A_RadiusGive("SoulReaperStrength",(128+user_strength),RGF_MONSTERS,user_strength)
		"####" "#" 0 A_RadiusGive("SRBFriendlifier",(128+user_strength),RGF_MONSTERS,1)
		Goto Explosion
	DmgSmaller:
		"####" "#" 0 A_Explode(user_strength*random(4,8),128+user_strength,0,0,128+user_strength)
	//And where it all winds up afterwards.
		Goto Explosion
	ReturnMana:
		"####" "#" 0 A_JumpIf(user_inf == 1,"Explosion")
		"####" "#" 0 A_GiveInventory("GreenManaOrb",user_strength,AAPTR_TARGET)
	Explosion:
		"####" "#" 0 A_Explode(0,128,0,0,128)
	ExplosionEffect:
	End:
	Death:
		"####" "#" 0 A_SpawnItemEx("PBExplosionDebrisless",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION)
		"####" "#" 1 A_TakeInventory("SRBConverterOut",1000,0,AAPTR_TARGET)
		Stop
	}
}

Actor SRMonsterDestroyer : CustomInventory
{
	+INVENTORY.ALWAYSPICKUP
	States
	{
	Pickup:
		TNT1 A 0 A_CheckFlag("FRIENDLY","End")
		TNT1 A 0 A_JumpIf(CheckClass("FDeathBringerThanatos",AAPTR_DEFAULT,0),"End")
		TNT1 A 0 A_JumpIf(CheckClass("PlayerPawn",AAPTR_DEFAULT,1),"End")
		TNT1 A 0 A_CheckFlag("VULNERABLE","Cont")
		Goto Cont
	Cont:
		TNT1 A 0 A_DamageSelf(100000,"DemonMorph",DMSS_FOILBUDDHA|DMSS_FOILINVUL|DMSS_NOFACTOR)
		Stop
	Cont2:
		TNT1 A 0 A_ChangeFlag("VULNERABLE",1)
		TNT1 A 0 A_DamageSelf(100000,"DemonMorph",DMSS_FOILBUDDHA|DMSS_FOILINVUL|DMSS_NOFACTOR)
		TNT1 A 0 A_ChangeFlag("VULNERABLE",0)
		Stop
	End:
		TNT1 A 0
		Stop
	}
}

Actor SoulReaperConvertToken : Inventory
{	Inventory.MaxAmount 1	Inventory.InterhubAmount 0	}

Actor SoulReaperStrength : Inventory
{	Inventory.MaxAmount 400	Inventory.InterhubAmount 0	}

Actor SRBConverterOut : Inventory
{	Inventory.MaxAmount 1	Inventory.InterhubAmount 0	}

Actor SRACount : Inventory
{	Inventory.MaxAmount 35	Inventory.InterhubAmount 0	}

Actor SRBFriendlifier : CustomInventory
{
	+INVENTORY.ALWAYSPICKUP
	+INVENTORY.AUTOACTIVATE
	States
	{
	Use:
		TNT1 A 0 A_SpawnItemEx("SRBController",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETTRACER)
		Stop
	}
}

Actor SRBController
{
	var int user_hp;
	var int user_health;
	var int user_strength;
	var int user_str2;
	var int user_timed[2];
	Projectile
	+NOINTERACTION
	+NODAMAGE
	+NOTONAUTOMAP
	RenderStyle None
	States
	{
	Spawn:
		TNT1 A 0 NoDelay A_CheckFlag("FRIENDLY","Looping",AAPTR_TRACER)
		TNT1 A 0 A_CheckFlag("ISMONSTER",1,AAPTR_TRACER)
		Goto DamageEnd
	// Death Inc has written an angry letter about letting in too many petlings and slaves.
	// Also, it's unfair trying to convert the big boss when you dont have 400 mana. WORK FOR IT!
		//"####" "#" 0 A_JumpIfInventory("AEoDToken",1,1,AAPTR_TRACER)
		//Goto DamageEnd
		"####" "#" 0 A_JumpIf(	CheckClass("FDeathBringerThanatos",AAPTR_TRACER,1) ||
								CheckClass("DBTVulnerableThing",AAPTR_TRACER,1) ||
								CheckClass("DBTVulnerableDouble",AAPTR_TRACER,1) ||
								CheckClass("DBTVulnerableThingSteel",AAPTR_TRACER,1) || 
								CheckClass("SpyCrab",AAPTR_TRACER,1) || 
								CheckClass("HTC2BlackBear",AAPTR_TRACER,1) ||
								CheckClass("BerthaBear",AAPTR_TRACER,1) ||
								CheckClass("FBeggar",AAPTR_TRACER,1) ||
								CheckClass("Bvictim",AAPTR_TRACER,1) ||
								CheckClass("HLScientist",AAPTR_TRACER,1) ||
								CheckClass("HL2Citizen",AAPTR_TRACER,1) ||
								CheckClass("FPeasant",AAPTR_TRACER,1) ||
								CheckClass("FBeggar",AAPTR_TRACER,1) ||
								CheckClass("FRat",AAPTR_TRACER,1) ||
								CheckClass("HLBabyHeadcrab",AAPTR_TRACER,1) ||
								CheckClass("FMiniSpider1",AAPTR_TRACER,1) ||
								CheckClass("FMiniSpider2",AAPTR_TRACER,1) ||
								CheckClass("FMiniSpider3",AAPTR_TRACER,1) ||
								CheckClass("LILCaleb",AAPTR_TRACER,1) ||
								CheckClass("WeepingAngel",AAPTR_TRACER,1),"DamageEnd")
	Looping:
		"####" "#" 0 A_JumpIfInventory("SoulReaperStrength",100,"Dec100",AAPTR_TRACER)
		"####" "#" 0 A_JumpIfInventory("SoulReaperStrength",10,"Dec10",AAPTR_TRACER)
		"####" "#" 0 A_JumpIfInventory("SoulReaperStrength",1,"Dec1",AAPTR_TRACER)
		
		Goto Decide
	Dec100:
		"####" "#" 0 A_TakeInventory("SoulReaperStrength",100,0,AAPTR_TRACER)
		"####" "#" 0 A_SetUserVar(user_strength,user_strength+100)
		Goto Looping
	Dec10:
		"####" "#" 0 A_TakeInventory("SoulReaperStrength",10,0,AAPTR_TRACER)
		"####" "#" 0 A_SetUserVar(user_strength,user_strength+10)
		Goto Looping
	Dec1:
		"####" "#" 0 A_TakeInventory("SoulReaperStrength",1,0,AAPTR_TRACER)
		"####" "#" 0 A_SetUserVar(user_strength,user_strength+1)
		Goto Looping
	Decide:
		TNT1 A 0 A_SetUserVar(user_hp,CallACS("SoulReaperHealthCheck",0,0,0)) //Gets their spawn health.
		TNT1 A 0 A_CheckFlag("FRIENDLY","Restore",AAPTR_TRACER)
		TNT1 A 0 A_SetUserVar(user_str2,random(1,400))
		TNT1 A 0 A_JumpIf(user_hp <= (1000 + (user_strength * 5)),1)
		Goto DamageEnd
		
		TNT1 A 0 A_JumpIf(user_strength + user_str2 >= 400,"Restore") //I need a better randomizer formula...
		Goto DamageEnd
	DamageEnd:
		TNT1 A 0 A_DamageTracer(user_strength*random(4,8)) //I dunno. Randumb is randumb. :B
		Stop
	Restore: //Converts and/or restores health to convertees or monsters already friendly.
		TNT1 A 0 A_ResetHealth(AAPTR_TRACER)
		TNT1 A 0 A_SetHealth(user_hp*user_strength,AAPTR_TRACER)
		TNT1 A 1 A_GiveInventory("SRFriendly",1,AAPTR_TRACER)
		Stop
	End:
		TNT1 A 0 
		Stop
	}
}

Actor SRBMaxController
{
	var int user_hp;
	var int user_health;
	var int user_strength;
	var int user_str2;
	var int user_timed[2];
	Projectile
	+NOINTERACTION
	+NODAMAGE
	+NOTONAUTOMAP
	RenderStyle None
	States
	{
	Spawn:
		TNT1 A 0 NoDelay A_CheckFlag("FRIENDLY","Restore",AAPTR_TRACER)
		"####" "#" 0 A_JumpIf( 	CheckClass("DBTVulnerableThing",AAPTR_TRACER,1) ||
							CheckClass("DBTVulnerableDouble",AAPTR_TRACER,1) ||
							CheckClass("DBTVulnerableThingSteel",AAPTR_TRACER,1), "GetMasterToTracer")
		"####" "#" 0 A_JumpIf(CheckClass("FDeathBringerThanatos",AAPTR_TRACER,0),"Looping")
		//"####" "#" 0 A_JumpIfInventory("AEoDToken",1,1,AAPTR_TRACER)
		//Goto DamageEnd
		TNT1 A 0 A_SetUserVar(user_hp,CallACS("SoulReaperHealthCheck",0,0,0)) //Get their spawn health.
		TNT1 A 0 A_JumpIf(user_hp > 50000,"DamageEnd") //Not from our mod!
	Looping:
		TNT1 A 0 A_JumpIfHealthLower(1,"End",AAPTR_TRACER)
		TNT1 A 350 A_GiveInventory("SRNoDamage",1,AAPTR_TRACER)
		Loop
	Restore:
		TNT1 A 0 A_ResetHealth(AAPTR_TRACER)
		TNT1 A 0 A_SetUserVar(user_hp,CallACS("SoulReaperHealthCheck",0,0,0)) //Get their spawn health.
		TNT1 A 0 A_SetHealth(user_hp*100,AAPTR_TRACER)
		TNT1 A 0 A_GiveInventory("SRFriendly",1,AAPTR_TRACER)
		Stop
	GetMasterToTracer:
		TNT1 A 0 A_TransferPointer(AAPTR_TRACER,AAPTR_DEFAULT,AAPTR_MASTER,AAPTR_TRACER,4)
		Goto Looping
	DamageEnd:
		TNT1 A 0 A_DamageTracer(100000,"Telefrag",DMSS_FOILBUDDHA|DMSS_FOILINVUL|DMSS_NOFACTOR)
		Stop
	End:
		TNT1 A 0 
		Stop
	}
}

Actor SRFriendly : CustomInventory
{
	+INVENTORY.ALWAYSPICKUP
	States
	{
	Pickup:
		TNT1 A 0 A_JumpIf(CheckClass("FDeathBringerThanatos",AAPTR_DEFAULT,0),2)
		TNT1 A 0 Thing_SetTranslation(0,109)
		TNT1 A 0 A_KillMaster("Telefrag",KILS_FOILINVUL,None,"AEoDSpawner")
		TNT1 A 0 A_ChangeFlag("FRIENDLY",1)
		TNT1 A 0 A_ChangeFlag("SOLID",0)
		TNT1 A 0 A_ChangeFlag("NOTELESTOMP",1)
		TNT1 A 0 A_ChangeFlag("NOBLOCKMONST",1)
		TNT1 A 0 A_ChangeFlag("DONTTHRUST",1)
		TNT1 A 0 A_ChangeFlag("THRUACTORS",1)
		TNT1 A 0 A_ChangeFlag("CANTSEEK",1)
		TNT1 A 0 A_CopyFriendliness(AAPTR_PLAYER1)
		TNT1 A 0 A_JumpIfInventory("SRFirepower",1,2)
		TNT1 A 0 A_GiveInventory("SRFirepower",1)
		TNT1 A 0 A_ChangeFlag("ALWAYSFAST",1)
		Stop
	End:
		TNT1 A 0
		Stop
	}
}

Actor SRFirepower : PowerDamage
{
	DamageFactor "Normal", 10
}

Actor SRNoDamage : CustomInventory
{
	+INVENTORY.ALWAYSPICKUP
	States
	{
	Pickup:
		TNT1 A 0 A_JumpIf(CheckClass("FDeathBringerThanatos",AAPTR_DEFAULT,0),2)
		TNT1 A 0 Thing_SetTranslation(0,109)
		TNT1 A 0 A_ChangeFlag("NODAMAGE",1)
		TNT1 A 0 A_ChangeFlag("SOLID",0)
		TNT1 A 0 A_ChangeFlag("NOTELESTOMP",1)
		TNT1 A 0 A_ChangeFlag("NOBLOCKMONST",1)
		TNT1 A 0 A_ChangeFlag("DONTTHRUST",1)
		TNT1 A 0 A_ChangeFlag("THRUACTORS",1)
		TNT1 A 0 A_ChangeFlag("CANTSEEK",1)
		TNT1 A 0 A_SetHealth(666666)
		TNT1 A 0 A_KillMaster("Telefrag",KILS_FOILINVUL,None,"AEoDSpawner")
		TNT1 A 0 A_CheckFlag("FRIENDLY","End")
		TNT1 A 0 A_ChangeFlag("FRIENDLY",1)
		TNT1 A 0 A_CopyFriendliness(AAPTR_PLAYER1)
		TNT1 A 0 A_TakeInventory("DBTDamageCounter",10000,0)
		Stop
	End:
		TNT1 A 0
		Stop
	}
}

Actor SoulReaperBeam
{
	var int user_seekflags;
	var int user_chance;
	var int user_y[3];
	var int user_z[3];
	//[0] = current position
	//[1] = offset amount to add after each move
	//[2] = positive or negative direction
	var int user_limit; //distance limit for lightning beam
	var int user_distance;
	var int user_time;
	var int user_override;
	var int user_c;
	var int user_t;
	var int user_soultype;
	var int user_soul;
	var int user_faceflags;
	Projectile
	+SEEKERMISSILE
	+DONTREFLECT
	+FOILINVUL
	+HITTRACER
	+PAINLESS
	+SCREENSEEKER
	+DONTSPLASH
	+NOTIMEFREEZE
	+NODAMAGETHRUST +CANNOTPUSH
	Speed 20
	Radius 4
	Height 2
	Damage 0
	DamageType "SoulReaperPull"
	//MaxTargetRange 4
	RenderStyle None
	States
	{
	Spawn:
		TNT1 A 0 NoDelay 
		{
			A_SetUserVar(user_t,0);
			if (random(1,10) == 1)
			{
				A_SetUserVar(user_chance,1);
				A_SetUserArray(user_y,1,random(10,50));
				A_SetUserArray(user_y,2,randompick(-1,1));
				A_SetUserArray(user_z,1,random(10,50));
				A_SetUserArray(user_z,2,randompick(-1,1));
				A_SetUserVar(user_limit,15);
				A_SetUserVar(user_time,random(3,30));
			}
			else
			{	A_SetUserVar(user_chance,0);	}

			if (A_CheckProximity("Null","DMSoulTarget",500,1,CPXF_SETTRACER|CPXF_CLOSEST|CPXF_CHECKSIGHT))
			{
					A_SetUserVar(user_faceflags,FAF_BOTTOM);
					A_SetUserVar(user_seekflags,SMF_PRECISE);
					A_ChangeFlag("THRUACTORS",1);
					A_GiveInventory("SoulSeekOn",1,AAPTR_TRACER);
					/*
				if (A_JumpIfTargetInLOS("Null",80,JLOSF_CHECKTRACER))
				{
					A_SetUserVar(user_faceflags,FAF_BOTTOM);
					A_SetUserVar(user_seekflags,SMF_PRECISE);
					A_ChangeFlag("THRUACTORS",1);
					A_GiveInventory("SoulSeekOn",1,AAPTR_TRACER);
				}
				else
				{
					A_SetUserVar(user_faceflags,FAF_MIDDLE);
					A_SetUserVar(user_seekflags,SMF_PRECISE|SMF_LOOK);
					A_RearrangePointers(AAPTR_DEFAULT,AAPTR_DEFAULT,AAPTR_NULL,PTROP_NOSAFEGUARDS);
				} */
			}
			else
			{
				A_SetUserVar(user_seekflags,SMF_PRECISE|SMF_LOOK);
			}
		}
		Goto Cont2
	Cont2:
		TNT1 A 0 
		{
			if(IsPointerEqual(AAPTR_TRACER,AAPTR_NULL))
			{	A_RearrangePointers(AAPTR_DEFAULT,AAPTR_DEFAULT,AAPTR_PLAYER_GETTARGET,4);	}
		}	
	L1:
		TNT1 A 0 A_JumpIf(user_chance < 1,"LCont")
		TNT1 A 0 A_SetUserVar(user_time,user_time-1)
		TNT1 A 0 A_JumpIf(user_time > 0,"L1S")
		TNT1 A 0 A_SetUserArray(user_y,1,random(10,50))
		TNT1 A 0 A_SetUserArray(user_z,1,random(10,50))
		TNT1 A 0 A_SetUserVar(user_time,random(3,30))
	L1S:
		TNT1 A 0 A_JumpIf((((user_y[0] + user_y[1])*0.1 < user_limit) && ((user_y[0] - user_y[1])*0.1 > (-user_limit))),"L2")
		TNT1 A 0 A_SetUserVar(user_override,1)
	L2:
		TNT1 A 0 A_JumpIf((user_override == 0) && (random(1,30) > 1),"L3")
		TNT1 A 0 A_SetUserArray(user_y,2,user_y[2]*-1)
		TNT1 A 0 A_SetUserVar(user_override,0)
	L3:
		TNT1 A 0 A_JumpIf(((user_z[0] + user_z[1])*0.1 < user_limit) && ((user_z[0] - user_z[1])*0.1 > (-user_limit)),"L4")
		TNT1 A 0 A_SetUserVar(user_override,1)
	L4:
		TNT1 A 0 A_JumpIf((user_override == 0) && (random(1,30) > 1),"L5")
		TNT1 A 0 A_SetUserArray(user_z,2,user_z[2]*-1)
		TNT1 A 0 A_SetUserVar(user_override,0)
	L5:
		TNT1 A 0 
		{
			A_SetUserArray(user_y,0,user_y[0]+(user_y[1]*user_y[2]));
			A_SetUserArray(user_z,0,user_z[0]+(user_z[1]*user_z[2]));
			A_SpawnItemEx("SoulReaperBeamElectricity",0,user_y[0]*0.1,user_z[0]*0.1,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS);
		}
	LCont:
		TNT1 A 0 
		{
			A_SpawnItemEx("SoulReaperBeamTrail",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS);
			A_SeekerMissile(1,1,user_seekflags,256,4);
			A_FaceTracer(10,10,0,0,user_faceflags);
			//A_Explode(1,128,0,0,128);
			if (A_Warp(AAPTR_DEFAULT,velx,vely,velz,0,WARPF_ABSOLUTEOFFSET,"Null"))
			{
				if ((GetDistance(true,TracerPtr) <= 64) && !IsPointerEqual(TracerPtr,NullPtr))
				{	return state("XDeath");	}
				
				A_SetUserVar(user_t,user_t+1);
				
				if (user_t > 20)
				{	return state("Check2");	}
			}
			else
			{
				return state("Check2");
			}
			return state("L1");
		}
	Check2:
		TNT1 AA 1 A_SeekerMissile(90,90,SMF_PRECISE)
	Death:
		TNT1 A 0
		Stop
	Crash:
	XDeath:
		TNT1 A 0 A_CheckFlag("SHOOTABLE","Dmg",AAPTR_TRACER)
		Stop
	Dmg:
		TNT1 A 0 A_JumpIf(CheckClass("DMSoulTarget",AAPTR_TRACER,0),"Specialty")		
		TNT1 A 0 A_JumpIfHealthLower(3,1,AAPTR_TRACER)
		Goto SkipSoul
		
		TNT1 A 0 A_CheckFlag("BUDDHA","SkipSoul",AAPTR_TRACER)
		TNT1 A 0 A_CheckFlag("NODAMAGE","SkipSoul",AAPTR_TRACER)
		TNT1 A 0 A_JumpIfHealthLower(1,"SkipSoul",AAPTR_TRACER)
		TNT1 A 0 A_SpawnItemEx("DMSoulMissile",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		TNT1 A 0 A_DamageTracer(2,"Extreme",DMSS_FOILINVUL,None,None,TargetPtr)
		TNT1 A 0 A_ChangeFlag("NODAMAGETHRUST",1)
		//TNT1 A 0 A_Explode(1,128,0,0,128)
		Stop
	SkipSoul:
		TNT1 A 0 A_DamageTracer(random(1,2),"Extreme",DMSS_FOILINVUL,None,None,TargetPtr)
		Stop
	DCont:
		TNT1 A 0 
		Stop
	Specialty:
		TNT1 A 0 A_Warp(AAPTR_TRACER,0,0,0,0,WARPF_NOCHECKPOSITION)
		TNT1 A 0 A_ChangeFlag("PAINLESS",0)
		TNT1 A 0 A_TransferPointer(AAPTR_DEFAULT,AAPTR_TRACER,AAPTR_TARGET,AAPTR_TARGET,4)
		TNT1 A 0 A_DamageTracer(1,"SoulReaperPull")
		//TNT1 A 0 A_SpawnItemEx("DMSoulMissile",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS,0,user_soultype)
		Stop
	}
}

Actor SoulReaperBeamElectricity
{
	+NOINTERACTION
	+NOTIMEFREEZE
	Translation "0:255=%[0,0,0]:[1,1,0]"
	Alpha 0.45
	Scale 0.05
	RenderStyle Add
	States
	{
	Spawn:
		X099 A 1 
		X099 A 1 A_FadeOut(0.035)
		Wait
	}
}

Actor SoulReaperBeamTrail
{
	var int user_s;
	var int user_r;
	var int user_t;
	+MISSILE
	+NODAMAGE
	+NOINTERACTION
	+NOTIMEFREEZE
	+SEEKERMISSILE
	Translation "0:255=%[0,0,0]:[0,1,0]"
	RenderStyle Add
	Scale 0.05
	Alpha 0.25
	Speed 0
	States
	{
	Spawn:
		X099 A 0 NoDelay A_SetUserVar(user_t,tid)
		X099 A 0 Thing_ChangeTID(0,0)
		X099 A 0 A_SetUserVar(user_s,random(1,5))
		X099 A 0 A_SetUserVar(user_r,random(0,359))
		X099 A 0 A_JumpIf(user_t > 0,"Specialty")
		X099 A 0 A_SetScale(frandom(0.03,0.06))		
		X099 A 0 A_SpawnItemEx("SoulReaperBeamTrail",-4.5,0,0,0,0,0,0,SXF_NOCHECKPOSITION,0,1)
		X099 A 0 A_SpawnItemEx("SoulReaperBeamTrail",-2.5,0,0,0,0,0,0,SXF_NOCHECKPOSITION,0,1)
		X099 A 0 A_SeekerMissile(10,10,SMF_PRECISE)
		X099 A 0 A_SpawnItemEx("SoulReaperBeamTrail",2.5,0,0,0,0,0,0,SXF_NOCHECKPOSITION,0,1)
		Goto Looping
	Specialty:
		X099 A 0 A_SetScale(ScaleX*frandom(0.02,0.04))
	Looping:
		X099 A 0 A_ChangeVelocity(0,cos(-user_r)*(user_s + frandom(0.1,0.5)),sin(user_r)*(user_s + frandom(0.1,0.5)),CVF_RELATIVE|CVF_REPLACE)
		X099 A 1 Bright A_FadeOut(0.025)
		Wait
	}
}

Actor SoulReaperToken : Inventory
{	Inventory.InterHubAmount 0		Inventory.MaxAmount 1	}

Actor SoulReaperAltToken : Inventory
{	Inventory.InterHubAmount 0		Inventory.MaxAmount 1	}

Actor SoulReaperBlade
{
	var int user_x[2];
	var int user_y[2];
	var int user_s;
	var int user_c;
	Projectile
	+RIPPER
	+DONTREFLECT
	+ALLOWBOUNCEONACTORS
	+BOUNCEONFLOORS
	+BOUNCEONWALLS
	+BOUNCEONCEILINGS
	+NOEXPLODEFLOOR
	+SKYEXPLODE
	+EXTREMEDEATH
	+USEBOUNCESTATE
	+SEEKERMISSILE
	+CANBOUNCEWATER
	+HITTRACER
	//+THRUACTORS
	RipperLevel 666 //It will rip through the greatest of monsters... Almost. 
	Damage 40
	Radius 15
	Height 4
	Speed 50
	BounceFactor 1
	WallBounceFactor 1
	Scale 0.10
	States
	{
	Spawn:
		M011 G 0
	Moving:
		M011 G 1 A_SpawnItemEx("SRBTrail",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERSCALE|SXF_TRANSFERSPRITEFRAME)
		M011 G 0 A_SetUserVar(user_c,user_c+1)
		M011 G 0 A_SetUserVar(user_s,0)
		Loop
	Bounce.Wall:
	Bounce.Floor:
	Bounce.Ceiling:
		M011 G 0 A_JumpIf(user_c > 175,"Death")
		M011 G 0 A_JumpIf(user_s == 1,"Moving")
		M011 G 0 A_SetUserVar(user_s,1)
		M011 G 1 A_RearrangePointers(AAPTR_DEFAULT,AAPTR_DEFAULT,AAPTR_NULL,4)
		M011 GGGG 0 A_SeekerMissile(90,90,SMF_LOOK|SMF_PRECISE,256)
		Goto Moving
	Bounce.Actor:
		M011 G 0 A_JumpIf(user_c > 175,"Death")
		M011 G 0 A_CheckFlag("SHOOTABLE",1,AAPTR_TRACER)
		Goto Moving
		
		M011 G 0 A_RearrangePointers(AAPTR_DEFAULT,AAPTR_DEFAULT,AAPTR_NULL,4)
		M011 GGGG 0 A_SeekerMissile(90,90,SMF_LOOK|SMF_PRECISE,256)
		Goto Moving
	Death:
		M011 G 0 A_SpawnItemEx("SoulReaperBladeDone",0,0,0,velx,vely,velz,0,SXF_NOCHECKPOSITION|SXF_ABSOLUTEVELOCITY|SXF_TRANSFERSCALE|SXF_TRANSFERSPRITEFRAME)
		Stop
	}
}

Actor SoulReaperBladeDone
{
	Projectile
	+THRUACTORS
	+BOUNCEONFLOORS
	+BOUNCEONWALLS
	+BOUNCEONCEILINGS
	+NOEXPLODEFLOOR
	+SKYEXPLODE
	-NOGRAVITY
	+BOUNCEAUTOOFFFLOORONLY
	+EXPLODEONWATER
	BounceType "Doom"
	Radius 12
	Height 4
	Speed 40
	States
	{
	Spawn:
		"####" "#" 350
	Death:
		"####" "#" 1 A_FadeOut(0.05)
		Wait
	}
}

Actor SRBTrail
{
	+NOINTERACTION
	RenderStyle Add
	States
	{
	Spawn:
		"####" "#" 1 A_FadeOut(0.1)
		Wait
	}
}

Actor SoulReaperDrop : AEoDWeaponDrop
{
	Inventory.MaxAmount 1
	States
	{
	Use:
		TNT1 A 0
		TNT1 A 0 A_SpawnItemEx("DroppedSoulReaper",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		Stop
	}
}


Actor DroppedSoulReaper
{
	Radius 16
	Height 20
	Scale 0.2
	States
	{
	Spawn:
		M011 Z 15
		TNT1 A 0 A_SpawnItemEx("AEoDSoulReaperNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
} 



Actor AEoDSoulReaperNoAmmo : AEoDSoulReaperItem
{
	+IGNORESKILL	+DONTGIB
	States
	{
	Spawn:
		M011 Z -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",0) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("ASTF",60,"Ammo")
		TNT1 A 0 A_JumpIfInventory("GreenMana",1,"Ammo3")
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("SoulReaperDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDSoulReaper",1)
		TNT1 A 0 A_TakeInventory("ASTF",60)
		TNT1 A 0 A_TakeInventory("GreenMana",1)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDPenetrator",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,0,158,0)
		Fail
	Ammo:
		TNT1 A 0 A_JumpIfInventory("GreenMana",1,1)
		Goto Ammo2
		
		TNT1 A 0 A_TakeInventory("ASTF",60)
		TNT1 A 0 A_TakeInventory("GreenMana",1)
		TNT1 A 0 A_JumpIfInventory("AEoDSoulReaper",1,2)
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("SoulReaperDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDSoulReaper",1)
		Stop
	Ammo2:
		TNT1 A 0 A_TakeInventory("ASTF",60)
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("SoulReaperDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDSoulReaper",1)
		TNT1 A 0 A_TakeInventory("GreenMana",1)
		Stop
	Ammo3:
		TNT1 A 0 A_TakeInventory("GreenMana",1)
		TNT1 A 0 A_GiveInventory("Weapon0Count",1)
		TNT1 A 0 A_GiveInventory("SoulReaperDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDSoulReaper",1)
		TNT1 A 0 A_TakeInventory("ASTF",60)
		Stop
	}
}