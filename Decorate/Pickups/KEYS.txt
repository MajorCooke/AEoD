///////// KEYS \\\\\\\\\\\

Actor BlueKeyCard : CustomInventory replaces BlueCard
{
inventory.pickupmessage "Picked up a blue keycard."
states
	{
	Spawn:
		BKEY A 0 NoDelay A_RearrangePointers(AAPTR_PLAYER1,AAPTR_DEFAULT,AAPTR_DEFAULT,4)
	Waiting:
		BKEY A 10 A_JumpIfInventory("DemonMorphActiveToken",1,"DistanceCheck",AAPTR_PLAYER1)
		BKEY B 10 bright A_JumpIfInventory("DemonMorphActiveToken",1,"DistanceCheck",AAPTR_PLAYER1)
		loop
	DistanceCheck:
		BKEY A 10 A_JumpIfCloser(32,"ForceGive")
		BKEY A 0 A_JumpIfInventory("DemonMorphActiveToken",1,1,AAPTR_PLAYER1)
		Goto Waiting
		BKEY B 10 bright A_JumpIfCloser(32,"ForceGive")
		BKEY A 0 A_JumpIfInventory("DemonMorphActiveToken",1,"DistanceCheck",AAPTR_PLAYER1)
		Goto Waiting
	ForceGive:
		TNT1 A 0 A_GiveInventory("BlueCard",1,AAPTR_PLAYER1)
		Stop
	Pickup:
		TNT1 A 1 A_GiveInventory("BlueCard",1)
		stop
	}
}

Actor RedKeyCard : CustomInventory replaces RedCard
{
inventory.pickupmessage "Picked up a red keycard."
states
	{
	Spawn:
		RKEY A 0 NoDelay A_RearrangePointers(AAPTR_PLAYER1,AAPTR_DEFAULT,AAPTR_DEFAULT,4)
	Waiting:
		RKEY A 10 A_JumpIfInventory("DemonMorphActiveToken",1,"DistanceCheck",AAPTR_PLAYER1)
		RKEY B 10 bright A_JumpIfInventory("DemonMorphActiveToken",1,"DistanceCheck",AAPTR_PLAYER1)
		loop
	DistanceCheck:
		RKEY A 10 A_JumpIfCloser(32,"ForceGive")
		RKEY A 0 A_JumpIfInventory("DemonMorphActiveToken",1,1,AAPTR_PLAYER1)
		Goto Waiting
		RKEY B 10 bright A_JumpIfCloser(32,"ForceGive")
		RKEY A 0 A_JumpIfInventory("DemonMorphActiveToken",1,"DistanceCheck",AAPTR_PLAYER1)
		Goto Waiting
	ForceGive:
		TNT1 A 0 A_GiveInventory("RedCard",1,AAPTR_PLAYER1)
		Stop
	Pickup:
		TNT1 A 1 A_GiveInventory("RedCard",1)
		stop
	}
}

Actor YellowKeyCard : CustomInventory replaces YellowCard
{
inventory.pickupmessage "Picked up a yellow keycard."
states
	{
	Spawn:
		YKEY A 0 NoDelay A_RearrangePointers(AAPTR_PLAYER1,AAPTR_DEFAULT,AAPTR_DEFAULT,4)
	Waiting:
		YKEY A 10 A_JumpIfInventory("DemonMorphActiveToken",1,"DistanceCheck",AAPTR_PLAYER1)
		YKEY B 10 bright A_JumpIfInventory("DemonMorphActiveToken",1,"DistanceCheck",AAPTR_PLAYER1)
		loop
	DistanceCheck:
		YKEY A 10 A_JumpIfCloser(32,"ForceGive")
		YKEY A 0 A_JumpIfInventory("DemonMorphActiveToken",1,1,AAPTR_PLAYER1)
		Goto Waiting
		YKEY B 10 bright A_JumpIfCloser(32,"ForceGive")
		YKEY A 0 A_JumpIfInventory("DemonMorphActiveToken",1,"DistanceCheck",AAPTR_PLAYER1)
		Goto Waiting
	ForceGive:
		TNT1 A 0 A_GiveInventory("YellowCard",1,AAPTR_PLAYER1)
		Stop
	Pickup:
		TNT1 A 1 A_GiveInventory("YellowCard",1)
		stop
	}
}

Actor BlueSkullKey : CustomInventory replaces BlueSkull
{
inventory.pickupmessage "Picked up a blue skull key."
states
	{
	Spawn:
		BSKU A 0 NoDelay A_RearrangePointers(AAPTR_PLAYER1,AAPTR_DEFAULT,AAPTR_DEFAULT,4)
	Waiting:
		BSKU A 10 A_JumpIfInventory("DemonMorphActiveToken",1,"DistanceCheck",AAPTR_PLAYER1)
		BSKU B 10 bright A_JumpIfInventory("DemonMorphActiveToken",1,"DistanceCheck",AAPTR_PLAYER1)
		loop
	DistanceCheck:
		BSKU A 10 A_JumpIfCloser(32,"ForceGive")
		BSKU A 0 A_JumpIfInventory("DemonMorphActiveToken",1,1,AAPTR_PLAYER1)
		Goto Waiting
		BSKU B 10 bright A_JumpIfCloser(32,"ForceGive")
		BSKU A 0 A_JumpIfInventory("DemonMorphActiveToken",1,"DistanceCheck",AAPTR_PLAYER1)
		Goto Waiting
	ForceGive:
		TNT1 A 0 A_GiveInventory("BlueSkull",1,AAPTR_PLAYER1)
		Stop
	Pickup:
		TNT1 A 1 A_GiveInventory("BlueSkull",1)
		stop
	}
}

Actor RedSkullKey : CustomInventory replaces RedSkull
{
inventory.pickupmessage "Picked up a red skull key."
states
	{
	Spawn:
		RSKU A 0 NoDelay A_RearrangePointers(AAPTR_PLAYER1,AAPTR_DEFAULT,AAPTR_DEFAULT,4)
	Waiting:
		RSKU A 10 A_JumpIfInventory("DemonMorphActiveToken",1,"DistanceCheck",AAPTR_PLAYER1)
		RSKU B 10 bright A_JumpIfInventory("DemonMorphActiveToken",1,"DistanceCheck",AAPTR_PLAYER1)
		loop
	DistanceCheck:
		RSKU A 10 A_JumpIfCloser(32,"ForceGive")
		RSKU A 0 A_JumpIfInventory("DemonMorphActiveToken",1,1,AAPTR_PLAYER1)
		Goto Waiting
		RSKU B 10 bright A_JumpIfCloser(32,"ForceGive")
		RSKU A 0 A_JumpIfInventory("DemonMorphActiveToken",1,"DistanceCheck",AAPTR_PLAYER1)
		Goto Waiting
	ForceGive:
		TNT1 A 0 A_GiveInventory("RedSkull",1,AAPTR_PLAYER1)
		Stop
	Pickup:
		TNT1 A 1 A_GiveInventory("RedSkull",1)
		stop
	}
}


Actor YellowSkullKey : CustomInventory replaces YellowSkull
{
inventory.pickupmessage "Picked up a yellow skull key."
states
	{
	Spawn:
		RSKU A 0 NoDelay A_RearrangePointers(AAPTR_PLAYER1,AAPTR_DEFAULT,AAPTR_DEFAULT,4)
	Waiting:
		RSKU A 10 A_JumpIfInventory("DemonMorphActiveToken",1,"DistanceCheck",AAPTR_PLAYER1)
		RSKU B 10 bright A_JumpIfInventory("DemonMorphActiveToken",1,"DistanceCheck",AAPTR_PLAYER1)
		loop
	DistanceCheck:
		RSKU A 10 A_JumpIfCloser(32,"ForceGive")
		RSKU A 0 A_JumpIfInventory("DemonMorphActiveToken",1,1,AAPTR_PLAYER1)
		Goto Waiting
		RSKU B 10 bright A_JumpIfCloser(32,"ForceGive")
		RSKU A 0 A_JumpIfInventory("DemonMorphActiveToken",1,"DistanceCheck",AAPTR_PLAYER1)
		Goto Waiting
	ForceGive:
		TNT1 A 0 A_GiveInventory("YellowSkull",1,AAPTR_PLAYER1)
		Stop
	Pickup:
		TNT1 A 1 A_GiveInventory("YellowSkull",1)
		stop
	}
}
