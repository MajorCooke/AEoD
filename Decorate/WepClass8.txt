//================================================================================================================
//================================================================================================================
//
//
//					AEons Of Death v6: Class 8 weapons
//
//
//================================================================================================================
//================================================================================================================



//================================================================================== 
//==================================================================================
//Lightning and Thunderstorm Spell
//Originally by Major Cooke
//Heavily modified by DBT and Ichor
//==================================================================================
//==================================================================================


Actor AEoDTomeOfSetItem : CustomInventory 6127
{
	+FLOORCLIP //
	+FLOATBOB
	+INVENTORY.IGNORESKILL
	Scale 0.8
	Inventory.Amount 1
	Inventory.PickupSound "weaponbuild"
	Inventory.PickupMessage "The Mystic Tome of Set is now yours!"
	States
	{
	Spawn:
		WTME ABCDEFGH 4 Bright
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDTomeOfSet",1,"Ammo")
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("TomeOfSetDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDTomeOfSet",1)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDTomeOfSet",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDTomeOfSet",1)
		Stop
	}
}

Actor AEoDTomeOfSet : Weapon // 6127
{
	Weapon.AmmoType1 "BlueMana"
	Weapon.AmmoType2 "BlueMana"
	Weapon.AmmoGive1 40
	Weapon.AmmoUse1 1
	Weapon.AmmoUse2 25
	Weapon.SelectionOrder 8100
	Weapon.UpSound "weapons/draw"
	Inventory.PickupSound "weaponbuild"
	Inventory.PickupMessage "The Mystic Tome of Set is now yours!"
	Scale 0.8
	+INVENTORY.IGNORESKILL
	+WEAPON.CHEATNOTWEAPON
	+FLOORCLIP
	+FLOATBOB
	Tag "Tome of set"
	States
	{
	Spawn:
		WTME ABCDEFGH 4 Bright
		Loop
	Select:
		TNT1 A 0 	
		TSET A 1 A_Raise
		TSET AA 0 A_Raise
		Loop
	Deselect:
		TNT1 A 0 A_StopSound(CHAN_WEAPON)
		TNT1 A 0 	
		TSET B 1 A_Lower
		TSET BB 0 A_Lower
		Loop
	Ready:
		TSET AAAAAABBBBBBCCCCCCDDDDDD 1 Bright A_WeaponReady
		Loop
	Fire:
		TSET E 2 Bright Offset(0,42)
		TSET F 0 Bright A_PlaySound("LightningSpell/Loop",CHAN_WEAPON,0.8,1)
		"####" "#" 0 A_JumpIfInventory("InfiniteAmmo",1,3)
		"####" "#" 0 A_JumpIfInventory("PowerEconomizer",1,2)
		"####" "#" 0 A_TakeInventory("BlueMana",2,1)
		TSET F 1 Bright Offset(0,52) A_SpawnItemEx("LightningMissileRedux",8,6,26,cos(-pitch)*10,0,sin(-pitch)*10,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPITCH)//A_FireCustomMissile("LightningMissile1",0+random(-2,2),1,8,-6)
		TSET F 0 A_SpawnItemEx("LightningMissileRedux",8,6,26,cos(-pitch)*10,0,sin(-pitch)*10,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPITCH)//A_FireCustomMissile("LightningMissile1",0+random(-2,2),1,8,-6)
		"####" "#" 0 A_SetPitch(pitch+frandom(-0.2,0.2)) "####" "#" 1 Bright Offset(0,52) A_SetAngle(angle+frandom(-0.2,0.2))
		TSET G 1 Bright Offset(0,52) A_SpawnItemEx("LightningMissileRedux",8,-6,26,cos(-pitch)*10,0,sin(-pitch)*10,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPITCH)
		TSET G 0 A_SpawnItemEx("LightningMissileRedux",8,-6,26,cos(-pitch)*10,0,sin(-pitch)*10,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPITCH)
		"####" "#" 0 A_SetPitch(pitch+frandom(-0.2,0.2)) "####" "#" 1 Bright Offset(0,52) A_SetAngle(angle+frandom(-0.2,0.2))
		TSET I 0 Bright A_ReFire
		TSET I 0 A_StopSound(CHAN_WEAPON)
		TSET I 0 A_PlaySound("LightningSpell/End",CHAN_WEAPON,0.8,0)
		TSET IJK 2 Bright Offset(0,52)
		Goto Ready
	Hold:
		"####" "#" 0 A_JumpIfInventory("InfiniteAmmo",1,3)
		"####" "#" 0 A_JumpIfInventory("PowerEconomizer",1,2)
		"####" "#" 0 A_TakeInventory("BlueMana",2,1)
		TSET F 1 Bright Offset(0,52) A_SpawnItemEx("LightningMissileRedux",8,6,26,cos(-pitch)*10,0,sin(-pitch)*10,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPITCH)
		TSET F 0 Bright A_SpawnItemEx("LightningMissileRedux",8,6,26,cos(-pitch)*10,0,sin(-pitch)*10,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPITCH)
		"####" "#" 0 A_SetPitch(pitch+frandom(-0.2,0.2)) "####" "#" 1 Bright Offset(0,52) A_SetAngle(angle+frandom(-0.2,0.2))
		TSET G 1 Bright Offset(0,52) A_SpawnItemEx("LightningMissileRedux",8,-6,26,cos(-pitch)*10,0,sin(-pitch)*10,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPITCH)
		TSET G 0 Bright A_SpawnItemEx("LightningMissileRedux",8,-6,26,cos(-pitch)*10,0,sin(-pitch)*10,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPITCH)
		"####" "#" 0 A_SetPitch(pitch+frandom(-0.2,0.2)) "####" "#" 1 Bright Offset(0,52) A_SetAngle(angle+frandom(-0.2,0.2))
		TSET I 0 Bright A_ReFire
		TSET I 0 A_StopSound(CHAN_WEAPON)
		TSET I 0 A_PlaySound("LightningSpell/End",CHAN_WEAPON,0.8,0)
		TSET IJK 2 Bright Offset(0,52)
		Goto Ready
	AltFire:
		TSET EF 3 bright
		TSET G 0 Bright A_PlaySound("weapons/lightningshotalt",CHAN_WEAPON)
		TNT1 A 0 A_SetBlend("DD DD FF",0.7,35)
		TSET G 0 Bright A_FireCustomMissile("ThunderStormSpellShot",0,1)
		"####" "#" 2 Bright A_SetPitch(pitch-4)
		TSET GIII 1 Bright A_SetPitch(pitch+1)
		TSET JK 3 bright
		TSET ABCDABCDABCDABCD 4 bright
		Goto Ready
	}
}

Actor LightningMissileRedux
{
	var int user_count[2];
	var int user_xyz[3];
	Projectile
	+FORCERADIUSDMG
	+EXTREMEDEATH
	Speed 6
	Damage 1
	Radius 6
	Height 4
	DamageType "Electric"
	DeathSound "weapons/lightningend"
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SetUserArray("user_count",0,0)
	Direction:
		TNT1 A 0 A_SetPitch(pitch+frandom(-2,2))
		TNT1 A 0 A_SetAngle(angle+frandom(-2,2))
		TNT1 A 0 A_SetUserArray("user_count",1,0)
	Moving:
		TNT1 A 0 A_SpawnItemEx("LightningMissileArk",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS,253)
		TNT1 A 0 A_SpawnItemEx("LightningTrail",(sin(-pitch)*random(-2,2)),frandom(-2,2),frandom(-2,2),0,0,0,0,SXF_NOCHECKPOSITION)
		//TNT1 A 0 A_Warp(AAPTR_DEFAULT,user_xyz[0],user_xyz[1],user_xyz[2],0,WARPF_USECALLERANGLE,"MoveSuccess") //A_Warp(AAPTR_DEFAULT,cos(-pitch)*6,0,sin(-pitch)*6,0,0,"Moving")
		TNT1 A 0 A_Warp(AAPTR_DEFAULT,cos(-pitch)*6,0,sin(-pitch)*6,0,WARPF_USECALLERANGLE,"MoveSuccess")
		Goto End
	MoveSuccess:
		TNT1 A 0 A_SetUserArray("user_count",0,user_count[0]+1)
		TNT1 A 0 A_SetUserArray("user_count",1,user_count[1]+1)
		TNT1 A 0 A_JumpIf(user_count[0]>=150,"End")
		TNT1 A 0 A_JumpIf(user_count[1]>=2,"Direction")
		Goto Moving
	End:
		TNT1 A 2
		Stop
	Death:
		TNT1 AAAAAAA 0 A_SpawnItemEx("TeslaFX",0,0,0,random(6,-6),random(6,-6),random(6,-6),0,0)
		TNT1 A 0 A_SpawnItemEx("LightningTrail",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_Explode(10,32,0)
		TNT1 A 1 A_Scream
		Stop
	}
}

Actor LightningMissileArk
{
	var int user_count[2];
	var int user_xyz[3];
	Projectile
	+PAINLESS
	+DONTREFLECT
	Speed 6
	Damage 0
	Radius 6
	Height 4
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SetUserArray("user_count",0,0)
	Direction:
		TNT1 A 0 A_SetUserArray("user_xyz",0,frandom(-3,3))
		TNT1 A 0 A_SetUserArray("user_xyz",0,frandom(-3,3))
		TNT1 A 0 A_SetUserArray("user_xyz",0,frandom(-3,3))
		//TNT1 A 0 A_SetPitch(pitch+frandom(-4,4))
		//TNT1 A 0 A_SetAngle(angle+frandom(-4,4))
		TNT1 A 0 A_SetUserArray("user_count",1,0)
	Moving:
		TNT1 A 0 A_SpawnItemEx("LightningTrailMini",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_Warp(AAPTR_DEFAULT,user_xyz[0],user_xyz[1],user_xyz[2],0,WARPF_ABSOLUTEOFFSET,"MoveSuccess") //A_Warp(AAPTR_DEFAULT,cos(-pitch)*6,0,sin(-pitch)*6,0,0,"Moving")
		//TNT1 A 0 A_Warp(AAPTR_DEFAULT,cos(-pitch)*6,0,sin(-pitch)*6,0,WARPF_USECALLERANGLE,"MoveSuccess")
		Goto Death
	MoveSuccess:
		TNT1 A 0 A_SetUserArray("user_count",0,user_count[0]+1)
		TNT1 A 0 A_SetUserArray("user_count",1,user_count[1]+1)
		TNT1 A 0 A_JumpIf(user_count[0]>=55,"Death")
		TNT1 A 0 A_JumpIf(user_count[1]>=1,"Direction")
		Goto Moving
	Death:
		TNT1 A 0
		Stop
	}
}

Actor LightningTrail
{
	+NOINTERACTION
	States
	{
	Spawn:
			TNT1 A 0
			TNT1 A 0 A_SpawnItemEx("LightningTrailDistortion",0,frandom(-5,5),frandom(-5,5),0,0,0,0,SXF_NOCHECKPOSITION)
			Stop
	}
}

Actor LightningTrailMini
{
	+NOINTERACTION
	States
	{
	Spawn:
			TNT1 A 0
			TNT1 A 0 A_SpawnItemEx("LightningTrailDistortionMini",0,frandom(-5,5),frandom(-5,5),0,0,0,0,SXF_NOCHECKPOSITION)
			Stop
	}
}
 
Actor LightningTrailDistortion
{
	+NOINTERACTION
	RenderStyle Add
	Scale 0.4
	//Scale 0.75
	Alpha 0.35
	States
	{
	Spawn:
		PLSE A 0
		PLSE A 0 A_SetScale(frandom(0.3,0.5))
		PLSE A 0 A_Jump(256,1,2,3)
		PLSE B 2 bright
		Stop
		PLSE C 2 bright
		Stop
		PLSE D 2 bright
		Stop
	}
}
 
Actor LightningTrailDistortionMini : LightningTrailDistortion
{
	Scale 0.15
	States
	{
	Spawn:
		PLSE A 0
		PLSE A 0 A_SetScale(frandom(0.1,0.3))
		PLSE A 0 A_Jump(256,1,2,3)
		PLSE B 2 bright
		Stop
		PLSE C 2 bright
		Stop
		PLSE D 2 bright
		Stop
	}
}
 
Actor LightningTagger : FastProjectile  //This thing is the main damager in the attack. While the random "zaps" can
{													   //cause damage, this "tagger" are the ones in charge of dealing the main dmg.
	Damage 15
	Speed 60
	Radius 3
	Height 3
	Projectile
	+EXTREMEDEATH
	DamageType "Electric"
	RenderStyle None
	States
	{
	Spawn:
			TNT1 AAAAAAAAAAAAAAAAAA 1
			Stop
	Death:
			//TNT1 AAAAAAAAAAAA 0 A_SpawnItemEx("TeslaFX",0,0,0,random(6,-6),random(6,-6),random(6,-6),0,0)
			TNT1 A 0 A_CustomMissile("LightningTrail",0,0)
			Stop
	}
}
 
//*****************************
Actor ThunderStormSpellShot
{
	Speed 37
	Damage 30
	Radius 12
	Height 12
	Projectile
	+SEEKERMISSILE
	+DONTREFLECT
	+EXTREMEDEATH
	DamageType "Electric"
	RenderStyle Add
	Scale 0.8
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 AA 0 A_SpawnItemEx("ThunderStormSpellShotTrail",random(5,-5),random(5,-5),random(5,-5),0,0,0,0,SXF_NOCHECKPOSITION)
		ZAP7 A 1 Bright A_SeekerMissile(90,90)
		TNT1 AA 0 A_SpawnItemEx("ThunderStormSpellShotTrail",random(5,-5),random(5,-5),random(5,-5),0,0,0,0,SXF_NOCHECKPOSITION)
		ZAP7 A 1 Bright
		TNT1 AA 0 A_SpawnItemEx("ThunderStormSpellShotTrail",random(5,-5),random(5,-5),random(5,-5),0,0,0,0,SXF_NOCHECKPOSITION)
		ZAP7 B 1 Bright A_SeekerMissile(90,90)
		TNT1 AA 0 A_SpawnItemEx("ThunderStormSpellShotTrail",random(5,-5),random(5,-5),random(5,-5),0,0,0,0,SXF_NOCHECKPOSITION)
		ZAP7 B 1 Bright
		TNT1 AA 0 A_SpawnItemEx("ThunderStormSpellShotTrail",random(5,-5),random(5,-5),random(5,-5),0,0,0,0,SXF_NOCHECKPOSITION)
		ZAP7 C 1 Bright A_SeekerMissile(90,90)
		TNT1 AA 0 A_SpawnItemEx("ThunderStormSpellShotTrail",random(5,-5),random(5,-5),random(5,-5),0,0,0,0,SXF_NOCHECKPOSITION)
		ZAP7 C 1 Bright
		TNT1 AA 0 A_SpawnItemEx("ThunderStormSpellShotTrail",random(5,-5),random(5,-5),random(5,-5),0,0,0,0,SXF_NOCHECKPOSITION)
		ZAP7 D 1 Bright A_SeekerMissile(90,90)
		TNT1 AA 0 A_SpawnItemEx("ThunderStormSpellShotTrail",random(5,-5),random(5,-5),random(5,-5),0,0,0,0,SXF_NOCHECKPOSITION)
		ZAP7 D 1 Bright
		TNT1 AA 0 A_SpawnItemEx("ThunderStormSpellShotTrail",random(5,-5),random(5,-5),random(5,-5),0,0,0,0,SXF_NOCHECKPOSITION)
		ZAP7 E 1 Bright A_SeekerMissile(90,90)
		TNT1 AA 0 A_SpawnItemEx("ThunderStormSpellShotTrail",random(5,-5),random(5,-5),random(5,-5),0,0,0,0,SXF_NOCHECKPOSITION)
		ZAP7 E 1 Bright
		TNT1 AA 0 A_SpawnItemEx("ThunderStormSpellShotTrail",random(5,-5),random(5,-5),random(5,-5),0,0,0,0,SXF_NOCHECKPOSITION)
		ZAP7 A 1 Bright A_SeekerMissile(90,90)
		TNT1 AA 0 A_SpawnItemEx("ThunderStormSpellShotTrail",random(5,-5),random(5,-5),random(5,-5),0,0,0,0,SXF_NOCHECKPOSITION)
		ZAP7 A 1 Bright
		TNT1 AA 0 A_SpawnItemEx("ThunderStormSpellShotTrail",random(5,-5),random(5,-5),random(5,-5),0,0,0,0,SXF_NOCHECKPOSITION)
		ZAP7 B 1 Bright
		TNT1 AA 0 A_SpawnItemEx("ThunderStormSpellShotTrail",random(5,-5),random(5,-5),random(5,-5),0,0,0,0,SXF_NOCHECKPOSITION)
		ZAP7 B 1 Bright
		TNT1 AA 0 A_SpawnItemEx("ThunderStormSpellShotTrail",random(5,-5),random(5,-5),random(5,-5),0,0,0,0,SXF_NOCHECKPOSITION)
		ZAP7 C 1 Bright A_SeekerMissile(90,90)
		TNT1 AA 0 A_SpawnItemEx("ThunderStormSpellShotTrail",random(5,-5),random(5,-5),random(5,-5),0,0,0,0,SXF_NOCHECKPOSITION)
		ZAP7 C 1 Bright
		TNT1 AA 0 A_SpawnItemEx("ThunderStormSpellShotTrail",random(5,-5),random(5,-5),random(5,-5),0,0,0,0,SXF_NOCHECKPOSITION)
		ZAP7 D 1 Bright A_SeekerMissile(90,90)
		TNT1 AA 0 A_SpawnItemEx("ThunderStormSpellShotTrail",random(5,-5),random(5,-5),random(5,-5),0,0,0,0,SXF_NOCHECKPOSITION)
		ZAP7 D 1 Bright
		TNT1 AA 0 A_SpawnItemEx("ThunderStormSpellShotTrail",random(5,-5),random(5,-5),random(5,-5),0,0,0,0,SXF_NOCHECKPOSITION)
		ZAP7 E 1 Bright A_SeekerMissile(90,90)
		TNT1 AA 0 A_SpawnItemEx("ThunderStormSpellShotTrail",random(5,-5),random(5,-5),random(5,-5),0,0,0,0,SXF_NOCHECKPOSITION)
		ZAP7 E 1 Bright
		Goto Death
	Death:
		TNT1 A 0 A_CheckCeiling("CSpawner")
		TNT1 A 0 A_SpawnItemEx("CloudSpawner1",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		TNT1 A 7
		Stop
	CSpawner:
		TNT1 A 0 A_SpawnItemEx("CloudSpawner1",0,0,-40,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		Stop
	}
}
Actor ThunderStormSpellShotTrail
{
	+NOINTERACTION
	RenderStyle Add
	Scale 0.3
	States
	{
	Spawn:
		 TNT1 A 0
		 TNT1 A 0 A_Jump(255,1,2,3,4,5,6,7,8)
		 ZAP7 AABBCCDDEE 1 Bright A_FadeOut(0.03)
		 Goto Spawn+2
	}
} 
 
Actor CloudSpawner1
{
	var int user_cloudspawncount;
	var int user_warpcount;
	Projectile
	Radius 4
	Height 11
	+NOINTERACTION
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SetUserVar("user_cloudspawncount",0)
		TNT1 A 0 A_Warp(AAPTR_DEFAULT,0,0,0,0,WARPF_TOFLOOR|WARPF_NOCHECKPOSITION)
	Warping:
		TNT1 A 0 A_SetUserVar("user_warpcount",user_warpcount+1)
		TNT1 A 0 A_JumpIf(user_warpcount>=200,"CloudShoot")
		TNT1 A 0 A_Warp(AAPTR_DEFAULT,0,0,user_warpcount,0,WARPF_TOFLOOR,"Warping")
		Goto CloudShoot
	CloudShoot:
		TNT1 AAAAA 0 A_SpawnItemEx("Cloud1",0,0,0,6,0,0,random(0,359),SXF_NOCHECKPOSITION)
		TNT1 A 1 A_SetUserVar("user_cloudspawncount",user_cloudspawncount+1)
		TNT1 A 0 A_JumpIf(user_cloudspawncount>=10,1)
		Loop
		TNT1 A 0 A_SetUserVar("user_cloudspawncount",0)
		TNT1 A 0 A_PlaySound("weapons/thunderstormactive")
		TNT1 A 0 A_SpawnItemEx("LightningGenerator",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER)
	CloudShoot2:
		TNT1 AAAAA 0 A_SpawnItemEx("Cloud1",0,0,0,6,0,0,random(0,359),SXF_NOCHECKPOSITION)
		TNT1 A 1 A_SetUserVar("user_cloudspawncount",user_cloudspawncount+1)
		TNT1 A 0 A_JumpIf(user_cloudspawncount>=60,1)
		Loop
		TNT1 A 0 A_SetUserVar("user_cloudspawncount",0)
		Stop
	}
}
 
Actor LightningGenerator
{
	var int user_count;
	Projectile
	+NOINTERACTION
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SetUserVar("user_count",0)
	Shooter:
		TNT1 AA 0 A_SpawnItemEx("LightningShotRandom",random(0,80),0,0,0,0,0,random(0,359),SXF_NOCHECKPOSITION|SXF_SETMASTER)//A_CustomMissile("LightningShotRandom",0,0,0+random(0,360),6,-10+random(-80,0))
		TNT1 A 0 A_SetUserVar("user_count",user_count+1)
		TNT1 A 2 A_JumpIf(user_count>=28,1) //TNT1 A 1 A_JumpIf(user_count>=55,1)	
		Loop
		TNT1 A 0
		Stop
	}
}
 
Actor Cloud1
{
	Scale .75
	+NOINTERACTION
	RenderStyle Add
	Alpha .75
	States
	{
	Spawn:
		SMOK ABC 7 //15
		SMOK DEFGHI 7 //15
		SMOK JKL 7 A_FadeOut(0.1) //15 A_FadeOut(0.1)
		Wait
	}
}
 
Actor LightningShotRandom
{
	var int user_count[2];
	var int user_xyz[3];
	Projectile
	+FORCERADIUSDMG
	+EXTREMEDEATH
	+DONTREFLECT
	Speed 6
	Damage 10
	Radius 6
	Height 6
	DamageType "Electric"
	DeathSound "weapons/lightningend"
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SetUserArray("user_count",0,0)
	Direction:
		TNT1 A 0 A_SetUserArray("user_xyz",0,frandom(-4,4))
		TNT1 A 0 A_SetUserArray("user_xyz",1,frandom(-4,4))
		TNT1 A 0 A_SetUserArray("user_xyz",2,frandom(-1.0,-3.0))
		TNT1 A 0 A_SetUserArray("user_count",1,0)
	Moving:
		TNT1 A 0 A_SpawnItemEx("LightningMissileArk",0,0,0,6,0,0,random(-10,10),SXF_NOCHECKPOSITION|SXF_TRANSFERPITCH|SXF_TRANSFERPOINTERS,240)
		TNT1 A 0 A_SpawnItemEx("LightningTrail",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		//TNT1 A 0 A_Warp(AAPTR_DEFAULT,user_xyz[0],user_xyz[1],user_xyz[2],0,WARPF_USECALLERANGLE,"MoveSuccess") //A_Warp(AAPTR_DEFAULT,cos(-pitch)*6,0,sin(-pitch)*6,0,0,"Moving")
		TNT1 A 0 A_Warp(AAPTR_DEFAULT,user_xyz[0],user_xyz[1],user_xyz[2],0,WARPF_ABSOLUTEOFFSET,1)
		Goto End
		
		TNT1 A 0 A_Warp(AAPTR_DEFAULT,user_xyz[0],user_xyz[1],user_xyz[2],0,WARPF_ABSOLUTEOFFSET,"MoveSuccess")
		Goto End
	MoveSuccess:
		TNT1 A 0 A_SetUserArray("user_count",0,user_count[0]+1)
		TNT1 A 0 A_SetUserArray("user_count",1,user_count[1]+1)
		TNT1 A 0 A_JumpIf(user_count[0]>=1000,"End")
		TNT1 A 0 A_JumpIf(user_count[1]>=random(10,25),"Direction")
		Goto Moving
	End:
		TNT1 A 0
	Death:
		TNT1 AAAAAAA 0 A_SpawnItemEx("TeslaFX",0,0,0,random(6,-6),random(6,-6),random(6,-6),0,0)
		TNT1 A 0 A_SpawnItemEx("LightningTrail",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_Explode(15,300,0)
		TNT1 A 1 A_Scream
		Stop
	}
}

Actor TomeOfSetDrop : CustomInventory
{
	Inventory.MaxAmount 1
	States
	{
	Use:
		TNT1 A 0
		TNT1 A 0 A_SpawnItemEx("DroppedTomeOfSet",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		Stop
	}
}

Actor DroppedTomeOfSet
{
	Radius 16
	Height 20
	Scale 0.8
	States
	{
	Spawn:
		WTME A 15 Bright 
		TNT1 A 0 A_SpawnItemEx("AEoDTomeOfSetNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
}

Actor AEoDTomeOfSetNoAmmo : AEoDTomeOfSetItem
{
	+FLOORCLIP
	+FLOATBOB
	+INVENTORY.IGNORESKILL
	Scale 0.8
	Inventory.Amount 1
	Inventory.PickupSound "weaponbuild"
	Inventory.PickupMessage "The Mystic Tome of Set is now yours!"
	States
	{
	Spawn:
		WTME ABCDEFGH 4 Bright
		Loop
	Pickup:
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("BlueMana",40,"Ammo")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("TomeOfSetDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDTomeOfSet",1)
		TNT1 A 0 A_TakeInventory("BlueMana",40)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDTomeOfSet",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,16,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_TakeInventory("BlueMana",40)
		TNT1 A 0 A_JumpIfInventory("AEoDTomeOfSet",1,2)
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("TomeOfSetDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDTomeOfSet",1)
		Stop
	}
}


//==================================================================================
//==================================================================================

//==================================================================================
//==================================================================================


Actor AEoDDSparilStaffItem : CustomInventory 6081
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	Scale 0.75
	Inventory.Amount 1
	Inventory.PickupMessage "You got D'Sparil's Staff! Let the fun begin."
	Inventory.PickupSound "weaponbuild"
	States
	{
	Spawn:
		DTSP A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDDSparilStaff",1,"Ammo")
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("DSparilStaffDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDDSparilStaff",1)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDDSparilStaff",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDDSparilStaff",1)
		Stop
	}
}

Actor AEoDDSparilStaff : Weapon // 6081
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	+WEAPON.CHEATNOTWEAPON
	+FLOATBOB
	Weapon.SelectionOrder 150
	Weapon.Ammotype1 "RedMana"
	Weapon.Ammotype2 "DarkMana"
	Weapon.AmmoGive1 10
	Weapon.AmmoGive2 4
	Weapon.AmmoUse1 8
	Weapon.AmmoUse2 2
	Weapon.SelectionOrder 13600
	Obituary "%o was zapped by %k's D'Sparil Staff."
	Inventory.PickupMessage "You got D'Sparil's Staff! Let the fun begin."
	Inventory.PickupSound "weaponbuild"
	weapon.upsound "weapons/draw"
	Scale 0.75
	Tag "D'sparil staff"
	States
	{
	Spawn:
		DTSP A 5
		Loop
	Ready: 
		DTSF A 0 A_Jump(3,2)
		DTSF A 1 A_WeaponReady
		Goto Ready
		
		DTSF R 0 A_PlaySound("dsparil/zap",7,0.5,0)
		DTSF RSTUVWXYZ 1 A_WeaponReady
		Goto Ready
	Deselect: 
		TNT1 A 0 	
		DTSF A 1 A_Lower
		TNT1 AA 0 A_Lower
		Loop
	Select: 
		TNT1 A 0 	
		DTSF A 1 A_Raise
		TNT1 AA 0 A_Raise
		Loop
	Fire: 
		TNT1 B 0 A_JumpIfInventory("PowerQuickFire",1,"FireQuick")
		DTSF A 2
		DTSF B 1
		TNT1 A 0 A_GunFlash
		DTSF CDE 1
		TNT1 A 0 A_PlaySound("dsparil/attack", CHAN_WEAPON, 1.0, 0)
		TNT1 A 0 //ACS_NamedExecute("s851",0,60,random(-20,20),0)
		DTSF F 0 A_Recoil(2)
		DTSF F 0 A_FireCustomMissile("DsparilLightning", 0, 1, 0, 2)
		DTSF GH 1 
		DTSF IJJ 1 //ACS_NamedExecute("s851",0,-20,0,0)
		DTSF K 1 
		DTSF LMNOPQFEDCBA 1
		Goto Ready
	FireQuick:
		TNT1 B 0 A_JumpIfInventory("PowerQuickFire",1,1)
		Goto Fire
		
		DTSF A 2
		DTSF B 1
		TNT1 A 0 A_GunFlash
		DTSF CDE 1
		TNT1 A 0 A_PlaySound("dsparil/attack", CHAN_WEAPON, 1.0, 0)
		TNT1 A 0 //ACS_NamedExecute("s851",0,60,random(-20,20),0)
		DTSF F 0 A_Recoil(2)
		DTSF F 0 A_FireCustomMissile("DsparilLightning", 0, 1, 0, 2)
		DTSF GH 1 
		DTSF IJJ 1 //ACS_NamedExecute("s851",0,-20,0,0)
		DTSF K 1 
		DTSF NQDA 1
		Goto Ready
	AltFire: 
		TNT1 B 0 A_JumpIfInventory("PowerQuickFire",1,"AltFireQuick")
		DTSF A 1
		DTSF B 1
		TNT1 A 0 A_GunFlash
		DTSF CDE 1
		TNT1 A 0 A_PlaySound("dsparil/attack", CHAN_WEAPON, 1.0, 0)
		TNT1 A 0 //ACS_NamedExecute("s851",0,50,random(-20,20),0)
		DTSF F 0 A_Recoil(2)
		TNT1 A 0 A_FireCustomMissile("DsparilStaffLightningDisciple", -30, 0, 0, 8)
		DTSF F 1 A_FireCustomMissile("DsparilStaffLightningDisciple", 30, 1, 0, 8)
		DTSF G 1
		DTSF HIJ 1 //ACS_NamedExecute("s851",0,-20,0,0)
		DTSF J 1
		DTSF JJKLMNOPQFEDCBA 1
		Goto Ready
	AltFireQuick:
		TNT1 B 0 A_JumpIfInventory("PowerQuickFire",1,1)
		Goto AltFire
		
		DTSF A 1
		DTSF B 1
		TNT1 A 0 A_GunFlash
		DTSF CDE 1
		TNT1 A 0 A_PlaySound("dsparil/attack", CHAN_WEAPON, 1.0, 0)
		TNT1 A 0 //ACS_NamedExecute("s851",0,50,random(-20,20),0)
		DTSF F 0 A_Recoil(2)
		TNT1 A 0 A_FireCustomMissile("DsparilStaffLightningDisciple", -30, 0, 0, 8)
		DTSF F 1 A_FireCustomMissile("DsparilStaffLightningDisciple", 30, 1, 0, 8)
		DTSF G 1
		DTSF HIJ 1 //ACS_NamedExecute("s851",0,-20,0,0)
		DTSF J 1
		DTSF KNQDA 1
		Goto Ready
	Flash:
		TNT1 A 3 A_Light1
		TNT1 A 2 A_Light2
		TNT1 A 1 A_Light0
		Stop
	} 
} 



Actor DsparilLightning : Sorcerer2FX1
{
	Damage 60
	+FORCERADIUSDMG
	+EXTREMEDEATH
	DeathSound "SorcererBigBallExplode"
	DamageType "Electric"
	Translation "0:255=%[0.3,0.4,0.5]:[0.6,0.83,1.0]"
	States
	{
	Spawn:
		TNT1 A 0 
		
		TNT1 A 0 A_SpawnItemEx("DSLLightning",0,0,0,0,0,0,random(0,359),SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS,170)
		TNT1 A 0 A_SpawnItemEx("DsparilLightningTrail",0,0,0,random(1,3),0,random(2,1),90,0)
		TNT1 A 0 A_SpawnItemEx("DsparilLightningTrail",0,0,0,random(1,3),0,random(2,1),-90,0)
		FX16 AAA 1 Bright A_SpawnItemEx("DsparilLightningTrailPartSpawner",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		
		TNT1 A 0 A_SpawnItemEx("DSLLightning",0,0,0,0,0,0,random(0,359),SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS,170)
		FX16 A 0 A_SpawnItemEx("DsparilLightningTrail",0,0,0,random(1,3),0,random(2,1),90,0)
		FX16 BBB 1 Bright A_SpawnItemEx("DsparilLightningTrailPartSpawner",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		
		TNT1 A 0 A_SpawnItemEx("DSLLightning",0,0,0,0,0,0,random(0,359),SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS,170)
		FX16 A 0 A_SpawnItemEx("DsparilLightningTrail",0,0,0,random(1,3),0,random(2,1),90,0)
		FX16 CCC 1 Bright A_SpawnItemEx("DsparilLightningTrailPartSpawner",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		Goto Spawn+1
	Death:
		FX16 G 0 A_SpawnItemEx("DSparilLightningExplosion",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)	//see GenericFX.AED
		FX16 G 4 Bright A_Explode(160,256,0)
		FX16 HIJKL 4 Bright
		Stop
	}
}

Actor DSLLightning
{
	var int user_failsafe;
	var int user_count;
	var int user_vel[3];
	Projectile
	+THRUACTORS
	+DONTSPLASH
	+FORCERADIUSDMG
	+EXTREMEDEATH
	+PAINLESS
	DamageType "Electric"
	Radius 4
	Height 4
	States
	{
	Spawn:
		TNT1 A 0
	Velocity:
		//TNT1 A 0 A_ChangeVelocity(frandom(-6,6),frandom(-6,6),frandom(-6,6),1)
		TNT1 A 0 A_Explode(3,16,0)
		TNT1 A 0 A_SetUserVar("user_count",0)
		TNT1 A 0 A_SetUserArray("user_vel",0,frandom(0.75,2.0))
		TNT1 A 0 A_SetUserArray("user_vel",1,frandom(-3.0,3.0))
		TNT1 A 0 A_SetUserArray("user_vel",2,frandom(-3.0,3.0))
		//TNT1 A 0 A_ChangeVelocity(user_vel[0],user_vel[1],user_vel[2],3)
	Warping:
		TNT1 A 0 A_SpawnItemEx("DSLLightningPuff",0,0,0,0,0,0,0,0,32)
		TNT1 A 0 A_Jump(256,1,2)
		TNT1 A 0 A_Warp(AAPTR_DEFAULT,user_vel[0],user_vel[1]*frandom(1.0,3.0),user_vel[2]*frandom(1.0,3.0),0,WARPF_STOP,1)
		Goto Death
		
		TNT1 A 0 A_Warp(AAPTR_DEFAULT,user_vel[0],user_vel[1]*frandom(1.0,3.0),user_vel[2]*frandom(1.0,3.0),0,0,"Warp2")
		Goto Death
	Warp2:
		TNT1 A 0 A_SetUserVar("user_failsafe",user_failsafe+1)
		TNT1 A 0 A_JumpIf(user_failsafe>=3000,"Death")
		TNT1 A 0 A_SetUserVar("user_count",user_count+1)
		TNT1 A 0 A_JumpIf(user_count>=random(5,15),"Velocity")
		Loop
	Death:
		TNT1 A 0 A_Explode(6,16,0)
		Stop
	}
}


Actor DsparilLightningTrailPartSpawner
{
	+NOINTERACTION
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 AAAAAA 0 A_SpawnItemEx("DSLLightningPuff2",random(15,-15),random(15,-15),random(15,-15),0,0,0,0,SXF_NOCHECKPOSITION,64)
		TNT1 A 1
		Stop
	}
}

Actor DsparilLightningTrail
{
	+NOINTERACTION
	Alpha 0.9
	Scale 0.05
	RenderStyle Add 
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SetScale(frandom(0.1,0.28))
		TNT1 A 0 A_Jump(256,1,2,3)
		FAXE R 2 Bright A_FadeOut(0.05)
		Goto Spawn+2
		
		FAXE S 2 Bright A_FadeOut(0.05)
		Goto Spawn+2
		
		FAXE T 2 Bright A_FadeOut(0.05)
		Goto Spawn+2
	}
}

//*****************************************************************
Actor DSparilLightningExplosion
{
	var int user_x[3];
	var int user_z[3];
	var int user_angle[3];
	var int user_count[2];
	var int user_z2;
	+NOINTERACTION
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_CheckFloor("Floored")
		TNT1 A 0 A_CheckCeiling("Ceilinged")
		Goto Resume
	Floored:
		TNT1 A 0 A_SetUserVar("user_z2",5)
		Goto Resume
	Ceilinged:
		TNT1 A 0 A_SetUserVar("user_z2",-5)
		Goto Resume
	Resume:
		TNT1 A 0 A_SetUserArray("user_x",0,random(4,16))
		TNT1 A 0 A_SetUserArray("user_x",1,random(4,16))
		TNT1 A 0 A_SetUserArray("user_x",2,random(4,16))
		TNT1 A 0 A_SetUserArray("user_z",0,random(-12,12))
		TNT1 A 0 A_SetUserArray("user_z",1,random(-12,12))
		TNT1 A 0 A_SetUserArray("user_z",2,random(-12,12))
		TNT1 A 0 A_SetUserArray("user_angle",0,random(0,359))
		TNT1 A 0 A_SetUserArray("user_angle",1,random(0,359))
		TNT1 A 0 A_SetUserArray("user_angle",2,random(0,359))
		TNT1 A 0 A_Warp(AAPTR_DEFAULT,0,0,user_z2,0,WARPF_NOCHECKPOSITION|WARPF_STOP)
	Lightning:
		TNT1 A 0 A_SpawnItemEx("DSLLightning",0,0,0,0,0,0,user_angle[0],SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)  //see WepClass8.AED
		TNT1 A 0 A_SpawnItemEx("DSLLightning",0,0,0,0,0,0,user_angle[1],SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		TNT1 A 0 A_SpawnItemEx("DSLLightning",0,0,0,0,0,0,user_angle[2],SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		TNT1 A 4 A_SetUserArray("user_count",0,user_count[0]+1)
		TNT1 A 0 A_JumpIf(user_count[0]>=5,"End")
		Loop
	End:
		TNT1 A 0
		Stop
	}
}

Actor DSLLightningPuff
{
	+NOINTERACTION
	Alpha 0.3
	Scale 0.05
	RenderStyle Add 
	//Translation "0:255=%[0.0,0.0,0.2]:[0.5,0.5,0.7]"
	//RenderStyle "Stencil"
	//StencilColor Blue
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SetScale(frandom(0.2,0.4))
		TNT1 A 0 A_Jump(256,"Jump1A","Jump1B","Jump1C")
	Jump1A:
		FAXE R 2 bright
		Goto ReJump
	Jump1B:
		FAXE S 2 bright
		Goto ReJump
	Jump1C:
		FAXE T 2 bright
		Goto ReJump
	Rejump:
		TNT1 A 0 A_SetScale(frandom(0.2,0.4))
		TNT1 A 0 A_Jump(256,"Jump2A","Jump2B","Jump2C")
	Jump2A:
		FAXE R 2 bright
		Stop
	Jump2B:
		FAXE S 2 bright
		Stop
	Jump2C:
		FAXE T 2 bright
		Stop
	}
}

Actor DSLLightningPuff2 : DSLLightningPuff
{	Alpha 0.8	}

//*****************************************************************

Actor DsparilStaffLightningDisciple // : Sorcerer2FX2
{
	Radius 16
	Height 6
	Speed 6
	PROJECTILE
	+DONTHURTSPECIES
	+FRIENDLY
	States
	{
	Spawn:
	FX11 ABABABA 5 Bright
	Death:
	TNT1 A 0 A_SpawnItem("NewFog",1)
	TNT1 A 0 A_Jump(256,1,2,3)
	TNT1 A 0 A_SpawnItem("FWizardF",1)
	Stop
	TNT1 A 0 A_SpawnItem("FBishopF",1)
	Stop
	TNT1 A 0 A_Jump(64,1)
	Goto Death+1
	
	TNT1 A 0 A_SpawnItem("FDeathBishopF",1)
	Stop
	}
}

Actor DSparilStaffDrop : CustomInventory
{
	Inventory.MaxAmount 1
	States
	{
	Use:
		TNT1 A 0
		TNT1 A 0 A_SpawnItemEx("DroppedDSparilStaff",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		Stop
	}
}

Actor DroppedDSparilStaff
{
	Radius 16
	Height 20
	Scale 0.75
	States
	{
	Spawn:
		DTSP A 15
		TNT1 A 0 A_SpawnItemEx("AEoDDSparilStaffNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
}

Actor AEoDDSparilStaffNoAmmo : AEoDDSparilStaffItem
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	Scale 0.75
	Inventory.Amount 1
	Inventory.PickupMessage "You got D'Sparil's Staff! Let the fun begin."
	Inventory.PickupSound "weaponbuild"
	States
	{
	Spawn:
		DTSP A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("RedMana",10,"Ammo")
		TNT1 A 0 A_JumpIfInventory("DarkMana",4,"Ammo3")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("DSparilStaffDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDDSparilStaff",1)
		TNT1 A 0 A_TakeInventory("RedMana",10)
		TNT1 A 0 A_TakeInventory("DarkMana",4)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDDSparilStaff",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_JumpIfInventory("DarkMana",4,1)
		Goto Ammo2
		
		TNT1 A 0 A_TakeInventory("RedMana",10)
		TNT1 A 0 A_TakeInventory("DarkMana",4)
		TNT1 A 0 A_JumpIfInventory("AEoDDSparilStaff",1,2)
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("DSparilStaffDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDDSparilStaff",1)
		Stop
	Ammo2:
		TNT1 A 0 A_TakeInventory("RedMana",10)
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("DSparilStaffDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDDSparilStaff",1)
		TNT1 A 0 A_TakeInventory("DarkMana",4)
		Stop
	Ammo3:
		TNT1 A 0 A_TakeInventory("DarkMana",4)
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("DSparilStaffDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDDSparilStaff",1)
		TNT1 A 0 A_TakeInventory("RedMana",10)
		Stop
	}
}

//==================================================================================
//==================================================================================

//==================================================================================
//==================================================================================


Actor AEoDNapalmLauncherItem : CustomInventory 6192
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	Scale 0.3
	Inventory.Amount 1
	Inventory.PickupMessage "Picked up a napalm launcher."
	Inventory.PickupSound "misc/w_pkup" 
	States
	{
	Spawn:
		NPLM A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDNapalmLauncher",1,"Ammo")
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("NapalmLauncherDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDNapalmLauncher",1)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDNapalmLauncher",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDNapalmLauncher",1)
		Stop
	}
}

Actor AEoDNapalmLauncher : Weapon // 6192
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	+WEAPON.CHEATNOTWEAPON
	Weapon.AmmoType "PlasmaRod" 
	Weapon.AmmoType2 "PlasmaRod"
	Weapon.AmmoGive1 30
	Weapon.AmmoUse 6
	Weapon.AmmoUse2 30
	Weapon.KickBack 15
	Weapon.SelectionOrder 14000
	Weapon.UpSound "weapons/rlan/draw"
	Inventory.PickupSound "misc/w_pkup" 
	Scale 0.3
	Inventory.PickupMessage "Picked up a napalm launcher."
	Obituary "%o was barbequed by %k's napalm launcher."
	Tag "Napalm Launcher"
	States
	{
	Spawn:
		NPLM A 3
		Loop
	Ready:
		NPLM B 1 A_WeaponReady
		Loop
	Deselect: 
		TNT1 A 0 	
		NPLM B 1 A_Lower
		TNT1 AA 0 A_Lower
		Loop
	Select: 
		TNT1 A 0 	
		NPLM B 1 A_Raise
		TNT1 AA 0 A_Raise
		Loop
	Fire: 
		NPLM B 3
		TNT1 A 0 //ACS_NamedExecute("s851",0,75,random(-5,5),0)
		TNT1 A 0 A_FireCustomMissile("GunSmokeSpawner",0,0,7,8)
		NPLM B 0 Bright A_PlayWeaponSound("reilsss/weapons/napalmcannonaltfire")//caleb/napalm
		NPLM B 0 Bright A_FireCustomMissile("PlayerNapalmRocket",0,1,8,2)
		NPLM DF 1 Bright
		NPLM EDC 2 //ACS_NamedExecute("s851",0,-25,0,0)				//<-
		NPLM B 15
		Goto Ready
	AltFire:
		NPLM B 3
		TNT1 A 0 //ACS_NamedExecute("s851",0,100,random(-20,20),0)
		TNT1 A 0 A_FireCustomMissile("GunSmokeSpawner",0,0,7,8)
		NPLM B 0 Bright A_PlayWeaponSound("reilsss/weapons/napalmcannonaltfire")//caleb/napalm
		NPLM B 0 Bright A_FireCustomMissile("PlayerNapalmRocketAltLarge",0,1,8,2)
		NPLM EH 1 Bright
		NPLM GFED 2 //ACS_NamedExecute("s851",0,-25,0,0)				//
		NPLM C 2
		NPLM B 35	
		Goto Ready
	}
}

Actor PlayerNapalmRocket
{
	Mass 1
	Radius 8
	Height 6
	Speed 22
	Damage 30
	Scale 0.35
	RenderStyle Add
	SeeSound "ClericFlameFire"
	DeathSound "reilsss/weapons/napalmexplosion"
	Projectile
	+FORCERADIUSDMG
	DamageType "Fire"
	States
	{
	Spawn:
		FBA2 AAABBBCCCDDDEEEFFF 1 Bright A_SpawnItemEx("FTFlameTrailMini3",random(-7,7),random(-4,4),random(-4,2),0,0,frandom(0,1.25),0,SXF_NOCHECKPOSITION)
		Loop
	Death:
		TNT1 AAAAAAA 0 A_SpawnItemEx("Q2RocketExtra",0,0,0,1,0,random(-1,3),random(1,360))
		TNT1 A 0 A_Explode(160,128,1)
		TNT1 AAAA 0 A_SpawnItemEx("FlmThrwrSmoke5",random(-20,20),random(20,-20),random(10,20),0,0,frandom(0.3,1.5),0,SXF_NOCHECKPOSITION)
		TNT1 AAAAA 0 A_SpawnItemEx("FTFlameTrail2",random(3,25),0,0,0,0,frandom(0,3),random(0,359),SXF_NOCHECKPOSITION)
		FRME A 10 Bright A_CustomMissile("NapalmRocketExLarge",0,0,0,0)
		Stop
	}
}

Actor PlayerNapalmRocketAltLarge : PlayerNapalmRocket
{
	-NOGRAVITY
	Damage 30
	Scale 0.35
	Gravity 0.4
	States
	{
	Spawn:
		TNT1 A 0 
		TNT1 A 0 ThrustThingZ(0,random(10,15),0,1)
		FBA2 AAABBBCCCDDDEEEFFF 1 Bright A_SpawnItemEx("FTFlameTrailMini3",random(-7,7),random(-4,4),random(-4,2),0,0,frandom(0,1.25),0,SXF_NOCHECKPOSITION)
		Goto Spawn+2
	Death:
		TNT1 AAAAAA 0 A_SpawnItemEx("PlayerNapalmRocketAltMedium",0,0,0,random(1,10),0, random(3,6),random(1,360))
		TNT1 A 0 A_Explode(130,128,1)
		TNT1 AAAAAAA 0 A_SpawnItemEx("Q2RocketExtra",0,0,0,1,0,random(-1,3),random(1,360))
		TNT1 AAAA 0 A_SpawnItemEx("FlmThrwrSmoke5",random(-20,20),random(20,-20),random(10,20),0,0,frandom(0.3,1.5),0,SXF_NOCHECKPOSITION)
		TNT1 AAAA 0 A_SpawnItemEx("FTFlameTrail2",random(3,25),0,0,0,0,frandom(0,3),random(0,359),SXF_NOCHECKPOSITION)
		FRME A 10 Bright A_CustomMissile("NapalmRocketExLarge",0,0,0,0)
		Stop
	}
}

Actor PlayerNapalmRocketAltMedium : PlayerNapalmRocketAltLarge
{
	Damage 24
	Scale 0.25
	States
	{
	Spawn:
		FBA2 AAABBBCCCDDDEEEFFF 1 Bright A_SpawnItemEx("FTFlameTrailMini2",random(-7,7),random(-4,4),random(-4,2),0,0,frandom(0,1.25),0,SXF_NOCHECKPOSITION)
		Loop
	Death:
		TNT1 AAAAAA 0 A_SpawnItemEx("PlayerNapalmRocketAltSmall",0,0,0,random(1,10),0,random(3,6),random(1,360))
		TNT1 A 0 A_Explode(80,112,1)
		TNT1 AAAAAA 0 A_SpawnItemEx("Q2RocketExtra",0,0,0,1,0,random(-1,3),random(1,360))
		TNT1 AAA 0 A_SpawnItemEx("FlmThrwrSmoke5",random(-20,20),random(20,-20),random(10,20),0,0,frandom(0.3,1.5),0,SXF_NOCHECKPOSITION)
		TNT1 AAA 0 A_SpawnItemEx("FTFlameTrail2",random(3,25),0,0,0,0,frandom(0,3),random(0,359),SXF_NOCHECKPOSITION)
		FRME A 0 Bright A_CustomMissile("NapalmRocketExMedium",0,0,0,0)
		Stop
	}
}

Actor PlayerNapalmRocketAltSmall : PlayerNapalmRocketAltLarge
{
	Damage 18
	Scale 0.15
	States
	{
	Spawn:
		FBA2 AAABBBCCCDDDEEEFFF 1 Bright A_SpawnItemEx("FTFlameTrailMini2",random(-7,7),random(-4,4),random(-4,2),0,0,frandom(0,1.25),0,SXF_NOCHECKPOSITION)
		Loop
	Death:
		TNT1 A 0 A_Explode(30,96,1)
		TNT1 AAAA 0 A_SpawnItemEx("Q2RocketExtra",0,0,0,1,0,random(-1,3),random(1,360))
		TNT1 AA 0 A_SpawnItemEx("FlmThrwrSmoke5",random(-20,20),random(20,-20),random(10,20),0,0,frandom(0.3,1.5),0,SXF_NOCHECKPOSITION)
		TNT1 AA 0 A_SpawnItemEx("FTFlameTrail2",random(3,25),0,0,0,0,frandom(0,3),random(0,359),SXF_NOCHECKPOSITION)	
		FRME A 0 Bright A_CustomMissile("NapalmRocketExSmall",0,0,0,0)
		Stop
	}
}

Actor NapalmLauncherDrop : CustomInventory
{
	Inventory.MaxAmount 1
	States
	{
	Use:
		TNT1 A 0
		TNT1 A 0 A_SpawnItemEx("DroppedNapalmLauncher",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		Stop
	}
}

Actor DroppedNapalmLauncher
{
	Radius 16
	Height 20
	Scale 0.3
	States
	{
	Spawn:
		NPLM A 15
		TNT1 A 0 A_SpawnItemEx("AEoDNapalmLauncherNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
}

Actor AEoDNapalmLauncherNoAmmo : AEoDNapalmLauncherItem
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	Scale 0.3
	Inventory.Amount 1
	Inventory.PickupMessage "Picked up a napalm launcher."
	Inventory.PickupSound "misc/w_pkup" 
	States
	{
	Spawn:
		NPLM A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("PlasmaRod",30,"Ammo")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("NapalmLauncherDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDNapalmLauncher",1)
		TNT1 A 0 A_TakeInventory("PlasmaRod",30)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDNapalmLauncher",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_TakeInventory("PlasmaRod",30)
		TNT1 A 0 A_JumpIfInventory("AEoDNapalmLauncher",1,2)
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("NapalmLauncherDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDNapalmLauncher",1)
		Stop
	}
}

//==================================================================================
//==================================================================================

//==================================================================================
//==================================================================================

Actor AEoDHEGrenadeLauncherItem : CustomInventory 6011
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	Scale 0.575
	Inventory.Amount 1
	Inventory.PickupMessage "Picked up a HE Grenade Launcher!"
	Inventory.PickupSound "reilsss/weappickup/hegrenadelauncher" 
	States
	{
	Spawn:
		PGRN A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDHEGrenadeLauncher",1,"Ammo")
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("HEGrenadeLauncherDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDHEGrenadeLauncher",1)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDHEGrenadeLauncher",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDHEGrenadeLauncher",1)
		Stop
	}
}

Actor AEoDHEGrenadeLauncher : Weapon // 6011
{ 
	+FLOORCLIP
	+INVENTORY.IGNORESKILL 
	+WEAPON.CHEATNOTWEAPON
	Weapon.AmmoType1 "AEGrenade" 
	Weapon.AmmoType2 "AEGrenade" 
	Weapon.AmmoGive1 3
	Weapon.AmmoUse1 5
	Weapon.AmmoUse2 3
	Weapon.SelectionOrder 14993
	Obituary "%o was victim of %k's HE Grenades."
	Inventory.PickupMessage "Picked up a HE Grenade Launcher!"
	Inventory.PickupSound "reilsss/weappickup/hegrenadelauncher" 
	weapon.upsound "weapons/rlan/draw"
	Scale .575
	Tag "HE grenade launcher"
	States 
	{ 
	Spawn: 
		PGRN A 3
		Loop 
	Ready: 
		QGRN A 1 A_WeaponReady 
		Loop 
	Deselect: 
		TNT1 A 0 	
		QGRN A 1 A_Lower 
		TNT1 AA 0 A_Lower
		Loop 
	Select: 
		TNT1 A 0 	
		QGRN A 1 A_Raise
		TNT1 AA 0 A_Raise 
		Loop 
	Fire: 
		QGRN A 0 A_GunFlash
		TNT1 A 0 A_Recoil(2)
		QGRN B 3 A_PlaySound("reilsss/weapons/grenadelauncherfire", CHAN_WEAPON, 1.0, 0)
		TNT1 A 0 //ACS_NamedExecute("s851",0,150,random(-20,20),0)
		TNT1 A 0 A_FireCustomMissile("GunSmokeSpawner",0,0,6,7)
		QGRN C 2 Bright A_FireCustomMissile("GrenadeL", 0, 1, 6, 0) 
		QGRN CDD 1 //ACS_NamedExecute("s851",0,-50,0,0)
		QGRN E 2
		QGRN F 3 A_PlaySound("reilsss/weapons/grenadelauncherbarrel", 7, 0.75, 0)
		QGRN G 4
		QGRN H 4 A_PlaySound("reilsss/weapons/grenadelauncherload", 6, 1.0, 0)
		QGRN A 10
		Goto Ready 
	AltFire:
		QGRN A 0 A_GunFlash
		TNT1 A 0 A_Recoil(2)
		QGRN B 3 A_PlaySound("reilsss/weapons/grenadelauncherfire", CHAN_WEAPON, 1.0, 0)
		TNT1 A 0 //ACS_NamedExecute("s851",0,150,random(-20,20),0)
		TNT1 A 0 A_FireCustomMissile("GunSmokeSpawner",0,0,6,7)
		QGRN C 2 Bright A_FireCustomMissile("GasGrenade", 0, 1, 6, 0) 
		QGRN CDD 1 //ACS_NamedExecute("s851",0,-50,0,0)
		QGRN E 2
		QGRN F 3 A_PlaySound("reilsss/weapons/grenadelauncherbarrel", 7, 0.75, 0)
		QGRN G 4
		QGRN H 4 A_PlaySound("reilsss/weapons/grenadelauncherload", 6, 1.0, 0)
		QGRN A 10
		Goto Ready 
	Flash: 
		CRBW Z 3 Bright A_Light1 
		CRBW Z 4 Bright A_Light0
		Stop
	}
} 

Actor GrenadeL
{
	PROJECTILE
	+EXTREMEDEATH
	BounceType "Doom"
	+DONTSPLASH 
	+GRENADETRAIL
	+CANBOUNCEWATER
	-NOGRAVITY
	+FORCERADIUSDMG
	Mass 1
	Radius 8
	Height 6
	Speed 35
	Damage 40 //20
	BounceSound "quake4/Weapons/GrenLaunch/Bounce"
	DeathSound "quake4/Misc/GrenadeExplo"
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_StopSound
		TNT1 A 0 ThrustThingZ(0,7,0,1)
		GRNL A 1 Bright A_SpawnItemEx("QuakeGrenSmokeTrail",random(5,-5),random(5,-5),random(5,-5),0,0,1,0,SXF_NOCHECKPOSITION)
		GRNL AA 0 A_SpawnItemEx("GrenTrail", random(5,-5), random(5,-5), random(5,-5),0,0,0,0,SXF_NOCHECKPOSITION) 
		Goto Spawn+3
	Death:
		TNT1 A 0 Bright A_Explode(random(300,600),314,1)
		TNT1 A 0 A_SpawnItemEx("PBExplosionSpawner",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_CustomMissile("GrenadeBit2Shooter",0,0,0)
		TNT1 A 10
		Stop
	}
}

Actor GrenadeBit2Shooter
{
	Projectile
	+RIPPER	RipperLevel 1
	+NOCLIP
	RenderStyle None
	States
	{
	Spawn:
		PLAY A 0
		PLAY AAAAAAAA 0 A_SpawnItemEx("GrenadeBit2",0,0,0,random(-4,4),random(-4,4),random(4,12),random(0,359),SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		PLAY A 100
		Stop
	}
}

Actor GrenadeBit2
{
	PROJECTILE
	BounceType "Doom" 
	+DONTSPLASH
	+CANBOUNCEWATER 
	+RIPPER	RipperLevel 1
	+FORCERADIUSDMG
	Mass 1
	Radius 8
	Height 6
	Speed 8
	Scale 0.5
	RenderStyle Add
	Damage 2
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_Gravity
		TNT1 A 0 A_Explode(32,32)
		SMPF FGHI 1 Bright A_SpawnItemEx("BitTrail2", 0, 0, 0,0,0,0,0,SXF_NOCHECKPOSITION)
		Loop
	Death:
		WRBL P 4 Bright 
		Stop
	}
}

Actor BitTrail2
{
	+NOINTERACTION
	Scale 0.6
	SeeSound "TNT1"
	DeathSound "TNT1"
	RenderStyle Add
	States
	{
	Spawn:
		BFE1 GHIJKLMNOPQRSTUVW 1 Bright A_FadeOut(0.03)
		Stop
	}  
}

Actor GrenTrail
{
	+NOINTERACTION
	SeeSound "TNT1"
	DeathSound "TNT1"
	Scale 0.7
	RenderStyle Translucent
	Alpha 0.6
	States
	{
	Spawn:
		SMK2 AABBCCDDEE 1 A_FadeOut(0.03)
		Wait
	}  
}
Actor GrenTrail2
{
	+NOINTERACTION
	SeeSound "TNT1"
	DeathSound "TNT1"
	RenderStyle Add
	Alpha 0.6
	States
	{
	Spawn:
		SMK2 ABCDE 2 BRIGHT
		Stop
	}  
}


//---------------------------------------------------------------
// This isnt designed to kill.  This is to make monsters stuck
// and to be able to fry them with the primary fire. Also
// since it's an area of effect, is great to stop for example
// a pack of barons of hell coming your way. -DBT
Actor GasGrenade
{
	var int user_angle;
	PROJECTILE
	BounceType "Doom" 
	+CANBOUNCEWATER
	+DONTSPLASH
	Mass 1
	Radius 8
	Height 6
	Speed 30
	Damage 0
	DamageType "AEPoison"
	+PAINLESS
	-NOGRAVITY
	+NODAMAGETHRUST
	Obituary "%o fell asleep due to an overdose of gas."
	BounceSound "quake4/Weapons/GrenLaunch/Bounce"
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SetUserVar("user_angle",0)
		TNT1 A 0 A_StopSound
		TNT1 A 0 ThrustThingZ(0,7,0,1)
		GASL A 1 Bright A_SpawnItemEx("Q2RocketAltSmoke",0,0,0,0,0,0.5,0,SXF_NOCHECKPOSITION)
		GASL A 0 A_SpawnItemEx("GrenTrail2", random(5,-5), random(5,-5), random(5,-5),0,0,0.4,0,SXF_NOCHECKPOSITION) 
		Goto Spawn+4
	Death:
		GASL A 2 Bright A_Gravity
		GASL A 0 A_PlaySound("freegas")
	Looper:	
		TNT1 A 0 A_JumpIf(user_angle>=1800,"Ender")
		GASL A 3 A_SpawnItemEx("GasGrenadeGas",0,0,10,frandom(1,2),0,frandom(0.2,0.5),user_angle,32+2048)
		TNT1 A 0 A_Explode(3,140,1,0,110)
		TNT1 A 0 A_SetUserVar("user_angle",user_angle+10)
		Loop
	Ender:
		GASL A 50
		Stop
	}
}

Actor GasGrenadeGas
{
	PROJECTILE
	+RIPPER	RipperLevel 1
	+BLOODLESSIMPACT
	Radius 10
	Height 10
	Speed 2
	Damage (1)
	Damage 0
	Obituary "%o choked on some toxic gas."
	RENDERSTYLE ADD
	DamageType "AEPoison"
	Scale 0.75
	ALPHA 0.0
	States
	{
	Spawn:
		X110 A 0
		X110 ABCDEFGHIJKLMNOP 2 A_Fadeto(0.8,0.05)
		X110 QRSTUVWXY 2 
		X110 ABCDEFGHIJKLMNOPQRSTUVWXY 2
	Outer:
		X110 ABCDEFGHIJKLMNOPQRSTUVWXY 2 A_FadeOut(0.03)
		Loop
	}
}

Actor GrenadeGas
{
	PROJECTILE
	+RIPPER	RipperLevel 1
	+BLOODLESSIMPACT
	Radius 10
	Height 10
	Speed 2
	Damage (random(1,2))
	Obituary "%o choked on some toxic gas."
	RENDERSTYLE ADD
	DamageType "AEPoison"
	ALPHA 0.67
	States
	{
	Spawn:
		GAS1 AABBCCDDEE 2 Bright A_FadeOut(0.01)
		GAS1 FFFFGGGGHHHHIIIIJJJJ 2 Bright A_FadeOut(0.01)
		GAS1 FFFFGGGGHHHHIIIIJJJJ 2 Bright A_FadeOut(0.01)
		GAS1 FFFFGGGGHHHHIIIIJJJJ 2 Bright A_FadeOut(0.01)
		Goto death
	Death:
		ZZZZ Z 1 BRIGHT
		Stop
	}
}

Actor HEGrenadeLauncherDrop : CustomInventory
{
	Inventory.MaxAmount 1
	States
	{
	Use:
		TNT1 A 0
		TNT1 A 0 A_SpawnItemEx("DroppedHEGrenadeLauncher",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		Stop
	}
}

Actor DroppedHEGrenadeLauncher
{
	Radius 16
	Height 20
	Scale 0.575
	States
	{
	Spawn:
		PGRN A 15
		TNT1 A 0 A_SpawnItemEx("AEoDHEGrenadeLauncherNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
}

Actor AEoDHEGrenadeLauncherNoAmmo : AEoDHEGrenadeLauncherItem
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	Scale 0.575
	Inventory.Amount 1
	Inventory.PickupMessage "Picked up a HE Grenade Launcher!"
	Inventory.PickupSound "reilsss/weappickup/hegrenadelauncher" 
	States
	{
	Spawn:
		PGRN A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("AEGrenade",3,"Ammo")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("HEGrenadeLauncherDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDHEGrenadeLauncher",1)
		TNT1 A 0 A_TakeInventory("AEGrenade",3)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDHEGrenadeLauncher",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_TakeInventory("AEGrenade",3)
		TNT1 A 0 A_JumpIfInventory("AEoDHEGrenadeLauncher",1,2)
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("HEGrenadeLauncherDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDHEGrenadeLauncher",1)
		Stop
	}
}

//==================================================================================
//==================================================================================

//==================================================================================
//==================================================================================

Actor AEoDRailGunItem : CustomInventory 6041
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	Scale 0.28
	Inventory.Amount 1
	Inventory.PickupMessage "You got the RailGun!"
	Inventory.PickupSound "reilsss/weappickup/railgun"
	States
	{
	Spawn:
		RLGA A 3
		Loop

	Pickup:
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
	
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"Ammo")
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",1,"Pickup2")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("RailGunDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDRailGun",1)
		TNT1 A 0 A_GiveInventory("AEoDRailGunCount",1)
		TNT1 A 0 	
		TNT1 A 0 A_JumpIfInventory("NoWeaponSwitch",1,2)
		TNT1 A 0 A_SelectWeapon("AEoDRailGun")
		TNT1 A 0
		Stop
	Pickup2:
		TNT1 A 0 A_GiveInventory("RailGunDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDRailGun",1)
		TNT1 A 0 A_GiveInventory("AEoDRailGunCount",1)
		TNT1 A 0 	
		TNT1 A 0 A_JumpIfInventory("NoWeaponSwitch",1,2)
		TNT1 A 0 A_SelectWeapon("AEoDRailGun")
		TNT1 A 0
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"Ammo")
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",1,"Pickup2")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDRailGun",1)
		Stop
	}
}

Actor AEoDRailGun : Weapon // 6041
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	//+WEAPON.CHEATNOTWEAPON
	Weapon.AmmoType1 "AEShell"
	Weapon.AmmoType2 "AEShell"
	Weapon.AmmoGive1 24
	Weapon.AmmoUse1 2
	Weapon.AmmoUse2 3
	Weapon.SelectionOrder 11950
	Inventory.PickupMessage "You got the RailGun!"
	Inventory.PickupSound "reilsss/weappickup/railgun"
	AttackSound "weapons/railgun/pfire"
	weapon.upsound "weapons/plasma/draw"
	Scale 0.28
	Tag "Railgun"
	States
	{
	Spawn:
		RLGA A 3
		Loop
	Ready:
		TNT1 A 0 A_TakeInventory("RailGunDropCheck",1)
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"Ready2")
		TNT1 A 0 A_PlaySound("reilsss/weapons/railgunidle1", 6, 1.0, 1)
		RLGG A 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"Ready2")
		RLGG A 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"Ready2")
		RLGG A 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"Ready2")
		RLGG A 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"Ready2")
		RLGG B 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"Ready2")
		RLGG B 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"Ready2")
		RLGG B 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"Ready2")
		RLGG B 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"Ready2")
		RLGG C 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"Ready2")
		RLGG C 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"Ready2")
		RLGG C 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"Ready2")
		RLGG C 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"Ready2")
		RLGG D 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"Ready2")
		RLGG D 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"Ready2")
		RLGG D 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"Ready2")
		RLGG D 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"Ready2")
		RLGG A 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"Ready2")
		RLGG A 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"Ready2")
		RLGG A 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"Ready2")
		RLGG A 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"Ready2")
		RLGG B 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"Ready2")
		RLGG B 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"Ready2")
		RLGG B 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"Ready2")
		RLGG C 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"Ready2")
		RLGG C 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"Ready2")
		RLGG C 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"Ready2")
		RLGG D 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"Ready2")
		RLGG D 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"Ready2")
		RLGG D 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"Ready2")
		Loop
	Ready2:
		TNT1 A 0 A_JumpIfInventory("RailGunDropCheck",1,"Ready")
		TNT1 A 0 A_PlaySound("reilsss/weapons/railgunidle1", 6, 1.0, 1)
		RLG2 A 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("RailGunDropCheck",1,"Ready")
		RLG2 A 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("RailGunDropCheck",1,"Ready")
		RLG2 A 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("RailGunDropCheck",1,"Ready")
		RLG2 A 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("RailGunDropCheck",1,"Ready")
		RLG2 B 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("RailGunDropCheck",1,"Ready")
		RLG2 B 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("RailGunDropCheck",1,"Ready")
		RLG2 B 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("RailGunDropCheck",1,"Ready")
		RLG2 B 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("RailGunDropCheck",1,"Ready")
		RLG2 C 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("RailGunDropCheck",1,"Ready")
		RLG2 C 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("RailGunDropCheck",1,"Ready")
		RLG2 C 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("RailGunDropCheck",1,"Ready")
		RLG2 C 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("RailGunDropCheck",1,"Ready")
		RLG2 D 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("RailGunDropCheck",1,"Ready")
		RLG2 D 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("RailGunDropCheck",1,"Ready")
		RLG2 D 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("RailGunDropCheck",1,"Ready")
		RLG2 D 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("RailGunDropCheck",1,"Ready")
		RLG2 A 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("RailGunDropCheck",1,"Ready")
		RLG2 A 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("RailGunDropCheck",1,"Ready")
		RLG2 A 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("RailGunDropCheck",1,"Ready")
		RLG2 A 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("RailGunDropCheck",1,"Ready")
		RLG2 B 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("RailGunDropCheck",1,"Ready")
		RLG2 B 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("RailGunDropCheck",1,"Ready")
		RLG2 B 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("RailGunDropCheck",1,"Ready")
		RLG2 C 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("RailGunDropCheck",1,"Ready")
		RLG2 C 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("RailGunDropCheck",1,"Ready")
		RLG2 C 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("RailGunDropCheck",1,"Ready")
		RLG2 D 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("RailGunDropCheck",1,"Ready")
		RLG2 D 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("RailGunDropCheck",1,"Ready")
		RLG2 D 1 A_WeaponReady
		TNT1 A 0 A_JumpIfInventory("RailGunDropCheck",1,"Ready")
		Loop
	Deselect:
		TNT1 A 0 A_StopSound(6)
		TNT1 A 0 	
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"Deselect2")
		RLGG A 1 A_Lower
		TNT1 AA 0 A_Lower
		Goto Deselect+1
	Deselect2:
		TNT1 A 0 A_StopSound(6)
		TNT1 A 0 	
		RLG2 A 1 A_Lower
		TNT1 AA 0 A_Lower
		Goto Deselect2+1
	Select:
		TNT1 A 0 	
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"Select2")
		RLGG A 1 A_Raise
		TNT1 AA 0 A_Raise
		Loop
	Select2:
		TNT1 A 0 	
		RLG2 A 1 A_Raise
		TNT1 AA 0 A_Raise
		Loop
	Fire:
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"Fire2")
		TNT1 A 0 A_StopSound(CHAN_BODY)
		RLGG FH 1
		TNT1 A 0 A_GunFlash
		TNT1 A 0 //ACS_NamedExecute("s851",0,120,random(-8,8),0)
		RLGG I 1 A_RailAttack(random(150,350),5,1,"77 FF 6F","E7 E7 FF",0,0)
		RLGG J 1
		RLGG KLM 1 //ACS_NamedExecute("s851",0,-40,0,0)
		RLGG M 1
		TNT1 A 0 A_FireCustomMissile("GunSmallSmokeSpawner",0,0,10,4)
		TNT1 A 0 A_FireCustomMissile("GunSmallSmokeSpawner",0,0,7,5)
		TNT1 A 0 A_FireCustomMissile("GunSmallSmokeSpawner",0,0,4,4)
		RLGG NO 3
		RLGG PQ 3
		RLGG A 18
		RLGG A 0 A_ReFire
		Goto Ready
	Fire2:
		TNT1 A 0 A_StopSound(CHAN_BODY)
		RLG2 EF 1
		TNT1 A 0 A_GunFlash
		TNT1 A 0 //ACS_NamedExecute("s851",0,120,random(-8,8),0)
		RLG2 G 1 A_RailAttack(random(150,350),5,1,"77 FF 6F","E7 E7 FF",0,0)
		RLG2 H 1
		RLG2 IJK 1 //ACS_NamedExecute("s851",0,-40,0,0)
		RLG2 K 1
		TNT1 A 0 A_FireCustomMissile("GunSmallSmokeSpawner",0,0,10,4)
		TNT1 A 0 A_FireCustomMissile("GunSmallSmokeSpawner",0,0,7,5)
		TNT1 A 0 A_FireCustomMissile("GunSmallSmokeSpawner",0,0,4,4)
		RLG2 LM 2
		RLG2 NO 2
		RLG2 A 2
		RNGG A 0 A_ReFire("Hold2")
		Goto Ready
	Hold2:
		RLG2 PQ 1
		TNT1 A 0 A_GunFlash
		TNT1 A 0 //ACS_NamedExecute("s851",0,120,random(-8,8),0)
		RLG2 R 1 A_RailAttack(random(150,350),-5,1,"77 FF 6F","E7 E7 FF",0,0)
		RLG2 S 1
		RLG2 TUV 1 //ACS_NamedExecute("s851",0,-40,0,0)
		RLG2 V 1
		TNT1 A 0 A_FireCustomMissile("GunSmallSmokeSpawner",0,0,-10,4)
		TNT1 A 0 A_FireCustomMissile("GunSmallSmokeSpawner",0,0,-7,5)
		TNT1 A 0 A_FireCustomMissile("GunSmallSmokeSpawner",0,0,-4,4)
		RLG2 WX 2
		RLG2 YZ 2
		RLG2 A 2
		RLGG A 0 A_ReFire("Fire2")
		Goto Ready
	AltFire:
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"AltFire2")
		TNT1 A 0 A_StopSound(CHAN_BODY)
		RLGG FH 1
		TNT1 A 0 A_GunFlash
		TNT1 A 0 //ACS_NamedExecute("s851",0,90,random(-8,8),0)
		TNT1 A 0 A_PlaySound("reilsss/weapons/railgunfire", CHAN_WEAPON, 1.0, 0)
		RLGG I 1 A_FireCustomMissile("RailgunAltBlast", 0, 1, 5, 0)
		RLGG J 1
		RLGG KLM 1 //ACS_NamedExecute("s851",0,-30,0,0)
		RLGG M 1
		TNT1 A 0 A_FireCustomMissile("GunSmallSmokeSpawner",0,0,10,4)
		TNT1 A 0 A_FireCustomMissile("GunSmallSmokeSpawner",0,0,7,5)
		TNT1 A 0 A_FireCustomMissile("GunSmallSmokeSpawner",0,0,4,4)
		RLGG NO 3
		RLGG PQ 3
		RLGG A 18
		RLGG A 0 A_ReFire
		Goto Ready
	AltFire2:
		TNT1 A 0 A_StopSound(CHAN_BODY)
		RLG2 EF 1
		TNT1 A 0 A_GunFlash
		TNT1 A 0 //ACS_NamedExecute("s851",0,90,random(-8,8),0)
		TNT1 A 0 A_PlaySound("reilsss/weapons/railgunfire", CHAN_WEAPON, 1.0, 0)
		RLG2 G 1 A_FireCustomMissile("RailgunAltBlast", 0, 1, 5, 0)
		RLG2 H 1
		RLG2 IJK 1 //ACS_NamedExecute("s851",0,-30,0,0)
		RLG2 K 1
		TNT1 A 0 A_FireCustomMissile("GunSmallSmokeSpawner",0,0,10,4)
		TNT1 A 0 A_FireCustomMissile("GunSmallSmokeSpawner",0,0,7,5)
		TNT1 A 0 A_FireCustomMissile("GunSmallSmokeSpawner",0,0,4,4)
		RLG2 LM 2
		RLG2 NO 2
		RLG2 A 2
		RLGG A 0 A_ReFire("AltHold2")
		Goto Ready
	AltHold2:
		RLG2 PQ 1
		TNT1 A 0 A_GunFlash
		TNT1 A 0 //ACS_NamedExecute("s851",0,90,random(-8,8),0)
		TNT1 A 0 A_PlaySound("reilsss/weapons/railgunfire", CHAN_WEAPON, 1.0, 0)
		RLG2 R 1 A_FireCustomMissile("RailgunAltBlast", 0, 1, -5, 0)
		RLG2 S 1
		RLG2 TUV 1 //ACS_NamedExecute("s851",0,-30,0,0)
		RLG2 V 1
		TNT1 A 0 A_FireCustomMissile("GunSmallSmokeSpawner",0,0,-10,4)
		TNT1 A 0 A_FireCustomMissile("GunSmallSmokeSpawner",0,0,-7,5)
		TNT1 A 0 A_FireCustomMissile("GunSmallSmokeSpawner",0,0,-4,4)
		RLG2 WX 2
		RLG2 YZ 2
		RLG2 A 2
		RLG2 A 0 A_ReFire("AltFire2")
		Goto Ready
	Flash:
		TNT1 A 1 A_Light2
		TNT1 A 2 A_Light1
		TNT1 A 2 A_Light0
		Stop
	}
}

// Added by Reilsss
//Weapon: Tripheleron Ion Cannon
//By: Inuyasha_989

Actor RailgunAltBlast
{
	PROJECTILE
	+RIPPER	RipperLevel 1
	+NOGRAVITY
	BounceType "Hexen"
	+SKYEXPLODE
	BounceCount 10
	BounceFactor 1
	WallBounceFactor 1
	ExplosionDamage 64
	ExplosionRadius 32
	DamageType "Plasma"
	Speed 35
	Damage 10
	Height 10
	Radius 10
	DeathSound "reilsss/weapons/dispersionexplosion"
	RenderStyle Add
	Alpha 0.8
	Scale 0.3
	States
	{
	Spawn:
		SBLL ABCDEFGHIJ 1 Bright A_CustomMissile("RailgunShockwave",0,0,0,0)
		Goto Spawn+1
	Death:
		SBLL K 1 A_Explode
		SBLL LMNOPQRSTUVW 1 BRIGHT
		Stop
	}
}


Actor RailgunShockwave
{
	+NOINTERACTION
	RenderStyle Add
	Alpha 0.7
	Scale 0.2
	Translation "112:127=192:207"
	States
	{
	Spawn:
		SHOK ABCDEFGHIJKLMNOPQR 1 Bright A_FadeOut(0.02) 
		Stop
	}
}

Actor AEoDRailGunPickup : CustomInventory //6042
{
	Scale 0.28
	Inventory.PickupMessage "You got the RailGun!"
	Inventory.PickupSound "reilsss/weappickup/railgun"
	States
	{
	Spawn:
		RLGA A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,4)
		TNT1 A 0 A_GiveInventory("AEoDRailGunCount",1)
		TNT1 A 0 A_JumpIfInventory("NoWeaponSwitch",1,2)
		TNT1 A 0 A_SelectWeapon("AEoDRailGun")
		TNT1 A 0 A_GiveInventory("AEoDRailGun",1)
		TNT1 A 0
		Stop
	}
}

Actor AEoDRailGunCount : Inventory
{
	Inventory.MaxAmount 2
	Inventory.Amount 1
}

Actor RailGunDropCheck : Inventory
{
	Inventory.Amount 1
	Inventory.MaxAmount 1
}

Actor RailGunDrop : CustomInventory
{
	Inventory.Amount 1
	Inventory.MaxAmount 2
	States
	{
	Use:
		TNT1 A 0
		TNT1 A 0 A_StopSound(6)
		TNT1 A 0 A_SpawnItemEx("DroppedRailGun",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		TNT1 A 0 A_TakeInventory("AEoDRailGunCount",1)
		Stop
	}
}

Actor DroppedRailGun
{
	Radius 16
	Height 20
	Scale 0.28
	States
	{
	Spawn:
		RLGA A 15
		TNT1 A 0 A_SpawnItemEx("AEoDRailGunNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
}

Actor AEoDRailGunNoAmmo : AEoDRailGunItem
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	Scale 0.28
	Inventory.Amount 1
	Inventory.PickupMessage "You got the RailGun!"
	Inventory.PickupSound "reilsss/weappickup/railgun"
	States
	{
	Spawn:
		RLGA A 3
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("AEShell",24,"Ammo")
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"Ammo")
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",1,"Pickup2")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("RailGunDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDRailGun",1)
		TNT1 A 0 A_GiveInventory("AEoDRailGunCount",1)
		TNT1 A 0 A_TakeInventory("AEShell",24)
		TNT1 A 0 	
		TNT1 A 0 A_JumpIfInventory("NoWeaponSwitch",1,2)
		TNT1 A 0 A_SelectWeapon("AEoDRailGun")
		TNT1 A 0
		Stop
	Pickup2:
		TNT1 A 0 A_JumpIfInventory("AEShell",24,"Ammo")
		TNT1 A 0 A_GiveInventory("RailGunDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDRailGun",1)
		TNT1 A 0 A_GiveInventory("AEoDRailGunCount",1)
		TNT1 A 0 A_TakeInventory("AEShell",24)
		TNT1 A 0 	
		TNT1 A 0 A_JumpIfInventory("NoWeaponSwitch",1,2)
		TNT1 A 0 A_SelectWeapon("AEoDRailGun")
		TNT1 A 0
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",2,"Ammo")
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",1,"Pickup2")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_TakeInventory("AEShell",24)
		TNT1 A 0 A_JumpIfInventory("AEoDRailGunCount",1,2)
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("AEoDRailGunCount",1)
		TNT1 A 0 A_GiveInventory("RailGunDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDRailGun",1)
		Stop
	}
}

//==================================================================================
//==================================================================================

//==================================================================================
//==================================================================================

Actor AEoDMindBlowerItem : CustomInventory 6049
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	+FLOATBOB
	Scale 0.8
	Inventory.Amount 1
	Inventory.PickupMessage "You picked up the Mind Blower."
	Inventory.PickupSound "pickuppiece"
	States
	{
	Spawn:
		WVNM A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDMindBlower",1,"Ammo")
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("MindBlowerDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDMindBlower",1)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDMindBlower",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDMindBlower",1)
		Stop
	}
}

Actor AEoDMindBlower : Weapon // 6049
{	
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	+WEAPON.CHEATNOTWEAPON
	+EXTREMEDEATH
	+FLOATBOB
	Weapon.AmmoType1 "GreenMana"
	Weapon.AmmoType2 "RedMana"
	Weapon.AmmoGive1 20
	Weapon.AmmoGive2 15
	Weapon.AmmoUse1 2
	Weapon.AmmoUse2 3
	Weapon.SelectionOrder 8200
	Inventory.PickupMessage "You picked up the Mind Blower."
	Inventory.PickupSound "pickuppiece"
	weapon.upsound "weapons/draw"
	Scale 0.8
	Tag "Mind blower"
	States
	{
	Spawn:
		WVNM A -1
		Loop
	Ready:
		TNT1 A 0 A_PlaySound("reilsss/weapons/magicidle6", 6, 0.4, 1)
		VNMG ABCD 3 A_weaponReady
		Goto Ready+1
	Deselect:
		TNT1 A 0 A_StopSound(6)
		TNT1 A 0 	
		VNMG A 1 A_Lower
		TNT1 AA 0 A_Lower
		Goto Deselect+1
	Select:
		TNT1 A 0 	
		VNMG A 1 A_Raise
		TNT1 AA 0 A_Raise
		Loop
	Fire:
		VNMG BCD 1
	Hold:
		VNMG E 2 Bright A_PlaySound("reilsss/weapons/soulreaverfire", CHAN_WEAPON, 1.0, 0)
		TNT1 A 0 A_SetBlend("Green",0.1,5)
		VNMG F 0 Bright //ACS_NamedExecute("s851",0,18,random(-3,3),0)
		VNMG F 2 Bright A_FireBullets(3,3,2,15,"MBPuff",1)
		VNMG G 2 Bright //ACS_NamedExecute("s851",0,-18,random(-3,3),0)
		TNT1 A 0 A_Refire
		VNMG DCB 1
		Goto Ready
	AltFire:
		VNMG HIJ 3
	AltHold:
		VNMG N 3 Bright
		TNT1 A 0 A_PlaySound("reilsss/weapons/soulreaveraltfire", CHAN_WEAPON, 1.0, 0)
		TNT1 A 0 A_SetBlend("Green",0.4,10)
		TNT1 A 0 //ACS_NamedExecute("s851",0,30,random(-3,3),0)
		TNT1 AAAA 0 A_FireCustomMissile("ScourShot1",random(-3,3),0,0,0)
		VNMG O 4 Bright A_FireCustomMissile("ScourShot2",0,1,0,0)
		VNMG P 3 Bright //ACS_NamedExecute("s851",0,-15,0,0)
		VNMG P 1 Bright //ACS_NamedExecute("s851",0,-15,0,0)
		VNMG Q 4 Bright
		TNT1 A 0 A_Refire
		VNMG JKLM 3
		VNMG JIH 3
		Goto Ready
	}
}

Actor ScourShot1
{
	PROJECTILE
	+THRUGHOST
	Radius 4
	Height 8
	Speed 25
	Damage 5
	PoisonDamage 24
	Damagetype "AEPoison"
	DeathSound "weapons/bloodx"
	RENDERSTYLE ADD
	Alpha 0.67
	Scale 0.48
	States
	{
	Spawn:
		FVN1 AABBCCDD 1 Bright A_SpawnItemEx("BarbTrail",0,0,0,0,0,0,0,SXF_ABSOLUTEMOMENTUM)
		Loop
	Death:
		FSFX DEFGHIJKLM 3 Bright A_FadeOut
		Stop
	}
}

Actor Barbtrail
{   
	+NOINTERACTION
	RENDERSTYLE ADD
	ALPHA 0.4
	Scale 0.25
	States
	{
	Spawn:
		TNT1 A 1 Bright
		SSFX CDEFGH 2 Bright
		Stop 
	}
}

Actor Barbtrail2 : Barbtrail { Scale 0.4 }


Actor ScourShot2 : ScourShot1
{
	PROJECTILE
	DONTHURTSHOOTER
	Speed 28
	Radius 6
	Height 8
	Damage 20
	poisondamage 24
	DeathSound "weapons/bloop2"
	Damagetype "AEPoison"
	States
	{
	Spawn:
		D2FX AAABBBCCCDDDEEEFFF 1 Bright A_SpawnItemEx("Barbtrail2",0,0,0,0,0,0,0,SXF_ABSOLUTEMOMENTUM)
		Loop
	Death:
		FSFX D 4 Bright
		FVN2 H 0 Bright A_CustomMissile("ScourDrop1",10,0,22.5,6,80)
		FVN2 H 0 Bright A_CustomMissile("ScourDrop1",10,0,45,6,80)
		FVN2 H 0 Bright A_CustomMissile("ScourDrop1",10,0,67.5,6,80)
		FVN2 H 0 Bright A_CustomMissile("ScourDrop1",10,0,90.5,6,80)
		FVN2 H 0 Bright A_CustomMissile("ScourDrop1",10,0,112.5,6,80)
		FVN2 H 0 Bright A_CustomMissile("ScourDrop1",10,0,135,6,80)
		FVN2 H 0 Bright A_CustomMissile("ScourDrop1",10,0,157.5,6,80)
		FVN2 H 0 Bright A_CustomMissile("ScourDrop1",10,0,180,6,80)
		FVN2 H 0 Bright A_CustomMissile("ScourDrop1",10,0,202.5,6,80)
		FVN2 H 0 Bright A_CustomMissile("ScourDrop1",10,0,225,6,80)
		FVN2 H 0 Bright A_CustomMissile("ScourDrop1",10,0,247.5,6,80)
		FVN2 H 0 Bright A_CustomMissile("ScourDrop1",10,0,270,6,80)
		FVN2 H 0 Bright A_CustomMissile("ScourDrop1",10,0,292.5,6,80)
		FVN2 H 0 Bright A_CustomMissile("ScourDrop1",10,0,315,6,80)
		FVN2 H 0 Bright A_CustomMissile("ScourDrop1",10,0,337.5,6,80)
		FVN2 H 0 Bright A_CustomMissile("ScourDrop1",10,0,0,6,80)
		FVN2 H 0 Bright A_CustomMissile("ScourDrop2",10,0,22.5,6,30)
		FVN2 H 0 Bright A_CustomMissile("ScourDrop2",10,0,45,6,30)
		FVN2 H 0 Bright A_CustomMissile("ScourDrop2",10,0,67.5,6,30)
		FVN2 H 0 Bright A_CustomMissile("ScourDrop2",10,0,90.5,6,30)
		FVN2 H 0 Bright A_CustomMissile("ScourDrop2",10,0,112.5,6,30)
		FVN2 H 0 Bright A_CustomMissile("ScourDrop2",10,0,135,6,30)
		FVN2 H 0 Bright A_CustomMissile("ScourDrop2",10,0,157.5,6,30)
		FVN2 H 0 Bright A_CustomMissile("ScourDrop2",10,0,180,6,30)
		FVN2 H 0 Bright A_CustomMissile("ScourDrop2",10,0,202.5,6,30)
		FVN2 H 0 Bright A_CustomMissile("ScourDrop2",10,0,225,6,30)
		FVN2 H 0 Bright A_CustomMissile("ScourDrop2",10,0,247.5,6,30)
		FVN2 H 0 Bright A_CustomMissile("ScourDrop2",10,0,270,6,30)
		FVN2 H 0 Bright A_CustomMissile("ScourDrop2",10,0,292.5,6,30)
		FVN2 H 0 Bright A_CustomMissile("ScourDrop2",10,0,315,6,30)
		FVN2 H 0 Bright A_CustomMissile("ScourDrop2",10,0,337.5,6,30)
		FVN2 H 0 Bright A_CustomMissile("ScourDrop2",10,0,0,6,30)
		FSFX EFGHIJKLM 3 Bright A_FadeOut
		Stop
	}
}


Actor ScourDrop1
{
	PROJECTILE
	-NOGRAVITY
	+THRUGHOST
	Radius 4
	Height 8
	Speed 15
	Damage 3
	poisondamage 24
	Damagetype "AEPoison"
	Gravity 1.4
	RENDERSTYLE ADD
	Alpha 0.67
	Scale 0.7
	Translation "0:255=%[0,0,0]:[0,1,0]"
	DeathSound "weapons/bloodx"
	States
	{
	Spawn:
		FX11 AAABBB 1 Bright A_SpawnItemEx("BarbFX",0,0,0,0,0,0,0,SXF_ABSOLUTEVELOCITY+SXF_TRANSFERTRANSLATION)
		Loop
	Death:
		TNT1 AAAA 0 A_SpawnItemEx("BSSpitExtra",0,0,0,random(1,-1),random(1,-1),random(0,3),0,0)	//see MonHL.AED
		TNT1 A 0 A_ChangeFlag("NOGRAVITY",1)
		FVN1 EFGHIJ 4 Bright
		Stop
	}
}

Actor BarbFX
{   
	+NOINTERACTION
	RENDERSTYLE ADD
	ALPHA 0.75
	Scale 0.35
	States
	{
	Spawn:
		TNT1 A 1 Bright
		FRB1 ABC 2 Bright A_FadeOut(0.07)
		Goto Spawn+1
	}
}

Actor ScourDrop2 : ScourDrop1
{
	Speed 8
	Gravity 1
}

Actor MBPuff
{
	+EXTREMEDEATH
	+NoBlockmap
	+NoGravity
	+ActivatePCross
	+ActivateImpact
	+NoTeleport
	+DropOff
	+PUFFONACTORS
	+FOILINVUL
	Radius 3
	Height 5
	Speed 0
	DamageType "AEMagic"
	Translation "0:255=%[0.0,0.1,0.0]:[0.0,1.0,0.0]"
	Scale 0.2
	States
	{
	Spawn:
		FRME A 0
		TNT1 A 0 A_SpawnItemEx("TeslaFXv6",random(3,-3),0,random(2,-2),0,0,frandom(0.2,0.5),0,SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION)	//see WeapClass7.AED 
		TNT1 AAAA 0 A_SpawnItemEx("BSSpitExtra",0,0,0,random(1,-1),random(1,-1),random(0,3),0,SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION)	//see MonHL.AED
		FRME ABCDEFGHIJKLMNOPQRS 1 Bright A_FadeOut(0.04)
		Stop
	}
}

Actor MBPuff2
{
	+EXTREMEDEATH
	+NoBlockmap
	+NoGravity
	+ActivatePCross
	+ActivateImpact
	+NoTeleport
	DamageType "AEMagic"
	+DropOff
	Radius 5
	Height 8
	Speed 0
	Translation "0:111=127:112", "128:249=127:112"
	Scale .45
	States
	{
	Spawn:
		FRME A 1 Bright
		FRME BCDEFGHIJKLMNOPQRS 1 Bright
		Stop
	}
}

Actor MindBlowerDrop : CustomInventory
{
	Inventory.MaxAmount 1
	States
	{
	Use:
		TNT1 A 0
		TNT1 A 0 A_StopSound(6)
		TNT1 A 0 A_SpawnItemEx("DroppedMindBlower",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		Stop
	}
}

Actor DroppedMindBlower
{
	Radius 16
	Height 20
	Scale 0.8
	States
	{
	Spawn:
		WVNM A 15
		TNT1 A 0 A_SpawnItemEx("AEoDMindBlowerNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
}

Actor AEoDMindBlowerNoAmmo : AEoDMindBlowerItem
{
	+FLOORCLIP
	+FLOATBOB
	+INVENTORY.IGNORESKILL
	Scale 0.8
	Inventory.Amount 1
	Inventory.PickupMessage "You picked up the Mind Blower."
	Inventory.PickupSound "pickuppiece"
	States
	{
	Spawn:
		WVNM A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("GreenMana",20,"Ammo")
		TNT1 A 0 A_JumpIfInventory("RedMana",15,"Ammo3")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("MindBlowerDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDMindBlower",1)
		TNT1 A 0 A_TakeInventory("GreenMana",20)
		TNT1 A 0 A_TakeInventory("RedMana",15)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDMindBlower",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_JumpIfInventory("RedMana",15,1)
		Goto Ammo2
		
		TNT1 A 0 A_TakeInventory("GreenMana",20)
		TNT1 A 0 A_TakeInventory("RedMana",15)
		TNT1 A 0 A_JumpIfInventory("AEoDMindBlower",1,2)
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("MindBlowerDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDMindBlower",1)
		Stop
	Ammo2:
		TNT1 A 0 A_TakeInventory("GreenMana",20)
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("MindBlowerDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDMindBlower",1)
		TNT1 A 0 A_TakeInventory("RedMana",15)
		Stop
	Ammo3:
		TNT1 A 0 A_TakeInventory("RedMana",15)
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("MindBlowerDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDMindBlower",1)
		TNT1 A 0 A_TakeInventory("GreenMana",20)
		Stop
	}
}

//==================================================================================
//==================================================================================

//==================================================================================
//==================================================================================


Actor AEoDIncendiaryItem : CustomInventory 6108
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	Scale 0.19
	Inventory.Amount 1
	Inventory.PickupMessage "You picked up an experimental incendiary launcher!"
	Inventory.PickupSound "reilsss/weappickup/heavyrocketlauncher"
	States
	{
	Spawn:
		WROM A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDIncendiary",1,"Ammo")
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("IncendiaryDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDIncendiary",1)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDIncendiary",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDIncendiary",1)
		Stop
	}
}

Actor AEoDIncendiary : Weapon // 6108
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	+WEAPON.CHEATNOTWEAPON
	Weapon.AmmoType1 "PlasmaRod"
	Weapon.AmmoType2 "PlasmaRod"
	Weapon.AmmoGive1 30
	Weapon.AmmoUse1 6
	Weapon.AmmoUse2 30
	Weapon.SelectionOrder 14998
	Obituary "%o was consumed by %k's flames."
	Inventory.PickupMessage "You picked up an experimental incendiary launcher!"
	Inventory.PickupSound "reilsss/weappickup/heavyrocketlauncher"
	Weapon.upsound "weapons/rlan/draw"
	Scale 0.19
	Tag "Incendiary"
	States
	{
	Spawn:
		WROM A -1
		Stop
	Ready:
		ROMU A 1 A_WeaponReady
		Loop
	Deselect:
		TNT1 A 0 	
		ROMU A 1 A_Lower
		TNT1 AA 0 A_Lower
		Goto Deselect
	Select:
		TNT1 A 0 	
		ROMU A 1 A_Raise
		TNT1 AA 0 A_Raise
		Goto Select
	Fire:
		TNT1 A 0 A_Recoil(2)
		TNT1 A 0 Bright A_PlaySound("reilsss/weapons/napalmcannonfire", CHAN_WEAPON, 1.0, 0)
		TNT1 A 0 //ACS_NamedExecute("s851",0,150,random(-20,20),0)
		TNT1 A 0 A_GunFlash
		ROMU B 1 Bright A_FireCustomMissile("FirewallRocket", 0, 1, 8, 2) 
		ROMU BCC 1 Bright //ACS_NamedExecute("s851",0,-50,0,0)
		ROMU DEF 2 Bright
		ROMU GH 2
		ROMU IJKLMNOPQR 2
		ROMU A 3
		Goto Ready
	AltFire:
		TNT1 A 0 A_Recoil(2)
		TNT1 A 0 Bright A_PlaySound("reilsss/weapons/napalmcannonfire", CHAN_WEAPON, 1.0, 0)
		TNT1 A 0 //ACS_NamedExecute("s851",0,150,random(-20,20),0)
		TNT1 A 0 A_GunFlash
		ROMU B 1 Bright A_FireCustomMissile("CrossfireRocket", 0, 1, 8, 2) 
		ROMU BCC 1 Bright //ACS_NamedExecute("s851",0,-50,0,0)
		ROMU DEF 3 Bright
		ROMU GH 3
		ROMU IJKLMNOPQR 2
		ROMU A 3
		Goto Ready
	Flash:
		TNT1 A 3 Bright A_Light1 
		TNT1 A 4 Bright A_Light0
		Stop
	}
}

Actor FirewallRocket
{
	Projectile
	-NOGRAVITY
	+FORCERADIUSDMG
	+EXTREMEDEATH
	Radius 6
	Height 8
	Scale 0.4
	Speed 25
	Damage 20
	Gravity 0.7
	DamageType "Fire"
	Obituary "%o told %k's Firewall rocket to unleash it's might on him."
	DeathSound "reilsss/weapons/napalmexplosion"
	States
	{
	Spawn:
		FBA2 AABBCCDDEEFF 1 Bright A_SpawnItemEx("FTFlameTrailMini3",random(-7,7),random(-4,4),random(-4,2),0,0,frandom(0,1.25),0,SXF_NOCHECKPOSITION)
		Loop
	Death:
		TNT1 A 0 A_Explode(128,128,1)
		TNT1 A 0 A_PlaySound("reilsss/weapons/napalmexplosion")
		TNT1 A 0 A_SpawnItemEx("iFiredYourWALL",0,0,0,25,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		TNT1 A 0 A_SpawnItemEx("iFiredYourWALL",0,25,0,25,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		TNT1 A 0 A_SpawnItemEx("iFiredYourWALL",0,-25,0,25,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		TNT1 A 0 A_SpawnItemEx("iFiredYourWALL",0,50,0,25,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		TNT1 A 0 A_SpawnItemEx("iFiredYourWALL",0,-50,0,25,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		TNT1 A 0 A_SpawnItemEx("iFiredYourWALL",0,75,0,25,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		TNT1 A 0 A_SpawnItemEx("iFiredYourWALL",0,-75,0,25,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		TNT1 A 0 A_SpawnItemEx("iFiredYourWALL",0,100,0,25,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		TNT1 A 0 A_SpawnItemEx("iFiredYourWALL",0,-100,0,25,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		Stop
	}
}

Actor iFiredYourWALL	//Yep, I'm making fun of Apple now. YOU'RE FIRED, WALL!
{
	var int user_count;
	Projectile
	+FLOORHUGGER
	+FORCERADIUSDMG
	+RIPPER	RipperLevel 1
	Radius 8
	Height 12
	Damage 10
	DamageType "Fire"
	Speed 25
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 AA 0 A_SpawnItemEx("IncendiaryFlamelet1",random(-10,25),random(-35,35),random(0,30),random(1,10),0,frandom(0.2,3),0,SXF_NOCHECKPOSITION)
		TNT1 AAAAA 0 A_SpawnItemEx("IncendiaryFlamelet1",random(-10,25),random(-35,35),random(0,30),random(1,10),0,frandom(0.2,3),0,SXF_NOCHECKPOSITION,220)
		TNT1 A 0 A_SpawnItemEx("FlmThrwrSmoke5",random(-10,25),random(-35,35),random(20,40),0,0,frandom(0.2,3),0,SXF_NOCHECKPOSITION,128)
		TNT1 A 1 //A_Explode(random(20,80),256,0,0,128)
		Loop
	Death:
		TNT1 A 0 A_SpawnItemEx("PBExplosionSpawnerSmokeless",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_Explode(96,64,0)
		Stop
	}
}

Actor CrossfireRocket
{
	PROJECTILE
	//+THRUGHOST
	+FORCERADIUSDMG
	Radius 7
	Height 8 
	Speed 25
	Damage 20
	DeathSound "reilsss/weapons/napalmexplosion"
	Obituary "%o was fired by %k's Crossfire missile."
	Scale 0.4
	DamageType "Fire"
	States
	{
	Spawn:
		FBA2 AABBCCDDEEFF 1 A_SpawnItemEx("FTFlameTrailMini3",random(-7,7),random(-4,4),random(-4,2),0,0,frandom(0,1.25),0,SXF_NOCHECKPOSITION)
		Loop
	Death:
		TNT1 A 0 A_CustomMissile("ExpQuakeSmall",0)
		TNT1 A 3 Bright A_CustomMissile("CrossfireExplosion1",0,0,0,6)
		TNT1 A 0 A_CustomMissile("CrossfireGenerator",1,0,0,6)
		TNT1 A 0 A_CustomMissile("CrossfireGenerator",1,0,72,6)
		TNT1 A 0 A_CustomMissile("CrossfireGenerator",1,0,144,6)
		TNT1 A 0 A_CustomMissile("CrossfireGenerator",1,0,216,6)
		XPL2 A 0 Bright A_CustomMissile("CrossfireGenerator",1,0,288,6)
		Stop
	}
}

Actor CrossfireGenerator
{
	Projectile
	+FORCERADIUSDMG
	+THRUACTORS
	Radius 1
	Height 1
	Speed 16
	Damage 1
	DamageType "Fire"
	Obituary "%o was flamed by %k's Crossfire entrails."
	DeathSound "reilsss/weapons/napalmexplosion"
	BounceType "Doom"
	BounceFactor .8
	RenderStyle None
	Scale 0.9
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_CustomMissile("SparkSpraySpawner",0)
		TNT1 A 1 A_CustomMissile("CrossfireExplosion1",0)
		TNT1 AAA 1
		TNT1 A 1 A_CustomMissile("CrossfireExplosion1",0)
		TNT1 AAA 1
		TNT1 A 0 A_CustomMissile("SparkSpraySpawner",0)
		TNT1 A 1 A_CustomMissile("CrossfireExplosion1",0)
		TNT1 AAA 1
		TNT1 A 1 A_CustomMissile("CrossfireExplosion1",0)
		TNT1 AAA 1
		TNT1 A 0 A_CustomMissile("SparkSpraySpawner",0)
		TNT1 A 1 A_CustomMissile("CrossfireExplosion1",0)
		TNT1 AAA 1
		Goto Death
	Death:
		TNT1 A 0 A_CustomMissile("CrossfireExplosion1",0)
		Stop
	}
}

Actor CrossfireExplosion1
{
	Projectile
	+FORCERADIUSDMG
	+NOINTERACTION
	+EXTREMEDEATH
	Radius 6
	Height 4
	Speed 0
	RenderStyle Add
	Alpha 0.99
	DamageType "Fire"
	Scale 1
	States
	{
	Spawn:
		TNT1 A 0
		Goto Death
	Death:
		TNT1 A 0
		TNT1 A 0 A_PlaySound("reilsss/weapons/napalmexplosion")
		//TNT1 A 0 A_SpawnItemEx("MonExplosionMediumSimple",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 AA 0 A_SpawnItemEx("FlmThrwrSmoke5",random(-20,20),random(20,-20),random(10,20),0,0,frandom(0.3,1.5),0,SXF_NOCHECKPOSITION)
		TNT1 AA 0 A_SpawnItemEx("FTFlameTrail2",random(3,25),0,0,0,0,frandom(0,3),random(0,359),SXF_NOCHECKPOSITION)
		TNT1 A 0 Bright A_CustomMissile("NapalmRocketExLarge",0,0,0,0)
		TNT1 A 3 Bright A_Explode(128,128)
		Stop
	}
}

Actor CrossfireExplosion2 : CrossfireExplosion1
{
	Alpha 0.75
	Scale 0.9
	States
	{
	Death:
		TNT1 A 0 A_PlaySound("reilsss/weapons/napalmexplosion")
		TNT1 AA 0 A_SpawnItemEx("FlmThrwrSmoke5",random(-20,20),random(20,-20),random(10,20),0,0,frandom(0.3,1.5),0,SXF_NOCHECKPOSITION)
		TNT1 AA 0 A_SpawnItemEx("FTFlameTrail2",random(3,25),0,0,0,0,frandom(0,3),random(0,359),SXF_NOCHECKPOSITION)
		TNT1 A 0 Bright A_CustomMissile("NapalmRocketExLarge",0,0,0,0)
		TNT1 A 3 Bright A_Explode(112,128)
		Stop
	}
}

Actor CrossfireExplosion3 : CrossfireExplosion1
{
	Alpha 0.7
	Scale 0.8
	States
	{
	Death:
		TNT1 A 0 A_PlaySound("reilsss/weapons/napalmexplosion")
		TNT1 AA 0 A_SpawnItemEx("FlmThrwrSmoke5",random(-20,20),random(20,-20),random(10,20),0,0,frandom(0.3,1.5),0,SXF_NOCHECKPOSITION)
		TNT1 AA 0 A_SpawnItemEx("FTFlameTrail2",random(3,25),0,0,0,0,frandom(0,3),random(0,359),SXF_NOCHECKPOSITION)
		TNT1 A 0 Bright A_CustomMissile("NapalmRocketExLarge",0,0,0,0)
		TNT1 A 3 Bright A_Explode(104,128)
		Stop
	}
}

Actor CrossfireExplosion4 : CrossfireExplosion1
{
	Alpha 0.6
	Scale 0.7
	States
	{
	Death:
		TNT1 A 0 A_PlaySound("reilsss/weapons/napalmexplosion")
		TNT1 AA 0 A_SpawnItemEx("FlmThrwrSmoke5",random(-20,20),random(20,-20),random(10,20),0,0,frandom(0.3,1.5),0,SXF_NOCHECKPOSITION)
		TNT1 AA 0 A_SpawnItemEx("FTFlameTrail2",random(3,25),0,0,0,0,frandom(0,3),random(0,359),SXF_NOCHECKPOSITION)
		TNT1 A 0 Bright A_CustomMissile("NapalmRocketExLarge",0,0,0,0)
		TNT1 A 3 Bright A_Explode(96,128)
		Stop
	}
}



Actor IncendiaryDrop : CustomInventory
{
	Inventory.MaxAmount 1
	States
	{
	Use:
		TNT1 A 0
		TNT1 A 0 A_SpawnItemEx("DroppedIncendiary",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		Stop
	}
}

Actor DroppedIncendiary
{
	Radius 16
	Height 20
	Scale 0.19
	States
	{
	Spawn:
		WROM A 15
		TNT1 A 0 A_SpawnItemEx("AEoDIncendiaryNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
}

Actor AEoDIncendiaryNoAmmo : AEoDIncendiaryItem
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	Scale 0.19
	Inventory.Amount 1
	Inventory.PickupMessage "You picked up an experimental incendiary launcher!"
	Inventory.PickupSound "reilsss/weappickup/heavyrocketlauncher"
	States
	{
	Spawn:
		WROM A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("PlasmaRod",30,"Ammo")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("IncendiaryDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDIncendiary",1)
		TNT1 A 0 A_TakeInventory("PlasmaRod",30)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDIncendiary",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_TakeInventory("PlasmaRod",30)
		TNT1 A 0 A_JumpIfInventory("AEoDIncendiary",1,2)
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("IncendiaryDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDIncendiary",1)
		Stop
	}
}

//==================================================================================
//==================================================================================

//==================================================================================
//==================================================================================

Actor AEoDDeathRayItem : CustomInventory 6107
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	Scale 0.16
	Inventory.Amount 1
	Inventory.PickupMessage "You got the Deathray! It's very atomic!"
	Inventory.PickupSound "reilsss/weappickup/ionecannon"
	States
	{
	Spawn:
		DTHR A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDDeathRay",1,"Ammo")
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("DeathRayDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDDeathRay",1)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDDeathRay",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDDeathRay",1)
		Stop
	}
}

Actor AEoDDeathRay : Weapon // 6107
{ 
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	+WEAPON.CHEATNOTWEAPON
	Weapon.AmmoType1 "AECell"
	Weapon.AmmoType2 "AECell"
	Weapon.AmmoGive1 25
	Weapon.AmmoUse1 10
	Weapon.AmmoUse2 30
	Weapon.Kickback 100
	Weapon.SelectionOrder 13000
	Obituary "%o learned why %k's DeathRay is so deadly."
	Inventory.PickupMessage "You got the Deathray! It's very atomic!"
	Inventory.PickupSound "reilsss/weappickup/ionecannon"
	Weapon.upsound "weapons/plasma/draw"
	Scale 0.16
	Tag "DeathRay"
	States 
	{ 
	Spawn: 
		DTHR A -1 
		Loop 
	Ready:
		TNT1 A 0 A_PlaySound("reilsss/weapons/alienweaponidle2", 6, 0.3, 1)
		DTHR B 1 A_WeaponReady 
		Goto Ready+1
	Deselect:
		TNT1 A 0 A_StopSound(6)
		TNT1 A 0 	
		DTHR B 1 A_Lower
		TNT1 AA 0 A_Lower
		Goto Deselect+1
	Select:
		TNT1 A 0 	
		DTHR B 1 A_Raise
		TNT1 AA 0 A_Raise
		Loop
	Fire:
		DTHR B 0 A_PlaySound("weapons/deathray/fire", CHAN_WEAPON, 1.0, 0)
		DTHR B 0 //ACS_NamedExecute("s851",0,30,random(-20,20),0)
		DTHR B 0 A_Gunflash
		DTHR C 3 A_FireCustomMissile("DeathRayMirrorBullet", 0, 1, 4, 3)
		DTHR DE 3 //ACS_NamedExecute("s851",0,-15,0,0)
		DTHR F 3
		DTHR B 14
		Goto Ready
	AltFire:
		DTHR B 0 A_PlaySound("weapons/deathray/fire", CHAN_WEAPON, 2.0, 0)
		DTHR B 0 //ACS_NamedExecute("s851",0,30,random(-20,20),0)
		DTHR B 0 A_Gunflash
		DTHR C 0 A_FireCustomMissile("DeathRayBullet", 0, 0, 4, 3)
		DTHR C 0 A_FireCustomMissile("DeathRayBullet", 8, 0, 4, 3)
		DTHR C 3 A_FireCustomMissile("DeathRayBullet", -8, 1, 4, 3)
		DTHR DE 3 //ACS_NamedExecute("s851",0,-15,0,0)
		DTHR F 3
		DTHR B 14
		Goto Ready
	Flash:
		DTHF A 3 Bright A_Light2
		DTHF B 3 Bright A_Light1 
		DTHF C 3 Bright A_Light0
		Stop   
	} 
}

Actor DeathRayBullet
{
	PROJECTILE
	+GHOST
	+WINDTHRUST
	+FORCEXYBILLBOARD
	+NODAMAGETHRUST
	Radius 3
	Height 3
	Speed 18
	Damage 20
	Deathsound "weapons/deathray/hit"
	RENDERSTYLE ADD
	Scale 0.25
	States
	{
	Spawn:
		TNT1 A 0 Bright A_SpawnItem("DeathRayFX3")
		R049 A 1 Bright A_SpawnItem("DeathRayFX1")
		Loop
	Death:
		R049 F 6 Bright A_Scream 
		R049 G 5 Bright	
		R049 H 4 Bright
		R049 I 3 Bright
		R049 J 2 Bright
		TNT1 A 0 A_SpawnItemEx("DeathRayExploGrow",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		R049 J 1 Bright A_SpawnItem("DeathRayFX2")	
		Stop
	}
}

Actor DeathRayMirrorBullet
{
	PROJECTILE
	+GHOST
	+WINDTHRUST
	+FORCEXYBILLBOARD
	+NODAMAGETHRUST
	+CANBOUNCEWATER
	BounceType Hexen
	BounceCount 4
	BounceFactor 1
	WallBounceFactor 1
	BounceSound "weapons/deathray/bounce"
	Radius 3
	Height 3
	Speed 18
	Damage 20
	Deathsound "weapons/deathray/hit"
	RENDERSTYLE ADD
	Scale 0.25
	States
	{
	Spawn:
		TNT1 A 0 Bright A_SpawnItem("DeathRayFX3")
		R049 A 1 Bright A_SpawnItem("DeathRayFX1")
		Loop
	Death:
		R049 F 6 Bright A_Scream 
		R049 G 5 Bright	
		R049 H 4 Bright
		R049 I 3 Bright
		R049 J 2 Bright
		TNT1 A 0 A_SpawnItemEx("DeathRayExploGrow",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		R049 J 1 Bright A_SpawnItem("DeathRayFX2")	
		Stop
	}
}
	
	
Actor DeathRayFX1
{   
	PROJECTILE
	+Randomize
	Radius 2
	Height 2
	Speed 0
	RENDERSTYLE Add
	ALPHA 0.50
	Scale 0.25
	States
	{
	Spawn:
		TNT1 A 0
		R049 B 10 Bright
		R049 C 5 Bright
		R049 D 5 Bright
		R049 E 5 Bright
		Stop
	}
}

Actor DeathRayFX2
{
	PROJECTILE
	+NOGRAVITY
	+RIPPER	RipperLevel 1
	+EXTREMEDEATH
	Radius 3
	Height 3
	Speed 0
	Damage 2
	Seesound "weapons/deathray/explode"
	Deathsound "weapons/deathray/explode"
	RENDERSTYLE None
	Scale 0.75
	States
	{
	Spawn:
		R049 K 2 
		Goto death
	Death:
		R049 M 0 A_Scream 
		TNT1 A 0 A_CustomMissile ("DeathRayFX5",0,0,0,2)
		TNT1 A 0 A_CustomMissile ("DeathRayFX5",0,0,20,2)
		TNT1 A 0 A_CustomMissile ("DeathRayFX5",0,0,40,2)
		TNT1 A 0 A_CustomMissile ("DeathRayFX5",0,0,60,2)
		TNT1 A 0 A_CustomMissile ("DeathRayFX5",0,0,80,2)
		TNT1 A 0 A_CustomMissile ("DeathRayFX5",0,0,100,2)
		TNT1 A 0 A_CustomMissile ("DeathRayFX5",0,0,120,2)
		TNT1 A 0 A_CustomMissile ("DeathRayFX5",0,0,140,2)
		TNT1 A 0 A_CustomMissile ("DeathRayFX5",0,0,160,2)
		TNT1 A 0 A_CustomMissile ("DeathRayFX5",0,0,180,2)
		TNT1 A 0 A_CustomMissile ("DeathRayFX5",0,0,-20,2)
		TNT1 A 0 A_CustomMissile ("DeathRayFX5",0,0,-40,2)
		TNT1 A 0 A_CustomMissile ("DeathRayFX5",0,0,-60,2)
		TNT1 A 0 A_CustomMissile ("DeathRayFX5",0,0,-80,2)
		TNT1 A 0 A_CustomMissile ("DeathRayFX5",0,0,-100,2)
		TNT1 A 0 A_CustomMissile ("DeathRayFX5",0,0,-120,2)
		TNT1 A 0 A_CustomMissile ("DeathRayFX5",0,0,-140,2)
		TNT1 A 0 A_CustomMissile ("DeathRayFX5",0,0,-160,2)
		TNT1 A 0 A_CustomMissile ("DeathRayFX5",0,0,10,2)
		TNT1 A 0 A_CustomMissile ("DeathRayFX5",0,0,30,2)
		TNT1 A 0 A_CustomMissile ("DeathRayFX5",0,0,50,2)
		TNT1 A 0 A_CustomMissile ("DeathRayFX5",0,0,70,2)
		TNT1 A 0 A_CustomMissile ("DeathRayFX5",0,0,90,2)
		TNT1 A 0 A_CustomMissile ("DeathRayFX5",0,0,110,2)
		TNT1 A 0 A_CustomMissile ("DeathRayFX5",0,0,130,2)
		TNT1 A 0 A_CustomMissile ("DeathRayFX5",0,0,150,2)
		TNT1 A 0 A_CustomMissile ("DeathRayFX5",0,0,170,2)
		TNT1 A 0 A_CustomMissile ("DeathRayFX5",0,0,-10,2)
		TNT1 A 0 A_CustomMissile ("DeathRayFX5",0,0,-30,2)
		TNT1 A 0 A_CustomMissile ("DeathRayFX5",0,0,-50,2)
		TNT1 A 0 A_CustomMissile ("DeathRayFX5",0,0,-70,2)
		TNT1 A 0 A_CustomMissile ("DeathRayFX5",0,0,-90,2)
		TNT1 A 0 A_CustomMissile ("DeathRayFX5",0,0,-110,2)
		TNT1 A 0 A_CustomMissile ("DeathRayFX5",0,0,-130,2)
		TNT1 A 0 A_CustomMissile ("DeathRayFX5",0,0,-150,2)
		TNT1 A 0 A_CustomMissile ("DeathRayFX5",0,0,-170,2)	
		R049 M 4 Bright A_Explode(128,180)
		R049 N 4	
		R049 O 4 
		R049 P 4 
		R049 Q 4 A_FadeOut(2)
		Stop
	}
}

Actor DeathRayExploGrow
{
	var int user_count;
	+FORCEXYBILLBOARD
	+NOINTERACTION
	RenderStyle Add
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SetUserVar("user_count",20)
	SizeLoop:
		TNT1 A 0 A_SetScale((user_count*0.01))
		TNT1 A 0 A_JumpIf(user_count>=150,"LoopEnd") 
		R049 K 1 Bright A_FadeOut(0.04)
		TNT1 A 0 A_SetUserVar("user_count",user_count+5)
		Loop	  
	LoopEnd:
		R049 K 2 Bright A_FadeOut(0.1)
		Wait
  }
}

Actor DeathRayFX3
{
	PROJECTILE
	+Randomize
	Radius 2
	Height 2
	Speed 0
	RENDERSTYLE Add
	ALPHA 0.50
	Scale 0.1
	States
	{
	Spawn:
		R049 A 10 A_Fadeout(1.0)
		Stop
	}
}

Actor DeathRayFX5
{   
	PROJECTILE
	+BLOODLESSIMPACT
	+NOGRAVITY
	+RIPPER	RipperLevel 1
	+NODAMAGETHRUST
	Damage (random(0,2))
	Radius 0
	Height 0
	Speed 6
	Scale 0.5
	RENDERSTYLE Add
	ALPHA 0.5
	States
	{
	Spawn:
		R049 R 40 A_FadeOut(20)
		Stop
	}
}

Actor BigSmokeCaller
{
	PROJECTILE
	+NOGRAVITY
	Radius 2
	Height 2
	Speed 0
	RENDERSTYLE Add
	ALPHA 0.50
	Scale 0.90
	States
	{
	Spawn:
		TNT1 A 1
		TNT1 A 0 A_CustomMissile ("SmokeFX",0,0,0)
		TNT1 A 0 A_CustomMissile ("SmokeFX",0,0,20)
		TNT1 A 0 A_CustomMissile ("SmokeFX",0,0,40)
		TNT1 A 0 A_CustomMissile ("SmokeFX",0,0,60)
		TNT1 A 0 A_CustomMissile ("SmokeFX",0,0,80)
		TNT1 A 0 A_CustomMissile ("SmokeFX",0,0,100)
		TNT1 A 0 A_CustomMissile ("SmokeFX",0,0,120)
		TNT1 A 0 A_CustomMissile ("SmokeFX",0,0,140)
		TNT1 A 0 A_CustomMissile ("SmokeFX",0,0,160)
		TNT1 A 0 A_CustomMissile ("SmokeFX",0,0,180)
		TNT1 A 0 A_CustomMissile ("SmokeFX",0,0,-20)
		TNT1 A 0 A_CustomMissile ("SmokeFX",0,0,-40)
		TNT1 A 0 A_CustomMissile ("SmokeFX",0,0,-60)
		TNT1 A 0 A_CustomMissile ("SmokeFX",0,0,-80)
		TNT1 A 0 A_CustomMissile ("SmokeFX",0,0,-100)
		TNT1 A 0 A_CustomMissile ("SmokeFX",0,0,-120)
		TNT1 A 0 A_CustomMissile ("SmokeFX",0,0,-140)
		TNT1 A 0 A_CustomMissile ("SmokeFX",0,0,-160)
		TNT1 A 0 A_CustomMissile ("SmokeFX",0,0,-180)
		TNT1 A 5
		Stop
	}
}
  
Actor SmokeFX
{   
	PROJECTILE
	+FORCEXYBILLBOARD
	+NOGRAVITY
	Radius 2
	Height 2
	Speed 5
	RENDERSTYLE Add
	ALPHA 0.50
	Scale 0.50
	States
	{
	Spawn:
		TNT1 A 1 
		R048 KLMNO 4
		R048 P 4 A_FadeOut(0.10)
		Stop
	}
}

Actor DeathRayDrop : CustomInventory
{
	Inventory.MaxAmount 1
	States
	{
	Use:
		TNT1 A 0
		TNT1 A 0 A_StopSound(6)
		TNT1 A 0 A_SpawnItemEx("DroppedDeathRay",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		Stop
	}
}

Actor DroppedDeathRay
{
	Radius 16
	Height 20
	Scale 0.16
	States
	{
	Spawn:
		DTHR A 15
		TNT1 A 0 A_SpawnItemEx("AEoDDeathRayNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
}

Actor AEoDDeathRayNoAmmo : AEoDDeathRayItem
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	Scale 0.16
	Inventory.Amount 1
	Inventory.PickupMessage "You got the Deathray! It's very atomic!"
	Inventory.PickupSound "reilsss/weappickup/ionecannon"
	States
	{
	Spawn:
		DTHR A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("AECell",25,"Ammo")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("DeathRayDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDDeathRay",1)
		TNT1 A 0 A_TakeInventory("AECell",25)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDDeathRay",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_TakeInventory("AECell",25)
		TNT1 A 0 A_JumpIfInventory("AEoDDeathRay",1,2)
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("DeathRayDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDDeathRay",1)
		Stop
	}
}

//==================================================================================
//==================================================================================

//==================================================================================
//==================================================================================

Actor AEoDFlakCannonItem : CustomInventory 6063
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	Scale 0.5
	Inventory.Amount 1
	Inventory.PickupMessage "You picked up the Flak Cannon!"
	Inventory.PickupSound "reilsss/weappickup/hegrenadelauncher"
	States
	{
	Spawn:
		R030 M -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("AEoDFlakCannonCount",2,"Ammo")
		TNT1 A 0 A_JumpIfInventory("AEoDFlakCannonCount",1,"Pickup2")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("FlakCannonDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDFlakCannon",1)
		TNT1 A 0 A_GiveInventory("AEoDFlakCannonCount",1)
		TNT1 A 0 	
		TNT1 A 0 A_JumpIfInventory("NoWeaponSwitch",1,2)
		TNT1 A 0 A_SelectWeapon("AEoDFlakCannon")
		TNT1 A 0
		Stop
	Pickup2:
		TNT1 A 0 A_GiveInventory("FlakCannonDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDFlakCannon",1)
		TNT1 A 0 A_GiveInventory("AEoDFlakCannonCount",1)
		TNT1 A 0 	
		TNT1 A 0 A_JumpIfInventory("NoWeaponSwitch",1,2)
		TNT1 A 0 A_SelectWeapon("AEoDFlakCannon")
		TNT1 A 0
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDFlakCannonCount",2,"Ammo")
		TNT1 A 0 A_JumpIfInventory("AEoDFlakCannonCount",1,"Pickup2")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDFlakCannon",1)
		Stop
	}
}

Actor AEoDFlakCannon : Weapon // 6063
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	+WEAPON.CHEATNOTWEAPON
	Weapon.AmmoType1 "AEGrenade"
	Weapon.AmmoType2 "AEGrenade"
	Weapon.AmmoGive1 8
	Weapon.AmmoUse1 2
	Weapon.AmmoUse2 2
	Weapon.SelectionOrder 9400
	Obituary "%o ate %k's Flak chunks."
	Inventory.PickupMessage "You picked up the Flak Cannon!"
	Inventory.PickupSound "reilsss/weappickup/hegrenadelauncher"
	Weapon.upsound "weapons/rlan/draw"
	Scale 0.5
	Tag "Flak cannon"
	States
	{
	Spawn:
		R030 M 0
		TNT1 A 0 A_SpawnItemEx("AEoDFlakCannonPickup",0,0,0,0,0,0,0,0)
		Stop

	Ready:
		TNT1 A 0 A_TakeInventory("FlakCannonDropCheck",1)
		TNT1 A 0 A_JumpIfInventory("AEoDFlakCannonCount",2,"Ready2")
		R030 A 1 A_WeaponReady
		Loop
	Ready2:
		TNT1 A 0 A_JumpIfInventory("FlakCannonDropCheck",1,"Ready")
		R302 A 1 A_WeaponReady
		Loop
	Deselect:
		TNT1 A 0 	
		TNT1 A 0 A_JumpIfInventory("AEoDFlakCannonCount",2,"Deselect2")
		R030 A 1 A_Lower
		TNT1 AA 0 A_Lower
		Loop
	Deselect2:
		TNT1 A 0 	
		R302 A 1 A_Lower
		TNT1 AA 0 A_Lower
		Loop
	Select:
		TNT1 A 0 	
		TNT1 A 0 A_JumpIfInventory("AEoDFlakCannonCount",2,"Select2")
		R030 A 1 A_Raise
		TNT1 AA 0 A_Raise
		Loop
	Select2:
		TNT1 A 0 	
		R302 A 1 A_Raise
		TNT1 AA 0 A_Raise
		Loop
	Fire:
		TNT1 A 0 A_JumpIfInventory("AEoDFlakCannonCount",2,"Fire2")
		TNT1 A 0 A_Recoil(1.5)
		R030 B 3 Bright A_PlaySound("reilsss/weapons/flakcannonfire", CHAN_WEAPON, 1.0, 0)
		TNT1 A 0 //ACS_NamedExecute("s851",0,60,random(-20,20),0)
		TNT1 A 0 A_GunFlash
		TNT1 AA 0 A_FireCustomMissile("GunSmokeSpawner",0,0,6.5,6)
		TNT1 A 0 A_FireCustomMissile("FlakChunk1",random(-6,6),0,9+random(-2,2),random(-15,15))
		TNT1 A 0 A_FireCustomMissile("FlakChunk2",random(-6,6),0,9+random(-2,2),random(-15,15))
		TNT1 A 0 A_FireCustomMissile("FlakChunk3",random(-6,6),0,9+random(-2,2),random(-15,15))
		TNT1 A 0 A_FireCustomMissile("FlakChunk2",random(-6,6),0,9+random(-2,2),random(-15,15))
		TNT1 A 0 A_FireCustomMissile("FlakChunk1",random(-6,6),0,9+random(-2,2),random(-15,15))
		TNT1 A 0 A_FireCustomMissile("FlakChunk2",random(-6,6),0,9+random(-2,2),random(-15,15))
		TNT1 A 0 A_FireCustomMissile("FlakChunk3",random(-6,6),0,9+random(-2,2),random(-15,15))
		R030 C 2 Bright A_FireCustomMissile("FlakChunk2",random(-6,6),1,7+random(-2,2),random(-15,15))
		R030 DDE 1 Bright //ACS_NamedExecute("s851",0,-20,0,0)
		R030 EFF 1 Bright
		R030 G 3 Bright
		TNT1 A 0 A_PlaySound("reilsss/weapons/flakcannonreload", 7, 1.0, 0)
		R030 HIJKL 4
		Goto Ready
	Fire2:
		TNT1 A 0 A_Recoil(1.5)
		R302 B 3 Bright A_PlaySound("reilsss/weapons/flakcannonfire", CHAN_WEAPON, 1.0, 0)
		TNT1 A 0 //ACS_NamedExecute("s851",0,60,random(-20,20),0)
		TNT1 A 0 A_GunFlash
		TNT1 AA 0 A_FireCustomMissile("GunSmokeSpawner",0,0,6.5,6)
		TNT1 A 0 A_FireCustomMissile("FlakChunk1",random(-6,6),0,9+random(-2,2),random(-15,15))
		TNT1 A 0 A_FireCustomMissile("FlakChunk2",random(-6,6),0,9+random(-2,2),random(-15,15))
		TNT1 A 0 A_FireCustomMissile("FlakChunk3",random(-6,6),0,9+random(-2,2),random(-15,15))
		TNT1 A 0 A_FireCustomMissile("FlakChunk2",random(-6,6),0,9+random(-2,2),random(-15,15))
		TNT1 A 0 A_FireCustomMissile("FlakChunk1",random(-6,6),0,9+random(-2,2),random(-15,15))
		TNT1 A 0 A_FireCustomMissile("FlakChunk2",random(-6,6),0,9+random(-2,2),random(-15,15))
		TNT1 A 0 A_FireCustomMissile("FlakChunk3",random(-6,6),0,9+random(-2,2),random(-15,15))
		R302 C 2 Bright A_FireCustomMissile("FlakChunk2",random(-6,6),1,9+random(-2,2),random(-15,15))
		R302 DDE 1 Bright //ACS_NamedExecute("s851",0,-20,0,0)
		R302 EFF 1 Bright
		TNT1 A 0 A_PlaySound("reilsss/weapons/flakcannonreload", 7, 1.0, 0)
		R302 G 3 Bright
		TNT1 A 0 A_Recoil(1.5)
		R302 H 3 Bright A_PlaySound("reilsss/weapons/flakcannonfire", CHAN_WEAPON, 1.0, 0)
		TNT1 A 0 //ACS_NamedExecute("s851",0,60,random(-20,20),0)
		TNT1 A 0 A_GunFlash
		TNT1 AA 0 A_FireCustomMissile("GunSmokeSpawner",0,0,6.5,6)
		TNT1 A 0 A_FireCustomMissile("FlakChunk1",random(-6,6),0,-9+random(-2,2),random(-15,15))
		TNT1 A 0 A_FireCustomMissile("FlakChunk2",random(-6,6),0,-9+random(-2,2),random(-15,15))
		TNT1 A 0 A_FireCustomMissile("FlakChunk3",random(-6,6),0,-9+random(-2,2),random(-15,15))
		TNT1 A 0 A_FireCustomMissile("FlakChunk2",random(-6,6),0,-9+random(-2,2),random(-15,15))
		TNT1 A 0 A_FireCustomMissile("FlakChunk1",random(-6,6),0,-9+random(-2,2),random(-15,15))
		TNT1 A 0 A_FireCustomMissile("FlakChunk2",random(-6,6),0,-9+random(-2,2),random(-15,15))
		TNT1 A 0 A_FireCustomMissile("FlakChunk3",random(-6,6),0,-9+random(-2,2),random(-15,15))
		R302 I 2 Bright A_FireCustomMissile("FlakChunk2",random(-6,6),1,-9+random(-2,2),random(-15,15))
		R302 JJK 1 Bright //ACS_NamedExecute("s851",0,-20,0,0)
		R302 KLL 1 Bright
		TNT1 A 0 A_PlaySound("reilsss/weapons/flakcannonreload", 7, 1.0, 0)
		R302 M 3 Bright
		R302 M 0 A_ReFire("Hold2")
		R302 STUVW 4
		Goto Ready
	Hold2:
		TNT1 A 0 A_Recoil(1.5)
		R302 N 3 Bright A_PlaySound("reilsss/weapons/flakcannonfire", CHAN_WEAPON, 1.0, 0)
		TNT1 A 0 //ACS_NamedExecute("s851",0,60,random(-20,20),0)
		TNT1 A 0 A_GunFlash
		TNT1 AA 0 A_FireCustomMissile("GunSmokeSpawner",0,0,6.5,6)
		TNT1 A 0 A_FireCustomMissile("FlakChunk1",random(-6,6),0,9+random(-2,2),random(-15,15))
		TNT1 A 0 A_FireCustomMissile("FlakChunk2",random(-6,6),0,9+random(-2,2),random(-15,15))
		TNT1 A 0 A_FireCustomMissile("FlakChunk3",random(-6,6),0,9+random(-2,2),random(-15,15))
		TNT1 A 0 A_FireCustomMissile("FlakChunk2",random(-6,6),0,9+random(-2,2),random(-15,15))
		TNT1 A 0 A_FireCustomMissile("FlakChunk1",random(-6,6),0,9+random(-2,2),random(-15,15))
		TNT1 A 0 A_FireCustomMissile("FlakChunk2",random(-6,6),0,9+random(-2,2),random(-15,15))
		TNT1 A 0 A_FireCustomMissile("FlakChunk3",random(-6,6),0,9+random(-2,2),random(-15,15))
		R302 O 2 Bright A_FireCustomMissile("FlakChunk2",random(-6,6),1,9+random(-2,2),random(-15,15))
		R302 PPQ 1 Bright //ACS_NamedExecute("s851",0,-20,0,0)
		R302 QRR 1 Bright
		TNT1 A 0 A_PlaySound("reilsss/weapons/flakcannonreload", 7, 1.0, 0)
		R302 G 3 Bright
		TNT1 A 0 A_Recoil(1.5)
		R302 H 3 Bright A_PlaySound("reilsss/weapons/flakcannonfire", CHAN_WEAPON, 1.0, 0)
		TNT1 A 0 //ACS_NamedExecute("s851",0,60,random(-20,20),0)
		TNT1 A 0 A_GunFlash
		TNT1 AA 0 A_FireCustomMissile("GunSmokeSpawner",0,0,6.5,6)
		TNT1 A 0 A_FireCustomMissile("FlakChunk1",random(-6,6),0,-9+random(-2,2),random(-15,15))
		TNT1 A 0 A_FireCustomMissile("FlakChunk2",random(-6,6),0,-9+random(-2,2),random(-15,15))
		TNT1 A 0 A_FireCustomMissile("FlakChunk3",random(-6,6),0,-9+random(-2,2),random(-15,15))
		TNT1 A 0 A_FireCustomMissile("FlakChunk2",random(-6,6),0,-9+random(-2,2),random(-15,15))
		TNT1 A 0 A_FireCustomMissile("FlakChunk1",random(-6,6),0,-9+random(-2,2),random(-15,15))
		TNT1 A 0 A_FireCustomMissile("FlakChunk2",random(-6,6),0,-9+random(-2,2),random(-15,15))
		TNT1 A 0 A_FireCustomMissile("FlakChunk3",random(-6,6),0,-9+random(-2,2),random(-15,15))
		R302 I 2 Bright A_FireCustomMissile("FlakChunk2",random(-6,6),1,-9+random(-2,2),random(-15,15))
		R302 JJK 1 Bright //ACS_NamedExecute("s851",0,-20,0,0)
		R302 KLL 1 Bright
		TNT1 A 0 A_PlaySound("reilsss/weapons/flakcannonreload", 7, 1.0, 0)
		R302 M 3 Bright
		R302 M 0 A_ReFire("Hold2")
		R302 STUVW 4
		Goto Ready
	AltFire:
		TNT1 A 0 A_JumpIfInventory("AEoDFlakCannonCount",2,"AltFire2")
		TNT1 A 0 A_Recoil(2)
		R030 B 3 Bright A_PlaySound("reilsss/weapons/flakcannonaltfire", CHAN_WEAPON, 1.0, 0)
		TNT1 A 0 //ACS_NamedExecute("s851",0,60,random(-20,20),0)
		TNT1 A 0 A_GunFlash
		TNT1 AA 0 A_FireCustomMissile("GunSmokeSpawner",0,0,6.5,6)
		R030 C 3 Bright A_FireCustomMissile("FlakGrenade", 0, 1, 8, 0) 
		R030 DDE 1 Bright //ACS_NamedExecute("s851",0,-20,0,0)
		R030 EFF 1 Bright
		R030 G 3 Bright
		TNT1 A 0 A_PlaySound("reilsss/weapons/flakcannonreload", 7, 1.0, 0)
		R030 HIJKL 4
		Goto Ready
	AltFire2:
		TNT1 A 0 A_Recoil(2)
		R302 B 3 Bright A_PlaySound("reilsss/weapons/flakcannonaltfire", CHAN_WEAPON, 1.0, 0)
		TNT1 A 0 //ACS_NamedExecute("s851",0,60,random(-20,20),0)
		TNT1 A 0 A_GunFlash
		TNT1 AA 0 A_FireCustomMissile("GunSmokeSpawner",0,0,6.5,6)
		R302 C 3 Bright A_FireCustomMissile("FlakGrenade", 0, 1, 8, 0) 
		R302 DDE 1 Bright //ACS_NamedExecute("s851",0,-20,0,0)
		R302 EFF 1 Bright
		TNT1 A 0 A_PlaySound("reilsss/weapons/flakcannonreload", 7, 1.0, 0)
		R302 G 3 Bright
		TNT1 A 0 A_Recoil(2)
		R302 H 3 Bright A_PlaySound("reilsss/weapons/flakcannonaltfire", CHAN_WEAPON, 1.0, 0)
		TNT1 A 0 //ACS_NamedExecute("s851",0,60,random(-20,20),0)
		TNT1 A 0 A_GunFlash
		TNT1 AA 0 A_FireCustomMissile("GunSmokeSpawner",0,0,6.5,6)
		R302 I 3 Bright A_FireCustomMissile("FlakGrenade", 0, 1, -8, 0) 
		R302 JJK 1 Bright //ACS_NamedExecute("s851",0,-20,0,0)
		R302 KLL 1 Bright
		TNT1 A 0 A_PlaySound("reilsss/weapons/flakcannonreload", 7, 1.0, 0)
		R302 M 3 Bright
		R302 M 0 A_ReFire("AltHold2")
		R302 STUVW 4
		Goto Ready
	AltHold2:
		TNT1 A 0 A_Recoil(2)
		R302 N 3 Bright A_PlaySound("reilsss/weapons/flakcannonaltfire", CHAN_WEAPON, 1.0, 0)
		TNT1 A 0 //ACS_NamedExecute("s851",0,60,random(-20,20),0)
		TNT1 A 0 A_GunFlash
		TNT1 AA 0 A_FireCustomMissile("GunSmokeSpawner",0,0,6.5,6)
		R302 O 3 Bright A_FireCustomMissile("FlakGrenade", 0, 1, 8, 0)
		R302 PPQ 1 Bright //ACS_NamedExecute("s851",0,-20,0,0)
		R302 QRR 1 Bright
		TNT1 A 0 A_PlaySound("reilsss/weapons/flakcannonreload", 7, 1.0, 0)
		R302 G 3 Bright
		TNT1 A 0 A_Recoil(2)
		R302 H 3 Bright A_PlaySound("reilsss/weapons/flakcannonaltfire", CHAN_WEAPON, 1.0, 0)
		TNT1 A 0 //ACS_NamedExecute("s851",0,60,random(-20,20),0)
		TNT1 A 0 A_GunFlash
		TNT1 AA 0 A_FireCustomMissile("GunSmokeSpawner",0,0,6.5,6)
		R302 I 3 Bright A_FireCustomMissile("FlakGrenade", 0, 1, -8, 0)
		R302 JJK 1 Bright //ACS_NamedExecute("s851",0,-20,0,0)
		R302 KLL 1 Bright
		TNT1 A 0 A_PlaySound("reilsss/weapons/flakcannonreload", 7, 1.0, 0)
		R302 M 3 Bright
		R302 M 0 A_ReFire("AltHold2")
		R302 STUVW 4
		Goto Ready
	Flash:
		TNT1 A 3 Bright A_Light1
		TNT1 A 4 Bright A_Light0
		Stop
	}
}

Actor FlakChunk1
{
	Projectile
	+DOOMBOUNCE
	-NOGRAVITY
	+CANBOUNCEWATER
	+ROCKETTRAIL
	Gravity 0.13
	BounceFactor 0.4
	WallBounceFactor 0.3
	DamageType "AEBullet"
	Radius 3
	Height 4
	Speed 60
	Damage 15
	SeeSound "reilsss/weapons/flakcannonbounce"
	Renderstyle Translucent
	Alpha 1.0
	Scale 0.3
	States
	{
	Spawn:
		R030 O 2
		Loop
	Death:
		R030 O 20
		R030 RUX 20
		R030 X 100 A_FadeOut(0.1)
		Stop
	}
}

Actor FlakChunk2 : FlakChunk1
{
	States
	{
	Spawn:
		R030 P 2
		Loop
	Death:
		R030 P 20
		R030 SVY 20
		R030 Y 100 A_FadeOut(0.1)
		Stop
	}
}

Actor FlakChunk3 : FlakChunk1
{
	States
	{
	Spawn:
		R030 Q 2
		Loop
	Death:
		R030 Q 20
		R030 TWZ 20
		R030 Z 100 A_FadeOut(0.1)
		Stop
	}
}

Actor FlakGrenChunk1 : FlakChunk1
{
	Gravity 0.5
	Speed 35
	Damage 6
}
Actor FlakGrenChunk2 : FlakChunk2 { }
Actor FlakGrenChunk3 : FlakChunk3 { }

Actor FlakGrenade
{
	PROJECTILE
	-NOGRAVITY
	+GRENADETRAIL
	+FORCERADIUSDMG
	Gravity 0.2
	Radius 8
	Height 8
	Speed 50
	Damage 30
	Scale 0.3
	States
	{
	Spawn:
		TNT1 AA 0 A_Gravity
		TNT1 A 0 ThrustThingZ(0,7,0,1)
		TNT1 A 0 A_SpawnItemEx("QRockTrail",random(-4,4),random(-4,4),random(-4,4),0,0,0,0,SXF_NOCHECKPOSITION)
		R030 N 1 A_SpawnItemEx("BarbasRocket1Trail2",random(-4,4),random(-4,4),random(-4,4),0,0,0,0,SXF_NOCHECKPOSITION)
		Goto Spawn+3
	Death:
		TNT1 A 0 A_PlaySound("reilsss/weapons/flakexplosion")
		TNT1 A 0 A_Explode(random(150,350),128,1)
		TNT1 A 0 A_SpawnItemEx("NewExplosionMedium",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 AAAA 0 A_SpawnItemEx("FlakGrenChunk1",0,0,0,20,0,random(3,12),random(1,359),SXF_NOCHECKPOSITION)
		TNT1 AAAA 0 A_SpawnItemEx("FlakGrenChunk2",0,0,0,20,0,random(3,12),random(1,359),SXF_NOCHECKPOSITION)
		TNT1 AAAA 0 A_SpawnItemEx("FlakGrenChunk3",0,0,0,20,0,random(3,12),random(1,359),SXF_NOCHECKPOSITION)
		TNT1 A 1
		Stop
	}
}

Actor FlakGrenadeExplosion
{
	PROJECTILE
	Renderstyle Translucent
	Alpha 1.0
	Scale 1.2
	States
	{
	Spawn:
		TNT1 A 0 //The first one makes no actions!
		TNT1 A 0 A_PlaySound("reilsss/weapons/flakexplosion")
		TNT1 A 0 A_CustomMissile("ExpQuakeSmall",0,0,0)
		TNT1 A 0 A_NoGravity
		R031 P 6 Bright A_Explode(256,128,1)
		TNT1 A 0 A_CustomMissile("ExploSmokeGeneral",0,0,0)
		R031 Q 6 Bright
		TNT1 AA 0 A_CustomMissile("FlakGrenChunk1", 8, 0, random(0,359))
		TNT1 AA 0 A_CustomMissile("FlakGrenChunk2", 8, 0, random(0,359))
		TNT1 AA 0 A_CustomMissile("FlakGrenChunk3", 8, 0, random(0,359))
		R031 RSTUVWXYZ 6 Bright A_FadeOut(0.2)
		Stop
	}
}

Actor AEoDFlakCannonPickup : CustomInventory //6042
{
	Scale 0.5
	Inventory.PickupMessage "You picked up the Flak Cannon!"
	Inventory.PickupSound "reilsss/weappickup/hegrenadelauncher"
	States
	{
	Spawn:
		R030 M -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDFlakCannonCount",2,4)
		TNT1 A 0 A_GiveInventory("AEoDFlakCannonCount",1)
		TNT1 A 0 A_JumpIfInventory("NoWeaponSwitch",1,2)
		TNT1 A 0 A_SelectWeapon("AEoDFlakCannon")
		TNT1 A 0 A_GiveInventory("AEoDFlakCannon",1)
		TNT1 A 0
		Stop
	}
}

Actor AEoDFlakCannonCount : Inventory
{
	Inventory.MaxAmount 2
	Inventory.Amount 1
}

Actor FlakCannonDropCheck : Inventory
{
	Inventory.Amount 1
	Inventory.MaxAmount 1
}

Actor FlakCannonDrop : CustomInventory
{
	Inventory.Amount 1
	Inventory.MaxAmount 2
	States
	{
	Use:
		TNT1 A 0
		TNT1 A 0 A_SpawnItemEx("DroppedFlakCannon",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		TNT1 A 0 A_TakeInventory("AEoDFlakCannonCount",1)
		Stop
	}
}

Actor DroppedFlakCannon
{
	Radius 16
	Height 20
	Scale 0.5
	States
	{
	Spawn:
		R030 M 15
		TNT1 A 0 A_SpawnItemEx("AEoDFlakCannonNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
}

Actor AEoDFlakCannonNoAmmo : AEoDFlakCannonItem
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	Scale 0.5
	Inventory.Amount 1
	Inventory.PickupMessage "You picked up the Flak Cannon!"
	Inventory.PickupSound "reilsss/weappickup/hegrenadelauncher"
	States
	{
	Spawn:
		R030 M -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("AEGrenade",8,"Ammo")
		TNT1 A 0 A_JumpIfInventory("AEoDFlakCannonCount",2,"Ammo")
		TNT1 A 0 A_JumpIfInventory("AEoDFlakCannonCount",1,"Pickup2")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("FlakCannonDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDFlakCannon",1)
		TNT1 A 0 A_GiveInventory("AEoDFlakCannonCount",1)
		TNT1 A 0 A_TakeInventory("AEGrenade",8)
		TNT1 A 0 	
		TNT1 A 0 A_JumpIfInventory("NoWeaponSwitch",1,2)
		TNT1 A 0 A_SelectWeapon("AEoDFlakCannon")
		TNT1 A 0
		Stop
	Pickup2:
		TNT1 A 0 A_JumpIfInventory("AEGrenade",8,"Ammo")
		TNT1 A 0 A_GiveInventory("FlakCannonDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDFlakCannon",1)
		TNT1 A 0 A_GiveInventory("AEoDFlakCannonCount",1)
		TNT1 A 0 A_TakeInventory("AEGrenade",8)
		TNT1 A 0 	
		TNT1 A 0 A_JumpIfInventory("NoWeaponSwitch",1,2)
		TNT1 A 0 A_SelectWeapon("AEoDFlakCannon")
		TNT1 A 0
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDFlakCannonCount",2,"Ammo")
		TNT1 A 0 A_JumpIfInventory("AEoDFlakCannonCount",1,"Pickup2")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_TakeInventory("AEGrenade",8)
		TNT1 A 0 A_JumpIfInventory("AEoDFlakCannonCount",1,2)
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("AEoDFlakCannonCount",1)
		TNT1 A 0 A_GiveInventory("FlakCannonDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDFlakCannon",1)
		Stop
	}
}

//==================================================================================
//==================================================================================

//==================================================================================
//==================================================================================

Actor AEoDLichStaffItem : CustomInventory 6205
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	+FLOATBOB
	Scale 0.75
	Inventory.Amount 1
	Inventory.PickupMessage "You got Lich Staff!"
	Inventory.PickupSound "weaponbuild"
	States
	{
	Spawn:
		LTSP A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDLichStaff",1,"Ammo")
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("LichStaffDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDLichStaff",1)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDLichStaff",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDLichStaff",1)
		Stop
	}
}

Actor AEoDLichStaff : Weapon // 6205
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	+WEAPON.CHEATNOTWEAPON
	+FLOATBOB
	Weapon.Ammotype1 "RedMana"
	Weapon.Ammotype2 "RedMana"
	Weapon.AmmoGive1 10
	Weapon.AmmoUse1 5
	Weapon.AmmoUse2 14
	Weapon.SelectionOrder 14300
	Obituary "%o was zapped by %k's Lich Staff."
	Inventory.PickupMessage "You got Lich Staff!"
	Inventory.PickupSound "weaponbuild"
	weapon.upsound "weapons/draw"
	Scale 0.75
	Tag "Lich staff"
	States
	{
	Spawn:
		LTSP A 5
		Loop
	Ready: 
		LTSF A 1 A_WeaponReady
		Goto Ready
	Deselect: 
		TNT1 A 0 	
		LTSF A 1 A_Lower
		TNT1 AA 0 A_Lower
		Loop
	Select: 
		TNT1 A 0 	
		LTSF A 1 A_Raise
		TNT1 AA 0 A_Raise
		Loop
	Fire: 
		LTSF A 2
		TNT1 A 0 A_GunFlash
		TNT1 A 0 A_PlaySound("reilsss/weapons/lichstafffire", CHAN_WEAPON, 1.0, 0)
		TNT1 A 0 A_SetBlend("Blue",0.25,25)
		TNT1 A 0 A_Recoil(2)
		LTSF B 0 A_FireCustomMissile("LichBlueBall", 0, 1, 0, 2)
		LISF B 0 A_SetPitch(pitch+3)
		LTSF BBC 1 A_SetPitch(pitch-1)
		LTSF CD 4 
		LTSF E 6 
		Goto Ready
	AltFire: 
		LTSF A 2
		LTSF K 2 A_GunFlash
		TNT1 A 0 A_PlaySound("reilsss/weapons/lichstaffaltfire", CHAN_WEAPON, 1.0, 0)
		TNT1 A 0 //ACS_NamedExecute("s851",0,120,random(-20,20),0)
		TNT1 A 0 A_SetBlend("White",0.25,50)
		TNT1 A 0 A_Recoil(2)
		LTSF L 2 A_FireCustomMissile("LichWhiteBall", 0, 1, 0, 8)
		LTSF MMNN 1 //ACS_NamedExecute("s851",0,-30,0,0)
		LTSF FG 4
		LTSF H 5 
		LTSF IJ 6
		Goto Ready
	Flash:
		TNT1 A 3 A_Light1
		TNT1 A 2 A_Light2
		TNT1 A 1 A_Light0
		Stop
	} 
}

Actor LichBlueBall : Sorcerer2FX1
{
	DamageType "Ice"
	Damage 35
	Scale 0.4
	DontHurtShooter
	States
	{
	Spawn:
		TNT1 A 0 
		TNT1 A 0 A_SpawnItemEx("CrystalSmoke2",0,0,0,0,0,1*2,0,0)
		TNT1 A 0 A_SpawnItemEx("CrystalSmoke2",0,0,0,0,0,-1*2,0,0)
		TNT1 A 0 A_SpawnItemEx("CrystalSmoke2b",0,0,0,0,0,1*2,0,0)
		TNT1 A 0 A_SpawnItemEx("CrystalSmoke2b",0,0,0,0,0,-1*2,0,0)
		RX12 A 2 Bright

		TNT1 A 0 A_SpawnItemEx("CrystalSmoke2",0,0,0,0,-0.4*2,0.8*2,0,0)
		TNT1 A 0 A_SpawnItemEx("CrystalSmoke2",0,0,0,0,0.4*2,-0.8*2,0,0)
		TNT1 A 0 A_SpawnItemEx("CrystalSmoke2b",0,0,0,0,-0.4*2,0.8*2,0,0)
		TNT1 A 0 A_SpawnItemEx("CrystalSmoke2b",0,0,0,0,0.4*2,-0.8*2,0,0)
		RX12 B 2 Bright 

		TNT1 A 0 A_SpawnItemEx("CrystalSmoke2",0,0,0,0,-0.8*2,0.4*2,0,0)
		TNT1 A 0 A_SpawnItemEx("CrystalSmoke2",0,0,0,0,0.8*2,-0.4*2,0,0)
		TNT1 A 0 A_SpawnItemEx("CrystalSmoke2b",0,0,0,0,-0.8*2,0.4*2,0,0)
		TNT1 A 0 A_SpawnItemEx("CrystalSmoke2b",0,0,0,0,0.8*2,-0.4*2,0,0)
		RX12 C 2 Bright 

		TNT1 A 0 A_SpawnItemEx("CrystalSmoke2",0,0,0,0,-1*2,0,0,0)
		TNT1 A 0 A_SpawnItemEx("CrystalSmoke2",0,0,0,0,1*2,0,0,0)
		TNT1 A 0 A_SpawnItemEx("CrystalSmoke2b",0,0,0,0,-1*2,0,0,0)
		TNT1 A 0 A_SpawnItemEx("CrystalSmoke2b",0,0,0,0,1*2,0,0,0)
		RX12 D 2 Bright 

		TNT1 A 0 A_SpawnItemEx("CrystalSmoke2",0,0,0,0,-0.8*2,-0.4*2,0,0)
		TNT1 A 0 A_SpawnItemEx("CrystalSmoke2",0,0,0,0,0.8*2,0.4*2,0,0)
		TNT1 A 0 A_SpawnItemEx("CrystalSmoke2b",0,0,0,0,-0.8*2,-0.4*2,0,0)
		TNT1 A 0 A_SpawnItemEx("CrystalSmoke2b",0,0,0,0,0.8*2,0.4*2,0,0)
		RX12 E 2 Bright 

		TNT1 A 0 A_SpawnItemEx("CrystalSmoke2",0,0,0,0,-0.4*2,-0.8*2,0,0)
		TNT1 A 0 A_SpawnItemEx("CrystalSmoke2",0,0,0,0,0.4*2,0.8*2,0,0)
		TNT1 A 0 A_SpawnItemEx("CrystalSmoke2b",0,0,0,0,-0.4*2,-0.8*2,0,0)
		TNT1 A 0 A_SpawnItemEx("CrystalSmoke2b",0,0,0,0,0.4*2,0.8*2,0,0)
		RX12 F 2 Bright
		Goto Spawn+1
	Death:
		TNT1 AAAAAAAAAAAAA 0 A_SpawnItemEx("CrystalSmoke22",0,0,0,random(3,-3)/(2*1.05),random(3,-3)/(2*1.05),random(3,-3)/(2*1.05),random(1,359),SXF_NOCHECKPOSITION)
		TNT1 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 0 A_SpawnItemEx("LichExtra",0,0,2,random(3,8),random(3,8),random(2,5),random(1,359),SXF_NOCHECKPOSITION)
		RX12 H 3 Bright A_Explode(256,128,0)
		RX12 IJKL 3 Bright
		Stop
	}
}

Actor CrystalSmoke2
{
	+NOINTERACTION
	RenderStyle Add
	Scale 0.4
	Translation "0:255=%[0,0,0]:[0,0,2]"
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_Jump(220,2,3,4,5,6,7,8,9,10)
		X105 ABCDEFGHIJKLMNOPQRSTUVWX 1 Bright A_FadeOut(0.05)
		Goto Spawn+2
	}
}

Actor CrystalSmoke22 : CrystalSmoke2 {Scale 0.6}

Actor CrystalSmoke2b
{
	+NOINTERACTION
	RenderStyle Add
	Alpha 0.6
	Scale 0.23
	States
	{
	Spawn:
		TNT1 A 0
		PLSS CDEFGHIJKLMNOPQRSTUVWXYZ 1
		PLSZ ABC 1 A_FadeOut(0.08)
		Wait
	}
}

Actor LichExtra : IceGuyFX2
{
	DamageType "Ice"
	Damage 6
	RenderStyle Add
}

Actor LichWhiteBall
{
	PROJECTILE
	BounceType "Doom"
	+CANBOUNCEWATER
	-NOGRAVITY
	+EXTREMEDEATH
	DamageType "Ice"
	Radius 8
	Height 8
	Speed 18
	Scale 0.7
	Gravity 0.5
	Damage 50
	BounceFactor 0.6
	Translation "0:255=%[0,0,0]:[0.7,0.7,1.2]"
	SeeSound "SorcererBallBounce"
	DeathSound "SorcererBigBallExplode"
	States
	{
	Spawn:
		TNT1 A 0 A_StopSound
		RX11 A 0
		RX11 B 0 ThrustThingZ(0,7,0,1)
		RX11 A 1 Bright A_SpawnItemEx("LichWhiteBallTrail",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION)
		TNT1 AA 0 A_SpawnItemEx("LichWhiteBallExploSpriteSmall",0,0,0,0,frandom(0.9,-0.9),0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION)
		RX11 A 1 Bright A_SpawnItemEx("LichWhiteBallTrail",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION)
		TNT1 AA 0 A_SpawnItemEx("LichWhiteBallExploSpriteSmall",0,0,0,0,frandom(0.9,-0.9),0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION)
		RX11 B 1 Bright A_SpawnItemEx("LichWhiteBallTrail",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION)
		TNT1 AA 0 A_SpawnItemEx("LichWhiteBallExploSpriteSmall",0,0,0,0,frandom(0.9,-0.9),0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION)
		RX11 B 1 Bright A_SpawnItemEx("LichWhiteBallTrail",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION)
		TNT1 AA 0 A_SpawnItemEx("LichWhiteBallExploSpriteSmall",0,0,0,0,frandom(0.9,-0.9),0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION)
		Goto Spawn+3
	Death:
		TNT1 AAAAAAAAAAAAAAAAAA 0 A_SpawnItemEx("LichWhiteBallExploSprite",0,0,0,frandom(1,3),0,frandom(3,-3),random(0,359),SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION)
		TNT1 AAAAAAAAAAAAAAAAAA 0 A_SpawnItemEx("LichWhiteBallExploSprite",0,0,0,frandom(1,3),0,frandom(3,-3),random(0,359),SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION)
		TNT1 AAAAAAAAAAAAAAAAAA 0 A_SpawnItemEx("LichWhiteBallExploSprite",0,0,0,frandom(1,3),0,frandom(3,-3),random(0,359),SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION)
		TNT1 A 0 A_Explode(350,256,0)
		TNT1 A 0 A_CustomMissile("LichWhiteBallExplo",10,0,0)
		TNT1 A 0 A_CustomMissile("LichWhiteBallExplo",10,0,15)
		TNT1 A 0 A_CustomMissile("LichWhiteBallExplo",10,0,30)
		TNT1 A 0 A_CustomMissile("LichWhiteBallExplo",10,0,45)
		TNT1 A 0 A_CustomMissile("LichWhiteBallExplo",10,0,60)
		TNT1 A 0 A_CustomMissile("LichWhiteBallExplo",10,0,75)
		TNT1 A 0 A_CustomMissile("LichWhiteBallExplo",10,0,90)
		TNT1 A 0 A_CustomMissile("LichWhiteBallExplo",10,0,105)
		TNT1 A 0 A_CustomMissile("LichWhiteBallExplo",10,0,120)
		TNT1 A 0 A_CustomMissile("LichWhiteBallExplo",10,0,135)
		TNT1 A 0 A_CustomMissile("LichWhiteBallExplo",10,0,150)
		TNT1 A 0 A_CustomMissile("LichWhiteBallExplo",10,0,165)
		TNT1 A 0 A_CustomMissile("LichWhiteBallExplo",10,0,180)
		TNT1 A 0 A_CustomMissile("LichWhiteBallExplo",10,0,-15)
		TNT1 A 0 A_CustomMissile("LichWhiteBallExplo",10,0,-30)
		TNT1 A 0 A_CustomMissile("LichWhiteBallExplo",10,0,-45)
		TNT1 A 0 A_CustomMissile("LichWhiteBallExplo",10,0,-60)
		TNT1 A 0 A_CustomMissile("LichWhiteBallExplo",10,0,-75)
		TNT1 A 0 A_CustomMissile("LichWhiteBallExplo",10,0,-90)
		TNT1 A 0 A_CustomMissile("LichWhiteBallExplo",10,0,-105)
		TNT1 A 0 A_CustomMissile("LichWhiteBallExplo",10,0,-120)
		TNT1 A 0 A_CustomMissile("LichWhiteBallExplo",10,0,-135)
		TNT1 A 0 A_CustomMissile("LichWhiteBallExplo",10,0,-150)
		TNT1 A 1 A_CustomMissile("LichWhiteBallExplo",10,0,-165)
		Stop
	}
}

Actor LichWhiteBallExploSprite
{
	+NOINTERACTION
	RenderStyle Add
	Scale 0.6
	Alpha 0.0
	States
	{
	Spawn:
		X110 A 0
		X110 ABCD 2 A_Fadeto(0.8,0.08)
		TNT1 A 0 A_ScaleVelocity(0.8)
		X110 EFGHI 2 A_Fadeto(0.8,0.08)
		TNT1 A 0 A_ScaleVelocity(0.8)
		X110 JKLMNOP 2 A_Fadeto(0.8,0.08)
		TNT1 A 0 A_ScaleVelocity(0.67)
		X110 QRSTUVWXY 2 
		TNT1 A 0 A_ScaleVelocity(0.67)
		X110 ABCDEFGHIJK 2
		TNT1 A 0 A_ScaleVelocity(0.67)
		X110 LMNOPQRSTUVWXY 2
	Outer:
		X110 ABCDEFGHIJKLMNOPQRSTUVWXY 2 A_FadeOut(0.03)
		Loop
	}
}

Actor LichWhiteBallExploSpriteSmall : LichWhiteBallExploSprite
{
	Scale 0.3
	States
	{
	Spawn:
		X110 A 0
		X110 ABCD 2 A_Fadeto(0.8,0.08)
		TNT1 A 0 A_ScaleVelocity(0.8)
		X110 EFGHI 2 A_Fadeto(0.8,0.08)
		TNT1 A 0 A_ScaleVelocity(0.8)
		X110 JKLMNOP 2 A_Fadeto(0.8,0.08)
		TNT1 A 0 A_ScaleVelocity(0.67)
		X110 QRSTUVWXY 2 A_FadeOut(0.03)
		TNT1 A 0 A_ScaleVelocity(0.67)
		X110 ABCDEFGHIJK 2 A_FadeOut(0.03)
		TNT1 A 0 A_ScaleVelocity(0.67)
		X110 LMNOPQRSTUVWXY 2 A_FadeOut(0.03)
	Outer:
		X110 ABCDEFGHIJKLMNOPQRSTUVWXY 2 A_FadeOut(0.04)
		Loop
	}
}

Actor LichWhiteBallTrail
{
	+NOINTERACTION
	RenderStyle Add
	Alpha 0.3
	Scale 1.3
	States
	{
	Spawn:
		RX11 AAABBB 1 Bright A_FadeOut(0.02)
		Loop
	}
}

Actor LichWhiteBallExplo
{
	PROJECTILE
	//+NOCLIP
	+RIPPER	RipperLevel 1
	+DONTSPLASH
	DamageType "Ice"
	Mass 1
	Speed 9
	Damage (5*random(1,3))
	Radius 2
	Height 2
	RenderStyle None
	Alpha 0.6
	Scale 1.2
	States
	{
	Spawn:
		X033 ABCD 2 Bright A_FadeOut(0.02)
		TNT1 A 0 A_ScaleVelocity(0.9)
		X033 EFGH 2 Bright A_FadeOut(0.02)
		TNT1 A 0 A_ScaleVelocity(0.75)
		X033 IJKL 2 Bright A_FadeOut(0.02)
		TNT1 A 0 A_ScaleVelocity(0.6)
		X033 MNOP 2 Bright A_FadeOut(0.02)
		TNT1 A 0 A_ScaleVelocity(0.6)
		X033 QR 2 Bright A_FadeOut(0.05)
		Wait
	Death:
		TNT1 A 1
		Stop 
	}
}

Actor LichStaffDrop : CustomInventory
{
	Inventory.MaxAmount 1
	States
	{
	Use:
		TNT1 A 0
		TNT1 A 0 A_SpawnItemEx("DroppedLichStaff",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		Stop
	}
}

Actor DroppedLichStaff
{
	Radius 16
	Height 20
	Scale 0.75
	States
	{
	Spawn:
		LTSP A 15
		TNT1 A 0 A_SpawnItemEx("AEoDLichStaffNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
}

Actor AEoDLichStaffNoAmmo : AEoDLichStaffItem
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	Scale 0.75
	Inventory.Amount 1
	Inventory.PickupMessage "You got Lich Staff!"
	Inventory.PickupSound "weaponbuild"
	States
	{
	Spawn:
		LTSP A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("RedMana",10,"Ammo")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("LichStaffDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDLichStaff",1)
		TNT1 A 0 A_TakeInventory("RedMana",10)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDLichStaff",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_TakeInventory("RedMana",10)
		TNT1 A 0 A_JumpIfInventory("AEoDLichStaff",1,2)
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("LichStaffDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDLichStaff",1)
		Stop
	}
}

//==================================================================================
//==================================================================================

//==================================================================================
//==================================================================================
Actor AEoDMorserLauncherItem : CustomInventory 6054
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	Scale 0.375
	Inventory.Amount 1
	Inventory.PickupMessage "You picked up the Mortar Launcher!"
	Inventory.PickupSound "reilsss/weappickup/heavyrocketlauncher"
	States
	{
	Spawn:
		R032 Q -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDMorserLauncher",1,"Ammo")
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("MorserLauncherDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDMorserLauncher",1)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDMorserLauncher",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDMorserLauncher",1)
		Stop
	}
}

Actor AEoDMorserLauncher : Weapon // 6054
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	+WEAPON.CHEATNOTWEAPON
	Weapon.AmmoType1 "AERocket"
	Weapon.AmmoType2 "AERocket"
	Weapon.AmmoGive1 10
	Weapon.AmmoUse1 2
	Weapon.AmmoUse2 4
	Weapon.SelectionOrder 14400
	Obituary "%o was cluster-bombed from %k's Mortar."
	Inventory.PickupMessage "You picked up the Mortar Launcher!"
	Inventory.PickupSound "reilsss/weappickup/heavyrocketlauncher"
	Weapon.upsound "weapons/rlan/draw"
	Scale 0.375
	Tag "Mortar launcher"
	States
	{
	Spawn:
		R032 Q -1
		Stop
	Ready:
		R032 A 1 A_WeaponReady
		Loop
	Deselect:
		TNT1 A 0 	
		R032 A 1 A_Lower
		TNT1 AA 0 A_Lower
		Goto Deselect
	Select:
		TNT1 A 0 	
		R032 A 1 A_Raise
		TNT1 AA 0 A_Raise
		Goto Select
	Fire:
		TNT1 A 0 A_Recoil(2)
		R032 B 3 Bright A_PlaySound("reilsss/weapons/morserlauncherfire", CHAN_WEAPON, 1.0, 0)
		TNT1 A 0 //ACS_NamedExecute("s851",0,120,random(-20,20),0)
		TNT1 A 0 A_GunFlash
		TNT1 AA 0 A_FireCustomMissile("GunSmokeSpawner",0,0,6.5,6)
		R032 C 3 Bright A_FireCustomMissile("MorserRocket", 0, 1, 8, 2) 
		R032 DDD 1 Bright //ACS_NamedExecute("s851",0,-40,0,0)
		R032 E 3 Bright 
		R032 FG 3 Bright
		TNT1 A 0 A_PlaySound("reilsss/weapons/morserlauncherturn", 7, 1.0, 0)
		R032 HIJKL 3
		TNT1 A 0 A_PlaySound("reilsss/weapons/morserlauncherload", 8, 1.0, 0)
		R032 MNOP 3
		Goto Ready
	AltFire:
		TNT1 A 0 A_Recoil(2)
		R032 B 3 Bright A_PlaySound("reilsss/weapons/morserlauncheraltfire", CHAN_WEAPON, 1.0, 0)
		TNT1 A 0 //ACS_NamedExecute("s851",0,120,random(-20,20),0)
		TNT1 A 0 A_GunFlash
		TNT1 AA 0 A_FireCustomMissile("GunSmokeSpawner",0,0,6.5,6)
		TNT1 A 0 Bright A_FireCustomMissile ("MorserHomingRocket",-8,0,8,1)
		R032 C 3 Bright A_FireCustomMissile ("MorserHomingRocket",8,1,8,1)
		R032 DDD 1 Bright //ACS_NamedExecute("s851",0,-40,0,0)
		R032 E 3 Bright 
		R032 FG 3 Bright
		TNT1 A 0 A_PlaySound("reilsss/weapons/morserlauncherturn", 7, 1.0, 0)
		R032 HIJKL 3
		TNT1 A 0 A_PlaySound("reilsss/weapons/morserlauncherload", 8, 1.0, 0)
		R032 MNOP 3
		Goto Ready
	Flash:
		TNT1 A 3 Bright A_Light1 
		TNT1 A 4 Bright A_Light0
		Stop
	}
}

Actor MorserRocket
{
	Projectile
	+EXTREMEDEATH
	+ROCKETTRAIL
	+FORCERADIUSDMG
	Radius 6
	Height 8
	Speed 25
	Damage 35
	SeeSound "reilsss/weapons/rocketfly"
	DeathSound "reilsss/weapons/morserexplosion"
	Scale 0.74
	States
	{
	Spawn:
		R032 TT 1 A_SpawnItemEx("QuakeGrenSmokeTrail",random(-1,-5),random(2,-2),random(2,-2),0,0,frandom(0.6,1.2),0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("Q2RocketExtra",0,0,0,1,0,random(-1,1),random(1,360))
		R032 UU 1 A_SpawnItemEx("QuakeGrenSmokeTrail",random(-1,-5),random(2,-2),random(2,-2),0,0,frandom(0.6,1.2),0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("Q2RocketExtra",0,0,0,1,0,random(-1,1),random(1,360))
		Loop
	Death:
		TNT1 A 0 A_SpawnItemEx("NewExplosionMediumBig",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 0 Bright A_Explode(190,128,1)
		TNT1 AAAAAAAAA 0 A_SpawnItemEx("MorserSwarm",0,0,0,random(-3,3),random(-3,3),random(5,8),random(0,359),SXF_NOCHECKPOSITION)
		TNT1 A 0 A_CustomMissile("ExpQuakeSmall",0,0,0)
		TNT1 A 10
		Stop
	}
}

Actor MorserHomingRocket : MorserRocket
{
	+SEEKERMISSILE
	Damage 45
	States
	{
	Spawn:
		R032 T 0 
		R032 T 0 Bright A_SpawnItemEx("QuakeGrenSmokeTrail",random(-1,-5),random(2,-2),random(2,-2),0,0,frandom(0.6,1.2),0,SXF_NOCHECKPOSITION)
		R032 T 0 Bright A_SpawnItemEx("Q2RocketExtra",0,0,0,1,0,random(-1,1),random(1,360))
		R032 T 1 Bright A_SeekerMissile(10,20,SMF_LOOK)
		R032 T 0 Bright A_SpawnItemEx("QuakeGrenSmokeTrail",random(-1,-5),random(2,-2),random(2,-2),0,0,frandom(0.6,1.2),0,SXF_NOCHECKPOSITION)
		R032 T 0 Bright A_SpawnItemEx("Q2RocketExtra",0,0,0,1,0,random(-1,1),random(1,360))
		R032 T 1 Bright 
		Loop
	Death:
		R031 I 0 Bright A_Explode(160+(random(30,160)),120,1)
		TNT1 A 10 A_SpawnItemEx("NewExplosionMediumConcentrated",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		Stop
	}
}


Actor MorserSwarm
{
	PROJECTILE
	+GRENADETRAIL
	-NOGRAVITY
	+EXTREMEDEATH
	Radius 4
	Height 3
	Speed 6
	Gravity 0.8
	Damage 6
	SeeSound "reilsss/weapons/grenadelauncherbounce"
	Scale 0.25
	+BOUNCEONCEILINGS
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_StopSound
		R014 C 3 Bright 
		Goto Spawn+2
	Death:
		TNT1 A 0 A_QuakeEx(3,3,0, 15,0,5,"", QF_SCALEDOWN)
		TNT1 A 0 A_PlaySound("reilsss/weapons/genericexplosion", CHAN_AUTO, 0.5, 0)
		TNT1 A 0 A_SpawnItemEx("NewExplosionSmallLittleBigger",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 3 A_Explode(96,64,1)
		Stop
	}
}

Actor MorserLauncherDrop : CustomInventory
{
	Inventory.MaxAmount 1
	States
	{
	Use:
		TNT1 A 0
		TNT1 A 0 A_SpawnItemEx("DroppedMorserLauncher",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		Stop
	}
}

Actor DroppedMorserLauncher
{
	Radius 16
	Height 20
	Scale 0.375
	States
	{
	Spawn:
		R032 Q 15
		TNT1 A 0 A_SpawnItemEx("AEoDMorserLauncherNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
}

Actor AEoDMorserLauncherNoAmmo : AEoDMorserLauncherItem
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	Scale 0.375
	Inventory.Amount 1
	Inventory.PickupMessage "You picked up the Mortar Launcher!"
	Inventory.PickupSound "reilsss/weappickup/heavyrocketlauncher"
	States
	{
	Spawn:
		R032 Q -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("AERocket",10,"Ammo")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("MorserLauncherDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDMorserLauncher",1)
		TNT1 A 0 A_TakeInventory("AERocket",10)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDMorserLauncher",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_TakeInventory("AERocket",10)
		TNT1 A 0 A_JumpIfInventory("AEoDMorserLauncher",1,2)
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("MorserLauncherDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDMorserLauncher",1)
		Stop
	}
}

//==================================================================================
//==================================================================================

//==================================================================================
//==================================================================================

Actor AEoDPulseCannonItem : CustomInventory 6085
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	Scale 1.1
	Inventory.Amount 1
	Inventory.PickupMessage "You got the Pulse Cannon!"
	Inventory.PickupSound "reilsss/weappickup/heavyrocketlauncher"
	States
	{
	Spawn:
		RR04 A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDPulseCannon",1,"Ammo")
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("PulseCannonDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDPulseCannon",1)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDPulseCannon",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDPulseCannon",1)
		Stop
	}
}

Actor AEoDPulseCannon : Weapon // 6085
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	+WEAPON.CHEATNOTWEAPON
	Radius 20
	Height 16
	Weapon.ammotype1 "PlasmaRod"
	Weapon.ammotype2 "AEGrenade"
	Weapon.ammogive1 50
	Weapon.ammogive2 4
	Weapon.ammouse1 10
	Weapon.ammouse2 1
	Weapon.SelectionOrder 11880
	Obituary "%o was blasted by %k's Pulse Cannon."
	Inventory.PickupMessage "You got the Pulse Cannon!"
	Inventory.PickupSound "reilsss/weappickup/heavyrocketlauncher"
	weapon.upsound "weapons/rlan/draw"
	Scale 1.1
	Tag "Pulse cannon"
	States
	{
	Spawn:
		RR04 A -1
		Stop
	Ready:
		TNT1 A 0 A_PlaySound("reilsss/weapons/alienweaponidle1", 6, 1.0, 1)
		RRAC A 20 A_WeaponReady
		Goto Ready+1
	Deselect:
		TNT1 A 0 A_StopSound(6)
		TNT1 A 0 	
		RRAC A 1 A_Lower
		RRAC AA 0 A_Lower
		Goto Deselect+1
	Select:
		TNT1 A 0 	
		RRAC A 1 A_Raise
		RRAC AA 0 A_Raise
		Goto Select
	Fire:
		TNT1 A 0 A_StopSound(CHAN_BODY)
		RRAC B 3
		TNT1 A 0 A_PlaySound("reilsss/weapons/fulerodgunfire", CHAN_WEAPON, 1.0, 0)
		RRAC C 1 Bright A_FireCustomMissile("PulseCannonPlasmashot2",0,1,8,7)
		RRAC CDD 1 Bright A_FireCustomMissile("PulseCannonPlasmashot",0,0,8,7)
		RRAC D 1 //ACS_NamedExecute("s851",0,50,random(-8,8),0)
		RRAC D 1 //ACS_NamedExecute("s851",0,-50,random(-8,8),0)
		RRAC EE 1 ////ACS_NamedExecute("s851",0,-10,0,0)
		RRAC FF 1 ////ACS_NamedExecute("s851",0,10,0,0)
		RRAC G 2
		RRAC H 4
		RRAC A 0 A_ReFire
		Goto Ready
	AltFire:
		TNT1 A 0 A_StopSound(CHAN_BODY)
		RRAC B 3
		TNT1 A 0 //ACS_NamedExecute("s851",0,50,random(-8,8),0)
		TNT1 A 0 A_PlaySound("reilsss/weapons/pulsecannonfire", CHAN_WEAPON, 1.0, 0)
		RRAC CC 1 Bright A_FireCustomMissile("AlienHulklandminePlayer",0,1,8,7)
		RRAC DD 1 Bright
		TNT1 A 0 //ACS_NamedExecute("s851",0,-50,random(-8,8),0)
		RRAC EE 1 //ACS_NamedExecute("s851",0,-10,0,0)
		RRAC FF 1 //ACS_NamedExecute("s851",0,10,0,0)
		RRAC G 2
		RRAC H 6
		RRAC A 0 A_ReFire
		Goto Ready
	}
}

//----------------------------------------------------------------
Actor PulseCannonPlasmashot
{
	Scale 0.25
	Radius 3
	Height 6
	speed 22
	damage 20 
	DeathSound "monster/alienhulk/laserimpact"
	DamageType "Plasma"
	Translation "0:255=%[0,0,0]:[1,1,1]"
	+MISSILE
	PROJECTILE
	states
	{
	Spawn:
		RR00 AABBCCDDEEFF 1 Bright A_SpawnItemEx("PulseCannonPlasmashotTrail",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION)
		Loop
	Death:
		TNT1 A 0 A_Explode(64,128,0)
		TNT1 A 1 A_SpawnItemEx("PCPrimaryExplo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION)
		Stop
	}
}

Actor PulseCannonPlasmashotTrail
{
	+NOINTERACTION
	Scale 0.15
	RenderStyle Add
	States
	{
	Spawn:
		RR00 ABCDEF 2 Bright A_FadeOut(0.1)
		Loop
	}
}

Actor PulseCannonPlasmashot2 : PulseCannonPlasmashot
{
	damage 15
	seesound "monster/leonard/alienarmgun"
}

Actor PCPrimaryExplo
{
	+NOINTERACTION
	RenderStyle Add
	Scale 1.3
	States
	{
	Spawn:
		TNT1 A 0 
		TNT1 AAAAAAAAAAAAAAAA 0 A_SpawnItemEx("PCPrimaryExploParticles",0,0,0,frandom(2,5.0),0,frandom(5,-5),random(0,359),SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION)
		X019 A 2 Light("WhiteSmallFlicker2") Bright
		X019 B 2 Light("WhiteSmallFlicker1") Bright
		X019 C 2 Light("WhiteMediumFlicker3") Bright
		X019 DFG 2 Light("WhiteMediumFlicker2") Bright
		X019 HIJ 2 Light("WhiteMediumFlicker3") Bright
		X019 KLM 2 Light("WhiteSmallFlicker1") Bright
		X019 NO 2 Light("WhiteSmallFlicker2") Bright
		X019 PQ 2 Light("WhiteSmallFlicker3") Bright
		X019 R 2 Bright
		Stop
	}
}
Actor PCPrimaryExploParticles
{
	Scale 0.35
	RenderStyle Add
	+NOINTERACTION
	States
	{
	Spawn:
		RFX1 B 3 Bright A_FadeOut(0.06)
		RFX1 B 0 A_ScaleVelocity(0.7)
		Loop
	Death:
		TNT1 A 1
		Stop
	}
}

//-----------------------------------------------------------------------

Actor AlienHulklandminePlayer
{
	Scale 0.5
	Radius 4
	Height 4
	damage 10
	speed 39
	+MISSILE
	seesound "monster/leonard/dynamitebounce"
	+EXTREMEDEATH
	states
	{
	Spawn:
		RR10 ABCD 3 Light("WhiteSmallPoint2") Bright
		Loop
	XDeath:
	Crash:
		TNT1 A 0 A_Explode(192,128,1)
		TNT1 A 0 A_PlaySound("monster/leonard/dynamiteexplode")
		TNT1 A 1 A_SpawnItemEx("PulseCannonLandMineExplosion",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		Stop
	Death:
		RR10 A 0 A_SpawnItem("AlienHulklandmine2Player")
		Stop
	}
}

Actor AlienHulklandminePlayer2 : AlienHulklandmineplayer { speed 57 }

Actor AlienHulklandmine2Player
{
	Scale 0.5
	Health 1
	Radius 4
	Height 4
	Speed 0
	DeathSound "monster/leonard/dynamiteexplode"
	+FRIENDLY
	+SHOOTABLE
	+LOOKALLAROUND
	+NOICEDEATH
	+NOBLOOD
	+DONTMORPH
	MONSTER
	-COUNTKILL
	+EXTREMEDEATH
	states
	{
	Spawn:
		RR10 ABCD 3 Light("WhiteSmallPoint2") Bright A_LookEx(2,0,80,0,360,"See")
		Loop
	See:
		TNT1 A 0 A_Scream
		TNT1 A 0 A_NoBlocking
		RR10 A 0 A_Explode(192,128)  
		TNT1 A 1 A_SpawnItemEx("PulseCannonLandMineExplosion",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		Stop
	Death:
		TNT1 A 0 A_Scream
		TNT1 A 0 A_NoBlocking
		RR10 A 0 A_Explode(192,128)  
		TNT1 A 1 A_SpawnItemEx("PulseCannonLandMineExplosion",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		Stop
	}
}

Actor PulseCannonLandMineExplosion : PBExplosionSpawner		//see Decorate/GenericFX.AED
{
	Translation "0:255=%[0,0,0]:[1,1,2]"
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_CheckFloor("Ground")
	Air:
		TNT1 A 0 A_SpawnItemEx("PCMineExploLight",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 AAA 0 A_SpawnItemEx("PBExploBackHalf",frandom(-2.5,2.5),0,frandom(-2.5,2.5),0,0,random(1,3),random(0,359),SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION)
		TNT1 AAAAAA 0 A_SpawnItemEx("PBExploMiniBackHalf",frandom(-2.5,2.5),0,frandom(-2.5,2.5),0,0,random(1,3),random(0,359),SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION,192)
		TNT1 A 2
		TNT1 AAAAAA 0 A_SpawnItemEx("PBMidSmokeHalf",frandom(0,1.5),0,frandom(0,1.5),frandom(-1,1),0,frandom(-3,3),random(0,359),SXF_NOCHECKPOSITION)
		TNT1 AAAAAAAAAAAA 0 A_SpawnItemEx("PBShockwaveSmokeHalf",frandom(2.5,5),0,0,frandom(7.5,10),0,0,random(0,359),SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("PulCanDebris",0,0,0,frandom(4.5,12),0,frandom(4,8.5),random(0,359),SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("PulCanDebris",0,0,0,random(5,10),0,frandom(5,10),random(0,359),SXF_NOCHECKPOSITION,128)
		Stop
	Ground:
		TNT1 A 0 A_SpawnItemEx("PCMineExploLight",0,0,5,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 AAA 0 A_SpawnItemEx("PBExploBackHalf",frandom(0,2.5),0,frandom(0.5,4),0,0,random(1,3),random(0,359),SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION)
		TNT1 AAAAAA 0 A_SpawnItemEx("PBExploMiniBackHalf",frandom(0,2.5),0,frandom(0.5,4),0,0,random(1,3),random(0,359),SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION,192)
		TNT1 A 2
		TNT1 AAAAAA 0 A_SpawnItemEx("PBMidSmokeHalf",frandom(0,1.5),0,frandom(0,1.5),frandom(0,1),0,frandom(0,1.5),random(0,359),SXF_NOCHECKPOSITION)
		TNT1 AAAAAAAAAAAA 0 A_SpawnItemEx("PBShockwaveSmokeHalf",frandom(2.5,5),0,4,frandom(7.5,10),0,0,random(0,359),SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("PulCanDebris",0,0,0,frandom(4.5,12),0,frandom(4,8),random(0,359),SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("PulCanDebris",0,0,0,random(5,10),0,frandom(7,10),random(0,359),SXF_NOCHECKPOSITION,128)
		Stop
   }
}

Actor PCMineExploLight		//this is just to display an "explosion" light
{
	+NOINTERACTION
	RenderStyle None
	States
	{
	Spawn:
		TNT1 A 0 
		TNT1 A 2 Light("WhiteSmallFlicker2") 
		TNT1 A 2 Light("WhiteSmallFlicker1") 
		TNT1 A 2 Light("WhiteMediumFlicker3") 
		TNT1 AAA 2 Light("WhiteMediumFlicker2") 
		TNT1 AAA 2 Light("WhiteMediumFlicker3") 
		TNT1 AAA 2 Light("WhiteSmallFlicker1") 
		TNT1 AA 2 Light("WhiteSmallFlicker2") 
		TNT1 AA 2 Light("WhiteSmallFlicker3") 
		Stop
	}
}

Actor PulCanDebris : PBDebrisHalf	//bouncing debris that spawns the smoke trails
{
	BounceFactor 0.4
		States
		{
		Spawn:
				TNT1 A 0
				TNT1 A 0 A_SetUserVar("user_limit",random(10,50))
				TNT1 A 0 A_SetUserVar("user_ticker",0)
		ParticleSpawner:
				TNT1 A 2 A_SpawnItemEx("PulCanDebrisFirePiece",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
				TNT1 A 0 A_SetUserVar("user_ticker",user_ticker+1)
				TNT1 A 0 A_JumpIf(user_ticker>=user_limit,"Death")
				Loop
		Death:
				TNT1 A 0
				Stop
		}
}


Actor PulCanDebrisFirePiece : PBDebrisPuff	//burning part of the trail 
{
	+NOINTERACTION
	Scale 0.13
	RenderStyle Add
	Translation "0:255=%[0,0,0]:[1,1,2]"
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SpawnItemEx("PulCanDebrisSmokeHalf",frandom(0,1),0,frandom(0,1),frandom(0,1),0,1,random(0,360),SXF_NOCHECKPOSITION)
		TNT1 A 0 A_Jump(128,"Two","Three")
	One:
		X006 ABCDEFGHIJKLMNOP 1 Bright 
		Stop
	Two:
		X007 ABCDEFGHIJ 1 Bright 
		Stop
	Three:
		X033 ABCDEFGHIJKLMNOPQR 1 Bright 
		Stop
	}
}
Actor PulCanDebrisSmokeHalf : PBDebrisSmoke	//smoke trail
{
	Scale 0.3
	Alpha 0.1
	States
	{
	Spawn:
		TNT1 A 0
		X037 AAAAAAAAAA 1 A_FadeIn(0.07)
		TNT1 A 0 A_Jump(255,"One","Two","Three","Four")
	One:
		X037 A 3 A_FadeOut(0.1)
		TNT1 A 0 A_ScaleVelocity(0.95)
		Loop
	Two:
		X037 B 3 A_FadeOut(0.1)
		TNT1 A 0 A_ScaleVelocity(0.95)
		Loop
	Three:
		X037 C 3 A_FadeOut(0.1)
		TNT1 A 0 A_ScaleVelocity(0.95)
		Loop
	Four:
		X037 D 3 A_FadeOut(0.1)
		TNT1 A 0 A_ScaleVelocity(0.95)
		Loop
	}
}
 

Actor PulseCannonDrop : CustomInventory
{
	Inventory.MaxAmount 1
	States
	{
	Use:
		TNT1 A 0
		TNT1 A 0 A_StopSound(6)
		TNT1 A 0 A_SpawnItemEx("DroppedPulseCannon",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		Stop
	}
}

Actor DroppedPulseCannon
{
	Radius 16
	Height 20
	Scale 1.1
	States
	{
	Spawn:
		RR04 A 15
		TNT1 A 0 A_SpawnItemEx("AEoDPulseCannonNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
}

Actor AEoDPulseCannonNoAmmo : AEoDPulseCannonItem
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	Scale 1.1
	Inventory.Amount 1
	Inventory.PickupMessage "You got the Pulse Cannon!"
	Inventory.PickupSound "reilsss/weappickup/heavyrocketlauncher"
	States
	{
	Spawn:
		RR04 A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("PlasmaRod",50,"Ammo")
		TNT1 A 0 A_JumpIfInventory("AEGrenade",4,"Ammo3")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("PulseCannonDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDPulseCannon",1)
		TNT1 A 0 A_TakeInventory("PlasmaRod",50)
		TNT1 A 0 A_TakeInventory("AEGrenade",4)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDPulseCannon",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_JumpIfInventory("AEGrenade",4,1)
		Goto Ammo2
		
		TNT1 A 0 A_TakeInventory("PlasmaRod",50)
		TNT1 A 0 A_TakeInventory("AEGrenade",4)
		TNT1 A 0 A_JumpIfInventory("AEoDPulseCannon",1,2)
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("PulseCannonDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDPulseCannon",1)
		Stop
	Ammo2:
		TNT1 A 0 A_TakeInventory("PlasmaRod",50)
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("PulseCannonDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDPulseCannon",1)
		TNT1 A 0 A_TakeInventory("AEGrenade",4)
		Stop
	Ammo3:
		TNT1 A 0 A_TakeInventory("AEGrenade",4)
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("PulseCannonDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDPulseCannon",1)
		TNT1 A 0 A_TakeInventory("PlasmaRod",50)
		Stop
	}
}
//==================================================================================
//==================================================================================

//==================================================================================
//==================================================================================

Actor AEoDShredderStaffItem : CustomInventory 6106
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	Scale 0.9
	Inventory.Amount 1
	Inventory.PickupMessage "You got the Shredder Staff"
	Inventory.PickupSound "pickuppiece"
	States
	{
	Spawn:
		S4RO A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDShredderStaff",1,"Ammo")
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("ShredderStaffDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDShredderStaff",1)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDShredderStaff",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDShredderStaff",1)
		Stop
	}
}

Actor AEoDShredderStaff : Weapon // 6106
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	+WEAPON.CHEATNOTWEAPON
	+FLOATBOB
	+WEAPON.NOAUTOAIM
	Weapon.AmmoType1 "GreenMana"
	Weapon.AmmoType2 "GreenMana"
	Weapon.AmmoGive1 40
	Weapon.AmmoUse1 10
	Weapon.AmmoUse2 25
	Weapon.SelectionOrder 9999
	Inventory.PickupMessage "You got the Shredder Staff!"
	Inventory.PickupSound "pickuppiece"
	weapon.upsound "weapons/draw"
	Scale 0.9
	Tag "Shredder staff"
	States
	{
	Spawn:
		S4RO A 3 Bright
		Loop
	Ready:
		S04I ABCDEF 5 A_WeaponReady
		Goto Ready+1
	Deselect:
		S04I A 0 A_StopSound(6)
		S04I A 0 	
		S04I A 1 A_Lower
		S04I AA 0 A_Lower
		Goto Deselect+1
	Select:
		S04I A 0 	
		S04I A 1 A_Raise
		S04I AA 0 A_Raise
		Loop
	Fire:
		S04I A 0 A_StopSound(CHAN_BODY)
		S04I A 0 A_PlaySound("reilsss/weapons/shrederstafffire", CHAN_WEAPON, 1.0, 0)
		S04I G 3
		S04I H 2 A_SetBlend("OliveDrab4",0.6,10)
		S04I I 4 A_FireCustomMissile("ShredderCrystal",0,1)
		S04I J 4
		S04I CDEF 5
		Goto Ready
	AltFire:
		S04I A 0 A_StopSound(CHAN_BODY)
		S04I G 3 
		S04I H 0 A_PlaySound("shredderstaff/altfire", CHAN_WEAPON, 1.0, 0)
		S04I A 0 
		S04I A 0 A_SetBlend("Green",0.5,3)
		S04I I 0 A_FireCustomMissile("ShredderAltFXSpawner",0,0)
		S04I H 0 A_RailAttack(200,0,1,none,none,RGF_SILENT,0,"ShredderBlastPuff",0,0,20000)
		S04I H 2 A_FireBullets(0,0,1,200,"ShredderExplosion",FBF_NORANDOMPUFFZ)
		S04I I 5 
		S04I J 4
		S04I FABCDE 5
		Goto Ready
	}
}

Actor ShredderAltFXSpawner
{
	var int user_s[4];
	var int user_failsafe;
	var int user_count;
	Projectile
	+THRUACTORS
	+FORCERADIUSDMG
	+EXTREMEDEATH
	Speed 8
	Radius 4
	Height 4
	RenderStyle Add
	DamageType "AEMagic"
	Alpha 1
	Translation "0:255=%[0.0,0.0,0.0]:[0.44,0.47,0.28]"
	States
	{
	Spawn:
		TNT1 A 0 NoDelay A_SetUserArray(user_s,0,random(0,359))
		TNT1 A 0 A_SetUserArray(user_s,1,random(0,359))
		TNT1 A 0 A_SetUserArray(user_s,2,random(1,8))
		TNT1 A 0 A_SetUserArray(user_s,3,random(1,8))
	Movement:
		TNT1 A 0 A_SpawnItemEx("ShredderBeamParticle2",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_JumpIf(user_s[0] < 360,2)
		TNT1 A 0 A_SetUserArray(user_s,0,user_s[0]-360)
		TNT1 A 0 A_SetUserArray(user_s,0,user_s[0]+user_s[2])
		TNT1 A 0 A_JumpIf(user_s[1] < 360,2)
		TNT1 A 0 A_SetUserArray(user_s,1,user_s[1]-360)
		TNT1 A 0 A_SetUserArray(user_s,1,user_s[1]+user_s[3])
		//(sin(-pitch)*(user_d))*(sin(user_s+90)),(sin(user_s)*user_d),(cos(pitch)*user_d)*(cos(user_s))
		TNT1 A 0 A_SpawnItemEx("ShredderBeamParticle",(sin(-pitch)*10)*sin(user_s[0]+90),(sin(user_s[0])*10),((cos(pitch)*10)*cos(user_s[0])),0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("ShredderBeamMiniParticle",(sin(-pitch)*10)*sin(user_s[0]+90),(sin(user_s[0])*10),((cos(pitch)*10)*cos(user_s[0])),0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("ShredderBeamMiniParticle2",(sin(-pitch)*10)*sin(user_s[1]+90),(sin(user_s[1])*10),((cos(pitch)*10)*cos(user_s[1])),0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_Warp(AAPTR_DEFAULT,velx,vely,velz,0,WARPF_ABSOLUTEOFFSET,1)
		Stop
		TNT1 A 0 A_SetUserVar("user_failsafe",user_failsafe+1)
		TNT1 A 0 A_JumpIf(user_failsafe>=5000,"Death")
		Loop
	Death:
		TNT1 A 0 
		Wait
	}
}

Actor ShredderBeamMiniParticleSp
{ }
Actor ShredderBeamMiniParticleSp2
{ }
Actor ShredderExplosion
{
	+NOINTERACTION
	+ALWAYSPUFF
	+PUFFGETSOWNER
	+THRUACTORS
	+DONTSPLASH
	+SKYEXPLODE
	+EXPLODEONWATER
	Radius 4
	Height 4
	RenderStyle Add
	DamageType "AEMagic"
	Alpha 1
	Translation "0:255=%[0.0,0.0,0.0]:[0.44,0.47,0.28]"
	States
	{
	Spawn:
		TNT1 A 0 NoDelay A_PlaySound("weapons/explode1")
		TNT1 A 0 A_Explode(450,256,0,0,128)
		SRBA FFFFGGGGHHHHIIII 1 Bright A_FadeOut(0.02)
		SRBA J 1 Bright A_FadeOut(0.1)
		Stop
	}
}

Actor ShredderAltTrailMain
{
	var int user_scale;
	+NOINTERACTION
	RenderStyle Add
	Translation "0:255=%[0.0,0.0,0.0]:[0.44,0.47,0.28]"
	Scale 0.5
	Alpha 0.5
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SetUserVar("user_scale",scaleX*100)
		TNT1 A 0 A_SpawnItemEx("ShredderAltTrailMini",0,0,0,0,3,0,0,SXF_TRANSFERPITCH|SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("ShredderAltTrailMini",0,0,0,0,-3,0,0,SXF_TRANSFERPITCH|SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("ShredderAltTrailMini",0,0,0,0,0,3,0,SXF_TRANSFERPITCH|SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("ShredderAltTrailMini",0,0,0,0,0,-3,0,SXF_TRANSFERPITCH|SXF_NOCHECKPOSITION)
	Scaling:
		LPUF A 1 A_SetScale((user_scale*0.01))
		LPUF A 0 A_SetUserVar("user_scale",user_scale+4)
		LPUF A 0 A_FadeOut(0.02)
		Loop
	}
}

Actor ShredderAltTrailMini
{
	var int user_scale;
	+NOINTERACTION
	RenderStyle Add
	Translation "0:255=%[0.0,0.0,0.0]:[0.44,0.47,0.28]"
	Scale 0.5
	Alpha 0.4
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SetUserVar("user_scale",scaleX*100)
	Scaling:
		LPUF A 1 A_SetScale((user_scale*0.01))
		LPUF A 0 A_SetUserVar("user_scale",user_scale-2)
		LPUF A 0 A_JumpIf(user_scale<=0,1)
		Loop
		TNT1 A 0
		Stop
	}
}


Actor ShredderBlastPuff
{
	var int user_scale;
	Projectile
	+THRUACTORS
	+NOBLOCKMAP
	+EXTREMEDEATH
	+FORCERADIUSDMG
	+PUFFGETSOWNER
	+ALWAYSPUFF
	+PUFFONACTORS
	-ALLOWPARTICLES
	Translation "0:255=%[0.0,0.0,0.0]:[0.44,0.47,0.28]"
	RenderStyle Add
	DamageType "AEMagic"
	Scale 0.3
	Alpha 1
	SeeSound "shredderstaff/blasthit"
	States
	{
	Spawn:
	Melee:
		TNT1 A 0
		TNT1 A 0 A_Explode(random(450,850),392,0,0,128)
		TNT1 A 0 A_SetUserVar("user_scale",scaleX*100)
		SRBA FFFFGGGGHHHHIIII 1 Bright A_SetScale((scaleX+0.1))
		SRBA J 0 Bright A_SetScale((scaleX+0.2))
		SRBA J 1 Bright A_FadeOut(0.1)
		Goto Spawn+19
	Crash:
	Death:
		TNT1 A 1
		Stop
	}
}

//=============================
//Shredder Staff FX (again)
//Created by Major Cooke

Actor ShredderBeamParticle //ShredderAltFX2
{
	+NOINTERACTION
	RenderStyle Add
	Scale 0.06
	Alpha 0.99
	Translation "0:255=%[0.0,0.0,0.0]:[0.88,0.94,0.56]"
	States
	{
	Spawn:
		TNT1 A 0
		X060 F 1 Bright A_FadeOut(0.03)
		Wait
	}
}

Actor ShredderBeamParticle2 //ShredderAltFX2
{
	+NOINTERACTION
	RenderStyle Add
	Scale 0.08
	Alpha 0.99
	Translation "0:255=%[0.0,0.0,0.0]:[0.88,0.94,0.56]"
	States
	{
	Spawn:
		TNT1 A 0
		X060 B 1 Bright A_FadeOut(0.03)
		Wait
	}
}

Actor ShredderBeamMiniParticle
{
	+NOINTERACTION
	Scale 0.1
	Translation "0:255=%[0.0,0.0,0.0]:[0.88,0.94,0.56]"
	RenderStyle Add
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SetAngle(random(0,359))
		TNT1 A 0 A_ChangeVelocity(frandom(0,6),0,frandom(-6,6),3)
	Fading:
		ICPR D 1 Bright A_FadeOut(0.02)		TNT1 A 0 A_ScaleVelocity(0.96)
		Loop
	}
}

Actor ShredderBeamMiniParticle2
{
	+NOINTERACTION
	Scale 0.1
	Translation "0:255=%[0.0,0.0,0.0]:[0.88,0.94,0.56]"
	RenderStyle Add
	States
	{
	Spawn:
		TNT1 A 0
		ICPR D 1 Bright A_FadeOut(0.02)		TNT1 A 0 A_ScaleVelocity(0.96)
		Loop
	}
}

Actor ShredderAltFX2
{
	var int user_failsafe;
	Projectile
	+THRUACTORS
	RenderStyle None
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_Jump(256,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,
						21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,"Movement")
		TNT1 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 0 A_Weave(1,1,1.5,1.5)
	Movement:
		TNT1 A 0 A_SpawnItemEx("ShredderBeamParticle",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_Warp(AAPTR_DEFAULT,velx,vely,velz,0,WARPF_ABSOLUTEOFFSET,1)
		Stop
		TNT1 A 0 A_Weave(1,1,1.5,1.5)
		TNT1 A 0 A_SetUserVar("user_failsafe",user_failsafe+1)
		TNT1 A 0 A_JumpIf(user_failsafe>=5000,"Death")
		Loop
	Death:
		TNT1 A 0
		Stop
	}
}

Actor ShredderAltFX3
{
	var int user_failsafe;
	var int user_count;
	var int user_s;
	Projectile
	+THRUACTORS
	RenderStyle None
	States
	{
	Spawn:
		TNT1 A 0 NoDelay A_SetUserVar("user_s",random(1,36))
		TNT1 A 0 A_Jump(256,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,"Movement")
		TNT1 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 0 A_Weave(1,1,1.5,1.5)
	Movement:
		TNT1 A 0 A_JumpIf(user_count!=5,2)
		TNT1 A 0 A_SpawnItemEx("ShredderBeamMiniParticle2",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_JumpIf(user_count<=10,3)
		TNT1 A 0 A_SetUserVar("user_count",0)
		TNT1 A 0 A_SpawnItemEx("ShredderBeamMiniParticle",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_Warp(AAPTR_DEFAULT,velx,vely,velz,0,WARPF_ABSOLUTEOFFSET,1)
		Goto Death
		
		TNT1 A 0 A_Weave(1,1,1.5,1.5)
		TNT1 A 0 A_SetUserVar("user_failsafe",user_failsafe+1)
		TNT1 A 0 A_SetUserVar("user_count",user_count+1)
		TNT1 A 0 A_JumpIf(user_failsafe>=5000,"Death")
		Loop
	Death:
		TNT1 A 0
		Stop
	}
}

//----------------------------------------------------------------------------
Actor ShredderCrystal : CrystalShot
{
	//Translation "0:255=%[0.0,0.0,0.0]:[0.74,0.88,0.2]"
	Translation "0:255=%[0.0,0.0,0.0]:[0.44,0.47,0.28]"
	Radius 8
	Height 8
	Speed 16
	Damage 8
	Scale 1.2
	PROJECTILE
	+EXTREMEDEATH
	+RIPPER
	RipperLevel 2
	+NODAMAGETHRUST
	+FORCERADIUSDMG
	-SEEKERMISSILE
	-ICEDAMAGE
	DamageType "AEMagic"
	DeathSound "weapons/crbreak"
	States
	{
	Spawn:
	CRYS A 0 Bright
	CRYS A 0 Bright A_JumpIf(waterlevel == 3,"Death")
	CRYS A 0 Bright A_CustomMissile("ShredderCrystalShard",0,0,random(5,90),6,0)
	CRYS A 0 Bright A_CustomMissile("ShredderCrystalShard",0,0,random(-5,-90),6,0)
	CRYS A 0 Bright A_CustomMissile("ShredderCrystalShard",0,0,random(90,175),6,0)
	CRYS A 0 Bright A_CustomMissile("ShredderCrystalShard",0,0,random(-90,-175),6,0)
	CRYS A 1 Light("OliveGreenMediumFlicker3") Bright
	TNT1 AAA 0 A_SpawnItemEx("ShredderStaffTrailBig",random(5,-5),random(5,-5),random(5,-5),0,0,frandom(0.3,1),0,SXF_NOCHECKPOSITION)
	CRYS A 1 Light("OliveGreenMediumFlicker3") Bright
	TNT1 AAA 0 A_SpawnItemEx("ShredderStaffTrailBig",random(5,-5),random(5,-5),random(5,-5),0,0,frandom(0.3,1),0,SXF_NOCHECKPOSITION)
	CRYS A 1 Light("OliveGreenMediumFlicker3") Bright
	TNT1 AAA 0 A_SpawnItemEx("ShredderStaffTrailBig",random(5,-5),random(5,-5),random(5,-5),0,0,frandom(0.3,1),0,SXF_NOCHECKPOSITION)
	Loop
	Death:
	TNT1 AAAAAAAAAAA 0 A_SpawnItemEx("ShredderStaffTrailBig",0,0,0,frandom(0.5,1),0,frandom(1,-1),random(0,359),SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION)
	TNT1 AAAAAAAA 0 A_CustomMissile("ShredderCrystalExtra",0,0,random(0,359))
	CRYE A 3 Light("OliveGreenMediumFlicker1") Bright A_Explode(150,96,0)
	CRYE B 3 Light("OliveGreenMediumFlicker2") Bright
	CRYE C 3 Light("OliveGreenMediumFlicker3") Bright
	CRYE D 2 Light("OliveGreenSmallFlicker1") Bright
	CRYE E 2 Light("OliveGreenSmallFlicker2") Bright
	CRYE F 2 Light("OliveGreenSmallFlicker3") Bright
	Stop
	}
}

Actor ShredderStaffTrailBig
{
	+NOINTERACTION
	RenderStyle Add
	//Alpha 0.9
	Scale 0.5
	Translation "0:255=%[0.0,0.0,0.0]:[0.44,0.47,0.28]"
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_Jump(255,2,5,8,12)
		PLSS CDEFGHIJKLMNOPQRSTUVWXYZ 1
		PLSZ ABC 1 A_FadeOut(0.08)
		Wait
	}
}

Actor ShredderStaffTrailSmall : ShredderStaffTrailBig { Scale 0.2 }

Actor ShredderCrystalShard
{
	Radius 4
	Height 4
	Speed 18
	Scale 0.6
	Damage 1
	Translation "0:255=%[0.0,0.0,0.0]:[0.44,0.47,0.28]"
	PROJECTILE
	+EXTREMEDEATH
	+RIPPER	RipperLevel 1
	+FORCERADIUSDMG
	+NODAMAGETHRUST
	-NOGRAVITY
	RenderStyle Add
	Gravity 0.65
	DamageType "AEMagic"
	DeathSound "MageShardsExplode"
	States
	{
	Spawn:
	SHRD A 0
	SHRD A 0 Bright A_JumpIf(waterlevel == 3,"Death")
	SHRD AAABBBCCC 1 Bright A_SpawnItemEx("ShredderStaffTrailSmall",random(2,-2),random(2,-2),random(2,-2),0,0,frandom(0.1,0.5),0,SXF_NOCHECKPOSITION)
	Loop
	Death:
	TNT1 A 0 A_ChangeFlag("NOGRAVITY",1)
	TNT1 AAA 0 A_CustomMissile("ShredderCrystalExtra",0,0,random(0,359))
	SHEX A 0 A_Explode(64,96,0)
	SHEX ABCD 3 Bright
	SHEX E 1 Bright A_FadeOut
	Wait
	}
}

Actor ShredderCrystalExtra : CrytalShotExtra { Translation "0:255=%[0.0,0.0,0.0]:[0.44,0.47,0.28]" }

Actor ShredderStaffDrop : CustomInventory
{
	Inventory.MaxAmount 1
	States
	{
	Use:
	TNT1 A 0
	TNT1 A 0 A_StopSound(6)
	TNT1 A 0 A_SpawnItemEx("DroppedShredderStaff",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
	Stop
	}
}

Actor DroppedShredderStaff
{
	Radius 16
	Height 20
	Scale 0.9
	States
	{
	Spawn:
	S4RO A 15
	TNT1 A 0 A_SpawnItemEx("AEoDShredderStaffNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
	Stop
	}
}

Actor AEoDShredderStaffNoAmmo : AEoDShredderStaffItem
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	Scale 0.9
	Inventory.Amount 1
	Inventory.PickupMessage "You got the Shredder Staff"
	Inventory.PickupSound "pickuppiece"
	States
	{
	Spawn:
		S4RO A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("GreenMana",40,"Ammo")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("ShredderStaffDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDShredderStaff",1)
		TNT1 A 0 A_TakeInventory("GreenMana",40)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDShredderStaff",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_TakeInventory("GreenMana",40)
		TNT1 A 0 A_JumpIfInventory("AEoDShredderStaff",1,2)
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("ShredderStaffDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDShredderStaff",1)
		Stop
	}
}

//==================================================================================
//==================================================================================

//==================================================================================
//==================================================================================

Actor AEoDRavenStaffItem : CustomInventory 6033
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	Scale 0.3
	Inventory.Amount 1
	Inventory.PickupMessage "You got the Raven Staff"
	Inventory.PickupSound "pickuppiece"
	States
	{
	Spawn:
		04RO ABCDEFGHIJKLMNOPQR 3 Bright
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDRavenStaff",1,"Ammo")
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("RavenStaffDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDRavenStaff",1)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDRavenStaff",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDRavenStaff",1)
		Stop
	}
}

Actor AEoDRavenStaff : Weapon // 6033
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	+WEAPON.CHEATNOTWEAPON
	Weapon.AmmoType1 "RedMana"
	Weapon.AmmoType2 "RedMana"
	Weapon.AmmoGive1 30
	Weapon.AmmoUse1 10
	Weapon.AmmoUse2 25
	Weapon.SelectionOrder 12700
	Inventory.PickupMessage "You got the Raven Staff"
	Inventory.PickupSound "pickuppiece"
	Weapon.upsound "weapons/draw"
	Scale 0.3
	Tag "Raven staff"
	States
	{
	Spawn:
		04RO ABCDEFGHIJKLMNOPQR 3 Bright
		Loop
	Ready:
		W04I A 1 A_WeaponReady
		Loop
	Deselect:
		TNT1 A 0 	
		W04I A 1 A_Lower
		TNT1 AA 0 A_Lower
		Loop
	Select:
		TNT1 A 0 	
		W04I A 1 A_Raise
		TNT1 AA 0 A_Raise
		Loop
	Fire:
		TNT1 A 0 A_PlayWeaponSound("h2ravenprojectile/shot")
		W04A A 0 A_GunFlash
		W04A A 2 A_SetBlend("white",0.7,10)
		TNT1 A 0 //ACS_NamedExecute("s851",0,35,random(-3,3),0)
		W04A A 0 A_FireCustomMissile("RavenStaffShot",0,1,0,0)
		W04A A 0 A_FireCustomMissile("RavenStaffShot",5,0,0,0)
		W04A A 3 A_FireCustomMissile("RavenStaffShot",-5,0,0,0)
		TNT1 A 0 //ACS_NamedExecute("s851",0,-35,random(-3,3),0)
		W04A A 2
		W04A BCD 4
		W04I A 10
		Goto Ready
	AltFire:
		TNT1 A 0 A_PlayWeaponSound("h2ravenprojectile/poweredshot")
		W04A A 2 A_SetBlend("white",0.5,3)
		TNT1 A 0 A_GunFlash
		W04A A 3 A_FireCustomMissile("RavenShooter",0,1,0,0)
		W04A BCD 3
		W04I A 8
		Goto Ready
	Flash:
		TNT1 A 3 A_Light1
		TNT1 A 3 A_Light0
		Stop
	}
}
//-------------------------------------------------------------------------------
Actor RavenShooter
{
	Projectile
	Speed 13
	Damage 0
	Scale 0.5
	States
	{
	Spawn:
		RVSH ABCDEFGH 2 Bright
		TNT1 A 0 A_Die
	Death:
		TNT1 A 0 A_SpawnItemEx("RavenProjectile",0,0,0,12,0,0,45,SXF_NOCHECKPOSITION|SXF_SETMASTER)
		TNT1 A 0 A_SpawnItemEx("RavenProjectile",0,0,0,12,0,0,135,SXF_NOCHECKPOSITION|SXF_SETMASTER)
		TNT1 A 0 A_SpawnItemEx("RavenProjectile",0,0,0,12,0,0,225,SXF_NOCHECKPOSITION|SXF_SETMASTER)
		TNT1 A 1 A_SpawnItemEx("RavenProjectile",0,0,0,12,0,0,315,SXF_NOCHECKPOSITION|SXF_SETMASTER)
		Stop
	}
}

Actor RavenProjectile
{
	Radius 6
	Height 8
	Speed 12
	SeeSound "h2ravenprojectile/echosqueak"
	Damage 1
	PROJECTILE
	+SEEKERMISSILE
	+RIPPER	RipperLevel 1
	+EXTREMEDEATH
	+PAINLESS
	+BLOODLESSIMPACT
	+STRIFEDAMAGE
	BounceType "Doom"
	DamageType "AEMagic"
	Scale 0.1
	ReactionTime 15
	BounceFactor 1
	WallBounceFactor 1
	States
	{
	Spawn:
		WRPW AAAAAAAAAA 1 Bright A_SpawnItemEx("RavenStaffRavenTrail",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		WRPW AAAA 0 A_SeekerMissile(90,90,SMF_LOOK,256,20)
		WRPW A 0 A_PlaySound("h2ravenprojectile/echosqueak")
		WRPW AAAAAAAAAA 1 Bright A_SpawnItemEx("RavenStaffRavenTrail",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		WRPW AAAA 0 A_SeekerMissile(90,90,SMF_LOOK,256,20)
		WRPW A 0 A_CountDown
		Loop
	}
}


Actor RavenStaffRavenTrail
{
	+NOINTERACTION
	Scale 0.1
	RenderStyle Translucent
	Alpha 0.7
	States
	{
	Spawn:
		WRPW A 2 Bright A_FadeOut(0.035)
		Loop
	}
}

Actor RavenTurn
{  
	+FRIENDLY
	MONSTER
	-shootable
	+NOGRAVITY
	+NOCLIP
	Radius 3
	Height 4
	Speed 0
	States
	{
	Spawn:
		PLAY A 0 A_Look
	See:
		PLAY A 0 A_Chase
	Missile:
		PLAY A 0 A_FaceTarget
		PLAY A 0 A_CustomMissile("RavenProjectile",0,0,0)
		Stop
	}
}


//-------------------------------------------------------------------------------
Actor RavenStaffShot
{
	Radius 8
	Height 12
	Speed 30
	Damage 15
	Projectile
	Scale 0.5
	+EXTREMEDEATH
	DamageType "AEMagic"
	States
	{
	Spawn:
		RVSH A 0
		RVSH A 0 A_Jump(256,"Type1","Type2")	//just to which side it spins
		Type1:
			TNT1 A 0 A_Jump(200,2,3,4,5,6)
			RVSH ABCDEFGH 2 Light("RedMediumPoint2") Bright 
			Goto Type1+1
		Type2:
			TNT1 A 0 A_Jump(200,2,3,4,5,6)
			RVSH HGFEDCBA 2 Light("RedMediumPoint2") Bright 
			Goto Type2+1
	Death:
		TNT1 A 0 A_SpawnItemEx("RavenStaffExplosion",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 AAAAAAAAAAAAA 0 A_SpawnItemEx("RavenStaffExplosionParticle",0,0,0,frandom(0.4,1.4),0,frandom(1.4,-1.4),random(0,359),SXF_NOCHECKPOSITION)
		TNT1 A 0 Bright A_Explode(random(128,256),192,0)
		Stop
	}
} 
Actor RavenStaffExplosion
{
	+NOINTERACTION
	RenderStyle Add
	DamageType "UnholyDisint"
	Scale 0.8
	States
	{
	Spawn:
		XPLO ABCDEFGHIJKL 3 Bright A_FadeOut(0.03)
		Stop
	}
}

Actor RavenStaffExplosionParticle : RavenStaffExplosion {	Scale 0.6	}


Actor RavenStaffDrop : CustomInventory
{
	Inventory.MaxAmount 1
	States
	{
	Use:
		TNT1 A 0
		TNT1 A 0 A_SpawnItemEx("DroppedRavenStaff",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		Stop
	}
}

Actor DroppedRavenStaff
{
	Radius 16
	Height 20
	Scale 0.3
	States
	{
	Spawn:
		04RO A 15
		TNT1 A 0 A_SpawnItemEx("AEoDRavenStaffNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
}

Actor AEoDRavenStaffNoAmmo : AEoDRavenStaffItem
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	Scale 0.3
	Inventory.Amount 1
	Inventory.PickupMessage "You got the Raven Staff"
	Inventory.PickupSound "pickuppiece"
	States
	{
	Spawn:
		04RO ABCDEFGHIJKLMNOPQR 3 Bright
		Loop
	Pickup:
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("RedMana",30,"Ammo")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("RavenStaffDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDRavenStaff",1)
		TNT1 A 0 A_TakeInventory("RedMana",30)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDRavenStaff",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_TakeInventory("RedMana",30)
		TNT1 A 0 A_JumpIfInventory("AEoDRavenStaff",1,2)
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("RavenStaffDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDRavenStaff",1)
		Stop
	}
}

//==================================================================================
//==================================================================================

//==================================================================================
//==================================================================================

Actor AEoDIonCannonItem : CustomInventory 6001
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	Inventory.Amount 1
	Scale 0.85
	Inventory.PickupMessage "You got the Ion Cannon!"
	Inventory.PickupSound "reilsss/weappickup/laserrifle"
	States
	{
	Spawn:
		R034 K -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDIonCannon",1,"Ammo")
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("IonCannonDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDIonCannon",1)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDIonCannon",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDIonCannon",1)
		Stop
	}
}

Actor AEoDIonCannon : Weapon 
{
	+FLOORCLIP
	+WEAPON.CHEATNOTWEAPON
	+INVENTORY.IGNORESKILL
	Scale 0.85
	Weapon.AmmoType1 "AECell"
	Weapon.AmmoType2 "AECell"
	Weapon.AmmoGive 40
	Weapon.AmmoUse1 1
	Weapon.AmmoUse2 25
	Weapon.SelectionOrder 9100
	Obituary "%o has got %p 'ion' %k."
	Inventory.PickupMessage "You got the Ion Cannon!"
	Inventory.PickupSound "reilsss/weappickup/ionecannon"
	Weapon.upsound "weapons/plasma/draw"
	Tag "Ion Cannon"
	States
	{
	Spawn:
		R034 K -1
		Loop
	Ready:
		TNT1 A 0 A_PlaySound("reilsss/weapons/electricidle5", 6, 0.2, 1)
		R034 A 1 A_WeaponReady
		Goto Ready+1
	Deselect:
		TNT1 A 0 			// this changes to the "Empty" spot
		TNT1 A 0 A_StopSound(6)
		R034 A 1 A_Lower
		TNT1 AA 0 A_Lower
		Goto Deselect+1
	Select:
		TNT1 A 0 		  // current weapon selected
		R034 A 1 A_Raise
		R034 AA 0 A_Raise
		Loop
	Fire:
		TNT1 B 0 A_JumpIfInventory("PowerQuickFire",1,"FireQuick")
		TNT1 A 0 A_JumpIfNoAmmo(1)
		R034 G 1
		TNT1 A 0 A_Light1
		TNT1 A 0 A_PlaySound("reilsss/weapons/ionecannonaltfire", CHAN_WEAPON, 0.5, 0)
		R034 H 1 Bright A_FireCustomMissile("IonCannonEnergyBall",0,1,7,5)
		TNT1 A 0 A_Light2
		R034 H 1 Bright A_Light0
		R034 IJ 1 Bright 
		R034 G 1 A_Refire
		Goto Ready
	FireQuick:
		TNT1 B 0 A_JumpIfInventory("PowerQuickFire",1,1)
		Goto Fire
		
		TNT1 A 0 A_Light1
		TNT1 A 0 A_PlaySound("reilsss/weapons/ionecannonaltfire", CHAN_WEAPON, 0.5, 0)
		R034 H 1 Bright A_FireCustomMissile("IonCannonEnergyBall",0,1,7,5)
		TNT1 A 0 A_Light2
		R034 I 0 Bright A_Light0
		R034 J 1 Bright 
		R034 G 1 A_Refire
		Goto Ready
	AltFire:
		TNT1 A 0 A_JumpIfNoAmmo(1)	
		R034 IJG 2 
		TNT1 A 0 A_Light1
		TNT1 A 0 A_PlaySound("reilsss/weapons/ioncannonaltfire", CHAN_WEAPON, 1.0, 0)
		R034 B 2 Bright A_FireBullets(0,0,1,20,"IonPuff",1)
		TNT1 A 0 A_Light2
		TNT1 A 0 A_Recoil(3)
		R034 C 0 Bright A_Light0
		R034 CD 2 Bright 
		R034 EFIJGHIJ 2
		R034 J 0 A_ReFire
		R034 G 3
		R034 H 4
		R034 I 5
		Goto Ready
	AltHold:
		R034 GHIJGHIJG 2 
		TNT1 A 0 A_Light1
		TNT1 A 0 A_PlaySound("reilsss/weapons/ioncannonaltfire", CHAN_WEAPON, 1.0, 0)
		R034 B 2 Bright A_FireBullets(0,0,1,20,"IonPuff",1)
		TNT1 A 0 A_Light2
		TNT1 A 0 A_Recoil(3)
		R034 C 0 Bright A_Light0
		R034 CD 2 Bright
		R034 EFIJGHIJ 2
		R034 J 0 A_ReFire
		R034 GH 2
		R034 I 3
		R034 J 4
		R034 G 5
		Goto Ready
	}
}

//------------------------------------------------------
Actor IonCannonEnergyBall
{
	Projectile
	Speed 20
	Damage 10
	+SEEKERMISSILE
	Radius 8
	Height 12
	Scale 0.5
	RenderStyle Add
	DamageType "Plasma"
	DeathSound "halflife/weapons/gausshit2"
	Alpha 0.9
	States
	{
	Spawn:
		X029 A 2 Light("YellowMediumFlicker3") Bright A_SeekerMissile(3,3)	TNT1 A 0 A_SpawnItemEx("IonCanTrail",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		X029 B 2 Light("YellowMediumFlicker3") Bright A_SeekerMissile(3,3)	TNT1 A 0 A_SpawnItemEx("IonCanTrail",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		X029 C 2 Light("YellowMediumFlicker3") Bright A_SeekerMissile(3,3)	TNT1 A 0 A_SpawnItemEx("IonCanTrail",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		X029 D 2 Light("YellowMediumFlicker3") Bright A_SeekerMissile(3,3)	TNT1 A 0 A_SpawnItemEx("IonCanTrail",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		X029 E 2 Light("YellowMediumFlicker3") Bright A_SeekerMissile(3,3)	TNT1 A 0 A_SpawnItemEx("IonCanTrail",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("IonCanTrail",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		X029 F 2 Light("YellowMediumFlicker3") Bright A_SeekerMissile(3,3)	TNT1 A 0 A_SpawnItemEx("IonCanTrail",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		X029 G 2 Light("YellowMediumFlicker3") Bright A_SeekerMissile(3,3)	TNT1 A 0 A_SpawnItemEx("IonCanTrail",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		X029 H 2 Light("YellowMediumFlicker3") Bright A_SeekerMissile(3,3)	TNT1 A 0 A_SpawnItemEx("IonCanTrail",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		X029 I 2 Light("YellowMediumFlicker3") Bright A_SeekerMissile(3,3)	TNT1 A 0 A_SpawnItemEx("IonCanTrail",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		X029 J 2 Light("YellowMediumFlicker3") Bright A_SeekerMissile(3,3)	TNT1 A 0 A_SpawnItemEx("IonCanTrail",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		X029 K 2 Light("YellowMediumFlicker3") Bright A_SeekerMissile(3,3)	TNT1 A 0 A_SpawnItemEx("IonCanTrail",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		Loop
	Death:
		TNT1 AAA 0 A_SpawnItemEx("NewExploSmallSmoke",0,0,0,frandom(0.05,0.4),0,frandom(-0.4,0.4),random(0,359),SXF_NOCHECKPOSITION)
		TNT1 AAAAAA 0 A_SpawnItemEx("IonCannonParticle",0,0,0,frandom(-1.5,1.5),0,frandom(0,2.2),random(0,359),SXF_NOCHECKPOSITION)
		TNT1 A 10 Light("YellowSmallFlicker1")
		TNT1 A 5 Light("YellowSmallFlicker2")
		TNT1 A 5 Light("YellowSmallFlicker3")
		Stop
	}
}

Actor IonCanTrail
{
	+NOINTERACTION
	RenderStyle Add
	Scale 0.45
	Alpha 0.5
	States
	{
	Spawn:
		X029 ABCDEFGHIJK 2 Bright A_FadeOut
		Loop
	}
}

Actor IonCannonParticle
{
	Radius 2
	Height 2
	Projectile
	-NOGRAVITY
	Gravity 0.2
	+THRUACTORS
	Scale 0.035
	RenderStyle None
	+DONTSPLASH
	Translation "80:111=160:167"
	states
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_Jump(230,2,3,4,5,6,7)
		TNT1 AAA 1 A_SpawnItemEx("IonCanParticleTrail",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
	Looper:
		TNT1 AAA 1 A_SpawnItemEx("IonCanParticleTrail",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_Jump(64,"Ender")
		Loop
	Ender:
		TNT1 A 1
		Stop
	}
}

Actor IonCanParticleTrail
{
	+NOINTERACTION
	RenderStyle Add
	Scale 0.07
	States
	{
	Spawn:
		X013 PQRSTUVWXY 2 A_FadeOut(0.04)
		Stop
	}
}

Actor IonPuff
{
	Radius 10
	Height 10
	RenderStyle None
	Projectile
	+NOINTERACTION
	+PUFFGETSOWNER
	+NOGRAVITY
	+PUFFONACTORS
	+ALWAYSPUFF
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_CheckFloor("SpawnFloor")
		TNT1 A 0 A_CheckCeiling("SpawnCeiling")
		TNT1 A 1 A_SpawnItemEx("IonExplosionSpawner",8,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER)
	SpawnFloor:
		TNT1 A 1 A_SpawnItemEx("IonExplosionSpawner",0,0,8,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER)
		Stop
	SpawnCeiling:
		TNT1 A 1 A_SpawnItemEx("IonExplosionSpawner",0,0,-8,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER)
		Stop
	}
}

//------------------------------------------------------
Actor IonExplosionSpawner
{
	var int user_rotation;
	Projectile
	+NOINTERACTION
	BounceFactor 1
	WallBounceFactor 1
	Radius 1
	Height 4
	Speed 0
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SpawnItemEx("IonExplShockwave",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SetUserVar("user_rotation",0)
	Rotater:
		TNT1 A 0 A_SpawnItemEx("IonExplosionBall",5,0,0,10,0,0,user_rotation,SXF_NOCHECKPOSITION|SXF_SETMASTER)
		TNT1 A 0 A_SetUserVar("user_rotation",user_rotation+10)
		TNT1 A 0 A_JumpIf(user_rotation>=360,1)
		Loop
		TNT1 A 0 A_SetUserVar("user_rotation",0)
		Stop
	}
}

Actor IonExplShockwave
{
	var int user_count;
	var int user_sub;
	+NOINTERACTION
	RenderStyle Add
	Scale 0.6
	Alpha 0.75
	Translation "0:255=%[0,0,0]:[1,0.75,0]"
	States
	{
	Spawn:
		X122 A 0
		X122 ABCD 1 A_SetScale(ScaleX+(0.15))
		X122 EFG 1 A_SetScale(ScaleX+(0.08))
		X122 HIJK 1 A_SetScale(ScaleX+(0.06))
		X122 LMNOP 1 A_SetScale(ScaleX+(0.04))
	Fading:
		X122 A 0 A_SetScale(ScaleX+(0.02))	X122 A 1 Bright A_FadeOut(0.03)
		X122 A 0 A_SetScale(ScaleX+(0.02))	X122 B 1 Bright A_FadeOut(0.03)
		X122 A 0 A_SetScale(ScaleX+(0.02))	X122 C 1 Bright A_FadeOut(0.03)
		X122 A 0 A_SetScale(ScaleX+(0.02))	X122 D 1 Bright A_FadeOut(0.03)
		X122 A 0 A_SetScale(ScaleX+(0.02))	X122 E 1 Bright A_FadeOut(0.03)
		X122 A 0 A_SetScale(ScaleX+(0.02))	X122 F 1 Bright A_FadeOut(0.03)
		X122 A 0 A_SetScale(ScaleX+(0.02))	X122 G 1 Bright A_FadeOut(0.03)
		X122 A 0 A_SetScale(ScaleX+(0.02))	X122 H 1 Bright A_FadeOut(0.03)
		X122 A 0 A_SetScale(ScaleX+(0.02))	X122 I 1 Bright A_FadeOut(0.03)
		X122 A 0 A_SetScale(ScaleX+(0.02))	X122 J 1 Bright A_FadeOut(0.03)
		X122 A 0 A_SetScale(ScaleX+(0.02))	X122 K 1 Bright A_FadeOut(0.03)
		X122 A 0 A_SetScale(ScaleX+(0.02))	X122 L 1 Bright A_FadeOut(0.03)
		X122 A 0 A_SetScale(ScaleX+(0.02))	X122 M 1 Bright A_FadeOut(0.03)
		X122 A 0 A_SetScale(ScaleX+(0.02))	X122 N 1 Bright A_FadeOut(0.03)
		X122 A 0 A_SetScale(ScaleX+(0.02))	X122 O 1 Bright A_FadeOut(0.03)
		X122 A 0 A_SetScale(ScaleX+(0.02))	X122 P 1 Bright A_FadeOut(0.03)
		Loop
	}
}

Actor IonExplosionBall
{
	PROJECTILE
	+RIPPER
	RipperLevel 4
	+BLOODLESSIMPACT
	+STEPMISSILE
	MaxStepHeight 48
	DamageType "Plasma"
	Radius 8
	Height 8
	Speed 10
	Damage 2
	RenderStyle Add
	Alpha 0.7
	States
	{
	Spawn:
		X013 ABCDEFGHIJKLMNOPQRSTUVWXY 1 Bright
		Stop
	}
}

Actor IonCannonDrop : CustomInventory
{
	Inventory.MaxAmount 1
	States
	{
	Use:
		TNT1 A 0
		TNT1 A 0 A_StopSound(6)
		TNT1 A 0 A_SpawnItemEx("DroppedIonCannon",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		Stop
	}
}

Actor DroppedIonCannon
{
	Radius 16
	Height 20
	Scale 0.85
	States
	{
	Spawn:
		R034 K 15
		TNT1 A 0 A_SpawnItemEx("AEoDIonCannonNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
}

Actor AEoDIonCannonNoAmmo : AEoDIonCannonItem
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	Scale 0.85
	Inventory.Amount 1
	Inventory.PickupMessage "You got the Ion Cannon!"
	Inventory.PickupSound "reilsss/weappickup/ionecannon"
	States
	{
	Spawn:
		R034 K 1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("AECell",40,"Ammo")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("IonCannonDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDIonCannon",1)
		TNT1 A 0 A_TakeInventory("AECell",40)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDIonCannon",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_TakeInventory("AECell",40)
		TNT1 A 0 A_JumpIfInventory("AEoDIonCannon",1,2)
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("IonCannonDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDIonCannon",1)
		Stop
	}
}

//==================================================================================
//==================================================================================

//==================================================================================
//==================================================================================

Actor AEoDPhalanxItem : CustomInventory 6086
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	Scale 0.2
	Inventory.Amount 1
	Inventory.PickupMessage "You filched a Phalanx!"
	Inventory.PickupSound "misc/w_pkup"
	States
	{
	Spawn:
		WPLX ABCDEFGHIJKLMNOPQRSTUVWX 3 Bright
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDPhalanx",1,"Ammo")
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("PhalanxDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDPhalanx",1)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDPhalanx",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDPhalanx",10)
		Stop
	}
}

Actor AEoDPhalanx : Weapon // 6086
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	+WEAPON.CHEATNOTWEAPON
	Weapon.AmmoType1 "AERocket"
	Weapon.AmmoType2 "AERocket"
	Weapon.AmmoGive1 10
	Weapon.AmmoUse1 1
	Weapon.AmmoUse2 4
	Weapon.SelectionOrder 14600
	Inventory.PickupMessage "You filched a Phalanx!"
	Inventory.PickupSound "misc/w_pkup"
	Weapon.upsound "weapons/draw"
	Scale 0.2
	Tag "Phalanx"
	States
	{
	Spawn:
		WPLX ABCDEFGHIJKLMNOPQRSTUVWX 3 Bright
		Loop
	Ready:
		PHLX A 1 A_WeaponReady
		Loop
	Deselect:
		TNT1 A 0 	
		PHLX A 1 A_Lower
		TNT1 AA 0 A_Lower
		Loop
	Select:
		TNT1 A 0 	
		PHLX A 1 A_Raise
		TNT1 AA 0 A_Raise
		Loop
	Fire:
		TNT1 A 0 A_PlayWeaponSound("q2gladiator/phalanx")
		TNT1 A 0 A_SetBlend("Yellow",0.3,20)
		PHLX B 4 A_FireCustomMissile("PhalanxShot",0,1,10,0)
		TNT1 A 0 //ACS_NamedExecute("s851",0,30,random(-3,3),0)
		PHLX C 4 A_FireCustomMissile("PhalanxShot",0,1,10,0)
		PHLX DDEEAA 2 //ACS_NamedExecute("s851",0,-5,random(-3,3),0)
		PHLX FGHGF 3
		PHLX A 14
		Goto Ready
	AltFire:
		PHLX A 30 A_PlaySound("weapons/phalanx/charge",CHAN_WEAPON,0.7,0)
		TNT1 A 0 A_SetBlend("Yellow",0.7,30)
		TNT1 A 0 //ACS_NamedExecute("s851",0,48,random(-3,3),0)
		TNT1 A 0 A_PlayWeaponSound("weapons/phalanx/altfire")
		PHLX B 4 A_FireCustomMissile("PhalanxAltShot",0,1,8,0)
		PHLX C 4
		PHLX DDEEAA 2 //ACS_NamedExecute("s851",0,-8,random(-3,3),0)
		PHLX FGHGF 3
		PHLX A 6
		Goto Ready
	}
}
//------------------------------------------------------------------
Actor PhalanxShot
{
	Radius 4
	Height 8
	Speed 28
	Damage 25
	RenderStyle Add
	Alpha 0.75
	Scale 0.25
	PROJECTILE
	+RANDOMIZE
	+EXTREMEDEATH
	+FORCERADIUSDMG
	States
	{
	Spawn:
		X025 YYXXWWVVUUTTSSRRQQPPOONNMMLLKKJJIIHHGGFFEEDDCCBBAA 1 Bright A_SpawnItemEx("PhalanxShotTrail",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		Loop
	Death:
		TNT1 A 0 A_CustomMissile("ExploSmokeGeneral",0,0,0)
		TNT1 A 0 A_PlaySound("q2gladiator/phalanx/explode")
		TNT1 A 0 A_Explode(random(100,220),128,1)
		TNT1 A 0 A_SpawnItemEx("NewExplosionMedium",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION,0)
		TNT1 AAAAAAAAAAAA 0 A_SpawnItemEx("Q2RocketExtra",0,0,0,1,0,random(-1,3),random(1,360))
		Stop
	}
}

Actor PhalanxShotTrail
{
	+NOINTERACTION
	RenderStyle Add
	Scale 0.25
	States
	{
	SPawn:
		X025 Y 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex-0.01,scaley-0.01)
		X025 X 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex-0.01,scaley-0.01)
		X025 W 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex-0.01,scaley-0.01)
		X025 V 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex-0.01,scaley-0.01)
		X025 U 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex-0.01,scaley-0.01)
		X025 T 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex-0.01,scaley-0.01)
		X025 S 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex-0.01,scaley-0.01)
		X025 R 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex-0.01,scaley-0.01)
		X025 Q 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex-0.01,scaley-0.01)
		X025 P 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex-0.01,scaley-0.01)
		X025 O 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex-0.01,scaley-0.01)
		X025 N 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex-0.01,scaley-0.01)
		X025 M 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex-0.01,scaley-0.01)
		X025 L 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex-0.01,scaley-0.01)
		X025 K 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex-0.01,scaley-0.01)
		X025 J 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex-0.01,scaley-0.01)
		X025 I 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex-0.01,scaley-0.01)
		X025 H 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex-0.01,scaley-0.01)
		X025 G 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex-0.01,scaley-0.01)
		X025 F 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex-0.01,scaley-0.01)
		X025 E 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex-0.01,scaley-0.01)
		X025 D 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex-0.01,scaley-0.01)
		X025 C 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex-0.01,scaley-0.01)
		X025 B 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex-0.01,scaley-0.01)
		X025 A 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex-0.01,scaley-0.01)
		Stop
	}
}
//--------------------------------------------------------------------------------------
Actor PhalanxAltShot
{
	Radius 5
	Height 10
	Speed 28
	Damage 80
	RenderStyle Add
	Scale 0.6
	PROJECTILE
	+RANDOMIZE
	+EXTREMEDEATH
	+FORCERADIUSDMG
	States
	{
	Spawn:
		X016 YXWVU 1 Bright A_SpawnItemEx("PhalanxAltShotTrail",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		X016 TSRQP 1 Bright A_SpawnItemEx("PhalanxAltShotTrail",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		X016 ONMLK 1 Bright A_SpawnItemEx("PhalanxAltShotTrail",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		X016 JIHGF 1 Bright A_SpawnItemEx("PhalanxAltShotTrail",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		X016 EDCBA 1 Bright A_SpawnItemEx("PhalanxAltShotTrail",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		Loop
	Death:
		TNT1 A 0 A_CustomMissile("ExploSmokeGeneral",0,0,0)
		TNT1 A 0 A_PlaySound("weapons/phalanx/explode",CHAN_VOICE,1.0,0)
		TNT1 A 0 A_Explode(420,270,1)
		TNT1 A 0 A_SpawnItemEx("NewExplosionBig",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION,0)
		TNT1 AAAAAAAAAAAA 0 A_SpawnItemEx("Q2RocketExtra",0,0,0,1,0,random(-1,3),random(1,360))
		TNT1 A 20 A_QuakeEx(8,8,0, 20,0,35,"", QF_SCALEDOWN)
		Stop
	}
}

Actor PhalanxAltShotTrail
{
	+NOINTERACTION
	RenderStyle Add
	Alpha 0.4
	Scale 0.8
	States
	{
	SPawn:
		X016 Y 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex+0.035,scaley+0.035)
		X016 X 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex+0.035,scaley+0.035)
		X016 W 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex+0.035,scaley+0.035)
		X016 V 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex+0.035,scaley+0.035)
		X016 U 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex+0.035,scaley+0.035)
		X016 T 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex+0.035,scaley+0.035)
		X016 S 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex+0.035,scaley+0.035)
		X016 R 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex+0.035,scaley+0.035)
		X016 Q 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex+0.035,scaley+0.035)
		X016 P 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex+0.035,scaley+0.035)
		X016 O 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex+0.035,scaley+0.035)
		X016 N 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex+0.035,scaley+0.035)
		X016 M 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex+0.035,scaley+0.035)
		X016 L 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex+0.035,scaley+0.035)
		X016 K 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex+0.035,scaley+0.035)
		X016 J 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex+0.035,scaley+0.035)
		X016 I 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex+0.035,scaley+0.035)
		X016 H 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex+0.035,scaley+0.035)
		X016 G 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex+0.035,scaley+0.035)
		X016 F 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex+0.035,scaley+0.035)
		X016 E 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex+0.035,scaley+0.035)
		X016 D 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex+0.035,scaley+0.035)
		X016 C 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex+0.035,scaley+0.035)
		X016 B 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex+0.035,scaley+0.035)
		X016 A 1 A_FadeOut(0.03) 	TNT1 A 0 A_SetScale(scalex+0.035,scaley+0.035)
		Loop
	}
}




Actor PhalanxDrop : CustomInventory
{
	Inventory.MaxAmount 1
	States
	{
	Use:
		TNT1 A 0
		TNT1 A 0 A_SpawnItemEx("DroppedPhalanx",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		Stop
	}
}

Actor DroppedPhalanx
{
	Radius 16
	Height 20
	Scale 0.2
	States
	{
	Spawn:
		WPLX A 15
		TNT1 A 0 A_SpawnItemEx("AEoDPhalanxNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
}

Actor AEoDPhalanxNoAmmo : AEoDPhalanxItem
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	Scale 0.2
	Inventory.Amount 1
	Inventory.PickupMessage "You filched a Phalanx!"
	Inventory.PickupSound "misc/w_pkup"
	States
	{
	Spawn:
		WPLX ABCDEFGHIJKLMNOPQRSTUVWX 3 Bright
		Loop
	Pickup:
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("AERocket",10,"Ammo")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("PhalanxDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDPhalanx",1)
		TNT1 A 0 A_TakeInventory("AERocket",10)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDPhalanx",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_TakeInventory("AERocket",10)
		TNT1 A 0 A_JumpIfInventory("AEoDPhalanx",1,2)
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("PhalanxDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDPhalanx",1)
		Stop
	}
}

//==================================================================================
//==================================================================================

//==================================================================================
//==================================================================================

Actor AEoDSniperRailgunItem : CustomInventory 6161
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	Scale 0.23
	Inventory.Amount 1
	Inventory.PickupMessage "You got the Sniper RailGun!"
	Inventory.PickupSound "weapons/stroggarmsaw/pickup"
	States
	{
	Spawn:
		RRGN A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDSniperRailgun",1,"Ammo")
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("SniperRailgunDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDSniperRailgun",1)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDSniperRailgun",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDSniperRailgun",10)
		Stop
	}
}

ACTOR AEoDSniperRailgun : Weapon // 6161
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	+CHEATNOTWEAPON
	Weapon.AmmoType1 "AEShell"
	Weapon.AmmoGive1 24
	Weapon.AmmoUse1 3
	Weapon.SelectionOrder 11979
	Inventory.PickupMessage "You got the Sniper RailGun!"
	Inventory.PickupSound "weapons/stroggarmsaw/pickup"
	weapon.upsound "weapons/plasma/draw"
	scale 0.23
	AttackSound "RGSTEREO"
	Weapon.Kickback 2
	Tag "Sniper railgun"
	States 
	{ 
	Spawn: 
		RRGN A -1
		Loop
	Select:
		TNT1 A 0 //ACS_NamedExecute("s799",0,17,0,0)
		RRG1 A 1 A_Raise
		TNT1 AA 0 A_Raise
		Goto Select
	Deselect:
		TNT1 A 0 A_JumpIfInventory("SniperRailgunZoomMode", 1, "ZoomDeselect")
		TNT1 A 0 A_TakeInventory("SniperRailgunZoomMode",1)
		TNT1 A 0 //ACS_NamedExecute("s799",0,0,0,0)
		TNT1 A 0 A_StopSound(6)
		RRG1 A 1 A_Lower
		TNT1 AA 0 A_Lower
		Goto Deselect+3
	ZoomDeselect:
		TNT1 A 0 //ACS_NamedExecute("s799",0,0,0,0)
		TNT1 A 0 A_TakeInventory("SniperRailgunZoomMode",1)
		//Zoom Out
		TNT1 A 0 A_ZoomFactor(1.0)
		TNT1 A 0 A_PlaySound("ZOOM_OUT", 8, 1.0, 0)
		RRG1 A 5
		Goto Deselect+3
	Ready:
		//TNT1 A 0 A_PlaySound("reilsss/weapons/railgunidle2", 6, 0.45, 1)
		TNT1 A 0 //A_PlaySound("RG_HUM", 6, 1.0, 1)
		TNT1 A 0 A_JumpIfInventory("SniperRailgunZoomMode", 1, "ZoomReady")
		RRG1 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 3 A_WeaponReady
		Goto Ready+1
	ZoomReady:
		TNT1 A 0 A_JumpIfTargetInLOS("ZoomReadyLockedOn")
		R016 N 1 A_WeaponReady
		Goto Ready
	ZoomReadyLockedOn:
		R016 O 1 A_WeaponReady
		Goto Ready
	Fire:
		TNT1 A 0 A_JumpIfInventory("SniperRailgunZoomMode", 1, "ZoomFire")
		TNT1 A 0 A_PlaySound("RLFIRE0", CHAN_WEAPON, 1.0, 0)
		TNT1 A 0 A_FireCustomMissile(Q4RailStereo,0,0,0,0)
		TNT1 A 0 A_RailAttack(random(350,500),5,1,Red,"Green",1,0,"ExtremeBulletPuff")
		TNT1 A 0 //ACS_NamedExecute("s851",0,120,random(-8,8),0)
		RRG1 A 1 Bright A_GunFlash
		TNT1 A 0 A_PlaySound("RLCHARGE", 5, 1.0, 0)
		RRG1 ABB 1 //ACS_NamedExecute("s851",0,-40,0,0)
		TNT1 A 0 A_FireCustomMissile("GunSmallSmokeSpawner",0,0,10,4)
		TNT1 A 0 A_FireCustomMissile("GunSmallSmokeSpawner",0,0,7,5)
		TNT1 A 0 A_FireCustomMissile("GunSmallSmokeSpawner",0,0,4,4)
		RRG1 CCC 1 
		RRG1 DEFAAAAAA 4
		TNT1 A 0 A_ReFire
		Goto Ready
	ZoomFire:
		TNT1 A 0 A_JumpIfTargetInLOS("ZoomFireLockedOn")
		TNT1 A 0 A_PlaySound("RLFIRE0", CHAN_WEAPON, 1.0, 0)
		TNT1 A 0 A_FireCustomMissile(Q4RailStereo,0,0,0,0)
		TNT1 A 0 A_RailAttack(random(250,600),1,1,Red,"Green",1,0,"ExtremeBulletPuff")
		TNT1 A 0 //ACS_NamedExecute("s851",0,120,random(-8,8),0)
		R016 N 1 Bright A_GunFlash
		TNT1 A 0 A_PlaySound("RLCHARGE", 5, 1.0, 0)
		R016 NNN 1 //ACS_NamedExecute("s851",0,-40,0,0)
		TNT1 A 0 A_FireCustomMissile("GunSmallSmokeSpawner",0,0,10,4)
		TNT1 A 0 A_FireCustomMissile("GunSmallSmokeSpawner",0,0,7,5)
		TNT1 A 0 A_FireCustomMissile("GunSmallSmokeSpawner",0,0,4,4)
		R016 NNNN 1
		R016 NNNNNNNNNNNNN 2
		R016 N 4
		TNT1 A 0 A_ReFire
		Goto Ready
	ZoomFireLockedOn:
		TNT1 A 0 A_PlaySound("RLFIRE0", CHAN_WEAPON, 1.0, 0)
		TNT1 A 0 A_FireCustomMissile(Q4RailStereo,0,0,0,0)
		TNT1 A 0 A_RailAttack(random(250,600),1,1,Red,"Green",1,0,"ExtremeBulletPuff")
		TNT1 A 0 //ACS_NamedExecute("s851",0,120,random(-8,8),0)
		R016 O 1 Bright A_GunFlash
		TNT1 A 0 A_PlaySound("RLCHARGE", 5, 1.0, 0)
		R016 OOO 1 //ACS_NamedExecute("s851",0,-40,0,0)
		TNT1 A 0 A_FireCustomMissile("GunSmallSmokeSpawner",0,0,10,4)
		TNT1 A 0 A_FireCustomMissile("GunSmallSmokeSpawner",0,0,7,5)
		TNT1 A 0 A_FireCustomMissile("GunSmallSmokeSpawner",0,0,4,4)
		R016 OOOO 1
		R016 OOOOOOOOOOOOO 2
		R016 N 4
		TNT1 A 0 A_ReFire
		Goto Ready
	Flash:
		TNT1 A 0 A_Light2
		TNT1 A 1 Bright A_SetBlend("Red",0.225,8)
		TNT1 A 2 A_Light1
		TNT1 A 0 A_Light0
		stop  
	AltFire:  //scopes the weapon and fires on release
		//Zoom In
		TNT1 A 0 A_JumpIfInventory("SniperRailgunZoomMode", 1, "ZoomOut")
		RRG1 A 1
		TNT1 A 0 A_ZoomFactor(5.0) //Half as good as a Sniper Rifle
		TNT1 A 0 A_PlaySound("weapons/AWP/zoom", 8, 1.0, 0)
		TNT1 A 0 A_GiveInventory("SniperRailgunZoomMode",1)
		TNT1 A 0 A_GiveInventory("Aiming",1)
		R016 N 9
		//TNT1 A 0 A_PlaySound("reilsss/weapons/sniperzoomidle", 6, 0.6, 1)	
		Goto Ready
	ZoomOut:
		//Zoom Out
		TNT1 A 0 A_ZoomFactor(1.0)
		TNT1 A 0 A_StopSound(6)
		TNT1 A 0 A_PlaySound("weapons/AWP/zoom", 8, 1.0, 0)
		TNT1 A 0 A_TakeInventory("SniperRailgunZoomMode",1)
		TNT1 A 0 //A_FireCustomMissile("GunSmallSmokeSpawner",0,0,6,7)
		RRG1 A 10
		Goto Ready
	}
}




Actor Q4RailStereo
{
	Radius 1
	Damage 0
	Scale 0.50
	Speed 0.2
	RenderStyle Add
	Alpha 0.15
	+NOINTERACTION
	SeeSound "RGSTEREO"
	States
	{
	Spawn:
		PUF6 BCDEFGHIJLNPRTVXZ 1
		PUF7 A 1
		Stop
	}
}

Actor SniperRailgunZoomMode : Inventory
{
	Inventory.Amount 0
	Inventory.MaxAmount 1
}

Actor SniperRailgunDrop : CustomInventory
{
	Inventory.MaxAmount 1
	States
	{
	Use:
		TNT1 A 0
		TNT1 A 0 A_StopSound(6)
		TNT1 A 0 A_SpawnItemEx("DroppedSniperRailgun",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		Stop
	}
}

Actor DroppedSniperRailgun
{
	Radius 16
	Height 20
	Scale 0.23
	States
	{
	Spawn:
		RRGN A 15
		TNT1 A 0 A_SpawnItemEx("AEoDSniperRailgunNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
}

Actor AEoDSniperRailgunNoAmmo : AEoDSniperRailgunItem
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	Scale 0.23
	Inventory.Amount 1
	Inventory.PickupMessage "You got the Sniper RailGun!"
	Inventory.PickupSound "weapons/stroggarmsaw/pickup"
	States
	{
	Spawn:
		RRGN A -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("AEShell",24,"Ammo")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("SniperRailgunDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDSniperRailgun",1)
		TNT1 A 0 A_TakeInventory("AEShell",24)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDSniperRailgun",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_TakeInventory("AEShell",24)
		TNT1 A 0 A_JumpIfInventory("AEoDSniperRailgun",1,2)
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("SniperRailgunDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDSniperRailgun",1)
		Stop
	}
}


//====================================================================
//====================================================================
//					   THE Bone Duster... >=3
//							 By Major Cooke
//					Ripped straight outta Bulletstorm.
//						 Doom hands added by DBT
//====================================================================
/*	
	This bad boy is pretty simple to operate... Primary fire shoots
	one barrel full of shells, secondary unloads all/remaining 
	shells. The more you unload while up-close, the greater the damage.
	And as an added	bonus, you can now SHOTGUN JUMP by aiming towards 
	the ground!	That's right! No more wasting precious rockets and 
	health!
	
	(Disclaimer: This only works with four loaded barrels, and only 
	partially works with three. We do not condone or recommend wasting
	shells.)
*/
//====================================================================
//====================================================================


Actor AEoDBoneDusterItem : CustomInventory
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	Inventory.Amount 1
	Scale 0.2
	Inventory.PickupSound "BoneDuster/Pickup"
	Inventory.PickupMessage "You grabbed the Bone Duster! Big Barrels AHOY!"
	States
	{
	Spawn:
		QDBS Q -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDBoneDuster",1,"Ammo")
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("BoneDusterDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDBoneDuster",1)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDBoneDuster",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDBoneDuster",1)
		Stop
	}
}

Actor BoneDusterDrop : CustomInventory
{
	Inventory.MaxAmount 1
	States
	{
	Use:
		TNT1 A 0
		TNT1 A 0 A_SpawnItemEx("DroppedBoneDuster",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		Stop
	}
}


Actor DroppedBoneDuster
{
	Radius 16
	Height 20
	Scale 0.2
	States
	{
	Spawn:
		QDBS Q 15
		TNT1 A 0 A_SpawnItemEx("AEoDBoneDusterNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
}


Actor AEoDBoneDusterNoAmmo : AEoDBoneDusterItem
{
	+INVENTORY.IGNORESKILL
	States
	{
	Spawn:
		QDBS Q -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("AEShell",20,"Ammo")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("BoneDusterDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDBoneDuster",1)
		TNT1 A 0 A_TakeInventory("AEShell",20)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDBoneDuster",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_TakeInventory("AEShell",20)
		TNT1 A 0 A_JumpIfInventory("AEoDBoneDuster",1,2)
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("BoneDusterDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDBoneDuster",1)
		Stop
	}
}

Actor AEoDBoneDuster : Weapon
{
	+WEAPON.AMMO_OPTIONAL
	+FLOORCLIP
	+WEAPON.NOAUTOAIM //due to buggy behavior.
	Scale 0.2
	Weapon.AmmoType1 "BoneDusterClip"
	Weapon.AmmoType2 "AEShell"
	Inventory.PickupSound "BoneDuster/Pickup"
	Inventory.PickupMessage "You grabbed the Bone Duster! Big Barrels AHOY!"
	Weapon.UpSound "BoneDuster/Switch"
	Weapon.AmmoGive1 20
	Weapon.SelectionOrder 12400
	Tag "Bone duster"
	States
	{
	Spawn:
		QDBS Q -1
		Stop
	Select:
		TNT1 A 0 	
		QDBS A 1 A_Raise
		QDBS AA 0 A_Raise
		Loop
	Deselect:
		"####" "#" 0 	
		"####" "#" 0 A_StopSound(5)
		"####" "#" 1 A_Lower
		"####" "##" 0 A_Lower
		Goto Deselect+1
	Ready:
		QDBS A 0 A_JumpIfInventory("BoneDusterClip",21,"AllocateAmmo")
		QDBS A 0 A_JumpIfInventory("BoneDusterClip",5,1)
		Goto ReadyNotLoaded
		
		QDBS A 1 A_WeaponReady(WRF_ALLOWRELOAD)
		Loop
	ReadyNotLoaded:
		QDBS A 0 A_JumpIfInventory("AEShell",5,"Reload")
		QDBS A 1 A_WeaponReady(WRF_NOFIRE)
		Loop
	AllocateAmmo:
		QDBS A 0 A_JumpIfInventory("BackpackItem",1,"AllocateBP")
		QDBS A 0 A_JumpIfInventory("AEShell",80,"AllocateOverflow")
		QDBS A 0 A_TakeInventory("BoneDusterClip",1)
		QDBS A 0 A_GiveInventory("AEShell",1)
		Goto Ready
	AllocateOverflow:
		QDBS A 0 A_TakeInventory("BoneDusterClip",1)
		QDBS A 0 A_SpawnItemEx("DroppedShellSpawner",12,0,32,12,0,5,random(-10,10),SXF_NOCHECKPOSITION)
		Goto Ready
	AllocateBP:
		QDBS A 0 A_JumpIfInventory("AEShell",150,"AllocateOverflow")
		QDBS A 0 A_TakeInventory("BoneDusterClip",1)
		QDBS A 0 A_GiveInventory("AEShell",1)
		Goto Ready
/*
For the firing frames, we'll want it to perform a reload after the shells are spent.
*/
	Fire:
		QDBS A 0 A_JumpIfInventory("BoneDusterClip",20,"FireLeft")
		QDBS A 0 A_JumpIfInventory("BoneDusterClip",15,"FireMidLeft")
		QDBS A 0 A_JumpIfInventory("BoneDusterClip",10,"FireMidRight")
		QDBS A 0 A_JumpIfInventory("BoneDusterClip",5,"FireRight")
		Goto "Reload"
	FireLeft:
		QDBS AAA 0 A_FireCustomMissile("BDFire",frandom(-6,6),0,3,6)
		QDBS K 1 bright
		Goto "FireGeneral"
	FireMidLeft:
		QDBS AAA 0 A_FireCustomMissile("BDFire",frandom(-6,6),0,4,6)
		QDBS L 1 bright
		Goto "FireGeneral"
	FireMidRight:
		QDBS AAA 0 A_FireCustomMissile("BDFire",frandom(-6,6),0,5,6)
		QDBS M 1 bright
		Goto "FireGeneral"
	FireRight:
		QDBS AAA 0 A_FireCustomMissile("BDFire",frandom(-6,6),0,6,6)
		QDBS N 1 bright
		Goto "FireGeneral"
	FireGeneral:
		QDBS A 0 A_PlaySound("BoneDuster/Fire",CHAN_WEAPON,1)
		
		QDBS A 0 A_FireBullets(4,4,random(20,60),0,"BDPuffPainless",0)
		QDBS AAAAAAAAAA 0 A_RailAttack(random(20,60),0,0,none,none,RGF_SILENT,0,"bdpuffpainless",4,2)
		QDBS A 0 A_RailAttack(1,0,0,none,none,RGF_SILENT,0,"BDPuffPainful")
		QDBS A 0 A_FireCustomMissile("BDHeatWavePartial",0,0,0,0)
		QDBS A 0 A_RailAttack(1,0,0,none,none,RGF_SILENT,0,"BDPuffPainful")
		QDBS A 0 A_TakeInventory("BoneDusterClip",5) //Force it. Only total ammo is unaffected.
		
	SharedFire:
		QDBS A 0 A_Recoil(5)
		QDBS A 0 Bright A_SetPitch(pitch-3)
		QDBS A 1 Bright A_GunFlash
		QDBS A 1 Offset(8,48) A_SetPitch(pitch+0.6)
		QDBS A 1 Offset(16,56) A_SetPitch(pitch+0.6)
		QDBS A 1 Offset(14,50) A_SetPitch(pitch+0.6)
		QDBS A 1 Offset(14,45) A_SetPitch(pitch+0.6)
		QDBS A 1 Offset(12,43) A_SetPitch(pitch+0.6)
		QDBS A 1 Offset(12,40)
		QDBS A 1 Offset(10,38)
		QDBS A 1 Offset(10,36)
		QDBS A 1 Offset(8,35)
		QDBS A 1 Offset(6,34)
		QDBS A 1 Offset(4,33)
		QDBS A 1 Offset(2,32)
		QDBS A 0 A_JumpIfInventory("BoneDusterClip",1,"GoodToGo")
		Goto "Reload"
	GoodToGo:
		QDBS AAAAAAAAAAAAAAAAAAAAAAA 1 Offset(0,32) A_WeaponReady(WRF_NOFIRE|WRF_ALLOWRELOAD|WRF_NOBOB)
		QDBS A 0 A_ReFire
		Goto Ready
	AltFire:
		QDBS A 0 A_JumpIfInventory("BoneDusterClip",20,"Alt4")
		QDBS A 0 A_JumpIfInventory("BoneDusterClip",15,"Alt3")
		QDBS A 0 A_JumpIfInventory("BoneDusterClip",10,"Alt2")
		QDBS A 0 A_JumpIfInventory("BoneDusterClip",5,"Alt1")
		Goto Reload
	Alt4:
		QDBS A 0 A_FireCustomMissile("MassChanger",0,0,0,0)
		QDBS A 0 A_FireCustomMissile("BDHeatWaveFull",0,0,0,0)
		QDBS A 0 A_PlaySound("BoneDuster/AltFire",CHAN_WEAPON,1)
		QDBS AAAAAAAAAAAA 0 A_FireCustomMissile("BDFire",frandom(-6,6),0,frandom(3,6),6)
		QDBS A 0 A_FireBullets(7,7,40,0,"ExtremeBulletPuffBloodless",0)
		QDBS AAAAAAAAAA 0 A_RailAttack(random(20,60),0,0,none,none,RGF_SILENT,0,"BDPuffPainless",7,3)
		QDBS AAAAAAAAAA 0 A_RailAttack(random(20,60),0,0,none,none,RGF_SILENT,0,"BDPuffPainless",7,3)
		QDBS AAAAAAAAAA 0 A_RailAttack(random(20,60),0,0,none,none,RGF_SILENT,0,"BDPuffPainless",7,3)
		QDBS AAAAAAAAAA 0 A_RailAttack(random(20,60),0,0,none,none,RGF_SILENT,0,"BDPuffPainless",7,3)
		QDBS A 0 A_RailAttack(1,0,0,none,none,RGF_SILENT,0,"BDPuffPainful")
		QDBS A 0 A_TakeInventory("BoneDusterClip",20)
		QDBS A 0 A_Recoil((cos(pitch)*20))
		QDBS A 0 A_JumpIf(pitch>=180,2)
		QDBS A 0 A_ChangeVelocity(0,0,(sin(pitch)*20),1)
		QDBS O 1 Bright A_SetPitch(pitch-12)
		QDBS O 1 Bright A_GunFlash
		QDBS A 1 Offset(8,48) A_SetPitch(pitch+2)
		QDBS A 1 Offset(16,56) A_SetPitch(pitch+2)
		QDBS A 1 Offset(14,50) A_SetPitch(pitch+2)
		QDBS A 1 Offset(14,45) A_SetPitch(pitch+2)
		QDBS A 1 Offset(12,43) A_SetPitch(pitch+1)
		QDBS A 1 Offset(12,40) A_SetPitch(pitch+1)
		QDBS A 1 Offset(10,38) A_SetPitch(pitch+1)
		QDBS A 1 Offset(10,36) A_SetPitch(pitch+1)
		QDBS A 1 Offset(8,35) 
		QDBS A 1 Offset(6,34)
		QDBS A 1 Offset(4,33)
		QDBS A 1 Offset(2,32)
		Goto "Reload"
	Alt3:
		QDBS A 0 A_FireCustomMissile("MassChanger",0,0,0,0)
		QDBS A 0 A_PlaySound("BoneDuster/Fire1",CHAN_WEAPON,1)
		QDBS A 0 A_PlaySound("BoneDuster/Fire2",CHAN_BODY,1)
		
		QDBS AAAAAAAAA 0 A_FireCustomMissile("BDFire",frandom(-6,6),0,frandom(3,6),6)
		QDBS A 0 A_FireBullets(6,6,30,0,"ExtremeBulletPuffBloodless",0)
		QDBS AAAAAAAAAA 0 A_RailAttack(random(20,60),0,0,none,none,RGF_SILENT,0,"BDPuffPainless",6,3)
		QDBS AAAAAAAAAA 0 A_RailAttack(random(20,60),0,0,none,none,RGF_SILENT,0,"BDPuffPainless",6,3)
		QDBS AAAAAAAAAA 0 A_RailAttack(random(20,60),0,0,none,none,RGF_SILENT,0,"BDPuffPainless",6,3)
		QDBS AAA 0 A_FireCustomMissile("BDHeatWavePartial",0,0,0,0)
		QDBS A 0 A_RailAttack(1,0,0,none,none,RGF_SILENT,0,"BDPuffPainful")
		QDBS A 0 A_TakeInventory("BoneDusterClip",15)
		QDBS A 0 A_Recoil((cos(pitch)*15))
		QDBS A 0 A_JumpIf(pitch>=60,2)
		QDBS A 0 A_ChangeVelocity(0,0,(sin(pitch)*12),1)
		QDBS O 1 Bright A_SetPitch(pitch-9)
		QDBS O 1 Bright A_GunFlash
		QDBS A 1 Offset(8,48) A_SetPitch(pitch+2)
		QDBS A 1 Offset(16,56) A_SetPitch(pitch+1)
		QDBS A 1 Offset(14,50) A_SetPitch(pitch+1)
		QDBS A 1 Offset(14,45) A_SetPitch(pitch+1)
		QDBS A 1 Offset(12,43) A_SetPitch(pitch+1)
		QDBS A 1 Offset(12,40) A_SetPitch(pitch+1)
		QDBS A 1 Offset(10,38) A_SetPitch(pitch+1)
		QDBS A 1 Offset(10,36) A_SetPitch(pitch+1)
		QDBS A 1 Offset(8,35) 
		QDBS A 1 Offset(6,34)
		QDBS A 1 Offset(4,33)
		QDBS A 1 Offset(2,32)
		Goto "Reload"
	Alt2:
		QDBS A 0 A_FireCustomMissile("MassChanger",0,0,0,0)
		QDBS A 0 A_PlaySound("BoneDuster/Fire1",CHAN_WEAPON,1)
		QDBS A 0 A_PlaySound("BoneDuster/Fire2",CHAN_BODY,1)
		
		QDBS AAAAAA 0 A_FireCustomMissile("BDFire",frandom(-6,6),0,frandom(3,6),6)
		QDBS A 0 A_FireBullets(5,5,20,0,"ExtremeBulletPuffBloodless",0)
		QDBS AAAAAAAAAA 0 A_RailAttack(random(20,60),0,0,none,none,RGF_SILENT,0,"BDPuffPainless",5,2)
		QDBS AAAAAAAAAA 0 A_RailAttack(random(20,60),0,0,none,none,RGF_SILENT,0,"BDPuffPainless",5,2)
		QDBS AA 0 A_FireCustomMissile("BDHeatWavePartial",0,0,0,0)
		QDBS A 0 A_RailAttack(1,0,0,none,none,RGF_SILENT,0,"BDPuffPainful")
		QDBS A 0 A_TakeInventory("BoneDusterClip",10)
		QDBS A 0 A_Recoil(10)
		QDBS O 1 Bright A_SetPitch(pitch-6)
		QDBS O 1 Bright A_GunFlash
		QDBS A 1 Offset(8,48) A_SetPitch(pitch+1.2)
		QDBS A 1 Offset(16,56) A_SetPitch(pitch+1.2)
		QDBS A 1 Offset(14,50) A_SetPitch(pitch+1.2)
		QDBS A 1 Offset(14,45) A_SetPitch(pitch+1.2)
		QDBS A 1 Offset(12,43) A_SetPitch(pitch+1.2)
		QDBS A 1 Offset(12,40) 
		QDBS A 1 Offset(10,38) 
		QDBS A 1 Offset(10,36) 
		QDBS A 1 Offset(8,35) 
		QDBS A 1 Offset(6,34)
		QDBS A 1 Offset(4,33)
		QDBS A 1 Offset(2,32)
		Goto "Reload"
	Alt1:
		QDBS A 0 A_FireCustomMissile("MassChanger",0,0,0,0)
		QDBS A 0 A_PlaySound("BoneDuster/Fire",CHAN_WEAPON,1)
		
		QDBS AAA 0 A_FireCustomMissile("BDFire",frandom(-6,6),0,frandom(3,6),6)
		QDBS A 0 A_FireBullets(4,4,10,0,"ExtremeBulletPuffBloodless",0)
		QDBS AAAAAAAAAA 0 A_RailAttack(random(20,60),0,0,none,none,RGF_SILENT,0,"BDPuffPainless",4,2)
		QDBS A 0 A_FireCustomMissile("BDHeatWavePartial",0,0,0,0)
		QDBS A 0 A_RailAttack(1,0,0,none,none,RGF_SILENT,0,"BDPuffPainful")
		QDBS A 0 A_TakeInventory("BoneDusterClip",24)
		QDBS K 1
		Goto "SharedFire"
	Reload:
		QDBS A 0 A_JumpIfInventory("BoneDusterClip",20,"Ready")
		QDBS A 0 A_JumpIfInventory("InfiniteAmmo",1,3)
		QDBS A 0 A_JumpIfInventory("PowerEconomizer",1,2)
		QDBS A 0 A_JumpIfInventory("AEShell",5,1)
		Goto ReadyNotLoaded
		
		QDBS A 0 A_PlaySound("BoneDuster/Reload",5,1)
		QDBS B 1 //These offsets took forever to get correct...
		QDBS B 1 Offset(1,32) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS B 1 Offset(1,31) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		//QDBS C 1 Offset(2,30)//34)
		QDBS C 1 Offset(3,28) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS C 1 Offset(4,26) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS C 1 Offset(5,24) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS C 1 Offset(6,22) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS D 1 Offset(7,20) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS D 1 Offset(8,18) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS D 1 Offset(9,16) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		//QDBS D 1 Offset(10,15)//41)
		QDBS E 1 Offset(10,14) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS E 1 Offset(9,13) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS E 1 Offset(9,13) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS E 1 Offset(8,12) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS E 1 Offset(8,12) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS E 1 Offset(7,13) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS F 1 Offset(6,14) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS F 1 Offset(6,15) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		//QDBS F 1 Offset(6,17)
		QDBS F 1 Offset(6,19) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		//QDBS F 1 Offset(6,21)
		QDBS G 1 Offset(6,22) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS G 1 Offset(5,23) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS H 1 Offset(5,24) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		//QDBS H 1 Offset(4,25)//35)
		QDBS H 1 Offset(3,26) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS H 1 Offset(2,28) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS I 1 Offset(1,30) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		//QDBS I 1 Offset(0,32)//34)
		QDBS I 1 Offset(0,34) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS I 1 Offset(0,38) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS J 1 Offset(0,42) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS J 1 Offset(0,46) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS J 1 Offset(0,54) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS J 1 Offset(0,62) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS J 1 Offset(-1,74) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS J 1 Offset(-2,86) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS J 1 Offset(-3,101) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS J 1 Offset(-4,111) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS J 1 Offset(-4,121) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS JJJJJ 0 Offset(-5,131) A_FireCustomMissile("ShotgunCasingSpawner",-4,0, random(3,-3),-10)
		QDBS JJJJJ 0 Offset(-5,131) A_FireCustomMissile("ShotgunCasingSpawner",-4,0, random(3,-3),-10)
		QDBS J 1 Offset(-5,131) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS JJJJJ 0 Offset(-5,131) A_FireCustomMissile("ShotgunCasingSpawner",-4,0, random(3,-3),-10)
		QDBS JJJJJ 0 Offset(-5,131) A_FireCustomMissile("ShotgunCasingSpawner",-4,0, random(3,-3),-10)
		QDBS J 18 Offset(-5,131) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS J 1 Offset(-4,107) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS J 1 Offset(-4,91) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS J 1 Offset(-4,77) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS J 1 Offset(-4,66) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS I 1 Offset(-4,60) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS I 1 Offset(-4,53) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS I 1 Offset(-4,47) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS I 1 Offset(-4,40) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS H 1 Offset(-3,35) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS H 1 Offset(-3,29) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS H 1 Offset(-3,25) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS H 1 Offset(-3,24) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS G 1 Offset(-3,23) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS G 1 Offset(-2,23) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS G 1 Offset(-2,24) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS G 1 Offset(-2,25) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS F 1 Offset(-2,26) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS F 1 Offset(-2,27) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS F 1 Offset(-2,28) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS F 1 Offset(-1,29) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS E 1 Offset(-1,30) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS E 1 Offset(-1,31) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS E 1 Offset(-1,32) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS E 1 Offset(0,32) A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS DDD 1 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS CC 1 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS BB 1 A_WeaponReady(WRF_NOBOB|WRF_NOFIRE)
		QDBS A 0 A_JumpIfInventory("PowerEconomizer",1,"ReloadSpecial") //Treat it like they have more than 20 shells at all times.
		QDBS A 0 A_JumpIfInventory("InfiniteAmmo",1,"ReloadSpecial")
		QDBS A 0 A_JumpIfInventory("AEShell",20,"Reload4")
		QDBS A 0 A_JumpIfInventory("AEShell",15,"Reload3")
		QDBS A 0 A_JumpIfInventory("AEShell",10,"Reload2")
	Reload1:
		QDBS A 0 A_TakeInventory("AEShell",5,1)
		QDBS A 0 A_GiveInventory("BoneDusterClip",5)
		Goto Ready
	Reload2:
		QDBS A 0 A_TakeInventory("AEShell",10,1)
		QDBS A 0 A_GiveInventory("BoneDusterClip",10)
		Goto Ready
	Reload3:
		QDBS A 0 A_TakeInventory("AEShell",15,1)
		QDBS A 0 A_GiveInventory("BoneDusterClip",15)
		Goto Ready
	Reload4:
		QDBS A 0 A_TakeInventory("AEShell",20,1)
		QDBS A 0 A_GiveInventory("BoneDusterClip",20)
		Goto Ready
	ReloadSpecial:
		QDBS A 0 A_TakeInventory("BoneDusterClip",2000,0)
		QDBS A 0 A_GiveInventory("BoneDusterClip",20)
		Goto Ready
	GunFlash:
		TNT1 A 2 A_Light2
		TNT1 A 1 A_Light1
		TNT1 A 0 A_Light0
		Stop
	}
}

Actor BDPuffPainful : NewPuff1
{
	+PUFFGETSOWNER
	+NOINTERACTION
	+EXTREMEDEATH
	+FORCEPAIN
	+SEEKERMISSILE
	+CAUSEPAIN
	DeathType "Extreme"
}

Actor BDPuff : NewPuff1
{
	+PUFFGETSOWNER
	+NOINTERACTION
	+EXTREMEDEATH
	+SEEKERMISSILE
	+CAUSEPAIN
	DeathType "Extreme"
}

Actor BDPuffPainless : NewPuff1
{
	+PUFFGETSOWNER
	+NOINTERACTION
	+EXTREMEDEATH
	+SEEKERMISSILE
	+PAINLESS
	DeathType "Extreme"
}

Actor BDPuff2 : NewPuff1
{
	+PUFFGETSOWNER
	+NOINTERACTION
	+EXTREMEDEATH
	+SEEKERMISSILE
	DeathType "Extreme"
}

Actor ExtremeBulletPuffBloodless : NewPuff1
{
	+PAINLESS
	+BLOODLESSIMPACT
	+EXTREMEDEATH
	+PUFFGETSOWNER
	+ALWAYSPUFF
	+SEEKERMISSILE
	+SCREENSEEKER
	DamageType "AEBullet"
	States
	{
	Spawn:
	Melee:
	XDeath:
		TNT1 A 0
		TNT1 A 0 A_SeekerMissile(0,0,1,256)
		TNT1 A 0 A_SpawnItemEx("BDFireSpewer",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		Stop
	Crash:
		TNT1 A 0 A_SpawnItemEx("NewPuff1",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		Stop
	}
}

//******************************************************
Actor BDFire
{
	var int user_flamecount;
	var int user_burncount;
	PROJECTILE
	+DONTREFLECT
	Radius 2
	Height 4
	Speed 32
	RenderStyle None
	Alpha 1
	Scale 0.3
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_ChangeVelocity(0,0,random(-4,4),1)
		TNT1 A 0 A_SetUserVar("user_flamecount",0)
		TNT1 A 0 A_SetUserVar("user_burncount",0)
	MovementLoop:
		X052 A 0 A_SpawnItemEx("FTFlameTrailMini0",random(-7,7),random(-1,1),random(-2,0),0,0,frandom(0,0.25),0,SXF_NOCHECKPOSITION,64)
		X052 A 1 A_SetUserVar("user_flamecount",user_flamecount+random(1,3))
		X052 A 0 A_JumpIf(user_flamecount>=30,"LifeTimeExpires")
		X052 A 0 A_JumpIf(user_flamecount>=25,"Trail5")
		X052 A 0 A_JumpIf(user_flamecount>=20,"Trail4")
		X052 A 0 A_JumpIf(user_flamecount>=15,"Trail3")
		X052 A 0 A_JumpIf(user_flamecount>=10,"Trail2")
		X052 A 0 A_JumpIf(user_flamecount>=5,"Trail1")
		Loop
	LifeTimeExpires:
		X052 A 0
		Stop
	Trail1:
		X052 AA 0 A_SpawnItemEx("FTFlameTrailMini1",random(-7,7),random(-3,3),random(-3,0),0,0,frandom(0,0.5),0,SXF_NOCHECKPOSITION,64)
		Goto MovementLoop+1
	Trail2:
		X052 AA 0 A_SpawnItemEx("FTFlameTrailMini2",random(-7,7),random(-4,4),random(-4,0),0,0,frandom(0,1),0,SXF_NOCHECKPOSITION,64)
		Goto MovementLoop+1
	Trail3:
		X052 A 0 A_SpawnItemEx("FTFlameTrailMini3",random(-7,7),random(-4,4),random(-4,2),0,0,frandom(0,1.25),0,SXF_NOCHECKPOSITION,64)
		Goto MovementLoop+1
	Trail4:
		TNT1 A 0 A_SpawnItemEx("FlmThrwrSmoke5",random(10,-10),random(5,-5),random(25,40),0,0,frandom(0.2,1.0),0,SXF_NOCHECKPOSITION,128)
		X052 A 0 A_SpawnItemEx("FTFlameTrailMini4",random(-7,7),random(-5,5),random(-4,2),0,0,frandom(0,1.5),0,SXF_NOCHECKPOSITION,64)
		Goto MovementLoop+1
	Trail5:
		TNT1 A 0 A_SpawnItemEx("FlmThrwrSmoke5",random(10,-10),random(5,-5),random(25,40),0,0,frandom(0.2,1.0),0,SXF_NOCHECKPOSITION,64)
		X052 A 0 A_SpawnItemEx("FTFlameTrailMini5",random(-7,7),random(-6,6),random(-4,2),0,0,frandom(0,2.2),0,SXF_NOCHECKPOSITION,64)
		Goto MovementLoop+1
	Death:
		TNT1 A 0 
		Stop
	}
}	
Actor BDFireSpewer
{
	var int user_burncount;
	Projectile
	+SEEKERMISSILE
	+FORCERADIUSDMG
	+EXTREMEDEATH
	+NOINTERACTION
	+NODAMAGETHRUST
	+PAINLESS
	DamageType "Fire"
	States
	{
	Spawn:
		TNT1 A 0 
	Burning:
		TNT1 A 0 A_Warp(AAPTR_TRACER,0,0,1,0,WARPF_STOP|WARPF_NOCHECKPOSITION)
		TNT1 A 0 A_Explode(random(1,3),64,0,0,32)
		TNT1 A 0 A_SpawnItemEx("FlmThrwrSmoke5",random(-25,25),0,random(0,64),0,0,frandom(0.2,1.0),0,SXF_NOCHECKPOSITION,250)
		TNT1 AA 0 A_SpawnItemEx("FTFlameTrail2",random(-32,32),random(-32,32),random(0,64),0,0,frandom(0.5,2.0),0,SXF_NOCHECKPOSITION,248)
		TNT1 A 2 A_SetUserVar("user_burncount",user_burncount+1)
		TNT1 A 0 A_JumpIf(user_burncount>=random(50,60),1)
		Loop
		TNT1 A 0
		Stop
	}
}

//******************************************************
Actor DroppedShellSpawner
{
	Projectile
	+THRUACTORS
	-NOGRAVITY
	+BOUNCEONWALLS
	+BOUNCEONCEILINGS
	+NOTRIGGER
	Radius 4
	Height 4
	Scale 0.75
	States
	{
	Spawn:
		AESC A 1
		Loop
	Death:
		TNT1 A 0 A_SpawnItemEx("BDShells",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		Stop
	}
}

Actor MassChanger
{
	Projectile
	+NOCLIP
	+NOINTERACTION
	+SEEKERMISSILE
	+SCREENSEEKER
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SeekerMissile(1,1,1,256)
		TNT1 A 0 A_JumpIfTargetInLOS("Modding",160,JLOSF_PROJECTILE|JLOSF_DEADNOJUMP)
		Stop
	Modding:
		TNT1 A 0 A_JumpIfInventory("MassImmune",1,"End",AAPTR_TRACER)
		TNT1 A 1 A_GiveInventory("MassSwapper",1,AAPTR_TRACER)
		TNT1 A 1
		TNT1 A 1 A_GiveInventory("MassRestorer",1,AAPTR_TRACER)
		Stop
	End:
		TNT1 A 0
		Stop
	}
}

/*
Explanation: What I'm trying to do here is get the monster in the player's sights
to have his mass set low, then back up to it's original. This ignores targets that
have 200 or less already.

1. Give the swapper which will in turn give a checker that floods the inventory
of the target per each count of mass.
2. Set the mass of the monster to 200, and allow him to be blown about.
3. Give another swapper which then retransfers the original mass back via sheep
counting.
*/

Actor MassSwapper : CustomInventory
{
	+INVENTORY.ALWAYSPICKUP
	+INVENTORY.AUTOACTIVATE
	States
	{
	Use:
		TNT1 A 0 A_CheckFlag("NOCLIP","End")
		TNT1 A 0 A_JumpIf(mass<=199,"End")
		TNT1 A 0 A_JumpIf(mass>=99999999,"Overboard")
		TNT1 A 0 A_GiveInventory("MassCount",mass)
		TNT1 A 0 A_SetMass(200)
		Stop
	Overboard:
		TNT1 A 0 A_GiveInventory("MassCount",99999999)
		TNT1 A 0 A_SetMass(200)
		Stop
	End:
		TNT1 A 0
		Stop
	}
}

Actor MassCheck1 : CustomInventory
{
	+INVENTORY.ALWAYSPICKUP
	States
	{
	Pickup:
		TNT1 A 0 A_JumpIf(mass>=99999999,"Overboard")
		//TNT1 A 0 A_SpawnItemEx("DebugMessage1",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		//TNT1 A 0 A_PrintBold("Non-infinite")
		TNT1 A 0 A_GiveInventory("MassCount",mass)
		TNT1 A 0 A_SetMass(200)
		Stop
	Overboard:
		//TNT1 A 0 A_SpawnItemEx("DebugMessage2",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		//TNT1 A 0 A_PrintBold("Infinite number - Switching...")
		TNT1 A 0 A_GiveInventory("MassCount",99999999)
		TNT1 A 0 A_SetMass(200)
		Stop
	}
}

Actor MassRestorer : CustomInventory
{
	States
	{
	Pickup:
		TNT1 A 0 A_JumpIfInventory("MassCount",9999999,"InstaRestore") //Save the trouble.
	Specialty:
		TNT1 A 0 A_JumpIfInventory("MassCount",1000,"Mass1000")
		TNT1 A 0 A_JumpIfInventory("MassCount",100,"Mass100")
		TNT1 A 0 A_JumpIfInventory("MassCount",10,"Mass10")
		TNT1 A 0 A_JumpIfInventory("MassCount",1,"Mass1")
		Stop
	Mass1000:
		TNT1 A 0 A_TakeInventory("MassCount",1000)
		TNT1 A 0 A_SetMass(mass+1000)
		Loop
	Mass100:
		TNT1 A 0 A_TakeInventory("MassCount",100)
		TNT1 A 0 A_SetMass(mass+100)
		Loop
	Mass10:
		TNT1 A 0 A_TakeInventory("MassCount",10)
		TNT1 A 0 A_SetMass(mass+10)
		Loop
	Mass1:
		TNT1 A 0 A_TakeInventory("MassCount",1)
		TNT1 A 0 A_SetMass(mass+1)
		Loop
	InstaRestore:
		TNT1 A 0 A_TakeInventory("MassCount",9999999)
		TNT1 A 0 A_SetMass(9999999)
		Stop
	}
}

Actor MassCount : Inventory
{
	Inventory.Amount 1
	Inventory.MaxAmount 9999999
}

Actor BDHeatwaveFull : FastProjectile
{
	Projectile
	//+PAINLESS
	+THRUACTORS
	+BOUNCEONWALLS
	+BOUNCEONFLOORS
	+BOUNCEONCEILINGS
	+SKYEXPLODE
	+CANBOUNCEWATER
	+FORCERADIUSDMG
	+EXTREMEDEATH
	+NODAMAGETHRUST
	Radius 1
	Height 1
	Speed 60
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 1 
		TNT1 A 0 A_Explode(random(400,800),128,0,0,128)
		Stop
	}
}

Actor BDHeatWavePartial : BDHeatWaveFull
{
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 1
		TNT1 A 0 A_Explode(random(100,200),128,0,0,64)
		Stop
	}
}

Actor BDMuzzleFlash
{
  RenderStyle Add
  PROJECTILE
  Speed 2
  Damage 0
  Scale 0.15 //15
  +NOINTERACTION
  states
  {
  Spawn:
	MUZZ A 0
	MUZZ M 0 Bright A_Jump(256,"Spawn1","Spawn2","Spawn3","Spawn4","Spawn5","Spawn6")
	Spawn1:
		MUZ2 B 2 bright
		Stop
	Spawn2:
		MUZ2 B 2 bright
		Stop
	Spawn3:
		MUZ2 C 2 bright
		Stop
	Spawn4:
		MUZ2 D 2 bright
		Stop
	Spawn5:
		MUZ2 E 2 bright
		Stop
	Spawn6:
		MUZ2 F 2 bright
		Stop
	}
}

Actor BoneDusterClip : Ammo
{
	Inventory.Amount 1
	Inventory.MaxAmount 20
	Ammo.BackpackMaxAmount 20
	Inventory.Icon "IESCA0"
	+INVENTORY.IGNORESKILL
}

Actor MassImmune : Inventory
{
	Inventory.Amount 1
	Inventory.MaxAmount 1
}
//=====================================================================================
//=====================================================================================
//	StakeGun
// My favorite
// Primary shoots an stake that will traver quite fast, though falling down a bit in the
// process. Deals massive damage. After a while in the air, the stake gets on fire and
// deals more damage upon hitting something. Altfire is a weird grenade that deals a lot
// of explosive damage only. Doesnt reach far on purpose, so be aware.
// Slot 8
//=====================================================================================
//=====================================================================================
Actor AEoDStakeGunItem : CustomInventory
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	Scale 0.15
	Inventory.Amount 1
	Inventory.PickupMessage "You snapped up the Stake gun!"
	Inventory.PickupSound "weapons/stroggarmsaw/pickup"
	States
	{
	Spawn:
		D008 Z -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDStakeGun",1,"Ammo")
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("StakeGunDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDStakeGun",1)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDStakeGun",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDStakeGun",1)
		Stop
	}
}


Actor StakeGunDrop : CustomInventory
{
	Inventory.MaxAmount 1
	States
	{
	Use:
		TNT1 A 0
		TNT1 A 0 A_SpawnItemEx("DroppedStakeGun",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		Stop
	}
}


Actor DroppedStakeGun
{
	Radius 16
	Height 20
	Scale 0.15
	States
	{
	Spawn:
		D008 Z 15
		TNT1 A 0 A_SpawnItemEx("AEoDStakeGunNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
}

Actor AEoDStakeGunNoAmmo : AEoDStakeGunItem
{
	+INVENTORY.IGNORESKILL
	States
	{
	Spawn:
		D008 Z -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("ASTF",48,"Ammo")
		TNT1 A 0 A_JumpIfInventory("AEGrenade",10,"Ammo3")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("StakeGunDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDStakeGun",1)
		TNT1 A 0 A_TakeInventory("ASTF",48)
		TNT1 A 0 A_TakeInventory("AEGrenade",10)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDStakeGun",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_JumpIfInventory("AEGrenade",10,1)
		Goto Ammo2
		
		TNT1 A 0 A_TakeInventory("ASTF",48)
		TNT1 A 0 A_TakeInventory("AEGrenade",10)
		TNT1 A 0 A_JumpIfInventory("AEoDStakeGun",1,2)
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("StakeGunDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDStakeGun",1)
		Stop
	Ammo2:
		TNT1 A 0 A_TakeInventory("ASTF",48)
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("StakeGunDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDStakeGun",1)
		TNT1 A 0 A_TakeInventory("AEGrenade",10)
		Stop
	Ammo3:
		TNT1 A 0 A_TakeInventory("AEGrenade",10)
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("StakeGunDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDStakeGun",1)
		TNT1 A 0 A_TakeInventory("ASTF",48)
		Stop
	}
}

Actor AEoDStakeGun : Weapon
{
	+WEAPON.NOAUTOAIM
	Weapon.AmmoType "ASTF"
	Weapon.AmmoUse 5
	Weapon.AmmoGive 48
	Weapon.AmmoType2 "AEGrenade"
	Weapon.AmmoUse2 1
	Weapon.AmmoGive2 10
	Weapon.KickBack 500
	Weapon.SelectionOrder 11911
	Scale 0.15
	Inventory.PickupMessage "You snapped up the Stake gun!"
	Weapon.UpSound "weapons/draw"
	Tag "Stake Gun"
	States
	{
	Spawn:
		D008 Z -1
		Stop
	Ready:
		D008 K 1 A_WeaponReady
		Loop
	Deselect:
		TNT1 A 0 	
		D008 K 1 A_Lower
		TNT1 AA 0 A_Lower
		Loop
	Select:
		TNT1 A 0 	
		D008 K 1 A_Raise
		TNT1 AA 0 A_Raise
		Loop
	Fire:
		TNT1 A 0 A_PlaySound("painkiller/weapon/StakeGun/StakeShoot",6)
		TNT1 A 0 A_RailAttack(50,7,0,None,None,RGF_SILENT,0,"ZombieRidder",0,0,128)
		D008 A 0 A_FireCustomMissile("StakeGunStake",0,1,7)
		D008 A 1 A_SetPitch(pitch-4)
		D008 B 2
		D008 BBBBBBBB 1 A_SetPitch(pitch+0.5)
		D008 CCCCCCDD 1
		D008 D 3
		D008 EFGH 5
		D008 IJ 4
		Goto Ready
	AltFire:
		TNT1 A 0 A_PlaySound("painkiller/weapon/StakeGun/GrenadeShoot",6)
		TNT1 A 0 A_FireCustomMissile("StakeGGren",0,1,6)
		D008 L 3 A_SetPitch(pitch-6)
		TNT1 A 0 A_PlaySound("painkiller/weapon/StakeGun/GrenadeReload",5)
		D008 M 4
		D008 MMMNNN 1 A_SetPitch(pitch+1)
		D008 OK 4
		Goto Ready
	}
}

DamageType ZombieRipper
{
	Factor 0
}

Actor ZombieRidder
{
	Projectile
	+NOINTERACTION
	+BLOODLESSIMPACT
	+NOBLOOD
	+PUFFGETSOWNER
	+EXTREMEDEATH
	DamageType "ZombieRipper"
	DeathType "Extreme"
	Damage 50
	States
	{
	Spawn:
		TNT1 A 1
		Stop
	}
}

Actor StakeGunStake : FastProjectile
{
	var int user_onfire;
	var int user_count;
	var int user_crash;
	Projectile
	Speed 50
	Radius 8
	Height 8
	Scale 0.15
	Damage 130
	Alpha 0.7
	MissileType "StakeTrail"
	MissileHeight 8
	+DONTREFLECT
	+BLOODSPLATTER
	+HITTRACER
	+EXTREMEDEATH
	+RIPPER
	+NOTIMEFREEZE
	RipperLevel 0
	States
	{
	Spawn:
		D008 P 0 NoDelay A_ChangeFlag("FORCEPAIN",randompick(0,0,0,0,1))
	Normal:
		D008 P 1 A_Explode(30,24,0,0,24)
		D008 P 1 ThrustThingZ(0,-1,0,1)	TNT1 A 0 A_Explode(30,24,0,0,24)
		D008 P 1 A_Explode(30,24,0,0,24)
		D008 P 1 ThrustThingZ(0,-1,0,1)	TNT1 A 0 A_Explode(30,24,0,0,24)
		D008 P 1 A_Explode(30,24,0,0,24)
		D008 P 1 ThrustThingZ(0,-1,0,1)	TNT1 A 0 A_Explode(30,24,0,0,24)
		D008 P 1 A_Explode(30,24,0,0,24)
		D008 P 1 ThrustThingZ(0,-1,0,1)	TNT1 A 0 A_Explode(30,24,0,0,24)
		D008 P 1 A_Explode(30,24,0,0,24)
		D008 P 1 ThrustThingZ(0,-1,0,1)	TNT1 A 0 A_Explode(30,24,0,0,24)
		D008 P 1 A_Explode(30,24,0,0,24)
		D008 P 1 ThrustThingZ(0,-1,0,1)	TNT1 A 0 A_Explode(30,24,0,0,24)
		D008 P 1 A_Explode(30,24,0,0,24)
		TNT1 A 0 A_SetUserVar("user_onfire",1)
	InFire:
		D008 P 0 A_SpawnItemEx("StakeFireTrail",-2,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		D008 P 1 ThrustThingZ(0,-1,0,1) TNT1 A 0 A_Explode(30,24,0,0,24)
		D008 P 1 A_Explode(30,24,0,0,24)
		Loop
	Crash:
		TNT1 A 0 A_SetUserVar(user_crash,1)
	XDeath:
		TNT1 A 0 A_JumpIf(user_onfire == 0,2)
		TNT1 A 0 A_Explode(random(100,600),12,0,0,12)
		TNT1 A 0 A_JumpIf(user_crash == 0,"S2")
	S1:
		TNT1 A 0 A_PlaySound("painkiller/weapon/StakeGun/StakeCrash")
		Goto SC
	S2:
		TNT1 A 0 A_PlaySound("painkiller/weapon/StakeGun/StakeHitFlesh")
		Goto SC
	SC:
		TNT1 A 0 A_SpawnItemEx("StakeGunStakeStoke",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		Stop		
	Death:
		D008 P 300
		D008 P 3 A_FadeOut
		Wait
	}
}

Actor StakeGunStakeStoke
{
	var int user_angle[2];
	var int user_count;
	var int user_x;
	var int user_y;
	var int user_z;
	var int user_oldangle;
	Projectile
	Scale 0.15
	BounceFactor 0.4
	BounceType "Doom"
	+BOUNCEONWALLS
	+BOUNCEONCEILINGS
	+SEEKERMISSILE
	+THRUACTORS
	+NOTIMEFREEZE
	+NOEXPLODEFLOOR
	States
	{
	Spawn:
		TNT1 A 0 NoDelay A_JumpIf(IsPointerEqual(AAPTR_TRACER,AAPTR_NULL),"Dropout")
		TNT1 A 0 A_SetUserArray(user_angle,0,angle)
		TNT1 A 0 A_SetUserVar(user_z,z)
		TNT1 A 0 A_Warp(AAPTR_TRACER,0,0,0,0,WARPF_NOCHECKPOSITION)
		TNT1 A 0 A_SetUserArray(user_angle,1,angle)
		TNT1 A 0 A_SetUserVar(user_z,user_z-z)
		TNT1 A 0 A_Warp(AAPTR_TRACER,-15,0,user_z,user_angle[0]-user_angle[1],WARPF_NOCHECKPOSITION)
	Warping:
		D008 P 0 A_JumpIf(IsPointerEqual(AAPTR_TRACER,AAPTR_NULL),"Dropout")
		D008 P 0 A_JumpIfHealthLower(1,"DropOut",AAPTR_TRACER)
		D008 P 0 A_Warp(AAPTR_TRACER,-15,0,user_z,user_angle[0]-user_angle[1],WARPF_NOCHECKPOSITION|WARPF_INTERPOLATE)
		D008 P 1 A_SetUserVar("user_count",user_count+1)
		D008 P 0 A_JumpIf(user_count>=300,1)
		Loop
		D008 P 0 A_FadeOut(0.02)
		Loop
	Death:
	Dropout:
		D008 P 0 A_Gravity
		D008 P 1 A_SetUserVar("user_count",user_count+1)
		D008 P 0 A_JumpIf(user_count<=299,"Dropout")
		D008 P 0 A_FadeOut(0.02)
		Wait
		
	}
}
Actor StakeOnFireToken : Inventory {	Inventory.MaxAmount 1	}

Actor StakeFireTrail
{
	+NOINTERACTION
	Scale 0.2
	RenderStyle Add
	States
	{
	Spawn:
		XPLO ABCDEFGHIJKL 1 Bright A_FadeOut(0.03)
		Stop
	}
}

Actor StakeTrail
{
	+NOINTERACTION
	+NOTIMEFREEZE
	Scale 0.2
	RenderStyle Translucent
	Alpha 0.7
	States
	{
	Spawn:
		FX04 D 1 A_FadeOut(0.05)
		Wait
	}
}
	
//******************************************************************
Actor StakeGGren
{
	Projectile
	Radius 8
	Height 16
	Damage 0
	Scale 0.6
	-NoGravity
	Gravity 0.5
	Speed 35
	+BOUNCEONWALLS +BOUNCEONFLOORS +BOUNCEONCEILINGS +BOUNCEAUTOOFF //+ALLOWBOUNCEONACTORS
	+CANBOUNCEWATER
	+EXTREMEDEATH
	+FORCERADIUSDMG
	BounceSound "painkiller/weapon/StakeGun/GrenadeBounce"
	DeathSound "painkiller/weapon/StakeGun/GrenadeExplo"
	ReactionTime 14
	States
	{
	Spawn:
		GRNL A 2 A_CustomMissile("Q2RocketAltSmoke",2,0,0)
		TNT1 A 0 A_ScaleVelocity(0.90)
		GRNL A 2 A_CustomMissile("Q2RocketAltSmoke",2,0,0)
		TNT1 A 0 A_ScaleVelocity(0.90)
		TNT1 A 0 A_CountDown
		Loop
	Death:
		TNT1 A 0 A_Explode(random(256,384),128)	//because the projectile itself doesnt do damage
		TNT1 A 1 A_SpawnItemEx("NewExplosionMedium",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		Stop
	}
}

Actor StakeGrenTrail
{
	+NOINTERACTION
	Scale 0.45
	RenderStyle Translucent
	Alpha 0.6
	States
	{
	Spawn:
		SMK2 AABBCCDDEE 1 A_FadeOut(0.03)
		Wait
	}  
}
Actor StakeGrenTrail2
{
	+NOINTERACTION
	RenderStyle Add
	Alpha 0.6
	Scale 0.7
	States
	{
	Spawn:
		SMK2 ABCDE 2 BRIGHT
		Stop
	}  
}

//=====================================================================================
//=====================================================================================
//	SMG
// This one is a very strong rapid fire weapon. Though it fires streams of 5 bullets.
// Alt fire is a flamethrower. No magic there.
// Planned a trick like the Electrodriver, altfire then fire, will throw a rolling
// burning barrel, that will explode after a bit or if you shoot at it. 
// Slot 8
//=====================================================================================
//=====================================================================================
Actor AEoDPKSMGItem : CustomInventory
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	Scale 0.17
	Inventory.Amount 1
	Inventory.PickupMessage "You made off with a Flamethrower-SMG Hybrid! Holy crap!"
	Inventory.PickupSound "weapons/stroggarmsaw/pickup"
	States
	{
	Spawn:
		D007 Z -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDPKSMG",1,"Ammo")
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("PKSMGDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDPKSMG",1)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDPKSMG",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDPKSMG",1)
		Stop
	}
}


Actor PKSMGDrop : CustomInventory
{
	Inventory.MaxAmount 1
	States
	{
	Use:
		TNT1 A 0
		TNT1 A 0 A_SpawnItemEx("DroppedPKSMG",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		Stop
	}
}


Actor DroppedPKSMG
{
	Radius 16
	Height 20
	Scale 0.17
	States
	{
	Spawn:
		D007 Z 15
		TNT1 A 0 A_SpawnItemEx("AEoDPKSMGNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
} 


Actor AEoDPKSMGNoAmmo : AEoDPKSMGItem
{
+INVENTORY.IGNORESKILL
	Scale 0.17
	States
	{
	Spawn:
		D007 Z -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("AEClip",50,"Ammo")
		TNT1 A 0 A_JumpIfInventory("PlasmaRod",30,"Ammo3")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("PKSMGDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDPKSMG",1)
		TNT1 A 0 A_TakeInventory("AEClip",50)
		TNT1 A 0 A_TakeInventory("PlasmaRod",30)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDPKSMG",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_JumpIfInventory("PlasmaRod",30,1)
		Goto Ammo2
		
		TNT1 A 0 A_TakeInventory("AEClip",50)
		TNT1 A 0 A_TakeInventory("PlasmaRod",30)
		TNT1 A 0 A_JumpIfInventory("AEoDPKSMG",1,2)
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("PKSMGDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDPKSMG",1)
		Stop
	Ammo2:
		TNT1 A 0 A_TakeInventory("AEClip",50)
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("PKSMGDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDPKSMG",1)
		TNT1 A 0 A_TakeInventory("PlasmaRod",30)
		Stop
	Ammo3:
		TNT1 A 0 A_TakeInventory("PlasmaRod",30)
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("PKSMGDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDPKSMG",1)
		TNT1 A 0 A_TakeInventory("AEClip",50)
		Stop
	}
}





Actor AEoDPKSMG : Weapon
{
	Weapon.AmmoType "AEClip"
	Weapon.AmmoUse 3
	Weapon.AmmoGive 50
	Weapon.AmmoType2 "PlasmaRod"
	Weapon.AmmoUse2 1
	Weapon.AmmoGive2 30
	Weapon.SelectionOrder 7600
	AttackSound "painkiller/weapon/machinegun/BulletShoot"
	Weapon.UpSound "weapons/draw"
	Inventory.PickupMessage "You made off with a Flamethrower-SMG Hybrid! Holy crap!"
	Scale 0.17
	Tag "PK SMG"
	States
	{
	Spawn:
		D007 Z -1
		Stop
	Ready:
		D007 E 1 A_WeaponReady
		Loop
	Deselect:
		TNT1 A 0 	
		D007 E 1 A_Lower
		TNT1 AA 0 A_Lower
		Loop
	Select:
		TNT1 A 0 	
		D007 E 1 A_Raise
		TNT1 AA 0 A_Raise
		Loop
	Fire:
		D007 ED 3
	Hold:
		TNT1 A 0 A_FireCustomMissile("GunSmallSmokeSpawner",0,0,3,7)
		TNT1 A 0 A_FireCustomMissile("PistolCasingSpawner",-50,0, 0,0)
		TNT1 A 0 A_FireBullets(5,5,1,40,"BulletDamagePuff")
		D007 F 2 Bright A_SetPitch(pitch-0.8)
		D007 BC 1 A_SetPitch(pitch+0.4)
		TNT1 A 0 A_Refire("Hold1")
		Goto HoldEnd
	Hold1:
		TNT1 A 0 A_FireCustomMissile("GunSmallSmokeSpawner",0,0,3,7)
		TNT1 A 0 A_FireCustomMissile("PistolCasingSpawner",-50,0, 0,0)
		TNT1 A 0 A_FireBullets(3,3,1,40,"BulletDamagePuff")
		D007 G 2 Bright A_SetPitch(pitch-0.8)
		D007 BC 1 A_SetPitch(pitch+0.4)
		TNT1 A 0 A_Refire("Hold2")
		Goto HoldEnd
	Hold2:
		TNT1 A 0 A_FireCustomMissile("GunSmallSmokeSpawner",0,0,3,7)
		TNT1 A 0 A_FireCustomMissile("PistolCasingSpawner",-50,0, 0,0)
		TNT1 A 0 A_FireBullets(3,3,1,40,"BulletDamagePuff")
		D007 H 2 Bright A_SetPitch(pitch-0.8)
		D007 BC 1 A_SetPitch(pitch+0.4)
		TNT1 A 0 A_Refire("Hold3")
		Goto HoldEnd
	Hold3:
		TNT1 A 0 A_FireCustomMissile("GunSmallSmokeSpawner",0,0,3,7)
		TNT1 A 0 A_FireCustomMissile("PistolCasingSpawner",-50,0, 0,0)
		TNT1 A 0 A_FireBullets(3,3,1,40,"BulletDamagePuff")
		D007 F 2 Bright A_SetPitch(pitch-0.8)
		D007 BC 1 A_SetPitch(pitch+0.4)
		TNT1 A 0 A_Refire("Hold4")
		Goto HoldEnd
	Hold4:
		TNT1 A 0 A_FireCustomMissile("GunSmallSmokeSpawner",0,0,3,7)
		TNT1 A 0 A_FireCustomMissile("PistolCasingSpawner",-50,0, 0,0)
		TNT1 A 0 A_FireBullets(3,3,1,40,"BulletPuff")
		D007 G 2 Bright A_SetPitch(pitch-0.8)
		D007 BC 1 A_SetPitch(pitch+0.4)
		TNT1 A 0 A_Refire("Hold5")
		Goto HoldEnd
	Hold5:
		TNT1 A 0 A_FireCustomMissile("GunSmallSmokeSpawner",0,0,3,7)
		TNT1 A 0 A_FireCustomMissile("PistolCasingSpawner",-50,0, 0,0)
		TNT1 A 0 A_FireBullets(3,3,1,40,"BulletPuff")
		D007 H 2 Bright A_SetPitch(pitch-0.6)
		D007 BC 1 A_SetPitch(pitch+0.3)
		D007 C 9
		TNT1 A 0 A_Refire("Hold")
	HoldEnd:
		D007 CDE 4
		Goto Ready
	AltFire:
		D007 EDC 3
	AltHold:
		D007 C 2 A_FireCustomMissile("FTFire",0,1,random(1,4),1)
		TNT1 A 0 A_Refire
		Goto AltEnd
	AltEnd:
		D007 DE 5
		Goto Ready
		
	}
}

//=====================================================================================
//=====================================================================================
//	Bone Shotgun
// Primary fire shoots some bone shards. Meant to be projectiles to make it different
// than the regular shotgun. The trails of course is to show the trajectory as well as
// showing the fact they're projectiles. Needs some nice puff.
// Secondary is just one big shot that deals defile damage. It has an explosion to have
// it affecting other nearby monsters too. Lookwise? whatever will work, but uses dark
// mana because, well, is a big tool.
// Low Slot 8
// By DBThanatos
// Sprites and sounds ripped from Painkiller.
//=====================================================================================
//=====================================================================================
Actor AEoDBoneShotgunItem : CustomInventory
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	Scale 0.22
	Inventory.Amount 1
	Inventory.PickupMessage "You bagged off with the Bone shotgun... What in the world?"
	Inventory.PickupSound "weapons/stroggarmsaw/pickup"
	States
	{
	Spawn:
		D001 Z -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDBoneShotgun",1,"Ammo")
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("BoneShotgunDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDBoneShotgun",1)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDBoneShotgun",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDBoneShotgun",1)
		Stop
	}
}


Actor BoneShotgunDrop : CustomInventory
{
	Inventory.MaxAmount 1
	States
	{
	Use:
		TNT1 A 0
		TNT1 A 0 A_SpawnItemEx("DroppedBoneShotgun",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		Stop
	}
}


Actor DroppedBoneShotgun
{
	Radius 16
	Height 20
	Scale 0.2
	States
	{
	Spawn:
		D001 Z 15
		TNT1 A 0 A_SpawnItemEx("AEoDBoneShotgunNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
} 



Actor AEoDBoneShotgunNoAmmo : AEoDBoneShotgunItem
{
	+INVENTORY.IGNORESKILL
	States
	{
	Spawn:
		D001 Z -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("RedMana",30,"Ammo")
		TNT1 A 0 A_JumpIfInventory("DarkMana",5,"Ammo3")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("BoneShotgunDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDBoneShotgun",1)
		TNT1 A 0 A_TakeInventory("RedMana",30)
		TNT1 A 0 A_TakeInventory("DarkMana",5)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDBoneShotgun",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_JumpIfInventory("DarkMana",5,1)
		Goto Ammo2
		
		TNT1 A 0 A_TakeInventory("RedMana",30)
		TNT1 A 0 A_TakeInventory("DarkMana",5)
		TNT1 A 0 A_JumpIfInventory("AEoDBoneShotgun",1,2)
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("BoneShotgunDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDBoneShotgun",1)
		Stop
	Ammo2:
		TNT1 A 0 A_TakeInventory("RedMana",30)
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("BoneShotgunDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDBoneShotgun",1)
		TNT1 A 0 A_TakeInventory("DarkMana",5)
		Stop
	Ammo3:
		TNT1 A 0 A_TakeInventory("DarkMana",5)
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("BoneShotgunDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDBoneShotgun",1)
		TNT1 A 0 A_TakeInventory("RedMana",30)
		Stop
	}
}

Actor AEoDBoneShotgun : Weapon
{
	Weapon.AmmoType "RedMana"
	Weapon.AmmoUse 6
	Weapon.AmmoGive 30
	Weapon.AmmoType2 "DarkMana"
	Weapon.AmmoUse2 5
	Weapon.AmmoGive2 5
	Weapon.SelectionOrder 7800
	Scale 0.22
	Inventory.PickupMessage "You bagged off with the Bone shotgun... What in the world?"
	Weapon.UpSound "weapons/draw"
	Tag "Bone shotgun"
	States
	{
	Spawn:
		D001 Z -1
		Stop
	Ready:
		D001 E 1 A_WeaponReady
		Loop
	Deselect:
		TNT1 A 0 	
		D001 E 1 A_Lower
		TNT1 AA 0 A_Lower
		Loop
	Select:
		TNT1 A 0 	
		D001 E 1 A_Raise
		TNT1 AA 0 A_Raise
		Loop
	Fire:
		TNT1 A 0 A_PlayWeaponSound("painkiller/weapon/boneshotgun/Fire")
		TNT1 A 0 A_FireCustomMissile("MuzzleFlashOrange",0,0,5,7)
		TNT1 A 0 A_FireCustomMissile("BoneShotgunShard",random(8,-8),1,5)
		TNT1 AAAA 0 A_FireCustomMissile("BoneShotgunShard",random(8,-8),0,5)
		TNT1 AAAAA 0 A_FireCustomMissile("BoneShotgunShard",random(8,-8),0,7)
		TNT1 A 0 A_SetBlend("66 10 10", .5, 8)
		D001 K 1 Bright A_SetPitch(pitch-6)
		D001 K 1 Bright
		D001 B 2
		D001 BBBBBBBBCC 1 A_SetPitch(pitch+0.6)
		D001 C 3
		D001 D 5
		D001 E 10
		Goto Ready
	AltFire:
		TNT1 A 0 A_PlayWeaponSound("painkiller/weapon/boneshotgun/AltFire")
		TNT1 A 0 A_FireCustomMissile("MuzzleFlashGreen",0,0,4,7)
		TNT1 A 0 A_FireCustomMissile("BoneShotgunDefiler",0,1,5)
		TNT1 A 0 A_SetBlend("4F 56 02", .8, 20)
		D001 F 3 A_SetPitch(pitch+8)
		D001 GGHHHHHH 2 A_SetPitch(pitch-1.0)
		D001 HHIJ 3
		Goto Ready
	}
}
//*************************************************
Actor BoneShotgunShard : FastProjectile
{
	Projectile
	Speed 90
	Damage (random(2,6)*12)
	Radius 3
	Height 4
	Scale 0.2
	MissileType "BSGShardTrail"
	MissileHeight 8
	+BLOODSPLATTER
	States
	{
	Spawn:
		RFX1 P 0
		RFX1 P 1 Bright ThrustThingZ(0,random(7,-7),0,1)
		RFX1 P 3 Bright
		Wait
	XDeath:
		Goto Crash+3 //to spawn a few of the shards
	Death:
	Crash:
		TNT1 A 0 A_Jump(200,"AfterSound")
		TNT1 A 0 A_PlaySound("painkiller/weapon/boneshotgun/randomcrack",6,0.6)
	AfterSound:
		TNT1 A 0 A_SpawnItemEx("TT5",1,0,0,0,0,frandom(0.1,0.3),random(0,359),SXF_NOCHECKPOSITION)
		TNT1 AAAAA 0 A_SpawnItemEx("BSGShardPiece",0,0,0,frandom(5.0,-5.0),frandom(5.0,-5.0),frandom(0,5.0),0,0)
		TNT1 A 1
		Stop
	}
}

Actor BSGShardTrail
{
	+NOINTERACTION
	Scale 0.12
	RenderStyle Translucent
	Alpha 0.7
	States
	{
	Spawn:
		FX04 D 1 Bright A_FadeOut(0.05)
		Wait
	}
}

Actor BSGShardPiece
{
	Translation "80:111=144:151"
	Scale 0.44
	Projectile
	Radius 2
	Height 2
	Speed 0
	Damage 3
	BounceType "Doom"
	BounceFactor 0.6
	-NOGRAVITY
	+DONTSPLASH
	Gravity 0.6
	States
	{
	Spawn:
		ICPR RRRRRR 1 Bright A_SpawnItemEx("BSGShardTrailSmaller",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_Jump(64,"FadeOut")
		Loop
	FadeOut:
		ICPR RRR 1 Bright A_SpawnItemEx("BSGShardTrailSmaller",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		ICPR R 0 A_FadeOut(0.1)
		Loop
	Death:
		ICPR R 1 Bright
		Stop
	}
}

Actor BSGShardTrailSmaller : BSGShardTrail
{	Scale 0.07	}

//*************************************************************
Actor BoneShotgunDefiler
{
	Projectile
	Speed 22
	Damage 15
	Radius 8
	Height 10
	DamageType "Defile"
	Translation "0:255=%[0.0,0.0,0.0]:[0.74,0.88,0.2]"
	RenderStyle Add
	Scale 0.8
	Alpha 0.67
	States
	{
	Spawn:
		ANFB A 1 Bright A_SpawnItemEx("BSGDefTrail",random(-1,-7),random(8,-8),random(2,-5),0,0,0,0,SXF_NOCHECKPOSITION)		TNT1 A 0 A_Explode(1,80,0,0,80)
		ANFB A 1 Bright A_SpawnItemEx("BSGDefTrail",random(-1,-7),random(8,-8),random(2,-5),0,0,0,0,SXF_NOCHECKPOSITION)		TNT1 A 0 A_Explode(1,80,0,0,80)
		ANFB B 1 Bright A_SpawnItemEx("BSGDefTrail",random(-1,-7),random(8,-8),random(2,-5),0,0,0,0,SXF_NOCHECKPOSITION)		TNT1 A 0 A_Explode(1,80,0,0,80)
		ANFB B 1 Bright A_SpawnItemEx("BSGDefTrail",random(-1,-7),random(8,-8),random(2,-5),0,0,0,0,SXF_NOCHECKPOSITION)		TNT1 A 0 A_Explode(1,80,0,0,80)
		ANFB C 1 Bright A_SpawnItemEx("BSGDefTrail",random(-1,-7),random(8,-8),random(2,-5),0,0,0,0,SXF_NOCHECKPOSITION)		TNT1 A 0 A_Explode(1,80,0,0,80)
		ANFB C 1 Bright A_SpawnItemEx("BSGDefTrail",random(-1,-7),random(8,-8),random(2,-5),0,0,0,0,SXF_NOCHECKPOSITION)		TNT1 A 0 A_Explode(1,80,0,0,80)
		Loop
	Death:
		TNT1 A 0 A_Explode(64,64)
		TNT1 AAAAAAAAAAAAAAAAAA 0 A_SpawnItemEx("PulseGrenadeExploParticle",0,0,0,frandom(0.5,2.8),0,frandom(2.5,-2.5),random(0,359),SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION) //see WepClass7.AED
		TNT1 AAAAAAAAA 0 A_SpawnItemEx("BSSpitExtra",0,0,0,random(1,-1),random(1,-1),random(0,4),0,SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION)
		ANFB D 4 Light("OliveGreenMediumFlicker1") Bright
		ANFB E 4 Light("OliveGreenMediumFlicker2") Bright
		ANFB F 4 Light("OliveGreenMediumFlicker3")Bright
		ANFB G 4 Light("OliveGreenSmallFlicker1")Bright
		Stop
	}
}




Actor BSGDefTrail
{
	+NOINTERACTION
	States
	{
	Spawn:
		TNT1 A 0 
		TNT1 AA 0 A_SpawnItemEx("BoneShotgunDefileTrail",random(5,-5),random(5,-5),random(5,-5),0,0,frandom(0.2,0.7),0,SXF_NOCHECKPOSITION)
		TNT1 AA 0 A_SpawnItemEx("BSGDDrop",0,random(5,-5),random(0,7),-0.02,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 1
		Stop
	}
}


Actor BoneShotgunDefileTrail
{
	+NOINTERACTION
	RenderStyle Add
	Scale 0.03
	Translation "0:255=%[0.0,0.0,0.0]:[0.74,0.88,0.2]"
	States
	{
	Spawn:
		TNT1 A 0 
		TNT1 A 0 A_Jump(256,"Type1","Type2")
	Type1:
		TNT1 A 0 A_SetScale(0.05)
		TNT1 A 0 A_Jump(250,2,4,6,8,10,12,14,16,18,20,22)
		X101 A 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		X101 B 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		X101 C 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		X101 D 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		X101 E 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		X101 F 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		X101 G 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		X101 H 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		X101 I 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		X101 J 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		X101 K 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		X101 L 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		X101 M 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		X101 N 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		X101 O 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		X101 P 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		Goto Type1+2
	Type2:
		TNT1 A 0 A_SetScale(0.055)
		TNT1 A 0 A_Jump(250,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38)
		X102 A 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		X102 B 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		X102 C 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		X102 D 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		X102 E 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		X102 F 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		X102 G 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		X102 H 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		X102 I 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		X102 J 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		X102 K 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		X102 L 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		X102 M 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		X102 N 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		X102 O 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		X102 P 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		X102 Q 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		X102 R 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		X102 S 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		X102 T 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		X102 U 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		X102 V 1 Bright A_FadeOut(0.032)	TNT1 A 0 A_SetScale(scalex+0.01,scaley+0.01)
		Goto Type2+2
	}
}

Actor BSGDDrop
{
	Projectile
	Speed 0
	Damage 0
	Radius 2
	Height 3
	-NOGRAVITY
	Translation "112:127=152:159"
	RenderStyle Add
	Scale 0.3
	+DONTSPLASH
	States
	{
	Spawn:
		FX20 A 3 Bright
		Wait
	Death:
		Fx20 BCDEF 3 Bright
		Stop
	}
}

Actor BSGDefExpFx
{
	+NOINTERACTION
	Translation "0:255=%[0.0,0.0,0.0]:[0.71,0.81,0.36]"
	Scale 0.7
	RenderStyle Translucent 
	Alpha 0.67
	States
	{
	Spawn:
		FX59 ABCDEF 2 Bright
		Stop
	}
}

Actor BSGDefExpFx2 : BSGDefExpFx
{
	States
	{
	Spawn:
		FX60 ABCDEFGHIJKLMN 1 Bright
		Stop
	}
}




//==============================================================================
//==============================================================================
//									Gut Flinger
//==============================================================================
//==============================================================================
Actor AEoDGutFlingerItem : CustomInventory 
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	Inventory.Amount 1
	Inventory.PickupMessage "You got the Gut Flinger! They look hungry. Feed them what they deserve!" 
	Inventory.PickupSound "misc/w_pkup" 
	States
	{
	Spawn:
		M005 F -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDGutFlinger",1,"Ammo")
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("GutFlingerDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDGutFlinger",1)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDGutFlinger",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDGutFlinger",1)
		Stop
	}
}

Actor GutFlingerDrop : CustomInventory
{
	Inventory.MaxAmount 1
	States
	{
	Use:
		TNT1 A 0
		TNT1 A 0 A_SpawnItemEx("DroppedGutFlinger",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		Stop
	}
}

Actor DroppedGutFlinger
{
	Radius 16
	Height 20
	States
	{
	Spawn:
		M005 F 15
		TNT1 A 0 A_SpawnItemEx("AEoDGutFlingerNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
}

Actor AEoDGutFlingerNoAmmo : AEoDGutFlingerItem
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	Inventory.Amount 1
	Inventory.PickupMessage "You got the Gut Flinger! They look hungry. Feed them what they deserve!" 
	Inventory.PickupSound "misc/w_pkup" 
	States
	{
	Spawn:
		M005 F -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("ASTF",20,"Ammo")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("GutFlingerDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDGutFlinger",1)
		TNT1 A 0 A_TakeInventory("ASTF",20)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDGutFlinger",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_TakeInventory("ASTF",20)
		TNT1 A 0 A_JumpIfInventory("AEoDGutFlinger",1,2)
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("GutFlingerDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDGutFlinger",1)
		Stop
	}
}

Actor AEoDGutFlinger : Weapon
{
	Weapon.SelectionOrder 1150
	Inventory.PickupSound "misc/w_pkup" 
	Weapon.AmmoType1 "ASTF" 
	Weapon.AmmoType2 "ASTF" 
	Weapon.AmmoGive 20
	Weapon.AmmoUse1 1
	Weapon.AmmoUse2 5
	Weapon.SelectionOrder 9050
	Inventory.PickupMessage "You got the Gut Flinger! They look hungry. Feed them what they deserve!" 
	AttackSound "" 
	Weapon.UpSound "weapons/draw"
	Scale 1
	Tag "Gut Flinger"
	States 
	{ 
	Spawn: 
		M005 F -1 
		Loop 
	Ready: 
		M005 A 1 A_WeaponReady 
		Loop 
	Deselect: 
		TNT1 A 0 	
		M005 A 1 A_Lower 
		M005 AA 0 A_Lower 
		Loop 
	Select: 
		TNT1 A 0 	
		M005 A 1 A_Raise 
		M005 AA 0 A_Raise 
		Loop
	Fire:
		M005 B 0 A_PlaySound("GUTFIRE")
		M005 B 0 A_FireBullets(2,2,3,9,"HTCGibBullet",1)
		M005 B 1 A_SetPitch(pitch-1)
		M005 A 1 A_SetPitch(pitch+1)
		M005 B 0 A_PlaySound("GUTFIRE")
		M005 B 0 A_FireBullets(2,2,3,9,"HTCGibBullet",1)
		M005 B 1 A_SetPitch(pitch-1)
		M005 A 1 A_SetPitch(pitch+1)
		M005 B 0 A_PlaySound("GUTFIRE")
		M005 B 0 A_FireBullets(2,2,3,9,"HTCGibBullet",1)
		M005 C 1 A_SetPitch(pitch-1)
		M005 D 1 A_SetPitch(pitch+1)
		M005 EEEDDCCBB 1
		Goto Ready
	AltFire: 
		M005 B 0 A_PlaySound("GUTFIRE") 
		M005 B 0 A_FireCustomMissile("HTCGib",2,1,8,-3)
		M005 B 1 A_SetPitch(pitch-4)
		M005 EEED 1 A_SetPitch(pitch+1)
		M005 D 2
		M005 CB 3
		Goto Ready
		
		M005 E 0
		Goto Deselect
	} 
}

Actor HTCGibBullet
{
	Projectile
	+PUFFGETSOWNER
	+NOBLOCKMAP
	+NOINTERACTION
	+PUFFONACTORS
	+ALWAYSPUFF
	+BLOODSPLATTER
	+EXTREMEDEATH
	+FORCERADIUSDMG
	Radius 4
	Height 4
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_Explode(random(1,5),64,0)
		TNT1 A 0 A_FaceTarget
		TNT1 A 0 A_SpawnItemEx("Blood",0,0,0,2,0,0,0,SXF_NOCHECKPOSITION)
		Stop
	XDeath:
		TNT1 A 0
		TNT1 A 0 A_Explode(random(1,5),64,0)
		TNT1 A 0 A_FaceTarget
		TNT1 A 0 A_SpawnItemEx("Blood",0,0,0,2,0,0,0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_Jump(192,4)
		TNT1 A 0 A_Jump(64,1)
		TNT1 AA 0 A_TossGib
		TNT1 A 0
		Stop
	Crash:
		TNT1 A 0
		TNT1 A 0 A_Explode(random(1,5),64,0)
		TNT1 A 0 A_SpawnItemEx("Blood",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		Stop
	}
}

Actor HTCGib
{
	Projectile
	+SEEKERMISSILE
	+DONTREFLECT
	+FORCERADIUSDMG
	+EXTREMEDEATH
	-NOGRAVITY
	+BOUNCEONWALLS
	WallBounceFactor 1
	Gravity 0.65
	Scale 0.34
	Damage 15
	Speed 30
	Radius 6
	Height 10
	States
	{
	Spawn:
		Q99B A 0
		Q99B A 0 A_ChangeVelocity(0,0,2,1)
		Q99B BBCCDDEEFFGGHHIIJJKKLLMMNN 1 A_SpawnItemEx("Blood",0,0,0,0,0,1,0,SXF_NOCHECKPOSITION)
		Loop
	Death:
		TNT1 A 0 A_SpawnItemEx("FlingerGibExplosion",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS,0,19999)
		TNT1 A 0 A_Explode(random(150,350),256,0)
		Stop
	}
}

Actor FlingerGibExplosion
{
	var int user_t;
	Projectile
	+NOINTERACTION
	RenderStyle Add
	Scale 0.85
	Alpha 0.99
	Translation "0:255=%[0,0,0]:[1,0,0]"
	States
	{
	Spawn:
		TNT1 A 0 NoDelay A_SetUserVar(user_t,tid)
		TNT1 A 0 Thing_ChangeTID(0,0)
		TNT1 AAAAA 0 A_SpawnItemEx("BloodMyst",0,0,0,frandom(0.2,5),0,frandom(0.2,5),random(0,359),SXF_NOCHECKPOSITION)
		TNT1 AAAAAAAAAA 0 A_SpawnItemEx("BloodMyst",0,0,0,frandom(0.2,5),0,frandom(0.2,5),random(0,359),SXF_NOCHECKPOSITION,128)
		TNT1 A 0 A_CheckFloor("FloorExplo")
	NormalExplo:
		TNT1 AA 0 A_SpawnItemEx("GibDropper",0,0,random(-10,10),0,0,0,0,SXF_NOCHECKPOSITION,0,user_t)
		TNT1 AAAA 0 A_SpawnItemEx("GibDropper",0,0,random(-10,10),0,0,0,0,SXF_NOCHECKPOSITION,64,user_t)
		TNT1 A 0 A_PlaySound("other/gibdeath")
		X116 ABCDEFGHIJKLMNOP 1 Bright A_FadeOut(0.01)
		X116 QRSTUVWXYZ 1 Bright A_FadeOut(0.03)
		X116 Z 1 Bright A_FadeOut(0.05)
		Wait
	FloorExplo:
		TNT1 AA 0 A_SpawnItemEx("GibDropper",0,0,random(10,40),0,0,0,0,SXF_NOCHECKPOSITION,0,user_t)
		TNT1 AAAA 0 A_SpawnItemEx("GibDropper",0,0,random(10,40),0,0,0,0,SXF_NOCHECKPOSITION,64,user_t)
		X106 ACEGIKMOQSUWY 1 bright
		X107 BDFHJLN 1 bright
		X107 PQRSTUV 1 Bright A_FadeOut(0.03)
		X107 V 1 Bright A_FadeOut(0.05)
		Wait
	}
}

Actor BloodMyst
{
	var int user_count;
	+NOINTERACTION
	RenderStyle Add
	Alpha 0
	Scale 0.5
	Translation "0:255=%[0,0,0]:[1,0,0]"
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SetScale(frandom(0.40,1.30))
		TNT1 A 0 A_SetScale(ScaleX*randompick(-1,1),ScaleY*randompick(-1,1))
		TNT1 A 0 A_FadeTo((0.99),frandom(0.30,0.99),0)
		TNT1 A 0 A_Jump(256,"Forward","Backward")
	Forward:
		X108 ABCDEFGHIJKLMNOPQRSTUVWX 1 A_ScaleVelocity(0.95)
		X108 ABCDEFGHIJKLMNOPQRSTUVWX 1 A_ScaleVelocity(0.95)
		X108 A 0 A_Stop
	ForwardLoop:
		X108 ABCDEFGHIJKLMNOPQRSTUVWX 1 A_SetUserVar("user_count",user_count+random(0,2))
		X108 A 0 A_JumpIf(user_count>=random(10,300),1)
		Loop
	ForwardFade:
		X108 ABCDEFGHIJKLMNOPQRSTUVWX 1 A_FadeOut(0.02)
		Loop
	Backward:
		X108 XWVUTSRQPONMLKJIHGFEDCBA 1 A_ScaleVelocity(0.95)
		X108 XWVUTSRQPONMLKJIHGFEDCBA 1 A_ScaleVelocity(0.95)
		X108 A 0 A_Stop
	BackwardLoop:
		X108 XWVUTSRQPONMLKJIHGFEDCBA 1 A_SetUserVar("user_count",user_count+random(1,5))
		X108 A 0 A_JumpIf(user_count>=random(10,400),1)
		Loop
	BackwardFade:
		X108 XWVUTSRQPONMLKJIHGFEDCBA 1 A_FadeOut(0.02)
		Loop
	}
}


//======================================================================================
//======================================================================================

//======================================================================================
//======================================================================================
Actor AEoDFlailGunItem : CustomInventory
{
	+FLOORCLIP
	+INVENTORY.IGNORESKILL
	Scale 0.2
	Inventory.Amount 1
	Inventory.PickupMessage "You grabbed the Flail Gun! Tag em and bag em, boys!"
	Inventory.PickupSound "BS/Flailgun/Pickup"
	States
	{
	Spawn:
		D013 P -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIfInventory("AEoDFlailGun",1,"Ammo")
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("FlailGunDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDFlailGun",1)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDFlailGun",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_GiveInventory("AEoDFlailGun",1)
		Stop
	}
}


Actor FlailGunDrop : CustomInventory
{
	Inventory.MaxAmount 1
	States
	{
	Use:
		TNT1 A 0
		TNT1 A 0 A_SpawnItemEx("DroppedFlailGun",0,0,32,8,0,0,0,SXF_NOCHECKPOSITION,0)
		Stop
	}
}


Actor DroppedFlailGun
{
	Radius 16
	Height 20
	Scale 0.2
	States
	{
	Spawn:
		D013 P 15
		TNT1 A 0 A_SpawnItemEx("AEoDFlailGunNoAmmo",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER,0)
		Stop
	}
} 



Actor AEoDFlailGunNoAmmo : AEoDFlailGunItem
{
	+INVENTORY.IGNORESKILL
	States
	{
	Spawn:
		D013 P -1
		Loop
	Pickup:
		TNT1 A 0 A_JumpIf(CallACS("WeaponSlotLimitCheck",8) <= 0,"Nothing")
		TNT1 A 0 A_JumpIfInventory("AEGrenade",5,"Ammo")
		TNT1 A 0 A_JumpIfInventory("ASTF",15,"Ammo3")
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("FlailGunDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDFlailGun",1)
		TNT1 A 0 A_TakeInventory("AEGrenade",5)
		TNT1 A 0 A_TakeInventory("ASTF",15)
		TNT1 A 0 	
		Stop
	Nothing:
		TNT1 A 0 A_JumpIfInventory("AEoDFlailGun",1,"Ammo")
		TNT1 A 0 A_JumpIfInventory("LimitScriptActive",1,1)
		Goto Pickup+2
		
		TNT1 A 0 ACS_NamedExecute("s798",0,8,0,0)
		Fail
	Ammo:
		TNT1 A 0 A_JumpIfInventory("ASTF",15,1)
		Goto Ammo2
		
		TNT1 A 0 A_TakeInventory("AEGrenade",5)
		TNT1 A 0 A_TakeInventory("ASTF",15)
		TNT1 A 0 A_JumpIfInventory("AEoDFlailGun",1,2)
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("FlailGunDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDFlailGun",1)
		Stop
	Ammo2:
		TNT1 A 0 A_TakeInventory("AEGrenade",5)
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("FlailGunDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDFlailGun",1)
		TNT1 A 0 A_TakeInventory("ASTF",15)
		Stop
	Ammo3:
		TNT1 A 0 A_TakeInventory("ASTF",15)
		TNT1 A 0 A_GiveInventory("Weapon8Count",1)
		TNT1 A 0 A_GiveInventory("FlailGunDrop",1)
		TNT1 A 0 A_GiveInventory("AEoDFlailGun",1)
		TNT1 A 0 A_TakeInventory("AEGrenade",5)
		Stop
	}
}



Actor AEoDFlailGun : weapon
{
	+WEAPON.AMMO_OPTIONAL
	+WEAPON.ALT_AMMO_OPTIONAL
	+WEAPON.PRIMARY_USES_BOTH
	+WEAPON.ALT_USES_BOTH
	Weapon.AmmoType1 "AEGrenade"
	Weapon.AmmoType2 "ASTF"
	Weapon.AmmoUse1 5
	Weapon.AmmoUse2 15
	Weapon.AmmoGive1 5
	Weapon.AmmoGive2 15
	Weapon.SelectionOrder 13200
	Inventory.PickupMessage "You grabbed the Flail Gun! Tag em and bag em, boys!"
	Inventory.PickupSound "BS/Flailgun/Pickup"
	Weapon.UpSound "BS/Flailgun/Raise"
	Tag "Flail gun"
	Scale 0.2
	States
	{
	Spawn: 
		D013 P -1
		Loop
	Ready:
		D013 A 0 A_JumpIfInventory("FlailToken",1,"ReadyToFlailOut")
		D013 A 1 A_WeaponReady
		Loop
	ReadyToFlailOut:
		D013 HIJ 2
		Goto ReadyFlailOut
	Select:
		D013 A 0 	
		D013 A 1 A_Raise
		D013 AA 0 A_Raise
		Loop
	Deselect:
		"####" "#" 0 A_PlaySound("BS/FlailGun/Lower",5,1,0)
	Deselecting:
		"####" "#" 0 	
		"####" "#" 1 A_Lower
		"####" "##" 0 A_Lower
		Loop
	Fire:
		D013 A 0 A_JumpIfInventory("FlailToken",1,"FlailDetonate")
		D013 A 0 A_JumpIfInventory("InfiniteAmmo",1,"SuccessfulPrimary")
		D013 A 0 A_JumpIfInventory("PowerEconomizer",1,"SuccessfulPrimary")
	CheckAmmoPrimary:
		D013 A 0 A_JumpIfInventory("ASTF",15,3)
		D013 A 0 A_PlaySound("rgp/no",CHAN_WEAPON,1,0)
		D013 A 1 A_WeaponReady(WRF_NOFIRE)
		Goto Ready
		
		D013 A 0 A_JumpIfInventory("AEGrenade",5,3)
		D013 A 0 A_PlaySound("rgp/no",CHAN_WEAPON,1,0)
		D013 A 1 A_WeaponReady(WRF_NOFIRE)
		Goto Ready
		
		D013 A 0 A_TakeInventory("ASTF",15,1)
		D013 A 0 A_TakeInventory("AEGrenade",5,1)
		Goto SuccessfulPrimary
	SuccessfulPrimary:
		D013 A 0 A_GiveInventory("FlailToken",1)
		D013 A 0 A_GunFlash
		D013 A 0 A_PlaySound("BS/FlailGun/Fire",CHAN_WEAPON,1,0)
		TNT1 AAAA 0 A_FireCustomMissile("GunSmokeSpawner",0,0,random(4,6),8)
		D013 A 0 A_FireCustomMissile("FlailMidPieceFlying",0,0,0)
		D013 KLM 1 Bright bright A_SetPitch(pitch-2)
		D013 NO 1 bright
		D013 CCCCCC 1 A_SetPitch(pitch+1)
		D013 CDDDDEEEE 1 
		D013 F 4
		D013 G 1
	ReadyFlailOut:
		D013 G 1 A_WeaponReady(WRF_NOSECONDARY|WRF_NOBOB)
		D013 G 0 A_JumpIfInventory("FlailToken",1,"ReadyFlailOut")
	FlailDetonate:
		D013 H 0 A_TakeInventory("FlailToken",1000,0)
		D013 HIJ 4
		Goto Ready
	AltFire:
		D013 A 0 A_JumpIfInventory("InfiniteAmmo",1,"SuccessfulSecondary")
		D013 A 0 A_JumpIfInventory("PowerEconomizer",1,"SuccessfulSecondary")
	CheckAmmoSecondary:
		D013 A 0 A_JumpIfInventory("ASTF",15,3)
		D013 A 0 A_PlaySound("rgp/no",CHAN_WEAPON,1,0)
		D013 A 10 A_WeaponReady(WRF_NOFIRE)
		Goto Ready
		
		D013 A 0 A_JumpIfInventory("AEGrenade",5,3)
		D013 A 0 A_PlaySound("rgp/no",CHAN_WEAPON,1,0)
		D013 A 10 A_WeaponReady(WRF_NOFIRE)
		Goto Ready
		
		D013 A 0 A_TakeInventory("ASTF",15,1)
		D013 A 0 A_TakeInventory("AEGrenade",5,1)
		Goto SuccessfulSecondary
	SuccessfulSecondary:
		D013 A 0 A_GunFlash
		D013 A 0 A_PlaySound("BS/FlailGun/Fire",CHAN_WEAPON,1,0)
		TNT1 AAAA 0 A_FireCustomMissile("GunSmokeSpawner",0,0,random(4,6),8)
		D013 A 0 A_FireCustomMissile("SuperFlail",0,0,0)
		D013 KLM 1 Bright A_SetPitch(pitch-3)
		D013 NO 1 bright
		D013 CCC 2
		D013 CDDDDEEEE 1 A_SetPitch(pitch+1)
		D013 FIJ 4
		Goto Ready
	Flash:
		D013 BC 3
		Stop

	}
}

Actor FlailMidPieceFlying
{
	var int user_timer;
	var int user_count;
	Projectile
	+DONTREFLECT
	-NOGRAVITY
	+SEEKERMISSILE
	+SCREENSEEKER
	+EXPLODEONWATER
	+THRUACTORS
	Gravity 0.085
	Speed 25
	Damage 0
	Radius 5
	Height 8
	Scale 0.1
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SpawnItemEx("FlailBombFlying",0,-8,0,velx,vely,velz,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS|SXF_ABSOLUTEMOMENTUM)
		TNT1 A 0 A_SetUserVar("user_count",user_count+1)
		TNT1 A 0 A_SpawnItemEx("FlailBombFlying",0,8,0,velx,vely,velz,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS|SXF_ABSOLUTEMOMENTUM)
		TNT1 A 0 A_SetUserVar("user_count",user_count+1)
		TNT1 A 0 A_ChangeFlag("THRUACTORS",0)
	Movement:
		ASPK A 1
		PLSS A 0 A_JumpIfInventory("FlailToken",1,"Movement",AAPTR_TARGET)
	Explode:
		PLSS A 0 A_ChangeFlag("NOINTERACTION",1)
		PLSS A 0 A_Stop
		PLSS A 0 A_TakeInventory("FlailToken",100,0,AAPTR_TARGET)
		PLSS A 0 A_TakeInventory("FlailLand",100,0,AAPTR_TARGET)
		PLSS A 0 A_TakeInventory("FlailOnEnemy",100,0,AAPTR_TARGET)
		Stop
	Death:
		PLSS A 0 A_Stop
		PLSS A 0 A_NoGravity
		PLSS A 0 A_ChangeFlag("NOINTERACTION",1)
		PLSS A 0 A_GiveInventory("FlailLand",1,AAPTR_TARGET)
		TNT1 A 0 A_JumpIf(user_count>=1,2)
		TNT1 A 0 A_SpawnItemEx("FlailBombFlying",0,-8,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		TNT1 A 0 A_JumpIf(user_count>=2,2)
		TNT1 A 0 A_SpawnItemEx("FlailBombFlying",0,8,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
	Waiting:
		ASPK A 1 A_SetUserVar("user_timer",user_timer+1)
		ASPK A 0 A_JumpIf(user_timer>=(35*5),"Explode")
		PLSS A 0 A_JumpIfInventory("FlailToken",1,"Waiting",AAPTR_TARGET)
		Goto Explode
	Crash:
	XDeath:
		PLSS A 0 A_SeekerMissile(90,90,3,256)
		PLSS A 0 A_Warp(AAPTR_TRACER,0,0,z-floorz,0,WARPF_TOFLOOR|WARPF_NOCHECKPOSITION)
		PLSS A 0 A_GiveInventory("FlailOnEnemy",1,AAPTR_TARGET)
		PLSS A 0 A_SpawnItemEx("FlailBombLeft",0,-4,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		PLSS A 1 A_SpawnItemEx("FlailBombRight",0,4,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		Stop
	}
}

Actor FlailBombLeft
{
	var int user_count;
	var int user_timer;
	var int user_z[3];
	Projectile
	+SEEKERMISSILE
	+NOINTERACTION
	+FORCERADIUSDMG
	+EXTREMEDEATH
	Speed 1
	Scale 0.03
	States
	{
	Spawn:
		BAL1 A 0
		BAL1 A 0 A_SetUserArray("user_z",0,z)
		TNT1 A 0 A_Warp(AAPTR_TRACER,-20,0,0,0,WARPF_NOCHECKPOSITION|WARPF_USECALLERANGLE)
		TNT1 A 0 A_SetUserArray("user_z",1,z)
		TNT1 A 0 A_SetUserArray("user_z",2,(user_z[0]-user_z[1]))
		TNT1 A 0 A_Warp(AAPTR_TRACER,-20,0,user_z[2],0,WARPF_NOCHECKPOSITION|WARPF_USECALLERANGLE)
	Wrap:
		BAL1 A 0 A_Warp(AAPTR_TRACER,-20,0,user_z[2],-33,WARPF_INTERPOLATE|WARPF_USECALLERANGLE|WARPF_NOCHECKPOSITION)
		CB01 A 1 A_Weave(0,1,0,3)
		BAL1 A 0 A_SpawnItemEx("FlailBombChain",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		BAL1 A 0 A_JumpIfInventory("FlailToken",1,1,AAPTR_TARGET)
		Goto Explode
		
		BAL1 A 0 A_Warp(AAPTR_TRACER,-20,0,user_z[2],-33,WARPF_INTERPOLATE|WARPF_USECALLERANGLE|WARPF_NOCHECKPOSITION)
		CB01 A 1 A_Weave(0,1,0,3)
		BAL1 A 0 A_SetUserVar("user_count",user_count+1)
		BAL1 A 0 A_JumpIfInventory("FlailToken",1,1,AAPTR_TARGET)
		Goto Explode
		
		BAL1 A 0 A_JumpIf(user_count>=14,"Close")
		Loop
	Close:
		CB01 A 0 A_PlaySound("BS/Flailgun/ChainsEnd",5)
		BAL1 A 0 A_GiveInventory("FlailConstriction",1,AAPTR_TRACER)
		CB01 A 1 A_Warp(AAPTR_TRACER,-18,0,user_z[2],0,WARPF_INTERPOLATE|WARPF_NOCHECKPOSITION|WARPF_STOP)
		CB01 A 1 A_Warp(AAPTR_TRACER,-16,0,user_z[2],0,WARPF_INTERPOLATE|WARPF_NOCHECKPOSITION|WARPF_STOP)
		CB01 A 1 A_Warp(AAPTR_TRACER,-14,0,user_z[2],0,WARPF_INTERPOLATE|WARPF_NOCHECKPOSITION|WARPF_STOP)
		CB01 A 1 A_Warp(AAPTR_TRACER,-12,0,user_z[2],0,WARPF_INTERPOLATE|WARPF_NOCHECKPOSITION|WARPF_STOP)
	Waiting:
		CB01 A 1 A_Warp(AAPTR_TRACER,-10,0,user_z[2],0,WARPF_INTERPOLATE|WARPF_NOCHECKPOSITION|WARPF_STOP)
		BAL1 A 0 A_SetUserVar("user_timer",user_timer+1)
		BAL1 A 0 A_JumpIfInventory("FlailToken",1,1,AAPTR_TARGET)
		Goto Explode
		
		BAL1 A 0 A_JumpIf(user_timer>=(35*5),"Explode")
		Loop
	Explode:
		MISL B 0 A_TakeInventory("FlailConstriction",1000,0,AAPTR_TRACER)
		MISL B 0 A_TakeInventory("FlailToken",1000,0,AAPTR_TARGET)
		MISL B 0 A_TakeInventory("FlailLand",1000,0,AAPTR_TARGET)
		MISL B 0 A_TakeInventory("FlailOnEnemy",1000,0,AAPTR_TARGET)
		MISL B 0 A_PlaySound("BS/Flailgun/Explosion")
		MISL B 0 A_Explode(random(800,600),192,0)
		TNT1 A 0 A_Explode(128,192,1)
		TNT1 A 0 A_SpawnItemEx("FlailExplosion",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		Stop
	}
}

Actor FlailBombRight
{
	var int user_z[3];
	var int user_count;
	var int user_timer;
	Projectile
	+SEEKERMISSILE
	+NOINTERACTION
	+FORCERADIUSDMG
	+EXTREMEDEATH
	Speed 1
	Scale 0.03
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SetUserArray("user_z",0,z)
		TNT1 A 0 A_Warp(AAPTR_TRACER,-20,0,0,0,WARPF_NOCHECKPOSITION|WARPF_USECALLERANGLE)
		TNT1 A 0 A_SetUserArray("user_z",1,z)
		TNT1 A 0 A_SetUserArray("user_z",2,(user_z[0]-user_z[1]))
		TNT1 A 0 A_Warp(AAPTR_TRACER,-20,0,user_z[2],0,WARPF_NOCHECKPOSITION|WARPF_USECALLERANGLE)
	Wrap:
		BAL1 A 0 A_Warp(AAPTR_TRACER,-20,0,user_z[2],33,WARPF_INTERPOLATE|WARPF_USECALLERANGLE|WARPF_NOCHECKPOSITION)
		CB01 A 1 A_Weave(0,1,0,3)
		BAL1 A 0 A_SpawnItemEx("FlailBombChain",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
		BAL1 A 0 A_JumpIfInventory("FlailToken",1,1,AAPTR_TARGET)
		Goto Explode
		
		BAL1 A 0 A_Warp(AAPTR_TRACER,-20,0,user_z[2],33,WARPF_INTERPOLATE|WARPF_USECALLERANGLE|WARPF_NOCHECKPOSITION)
		CB01 A 1 A_Weave(0,1,0,3)
		BAL1 A 0 A_SetUserVar("user_count",user_count+1)
		BAL1 A 0 A_JumpIfInventory("FlailToken",1,1,AAPTR_TARGET)
		Goto Explode
		
		BAL1 A 0 A_JumpIf(user_count>=14,"Close")
		Loop
	Close:
		CB01 A 0 A_PlaySound("BS/Flailgun/ChainsEnd",5)
		CB01 A 1 A_Warp(AAPTR_TRACER,-18,0,user_z[2],0,WARPF_INTERPOLATE|WARPF_NOCHECKPOSITION|WARPF_STOP)
		CB01 A 1 A_Warp(AAPTR_TRACER,-16,0,user_z[2],0,WARPF_INTERPOLATE|WARPF_NOCHECKPOSITION|WARPF_STOP)
		CB01 A 1 A_Warp(AAPTR_TRACER,-14,0,user_z[2],0,WARPF_INTERPOLATE|WARPF_NOCHECKPOSITION|WARPF_STOP)
		CB01 A 1 A_Warp(AAPTR_TRACER,-12,0,user_z[2],0,WARPF_INTERPOLATE|WARPF_NOCHECKPOSITION|WARPF_STOP)
	Waiting:
		CB01 A 1 A_Warp(AAPTR_TRACER,-10,0,user_z[2],0,WARPF_INTERPOLATE|WARPF_NOCHECKPOSITION|WARPF_STOP)
		BAL1 A 0 A_SetUserVar("user_timer",user_timer+1)
		BAL1 A 0 A_JumpIfInventory("FlailToken",1,1,AAPTR_TARGET)
		Goto Explode
		
		BAL1 A 0 A_JumpIf(user_timer>=(35*5),"Explode")
		Loop
	Explode:
		MISL B 0 A_TakeInventory("FlailConstriction",1000,0,AAPTR_TRACER)
		MISL B 0 A_TakeInventory("FlailToken",1000,0,AAPTR_TARGET)
		MISL B 0 A_TakeInventory("FlailLand",1000,0,AAPTR_TARGET)
		MISL B 0 A_TakeInventory("FlailOnEnemy",1000,0,AAPTR_TARGET)
		MISL B 0 A_Explode(random(400,800),192,0)
		TNT1 A 0 A_Explode(128,192,1)
		TNT1 A 1 A_SpawnItemEx("FlailExplosion",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		Stop
	}
}

Actor FlailBombChain
{
	Projectile
	var int user_z[3];
	var int user_angle;
	+NOINTERACTION
	+SEEKERMISSILE
	Scale 0.085
	States
	{
	Spawn:
		PLSS B 0
		TNT1 A 0 A_PlaySound("BS/Flailgun/Chain",5,1,0)
		PLSS B 0 A_SetUserVar("user_angle",angle)
		BAL1 A 0 A_SetUserArray("user_z",0,z)
		TNT1 A 0 A_Warp(AAPTR_TRACER,-20,0,0,0,WARPF_NOCHECKPOSITION|WARPF_USECALLERANGLE)
		TNT1 A 0 A_SetUserArray("user_z",1,z)
		TNT1 A 0 A_SetUserArray("user_z",2,(user_z[0]-user_z[1]))
		TNT1 A 0 A_Warp(AAPTR_TRACER,-20,0,user_z[2],0,WARPF_NOCHECKPOSITION|WARPF_USECALLERANGLE)
	Checking:
		PLSS B 0 A_Warp(AAPTR_TRACER,-20,0,user_z[2],user_angle,WARPF_INTERPOLATE|WARPF_NOCHECKPOSITION)
		PLSS B 0 A_JumpIfInventory("FlailToken",1,1,AAPTR_TARGET)
		Goto End
		
		ASPK B 1 A_JumpIfInventory("FlailConstriction",1,"Close",AAPTR_TRACER)
		Loop
	Close:
		ASPK A 1 A_Warp(AAPTR_TRACER,-18,0,user_z[2],user_angle,WARPF_INTERPOLATE|WARPF_NOCHECKPOSITION|WARPF_STOP)
		ASPK A 1 A_Warp(AAPTR_TRACER,-16,0,user_z[2],user_angle,WARPF_INTERPOLATE|WARPF_NOCHECKPOSITION|WARPF_STOP)
		ASPK A 1 A_Warp(AAPTR_TRACER,-14,0,user_z[2],user_angle,WARPF_INTERPOLATE|WARPF_NOCHECKPOSITION|WARPF_STOP)
		ASPK A 1 A_Warp(AAPTR_TRACER,-12,0,user_z[2],user_angle,WARPF_INTERPOLATE|WARPF_NOCHECKPOSITION|WARPF_STOP)
	Waiting:
		ASPK A 1 A_Warp(AAPTR_TRACER,-10,0,user_z[2],user_angle,WARPF_INTERPOLATE|WARPF_NOCHECKPOSITION|WARPF_STOP)
		BAL1 A 0 A_JumpIfInventory("FlailToken",1,"Waiting",AAPTR_TARGET)
		Goto End
	End:
		TNT1 A 0
		Stop
	}
}
		
Actor FlailBombFlying
{
	Projectile
	+THRUACTORS
	+FORCERADIUSDMG
	+EXTREMEDEATH
	-NOGRAVITY
	Radius 6
	Height 6
	Speed 25
	Gravity 0.085
	Scale 0.03
	States
	{
	Spawn:
		BAL1 A 0
	Movement:
		CB01 A 1 bright
		BAL1 A 0 A_JumpIfInventory("FlailOnEnemy",1,"End",AAPTR_TARGET)
		BAL1 A 0 A_JumpIfInventory("FlailLand",1,"Still",AAPTR_TARGET)
		BAL1 A 0 A_JumpIfInventory("FlailToken",1,"Movement",AAPTR_TARGET)
		Goto Explode
	Death:
	Still:
		BAL1 A 0 A_ChangeFlag("NOINTERACTION",1)
		BAL1 A 0 A_NoGravity
		BAL1 A 0 A_Stop
	Stillness:
		CB01 A 1 bright
		BAL1 A 0 A_JumpIfInventory("FlailOnEnemy",1,"End",AAPTR_TARGET)
		BAL1 A 0 A_JumpIfInventory("FlailToken",1,"Stillness",AAPTR_TARGET)
	Explode:
		MISL B 0 A_PlaySound("BS/Flailgun/Explosion")
		MISL B 0 A_Explode(random(400,800),192,0)
		TNT1 A 1 A_SpawnItemEx("FlailExplosion",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		Stop
	End:
		TNT1 A 0
		Stop
	}
}

Actor FlailExplosion
{
	+NOINTERACTION
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 AAAAAAAAAA 0 A_SpawnItemEx("PBExploMiniBack",frandom(0,3),0,frandom(-6,6),frandom(0.1,3),0,frandom(-8,8),random(0,359),SXF_NOCHECKPOSITION)
		TNT1 AAAAAAAAAAAAAAA 0 A_SpawnItemEx("PBExploMiniBack",frandom(0,3),0,frandom(-6,6),frandom(0.1,3),0,frandom(-8,8),random(0,359),SXF_NOCHECKPOSITION,192)
		Stop
	}
}

Actor SuperFlail
{
	var int user_counter;
	Projectile
	+RIPPER	RipperLevel 1
	+NOBOSSRIP
	+DONTREFLECT
	+EXTREMEDEATH
	+FORCERADIUSDMG
	-NOGRAVITY
	+SEEKERMISSILE
	Radius 10
	Height 16
	Damage 40
	Speed 35
	Gravity 0.1
	Scale 0.05
	Translation "0:255=%[0,0,0]:[1,0.85,0.1]"
	States
	{
	Spawn:
		CB01 A 1
		Loop
	XDeath:		//this was in case it wasnt a ripper, but now it just sticks to walls
	Crash:
		TNT1 A 0 A_SetUserVar("user_counter",0)
		TNT1 A 0 A_ChangeFlag("THRUACTORS",1)
		TNT1 A 0 A_NoGravity
		TNT1 A 0 A_SeekerMissile(0,0,1,256,0)
	Looper:
		TNT1 A 0 A_JumpIf(user_counter>=60,"Explode")
		CB01 A 1 A_Warp(AAPTR_TRACER,0,0,32,0,WARPF_COPYINTERPOLATION|WARPF_NOCHECKPOSITION)
		TNT1 A 0 A_SetUserVar("user_counter",user_counter+1)
		Loop
	Death:
		TNT1 A 0 A_ChangeFlag("NOGRAVITY",1)
		CB01 A 60
	Explode:
		TNT1 A 0 A_PlaySound("BS/Flailgun/Explosion")
		TNT1 A 0 A_Explode(random(720,1046),192,0)
		TNT1 A 0 A_Explode(random(75,150),192,1)
		TNT1 A 10 A_SpawnItemEx("FlailExplosion",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
		Stop
	}
}
		

Actor FlailToken : Inventory
{	Inventory.MaxAmount 1	Inventory.InterhubAmount 0	}

Actor FlailLand : Inventory
{	Inventory.MaxAmount 1	Inventory.InterhubAmount 0	}

Actor FlailOnEnemy : Inventory
{	Inventory.MaxAmount 1	Inventory.InterhubAmount 0	}

Actor FlailConstriction : Inventory
{	Inventory.MaxAmount 1	Inventory.InterhubAmount 0	}